#pragma once

#include <iostream>
#include <locale>
#include <string>
#include <windows.h>
//#include <winsock2.h>
//#pragma comment(lib,"ws2_32.lib")


#define CURL_STATICLIB
#include "curl.h"

#ifndef _E_MAIN_WINDOW_ALREADY_LINKED_
#define _E_MAIN_WINDOW_ALREADY_LINKED_
#include "EWindowMain.h"
#endif

/**/
#ifndef _E_CLASS_LINKER_ALREADY_LINKED_
#define _E_CLASS_LINKER_ALREADY_LINKED_
#include "EClassLinker.h"
#endif
/**/

/**/
#include "NoSimpleWayAPI[v2]/EDataEntity.h"
/**/

/**/
#ifndef _IRR_KLANG_ALREADY_LINKED_
#define _IRR_KLANG_ALREADY_LINKED_
#include <irr/irrKlang.h>
#endif
/**/

#ifndef _E_GRAPHIC_CORE_ALREADY_LINKED_
/**/#define _E_GRAPHIC_CORE_ALREADY_LINKED_
/**/#include "NoSimpleWayAPI[v2]/EGraphicCore.h"
#endif

#include <chrono>
#include <windows.h>
#include <Lmcons.h>
#include <shlobj.h>

#define _SILENCE_EXPERIMENTAL_FILESYSTEM_DEPRECATION_WARNING
#include <experimental/filesystem>


namespace LootFilterVersionPattern
{
	std::vector<PatternStruct*> registered_loot_filter_version_patterns;
}

//class Entity;
EWindowMain* EWindowMain::link_to_main_window;

EButtonGroup* EWindowMain::select_rarity_button_group = nullptr;
//EButtonGroup* EWindowMain::select_quality_button_group = nullptr;
EButtonGroupFilterBlockEditor* EWindowMain::active_loot_filter_editor = nullptr;
EButtonGroup* EWindowMain::world_parameters = nullptr;
EButtonGroup* EWindowMain::tab_list_group = nullptr;
EButtonGroupNewLootFilter* EWindowMain::create_new_loot_filter_group = nullptr;
EButtonGroupDataEntity* EWindowMain::data_entity_filter = nullptr;
EButtonGroupBottomFilterBlockControl* EWindowMain::bottom_filter_block_control = nullptr;
EButtonGroupLootSimulator* EWindowMain::loot_simulator_button_group = nullptr;
EButtonGroupFilterEditorTopHeader* EWindowMain::header_line = nullptr;
EButtonGroupLootFilterList* EWindowMain::existing_loot_filter_list = nullptr;

//deleting groups
EButtonGroupConfirmActionOpenAutogeneratedLootFilter* EWindowMain::confirm_load_autogenerated_block = nullptr;
EButtonGroupConfirmActionDelete* EWindowMain::confirm_deletion_group = nullptr;

EButtonGroup* EWindowMain::info_button_group = nullptr;
EButtonGroup* EWindowMain::style_list_group = nullptr;
EButtonGroup* EWindowMain::pointer_to_joke_AD = nullptr;
EButtonGroup* EWindowMain::pointer_to_battlepass = nullptr;
EButtonGroupFastMessage* EWindowMain::background_loading_info = nullptr;
EButtonGroupLootFilterErrors* EWindowMain::registered_group_filter_error_list = nullptr;

EButtonGroupVersionControlConfigure* EWindowMain::registered_group_loot_version_configure = nullptr;


std::string												EWindowMain::username;
std::string												EWindowMain::path_of_exile_folder;

bool EWindowMain::first_time_open = false;
bool EWindowMain::have_no_loot_version_config = false;
bool EWindowMain::have_no_loot_version_pattern_config = false;


int														EWindowMain::selected_filter_tab_id;

RouterVariant* EWindowMain::registered_rarity_router_variants[NSW_registered_rarity_count];
RouterVariant* EWindowMain::registered_alternate_gem_quality_router_variants[NSW_registered_altered_gem_quality_count];


std::vector<EDataEntity*>								EWindowMain::registered_data_entity_game_item_list;
std::vector<EDataEntity*>								EWindowMain::registered_data_entity_class_list;
std::vector<EDataEntity*>								EWindowMain::registered_data_entity_explicit_list;

std::vector < std::string>								EWindowMain::filter_text_lines;
std::vector <EButtonGroupFilterBlockEditor*>			EWindowMain::filter_block_tabs = std::vector<EButtonGroupFilterBlockEditor*>(filter_tabs_count);

std::vector<ENamedSound*>								EWindowMain::default_sound_list;
std::vector<ENamedSound*>								EWindowMain::custom_sound_list;

GameItemAttribute* GameItemAttribute::default_game_attribute[DefaultGameAttributeEnum::_GAME_ATTRIBUTE_LAST_ELEMENT];


namespace NS_DefaultGabarites
{
	ETextureGabarite* texture_example_text_for_preview_box;
	ETextureGabarite* texture_example_text_for_preview_box_half;
	ETextureGabarite* texture_example_text_bg_for_preview_box;

	ETextureGabarite* texture_loot_version_full_ignore;
	ETextureGabarite* texture_loot_version_hide;
	ETextureGabarite* texture_loot_version_ignore;
	ETextureGabarite* texture_loot_version_default;
	ETextureGabarite* texture_loot_version_focus;

	ETextureGabarite* texture_show_hide_visual_editor;
	ETextureGabarite* texture_show_hide_visual_editor_deactivate;

	ETextureGabarite* texture_minimap_shape_circle;
	ETextureGabarite* texture_minimap_shape_diamond;
	ETextureGabarite* texture_minimap_shape_hexagon;
	ETextureGabarite* texture_minimap_shape_square;
	ETextureGabarite* texture_minimap_shape_star;
	ETextureGabarite* texture_minimap_shape_triangle;
	ETextureGabarite* texture_minimap_shape_cross;
	ETextureGabarite* texture_minimap_shape_moon;
	ETextureGabarite* texture_minimap_shape_raindrop;
	ETextureGabarite* texture_minimap_shape_kite;
	ETextureGabarite* texture_minimap_shape_pentagon;
	ETextureGabarite* texture_minimap_shape_upside_down_house;

	ETextureGabarite* texture_help_description_exact_match[NSW_languages_count];

	ETextureGabarite* texture_button_plus;

	ETextureGabarite* texture_button_move_up;
	ETextureGabarite* texture_button_move_down;
	ETextureGabarite* texture_button_move;
	ETextureGabarite* texture_button_move_small;

	ETextureGabarite* texture_button_cut;

	ETextureGabarite* texture_button_remove_filter_block;

	ETextureGabarite* texture_ray;

	ETextureGabarite* texture_WARNING;

	ETextureGabarite* texture_config_gear;


}


void EWindowMain::draw_additional(float _d)
{


	NS_EGraphicCore::default_batcher_for_drawing->set_transform_position(0.0f, 0.0f);
	NS_EGraphicCore::default_batcher_for_drawing->set_transform_screen_size(NS_EGraphicCore::SCREEN_WIDTH, NS_EGraphicCore::SCREEN_HEIGHT);
	NS_EGraphicCore::default_batcher_for_drawing->set_transform_zoom(1.0f);



	//for (int j = 0; j < CLUSTER_DIM_X; j++)
	//for (int i = 0; i < CLUSTER_DIM_Y; i++)
	//{
	//	if (!cluster_array[j][i]->entity_list.empty())
	//	for (Entity* e : cluster_array[j][i]->entity_list)
	//	{
	//		e->draw();
	//	}

	//}

	NS_EGraphicCore::default_batcher_for_drawing->draw_call();


	//if (EInputCore::key_pressed_once(GLFW_KEY_W))	{ EInputCore::logger_simple_success("WwWwW"); }
	//if (EInputCore::key_holded(GLFW_KEY_W))			{ EInputCore::logger_simple_success("holded WwWwW"); }
}

void EWindowMain::update_additional(float _d)
{
	//for (int j = 0; j < CLUSTER_DIM_X; j++)
	//for (int i = 0; i < CLUSTER_DIM_Y; i++)
	//{
	//	
	//	for (Entity* el : cluster_array[j][i]->entity_list)
	//	{
	//		el->update(_d);
	//	}
	//}

	//if (EInputCore::key_pressed_once(GLFW_KEY_LEFT_SHIFT))
	//{
	//	for (EButtonGroup* group : loot_filter_editor->group_list)
	//	{
	//		if (group->is_this_group_active())
	//		{
	//			EInputCore::logger_param("World x", group->region_gabarite->world_position_x);
	//			EInputCore::logger_param("World y", group->region_gabarite->world_position_y);
	//			std::cout << std::endl << std::endl;
	//		}
	//	}
	//}

	if
		(
			(EInputCore::key_pressed(GLFW_KEY_LEFT_CONTROL))
			&&
			(EInputCore::key_pressed_once(GLFW_KEY_DELETE))
			)
	{
		for (EButtonGroup* group : button_group_list)
		{
			//EWindowMain::loot_filter_editor->destroy_all_vertex_buffer_data();
			group->destroy_all_vertex_buffer_data();
		}
	}
	if
	(
		(EInputCore::key_pressed(GLFW_KEY_LEFT_SHIFT))
		&&
		(EInputCore::key_pressed_once(GLFW_KEY_F5))
	)
	{
		EWindowMain::import_loot_patterns_from_file();
		EWindowMain::add_all_loot_patter_to_loot_simulator(EWindowMain::loot_simulator_button_group->pointer_to_patterns_buttons_segment);
		EWindowMain::loot_simulator_button_group->need_refresh = true;
	}


}

void EDataActionCollection::action_select_this_text_variant(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EntityButton* clicked_button = static_cast<EntityButton*>(_entity);
	ETextArea* clicked_button_text_area = EntityButton::get_last_clickable_area(clicked_button)->text_area;

	EButtonGroup* root_group = clicked_button->parent_button_group->root_group;
	EDataContainer* root_container = root_group->data_container;


	ETextArea* target_text_area = static_cast<EDataContainer_Group_TextSelectorFromVariants*>(root_container)->target_button->main_text_area;

	//target_text_area->localisation_text = clicked_button_text_area->localisation_text;
	//*target_text_area->stored_text = *EntityButton::get_last_clickable_area(static_cast<EntityButton*>(_entity))->text_area->stored_text;

	//transfer parameters from [select rarity button] to [non-listed button]
	target_text_area->stored_color = clicked_button_text_area->stored_color;
	target_text_area->color = clicked_button_text_area->color;
	target_text_area->localisation_text = clicked_button_text_area->localisation_text;

	target_text_area->change_text(clicked_button_text_area->localisation_text.localisations[ELocalisationText::active_localisation]);

	root_group->close_this_group();
}

void EDataActionCollection::action_mark_parent_group_as_removed(Entity* _entity, ECustomData* _custom_data, float _d)
{
	//EWindowMain::make_unsaved_loot_filter_changer();
	EInputCore::logger_simple_info("try mark parent group is deleted");

	if (static_cast<EntityButton*>(_entity)->parent_button_group != nullptr)
	{

		static_cast<EntityButton*>(_entity)->parent_button_group->block_need_remove = true;

		EInputCore::logger_simple_success("marked as deleted");
	}
	else
	{
		EInputCore::logger_simple_error("parent is NULL");
	}
}

void EDataActionCollection::action_open_mark_filter_blocks_as_removed_confirmation(Entity* _entity, ECustomData* _custom_data, float _d)
{

	EWindowMain::confirm_deletion_group->button_invoker = static_cast<EntityButton*>(_entity);
	EWindowMain::confirm_deletion_group->group_invoker = static_cast<EntityButtonForFilterBlock*>(_entity)->parent_filter_block;

	EWindowMain::confirm_deletion_group->pointer_to_confirm_button->stored_action = &EDataActionCollection::action_confirmed_mark_filter_blocks_as_removed_confirmation;
	EWindowMain::confirm_deletion_group->pointer_to_decline_button->stored_action = &EDataActionCollection::action_close_root_group;

	EWindowMain::confirm_deletion_group->pointer_to_description_text_area->localisation_text.localisations[NSW_localisation_EN] = "Delete selected filter block. If multiple block selected, all selected block will be deleted.\nYou sure?";
	EWindowMain::confirm_deletion_group->pointer_to_description_text_area->localisation_text.localisations[NSW_localisation_RU] = "Вы уверены, что хотите удалить указанный блок лутфильтра?\nЕсли выбрано несколько блоков, будут удалены ВСЕ ВЫБРАННЫЕ БЛОКИ!";
	EWindowMain::confirm_deletion_group->pointer_to_description_text_area->update_localisation();

	EWindowMain::confirm_deletion_group->activate_move_to_foreground_and_center();
	//EButtonGroup::super_focus_on_this_group = EWindowMain::confirm_deletion_group;

	EWindowMain::confirm_deletion_group->make_this_group_superfocused();

}

void EDataActionCollection::action_confirmed_mark_filter_blocks_as_removed_confirmation(Entity* _entity, ECustomData* _custom_data, float _d)
{

	EButtonGroupFilterBlock*
		parent_group_for_button = static_cast<EButtonGroupFilterBlock*>(EWindowMain::confirm_deletion_group->group_invoker);

	parent_group_for_button->block_need_remove = true;



	//remove single button from error list
	//if ((!parent_group_for_button->is_selected) || (EButtonGroup::selected_groups.empty()))
	//{
	//	for (EntityButton* but : EWindowMain::registered_group_filter_error_list->part_with_buttons->workspace_button_list)
	//	{
	//		EntityButtonFilterBlockError*
	//			error_button = static_cast<EntityButtonFilterBlockError*>(but);

	//		if (error_button->target_filter_block == static_cast<EntityButtonForFilterBlock*>(_entity)->parent_filter_block)
	//		{
	//			EWindowMain::registered_group_filter_error_list->part_with_buttons->delete_exact_button(error_button);
	//		}

	//		EWindowMain::registered_group_filter_error_list->need_refresh = true;
	//	}
	//}
	//else//remove associated buttons from error list
	//{
	//	for (EButtonGroup* selected_group : EButtonGroup::selected_groups)
	//	{
	//		selected_group->block_need_remove = true;

	//		for (EntityButton* but : EWindowMain::registered_group_filter_error_list->part_with_buttons->workspace_button_list)
	//		{
	//			EntityButtonFilterBlockError*
	//				error_button = static_cast<EntityButtonFilterBlockError*>(but);

	//			if (error_button->target_filter_block == selected_group)
	//			{
	//				EWindowMain::registered_group_filter_error_list->part_with_buttons->delete_exact_button(error_button);

	//				EWindowMain::registered_group_filter_error_list->need_refresh = true;
	//			}
	//		}
	//	}
	//}

	if (EWindowMain::registered_group_filter_error_list->is_this_group_active())
	{
		EWindowMain::registered_group_filter_error_list->check_errors();
	}

	bool at_least_one_user_block = false;

	//int id = -1;
	for (EButtonGroup* group : EWindowMain::active_loot_filter_editor->group_list)
	{
		if (EButtonGroupFilterBlock* block = dynamic_cast<EButtonGroupFilterBlock*>(group))
		{
			if
				(
					(!block->block_need_remove)
					&&
					(!block->is_default_filter_block)
					&&
					(!block->is_base_filter_block)
					)
			{
				at_least_one_user_block = true;
				break;
			}
		}
	}

	if (!at_least_one_user_block)
	{
		parent_group_for_button->block_need_remove = false;


		parent_group_for_button->clear_non_listed_segment();
		parent_group_for_button->clear_listed_segment();

		//set default selection for filter version router
		for (int i = 0; i < NSW_LOOT_FILTER_MAX_VERSIONS; i++)
		{
			parent_group_for_button->version_routers[i]->select_variant(3);
		}

		parent_group_for_button->button_show_hide->select_variant(1);
		parent_group_for_button->button_continue->select_variant(1);




		parent_group_for_button->text_size = 30.0f;

		//background
		parent_group_for_button->pointer_to_color_button[0]->stored_color->set_color_RGBA(0.0f, 0.1f, 0.2, 1.0);

		//text
		parent_group_for_button->pointer_to_color_button[1]->stored_color->set_color_RGBA(0.9f, 0.5f, 0.2, 1.0);

		//rama
		parent_group_for_button->pointer_to_color_button[2]->stored_color->set_color_RGBA(0.55f, 0.57f, 0.6, 1.0);




		parent_group_for_button->user_sound_volume_value = 1.0f;
		parent_group_for_button->ingame_sound_volume_value = 1.0f;

		parent_group_for_button->game_sound_suppressor_bool = false;
		parent_group_for_button->custom_sound_suppressor_bool = false;


		parent_group_for_button->pointer_to_forcibly_disable_ingame_sound_variant_button->select_variant(0);
		parent_group_for_button->pointer_to_forcibly_disable_user_sound_variant_button->select_variant(0);
		parent_group_for_button->pointer_to_disable_enable_drop_sound->select_variant(0);
		parent_group_for_button->pointer_to_optional_user_sound->select_variant(0);

		parent_group_for_button->ray_suppressor = false;
		parent_group_for_button->minimap_icon_color_suppressor_bool = false;

		parent_group_for_button->pointer_to_forcibly_disable_minimap_icon_variant_button->select_variant(0);



		//color checkers
		for (int i = 0; i < 3; i++)
		{
			parent_group_for_button->color_check[i] = true;
		}
	}



	EWindowMain::make_unsaved_loot_filter_changes();
	EWindowMain::confirm_deletion_group->close_this_group();

	//EWindowMain::loot_simulator_button_group->refresh_loot_simulator();
	//EWindowMain::loot_simulator_button_group->delayed_execution = true;
	EWindowMain::loot_simulator_button_group->clear_loot_simulator();
}

void EDataActionCollection::action_highlight_removed_block(Entity* _entity, ECustomData* _custom_data, float _d)
{

	EntityButtonForFilterBlock*
		but = static_cast<EntityButtonForFilterBlock*>(_entity);

	EButtonGroupFilterBlock* filter_block = but->parent_filter_block;



	if (EClickableArea::active_clickable_region == but->main_clickable_area)
	{

		//bool in_selected_gabarite = false;

		if
			(
				(!filter_block->is_selected)
				||
				(EButtonGroup::selected_groups.empty())
				)
		{
			filter_block->highlight_this_group_red_warning();
		}
		else
		{
			for (EButtonGroup* selected_element : EButtonGroup::selected_groups)
			{
				selected_element->highlight_this_group_red_warning();
			}
		}
	}
}

void EDataActionCollection::action_generate_filter_block_text(Entity* _entity, ECustomData* _custom_data, float _d)
{
	//const char* output = (*_custom_data->clickable_area_list.back()->text_area->stored_text).c_str();
	std::string str = "";



	EButtonGroup* filter_block_massive = static_cast<EDataContainer_Button_StoreParentFilterBlock*>(_custom_data->data_container)->parent_filter_block->root_group;
	for (EButtonGroup* group : filter_block_massive->group_list)
	{
		if (EButtonGroupFilterBlock* block = dynamic_cast<EButtonGroupFilterBlock*>(group))//filter block
		{
			str += generate_filter_block_text(group, -1);
			str += '\n';
		}
		else
			if (EButtonGroupFilterBlockSeparator* block = dynamic_cast<EButtonGroupFilterBlockSeparator*>(group))//filter block separator
			{
				str += generate_filter_block_separator_text(static_cast<EButtonGroupFilterBlockSeparator*>(group), FilterBlockSaveMode::VERSION_ORIGINAL);
			}
	}

	const char* output = str.c_str();
	const size_t len = strlen(output) + 1;

	HGLOBAL hMem = GlobalAlloc(GMEM_MOVEABLE, len);
	memcpy(GlobalLock(hMem), output, len);

	GlobalUnlock(hMem);
	OpenClipboard(0);
	EmptyClipboard();
	SetClipboardData(CF_TEXT, hMem);
	CloseClipboard();
}

void EDataActionCollection::action_select_this_filter_variant(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EDataContainer_Group_DataEntitiesSearch*
	button_group_data_container = (EDataContainer_Group_DataEntitiesSearch*)EWindowMain::data_entity_filter->data_container;

	{
		EntityButtonFilterRule*
		filter_button = (EntityButtonFilterRule*)_entity;

		//std::cout << filter_button->target_data_container->target_rule << std::endl;

		//filter_button->target_data_container->target_rule = filter_button->target_filter_rule;
		button_group_data_container->target_rule = filter_button->target_filter_rule;

		filter_button->parent_button_group->selected_button = filter_button;


		if ((EInputCore::key_pressed(GLFW_KEY_LEFT_SHIFT)) || (true))
		{
			EWindowMain::data_entity_filter->right_side_for_configure->button_group_is_active = true;

			EWindowMain::data_entity_filter->right_side_for_configure->remove_all_workspace_buttons();

			DataEntityFilterConfigurer::clear_router_vector(DETFConfigurerMode::DATA_ENTITY_FILTER);

			for (int i = 0; i < filter_button->target_filter_rule->required_tag_list.size(); i++)
				//for (DataEntityTagFilter tag_filter : filter_button->target_filter_rule->required_tag_list)
			{
				DataEntityTagFilter*
				tag_filter = &filter_button->target_filter_rule->required_tag_list[i];


				DataEntityFilterConfigurer::create_configurer_buttons
				(
					tag_filter,
					DETFConfigurerMode::DATA_ENTITY_FILTER,
					EWindowMain::data_entity_filter->right_side_for_configure
				);
			}
		}
		else
		{
			EWindowMain::data_entity_filter->right_side_for_configure->button_group_is_active = false;
		}
		//filter_button->
	}

	EDataActionCollection::action_type_search_data_entity_text(button_group_data_container->filter_text_area);
}

void EDataActionCollection::action_switch_folder_for_data_entity_filter(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EntityButtonFilterRule*
		filter_rule_button = static_cast<EntityButtonFilterRule*>(_entity);

	filter_rule_button->is_expanded = !filter_rule_button->is_expanded;

	EInputCore::logger_param("child_button_list size", filter_rule_button->child_button_list.size());

	for (EntityButton* but : filter_rule_button->child_button_list)
	{
		EntityButtonFilterRule*
			child_button = static_cast<EntityButtonFilterRule*>(but);

		child_button->hidden_by_folder = !filter_rule_button->is_expanded;
	}

	//EDataContainer_Group_DataEntitiesSearch*
	//button_group_data_container = (EDataContainer_Group_DataEntitiesSearch*)EWindowMain::data_entity_filter->data_container;

	//EDataActionCollection::action_type_search_data_entity_text(button_group_data_container->filter_text_area);

	//EWindowMain::data_entity_filter->need_refresh = true;
	if (filter_rule_button->is_expanded)
	{
		EWindowMain::data_entity_filter->right_side_for_filters->scroll_down(filter_rule_button->button_gabarite->size_y * filter_rule_button->child_button_list.size());
	}
	else
	{
		EWindowMain::data_entity_filter->right_side_for_filters->scroll_up(filter_rule_button->button_gabarite->size_y * filter_rule_button->child_button_list.size());
	}

	EWindowMain::data_entity_filter->right_side_for_filters->need_change = true;
}

void EDataActionCollection::action_open_loot_filters_list_window(Entity* _entity, ECustomData* _custom_data, float _d)
{
	//for (EButtonGroup* group : EWindowMain::loot_filter_editor->group_list)
	//{
	//	group->need_remove = true;
	//}



	if
		(
			(EWindowMain::header_line->pointer_to_bottom_tabs_section->selected_button != nullptr)
			&&
			(static_cast<EntityButtonFilterBlockTab*>(EWindowMain::header_line->pointer_to_bottom_tabs_section->selected_button)->unsave_changes)
			&&
			(!EButtonGroupConfirmAction::confirm_decline_group->button_group_is_active)
			)
	{
		EButtonGroupConfirmAction::confirm_decline_group->pointer_to_confirm_button->stored_action = &EDataActionCollection::action_open_loot_filters_list_window;
		EButtonGroupConfirmAction::confirm_decline_group->activate_move_to_foreground_and_center();

		EButtonGroupConfirmAction::confirm_decline_group->make_this_group_superfocused();
	}
	else
	{
		EButtonGroupConfirmAction::confirm_decline_group->close_this_group();
		EWindowMain::existing_loot_filter_list->activate_move_to_foreground_and_center();
		EWindowMain::load_loot_filter_list();
	}

	EWindowMain::existing_loot_filter_list->need_refresh = true;
}

void EDataActionCollection::action_confirm_creating_new_loot_filter(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EButtonGroupConfirmAction::confirm_decline_group->close_this_group();

	EWindowMain::create_new_loot_filter_group->activate_move_to_foreground_and_center();
	EWindowMain::create_new_loot_filter_group->input_field_button->main_text_area->change_text("");
}

void EDataActionCollection::action_select_this_loot_filter_from_list(Entity* _entity, ECustomData* _custom_data, float _d)
{

	//EWindowMain::loot_filter_editor->need_remove = true;
	EWindowMain::confirm_load_autogenerated_block->close_this_group();

	for (EButtonGroup* group : EWindowMain::active_loot_filter_editor->group_list)
	{
		//group->need_remove = true;
		if (!disable_deleting) { delete group; }
	}

	EWindowMain::active_loot_filter_editor->group_list.clear();
	EWindowMain::active_loot_filter_editor->group_list.shrink_to_fit();
	EWindowMain::existing_loot_filter_list->close_this_group();

	EWindowMain::tab_list_group->selected_button->main_text_area->change_text(((EntityButtonForLootFilterSelector*)_entity)->filter_name);
	EWindowMain::tab_list_group->selected_button->main_text_area->localisation_text.localisations[NSW_localisation_EN] = ((EntityButtonForLootFilterSelector*)_entity)->filter_name;
	EWindowMain::tab_list_group->selected_button->main_text_area->localisation_text.localisations[NSW_localisation_RU] = ((EntityButtonForLootFilterSelector*)_entity)->filter_name;
	static_cast<EntityButtonFilterBlockTab*>(EWindowMain::tab_list_group->selected_button)->is_empty = false;


	EWindowMain::open_loot_filter(((EntityButtonForLootFilterSelector*)_entity)->loot_filter_full_path, LootFilterOpenMode::LOOT_FILTER_OPEN_MODE_USER_FILTER_FROM_DISC);

	if (true)
	{
		EButtonGroupFilterBlockSeparator*
			separator = EWindowMain::create_filter_block_separator(EWindowMain::active_loot_filter_editor, -1);
		separator->pointer_to_description_button->main_text_area->change_text("DEFAULT FILTER BLOCKS");
		separator->is_expanded = false;
		separator->autogenerated_do_dot_save = true;
		separator->for_default_filter_block = true;

		EWindowMain::open_loot_filter("data/default_loot_filter.filter", LootFilterOpenMode::LOOT_FILTER_OPEN_MODE_DEFAULT_FILTER_FROM_GAME);

		EButtonGroupFilterBlockSeparator*
			base_separator = EWindowMain::create_filter_block_separator(EWindowMain::active_loot_filter_editor, -1);
		base_separator->pointer_to_description_button->main_text_area->change_text("BASE COLOURS");
		base_separator->is_expanded = false;
		base_separator->autogenerated_do_dot_save = true;
		base_separator->for_default_filter_block = true;

		EWindowMain::open_loot_filter("data/base_loot_filter.filter", LootFilterOpenMode::LOOT_FILTER_OPEN_MODE_BASIC_FILTER_COLORS_FROM_GAME);
	}





	for (EButtonGroup* group : EWindowMain::active_loot_filter_editor->group_list)
	{
		if (group->group_is_suppressed) { group->recursive_set_suppressed(); }
	}

	//EWindowMain::loot_filter_editor->realign_groups();

	EWindowMain::active_loot_filter_editor->need_refresh = true;

	//EWindowMain::loot_simulator_button_group->refresh_loot_simulator();
	EWindowMain::loot_simulator_button_group->clear_loot_simulator();
	EWindowMain::loot_simulator_button_group->delayed_execution = true;

	EWindowMain::remove_unsave_changes_flag_from_tab();

}

void EDataActionCollection::action_add_all_entity_buttons_to_filter_block(Entity* _entity, ECustomData* _custom_data, float _d)
{
	auto data_entity_container = static_cast<EDataContainer_Group_DataEntitiesSearch*>(static_cast<EntityButton*>(_entity)->parent_button_group->root_group->data_container);

	if ((data_entity_container != nullptr) && (data_entity_container->pointer_to_group_with_data_entities != nullptr))
	{
		for (EntityButton* but : data_entity_container->pointer_to_group_with_data_entities->workspace_button_list)
			if (but->entity_is_active())
			{
				data_entity_container->action_on_select_for_button(but, Entity::get_last_custom_data(but), _d);
			}
	}


}

void EDataActionCollection::action_import_filter_text_from_clipboard(Entity* _entity, ECustomData* _custom_data, float _d)
{
	if (!OpenClipboard(nullptr))
	{
	}

	// Get handle of clipboard object for ANSI text
	HANDLE hData = GetClipboardData(CF_TEXT);
	if (hData == nullptr)
	{
	}

	// Lock the handle to get the actual text pointer
	char* pszText = static_cast<char*>(GlobalLock(hData));
	if (pszText == nullptr)
	{
	}

	// Save text in a string class instance
	std::string clipboard_text(pszText);

	std::string full_text = clipboard_text;

	EWindowMain::filter_text_lines.clear();
	std::string buffer = "";

	for (int i = 0; i < full_text.length(); i++)
	{

		if ((full_text[i] == '\r') || (full_text[i] == '\n') || (i + 1 >= full_text.length()))
		{
			if (i + 1 >= full_text.length())
			{
				buffer += full_text[i];
			}

			EWindowMain::filter_text_lines.push_back(buffer);
			buffer = "";
		}

		if
			(
				(
					(i < full_text.length())
					&&
					(full_text[i] != '\r')
					&&
					(full_text[i] != '\n')
					)

				)
		{
			buffer += full_text[i];
		}
	}

	//text = clipboard_text;

	// Release the lock
	GlobalUnlock(hData);

	// Release the clipboard
	CloseClipboard();

	EWindowMain::parse_filter_text_lines(static_cast<EntityButtonForFilterBlock*>(_entity)->parent_filter_block, LootFilterOpenMode::LOOT_FILTER_OPEN_MODE_USER_FILTER_FROM_DISC);

	EWindowMain::active_loot_filter_editor->need_refresh = true;

}

void EDataActionCollection::action_add_text_as_item(Entity* _entity, ECustomData* _custom_data, float _d)
{
	auto data_entity_container = static_cast<EDataContainer_Group_DataEntitiesSearch*>(static_cast<EntityButton*>(_entity)->parent_button_group->root_group->data_container);

	EntityButtonWideItem*
		wide_button = EntityButtonWideItem::create_wide_item_button
		(
			new ERegionGabarite(220.0f, 40.0f),
			data_entity_container->pointer_to_group_item_receiver,
			nullptr,
			EFont::font_list[0],
			true
		);


	data_entity_container->pointer_to_group_item_receiver->add_button_to_working_group(wide_button);

	//wide_button->description_container->replacer_list.push_back(EStringReplacer("%a", data_entity_container->filter_text_area->original_text));

	ELocalisationText l_text;
	l_text.base_name = data_entity_container->filter_text_area->original_text;
	l_text.localisations[NSW_localisation_EN] = data_entity_container->filter_text_area->original_text;
	l_text.localisations[NSW_localisation_RU] = data_entity_container->filter_text_area->original_text;

	wide_button->main_text_area->localisation_text = l_text;
	wide_button->main_text_area->change_text(l_text.localisations[ELocalisationText::active_localisation]);

	//EButtonGroup::change_group(data_entity_container->pointer_to_group_item_receiver);
	data_entity_container->pointer_to_group_item_receiver->need_change = true;

	((EntityButton*)(_entity))->parent_button_group->root_group->close_this_group();
}

void EDataActionCollection::action_add_new_filter_block(Entity* _entity, ECustomData* _custom_data, float _d)
{
	int position = -1;

	EDataContainer* base_container = ((EntityButton*)_entity)->parent_button_group->root_group->data_container;
	EDataContainer_Group_AddContentToFilterBlock* data_container = (EDataContainer_Group_AddContentToFilterBlock*)base_container;
	EButtonGroupFilterBlock* filter_block = data_container->target_filter_block;

	for (int i = 0; i < EWindowMain::active_loot_filter_editor->group_list.size(); i++)
	{
		if (EWindowMain::active_loot_filter_editor->group_list[i] == filter_block)
		{
			position = i;
		}
	}

	EWindowMain::create_filter_block(EWindowMain::active_loot_filter_editor, position);

	EWindowMain::active_loot_filter_editor->group_list[position]->highlight_this_group_green_info();

	EWindowMain::active_loot_filter_editor->need_refresh = true;

	if (!EInputCore::key_pressed(GLFW_KEY_LEFT_SHIFT))
	{
		EButtonGroup::add_content_to_filter_block_group->close_this_group();
	}

	//EWindowMain::make_unsaved_loot_filter_changer();

	//EWindowMain::loot_simulator_button_group->refresh_loot_simulator();
	EWindowMain::loot_simulator_button_group->delayed_execution = true;
}

void EDataActionCollection::action_open_custom_sound_list(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EButtonGroup::sound_list_group->stored_sound_type_enum = NSW_StoredSoundsType::CUSTOM_USER_SOUND;

	EButtonGroup::sound_list_group->target_sound_button = static_cast<EntityButtonFilterSound*>(_entity);
	EButtonGroup::sound_list_group->activate_move_to_foreground_and_center();

	EntityButtonFilterSound*
		clicked_sound_button = static_cast<EntityButtonFilterSound*>(_entity);



	EButtonGroup::sound_list_group->action_on_select_for_button = &EDataActionCollection::action_select_this_sound_for_target_button;
	//EWindowMain::load_custom_sound_list();

	EButtonGroup::sound_list_group->pointer_to_sound_list = &EWindowMain::custom_sound_list;

	EButtonGroup::sound_list_group->refresh_sound_list();
	EButtonGroup::sound_list_group->need_refresh = true;
}

void EDataActionCollection::action_open_ingame_sound_list(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EButtonGroup::sound_list_group->stored_sound_type_enum = NSW_StoredSoundsType::INGAME_SOUNDS;

	EButtonGroup::sound_list_group->target_sound_button = static_cast<EntityButtonFilterSound*>(_entity);
	EButtonGroup::sound_list_group->activate_move_to_foreground_and_center();

	EntityButtonFilterSound*
		clicked_sound_button = static_cast<EntityButtonFilterSound*>(_entity);

	EButtonGroup::sound_list_group->action_on_select_for_button = &EDataActionCollection::action_select_this_sound_for_target_button;
	//EWindowMain::load_custom_sound_list();

	EButtonGroup::sound_list_group->pointer_to_sound_list = &EWindowMain::default_sound_list;

	EButtonGroup::sound_list_group->refresh_sound_list();
	EButtonGroup::sound_list_group->need_refresh = true;
}

void EDataActionCollection::action_play_attached_sound(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EntityButtonFilterSound* sound_button = static_cast<EntityButtonFilterSound*>(_entity);

	if (sound_button->named_sound_vector.empty())
	{
		EInputCore::logger_simple_error("<named_sound_vector> is EMPTY!");
	}
	else
	{
		ENamedSound*
			random_sound;

		random_sound = sound_button->named_sound_vector[rand() % sound_button->named_sound_vector.size()];

		if (random_sound == nullptr)
		{
			EInputCore::logger_simple_error("<random_sound> is NULL!");
		}
		else
			if (random_sound->sound == nullptr)
			{
				EInputCore::logger_simple_error("<sound> in <ENamedSound> is NULL!");
			}
			else
				if (ESound::engine == nullptr)
				{
					EInputCore::logger_simple_error("Sound engine dont work!");
				}
				else
				{
					float sound_multiplier = 1.0f;

					if (sound_button->parent_filter_block != nullptr)
					{
						if (EButtonGroup::sound_list_group->stored_sound_type_enum == NSW_StoredSoundsType::INGAME_SOUNDS)
						{
							sound_multiplier = sound_button->parent_filter_block->ingame_sound_volume_value;
						}
						else
						{
							sound_multiplier = sound_button->parent_filter_block->user_sound_volume_value;
						}
					}

					random_sound->sound->setDefaultVolume(0.01f * sound_multiplier);


					ESound::engine->play2D(random_sound->sound);

				}
	}
}

void EDataActionCollection::action_invoke_button_action_in_sound_group(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EntityButtonFilterSound* sound_button = static_cast<EntityButtonFilterSound*>(_entity);

	if (sound_button->target_sound_group != nullptr)
	{
		if (sound_button->target_sound_group->action_on_select_for_button != nullptr)
		{
			sound_button->target_sound_group->action_on_select_for_button(sound_button, _custom_data, _d);
		}

		if ((sound_button->target_sound_group != nullptr) && (sound_button->target_sound_group->stored_sound_type_enum != NSW_StoredSoundsType::CUSTOM_USER_SOUND))
		{
			sound_button->target_sound_group->close_this_group();
		}
	}
}

void EDataActionCollection::action_show_hide_cosmetic_blocks(Entity* _entity, ECustomData* _custom_data, float _d)
{
	auto but = static_cast<EntityButtonVariantRouterForFilterBlock*>(_entity);

	//but->parent_filter_block->pointer_to_cosmetic_segment	->is_active									= but->selected_variant;
	but->parent_filter_block->pointer_to_sound_segment->button_group_is_active = but->selected_variant;
	but->parent_filter_block->pointer_to_minimap_and_ray_segment->button_group_is_active = but->selected_variant;
	but->parent_filter_block->pointer_to_minimap_and_ray_segment->button_group_is_active = but->selected_variant;
	but->parent_filter_block->pointer_to_fake_listed_segment_in_filter_block->button_group_is_active = but->selected_variant;
	but->parent_filter_block->pointer_to_listed_segment_in_filter_block->button_group_is_active = !but->selected_variant;



	//but->parent_filter_block->pointer_to_cosmetic_segment->region_gabarite->have_phantom_translation	= false;
	but->parent_filter_block->pointer_to_sound_segment->region_gabarite->have_phantom_translation = false;
	but->parent_filter_block->pointer_to_minimap_and_ray_segment->region_gabarite->have_phantom_translation = false;
	but->parent_filter_block->pointer_to_minimap_and_ray_segment->region_gabarite->have_phantom_translation = false;
	but->parent_filter_block->pointer_to_fake_listed_segment_in_filter_block->region_gabarite->have_phantom_translation = false;
	but->parent_filter_block->pointer_to_listed_segment_in_filter_block->region_gabarite->have_phantom_translation = false;





	//EButtonGroup::change_group(but->parent_filter_block);
	but->parent_filter_block->need_change = true;
	//EButtonGroup::change_group(but->parent_filter_block);
}

void EDataActionCollection::action_select_this_sound_for_target_button(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EWindowMain::make_unsaved_loot_filter_changes();

	EntityButtonFilterSound*
		sound_button = static_cast<EntityButtonFilterSound*>(_entity);

	EButtonGroupSoundList*
		sound_group = EButtonGroup::sound_list_group;

	std::vector<ENamedSound*>* pointer_to_target_named_sound = &(sound_group->target_sound_button->named_sound_vector);

	if (sound_button->named_sound_vector.empty())
	{
		EInputCore::logger_simple_error("Cannot set sound because sound_vector in this button is EMPTY!");
	}
	else
		if (sound_group->target_sound_button != nullptr)
		{
			if (sound_group->stored_sound_type_enum == NSW_StoredSoundsType::INGAME_SOUNDS)
			{
				//push sound to vector
				if (sound_group->target_sound_button->named_sound_vector.empty())
				{
					(*pointer_to_target_named_sound).push_back(sound_button->named_sound_vector[0]);
				}
				else//replace existing sound in vector
				{
					(*pointer_to_target_named_sound)[0] = sound_button->named_sound_vector[0];
				}

				EButtonGroup::sound_list_group->set_colors_to_registered_buttons();
			}
			else
				if (sound_group->stored_sound_type_enum == NSW_StoredSoundsType::CUSTOM_USER_SOUND)
				{
					(*pointer_to_target_named_sound).push_back(sound_button->named_sound_vector[0]);

					EButtonGroup::sound_list_group->add_selected_button_to_right_side(sound_button->named_sound_vector[0]);

					EButtonGroup::sound_list_group->set_colors_to_registered_buttons();
					EButtonGroup::sound_list_group->part_with_registered_sound->need_change = true;
				}
		}

}

void EDataActionCollection::action_select_this_tab(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EntityButtonFilterBlockTab* tab_button = static_cast<EntityButtonFilterBlockTab*>(_entity);

	//for (EButtonGroup* group: EWindowMain::loot_filter_editor->group)

	EWindowMain::active_loot_filter_editor->destroy_all_vertex_buffer_data();

	int id = -1;

	//search matched EButtonGroup
	for (int i = 0; i < EWindowMain::link_to_main_window->button_group_list.size(); i++)
		if (EWindowMain::link_to_main_window->button_group_list[i] == EWindowMain::active_loot_filter_editor)
		{
			EWindowMain::link_to_main_window->button_group_list[i] = EWindowMain::filter_block_tabs[tab_button->tab_id];
			break;
		}

	for (int i = 0; i < EWindowMain::link_to_main_window->autosize_group_list.size(); i++)
		if (EWindowMain::link_to_main_window->autosize_group_list[i] == EWindowMain::active_loot_filter_editor)
		{
			EWindowMain::link_to_main_window->autosize_group_list[i] = EWindowMain::filter_block_tabs[tab_button->tab_id];
			break;
		}


	EWindowMain::header_line->pointer_to_bottom_tabs_section->selected_button = tab_button;

	EWindowMain::active_loot_filter_editor = EWindowMain::filter_block_tabs[tab_button->tab_id];
	EWindowMain::selected_filter_tab_id = tab_button->tab_id;

	for (EWindow* w : EWindow::window_list)
	{
		NS_EGraphicCore::refresh_autosize_groups(w);
	}

	//EWindowMain::loot_simulator_button_group->refresh_loot_simulator();
	EWindowMain::loot_simulator_button_group->clear_loot_simulator();
	EWindowMain::loot_simulator_button_group->delayed_execution = true;

	//EButtonGroup::change_group(EWindowMain::loot_filter_editor);
	EWindowMain::active_loot_filter_editor->need_change = true;

}

void EDataActionCollection::action_create_new_loot_filter_with_name(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EntityButton* but = static_cast<EntityButton*>(_entity);

	if
		(
			(but->parent_button_group != nullptr)
			&&
			(but->parent_button_group->root_group != nullptr)
			)
	{
		std::string new_loot_filter_name = static_cast<EButtonGroupNewLootFilter*>(but->parent_button_group->root_group)->input_field_button->main_text_area->original_text;

		EntityButtonFilterBlockTab* tab{};

		//tab = static_cast<EntityButtonFilterBlockTab*>(EWindowMain::tab_list_group->selected_button);

		for (EntityButton* tab_button : EWindowMain::tab_list_group->workspace_button_list)
		{
			if (static_cast<EntityButtonFilterBlockTab*>(tab_button)->is_empty)
			{
				tab = static_cast<EntityButtonFilterBlockTab*>(tab_button);

				EWindowMain::tab_list_group->selected_button = tab;

				break;
			}
		}

		if (tab == nullptr) { tab = static_cast<EntityButtonFilterBlockTab*>(EWindowMain::tab_list_group->selected_button); }

		EDataActionCollection::action_select_this_tab(tab, tab->main_custom_data, _d);

		EButtonGroup*
			filter_editor = tab->target_filter_editor;

		tab->is_empty = false;

		//EWindowMain::loot_filter_editor = tab->target_filter_editor;
		//EWindowMain::loot_filter_editor = EWindowMain::filter_block_tabs[tab->tab_id];

		for (EButtonGroup* button_group : filter_editor->group_list)
		{
			if (!disable_deleting) { delete button_group; }
		};

		filter_editor->group_list.clear();
		filter_editor->group_list.shrink_to_fit();

		tab->main_text_area->change_text(new_loot_filter_name);
		tab->main_text_area->localisation_text.localisations[NSW_localisation_EN] = new_loot_filter_name;
		tab->main_text_area->localisation_text.localisations[NSW_localisation_RU] = new_loot_filter_name;

		EButtonGroupFilterBlock* created_filter_block = EWindowMain::create_filter_block(filter_editor, -1);

		filter_editor->scroll_y = 0.0f;



		EWindowMain::create_new_loot_filter_group->close_this_group();;

		EDataActionCollection::action_multisave_lootfilter(_entity, _custom_data, _d);

		//EButtonGroup::refresh_button_group(filter_editor);
		filter_editor->need_refresh;
	}
}

void EDataActionCollection::action_open_new_lootfilter_group(Entity* _entity, ECustomData* _custom_data, float _d)
{
	if
		(
			(EWindowMain::header_line->pointer_to_bottom_tabs_section->selected_button != nullptr)
			&&
			(static_cast<EntityButtonFilterBlockTab*>(EWindowMain::header_line->pointer_to_bottom_tabs_section->selected_button)->unsave_changes)
			)
	{

		EButtonGroupConfirmAction::confirm_decline_group->pointer_to_confirm_button->stored_action = &EDataActionCollection::action_confirm_creating_new_loot_filter;
		EButtonGroupConfirmAction::confirm_decline_group->activate_move_to_foreground_and_center();

		EButtonGroupConfirmAction::confirm_decline_group->make_this_group_superfocused();
	}
	else
	{
		EWindowMain::create_new_loot_filter_group->activate_move_to_foreground_and_center();
		EWindowMain::create_new_loot_filter_group->input_field_button->main_text_area->change_text("");
	}
}

void EDataActionCollection::action_clone_block(Entity* _entity, ECustomData* _custom_data, float _d)
{
	//EWindowMain::make_unsaved_loot_filter_changer();

	EDataContainer* base_container = ((EntityButton*)_entity)->parent_button_group->root_group->data_container;
	EDataContainer_Group_AddContentToFilterBlock* data_container = (EDataContainer_Group_AddContentToFilterBlock*)base_container;
	EButtonGroupFilterBlock* filter_block = data_container->target_filter_block;

	int position = -1;
	for (int i = 0; i < EWindowMain::active_loot_filter_editor->group_list.size(); i++)
	{
		if (EWindowMain::active_loot_filter_editor->group_list[i] == filter_block)
		{
			position = i;


		}
	}

	if (position >= 0)
	{
		std::string full_text = "";
		full_text += generate_filter_block_text(EWindowMain::active_loot_filter_editor->group_list[position], -1);

		generate_filter_lines_from_text(full_text);
	}

	EWindowMain::parse_filter_text_lines(filter_block, LootFilterOpenMode::LOOT_FILTER_OPEN_MODE_USER_FILTER_FROM_DISC);

	EWindowMain::active_loot_filter_editor->group_list[position]->highlight_this_group_green_info();

	EWindowMain::active_loot_filter_editor->need_refresh = true;

	if (!EInputCore::key_pressed(GLFW_KEY_LEFT_SHIFT))
	{
		EButtonGroup::add_content_to_filter_block_group->close_this_group();
	}

	//EWindowMain::loot_simulator_button_group->refresh_loot_simulator();
	EWindowMain::loot_simulator_button_group->delayed_execution = true;
}

void EDataActionCollection::action_add_separator_block(Entity* _entity, ECustomData* _custom_data, float _d)
{
	//EWindowMain::make_unsaved_loot_filter_changer();

	int position = -1;

	EDataContainer* base_container = ((EntityButton*)_entity)->parent_button_group->root_group->data_container;
	EDataContainer_Group_AddContentToFilterBlock* data_container = (EDataContainer_Group_AddContentToFilterBlock*)base_container;
	EButtonGroupFilterBlock* filter_block = data_container->target_filter_block;

	for (int i = 0; i < EWindowMain::active_loot_filter_editor->group_list.size(); i++)
	{
		if (EWindowMain::active_loot_filter_editor->group_list[i] == filter_block)
		{
			position = i;
		}
	}

	EButtonGroupFilterBlockSeparator* jc_separator = EWindowMain::create_filter_block_separator(EWindowMain::active_loot_filter_editor, position);
	jc_separator->highlight_this_group_green_info();

	EWindowMain::active_loot_filter_editor->need_refresh = true;

	//EDataActionCollection::action_make_unsave_filter_block_changes(_entity, _custom_data, _d);
	EWindowMain::make_unsaved_loot_filter_changes();

	if (!EInputCore::key_pressed(GLFW_KEY_LEFT_SHIFT))
	{
		//EButtonGroup::add_content_to_filter_block_group->button_group_is_active = false;
		EButtonGroup::add_content_to_filter_block_group->close_this_group();
	}
}

void EDataActionCollection::generate_filter_lines_from_text(std::string& full_text)
{
	EWindowMain::filter_text_lines.clear();
	std::string buffer = "";

	for (int i = 0; i < full_text.length(); i++)
	{

		if ((full_text[i] == '\r') || (full_text[i] == '\n') || (i + 1 >= full_text.length()))
		{
			if (i + 1 >= full_text.length())
			{
				buffer += full_text[i];
			}

			EWindowMain::filter_text_lines.push_back(buffer);
			buffer = "";
		}

		if
			(
				(
					(i < full_text.length())
					&&
					(full_text[i] != '\r')
					&&
					(full_text[i] != '\n')
					)

				)
		{
			buffer += full_text[i];
		}
	}
}

void EDataActionCollection::action_remove_filter_block(Entity* _entity, ECustomData* _custom_data, float _d)
{
	static_cast<EntityButtonForFilterBlock*>(_entity)->parent_filter_block->block_need_remove = true;

	bool have_any_user_block = false;



	EWindowMain::loot_simulator_button_group->clear_loot_simulator();

	//EWindowMain::loot_simulator_button_group->refresh_loot_simulator();
	//EWindowMain::loot_simulator_button_group->delayed_execution = true;

}

void EDataActionCollection::action_move_filter_block_up(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EButtonGroupFilterBlock*
		parent_filter_block = static_cast<EntityButtonForFilterBlock*>(_entity)->parent_filter_block;

	int vector_position = -1;

	for (int i = 0; i < EWindowMain::active_loot_filter_editor->group_list.size(); i++)
		if (EWindowMain::active_loot_filter_editor->group_list[i] == parent_filter_block)
		{
			vector_position = i;
		}

	if (vector_position > 0)
	{
		EButtonGroupFilterBlock*
			swap = parent_filter_block;

		EWindowMain::active_loot_filter_editor->group_list[vector_position] = EWindowMain::active_loot_filter_editor->group_list[vector_position - 1];
		EWindowMain::active_loot_filter_editor->group_list[vector_position - 1] = swap;

		swap->highlight_this_group_green_info();

		//EButtonGroup::change_group(EWindowMain::loot_filter_editor);
		EWindowMain::active_loot_filter_editor->need_change = true;

	}
}

void EDataActionCollection::action_move_filter_block_down(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EButtonGroupFilterBlock*
		parent_filter_block = static_cast<EntityButtonForFilterBlock*>(_entity)->parent_filter_block;

	//int vector_position = -1;

	//for (int i = 0; i < EWindowMain::loot_filter_editor->group_list.size(); i++)
	//	if (EWindowMain::loot_filter_editor->group_list[i] == parent_filter_block)
	//	{
	//		vector_position = i;
	//	}

	//if ((vector_position >= 0) && (vector_position < EWindowMain::loot_filter_editor->group_list.size()))
	//{
	//	EButtonGroupFilterBlock*
	//	swap = parent_filter_block;
	//	EWindowMain::loot_filter_editor->group_list[vector_position] = EWindowMain::loot_filter_editor->group_list[vector_position + 1];
	//	EWindowMain::loot_filter_editor->group_list[vector_position + 1] = swap;

	//	//EButtonGroup::change_group(EWindowMain::loot_filter_editor);
	//	
	//}

	parent_filter_block->swap_to_next = true;

	//EWindowMain::loot_filter_editor->need_change = true;
}

void EDataActionCollection::action_move_filter_block(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EButtonGroup::vector_moving_group = static_cast<EntityButtonForFilterBlock*>(_entity)->parent_filter_block;
	EButtonGroup::parent_vector_moving_group = static_cast<EntityButtonForFilterBlock*>(_entity)->parent_button_group->root_group;

	EButtonGroup::move_vector_mode = MoveVectorMethod::METHOD_DRAG;

	EWindowMain::make_unsaved_loot_filter_changes();
}

void EDataActionCollection::action_move_button_group(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EButtonGroup::vector_moving_group = static_cast<EntityButtonMoveButtonGroup*>(_entity)->target_group_for_moving;
	EButtonGroup::parent_vector_moving_group = static_cast<EntityButtonMoveButtonGroup*>(_entity)->parent_group_for_moving;

	EButtonGroup::move_vector_mode = static_cast<EntityButtonMoveButtonGroup*>(_entity)->move_method;
}

void EDataActionCollection::action_open_delete_listed_segment_confirmation(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EWindowMain::confirm_deletion_group->button_invoker = static_cast<EntityButton*>(_entity);
	EWindowMain::confirm_deletion_group->group_invoker = static_cast<EntityButtonForListedSegment*>(_entity)->listed_group;

	EWindowMain::confirm_deletion_group->pointer_to_confirm_button->stored_action = &EDataActionCollection::action_confirmed_deleting_listed_segment;
	EWindowMain::confirm_deletion_group->pointer_to_decline_button->stored_action = &EDataActionCollection::action_close_root_group;

	EWindowMain::confirm_deletion_group->pointer_to_description_text_area->localisation_text.localisations[NSW_localisation_EN] = "Delete selected block. You sure?";
	EWindowMain::confirm_deletion_group->pointer_to_description_text_area->localisation_text.localisations[NSW_localisation_RU] = "Вы уверены, что хотите удалить указанный блок?";
	EWindowMain::confirm_deletion_group->pointer_to_description_text_area->update_localisation();

	EWindowMain::confirm_deletion_group->activate_move_to_foreground_and_center();
	EWindowMain::confirm_deletion_group->make_this_group_superfocused();
}

void EDataActionCollection::action_confirmed_deleting_listed_segment(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EWindowMain::make_unsaved_loot_filter_changes();

	EntityButtonConfirmAction*
		confirm_button = static_cast<EntityButtonConfirmAction*>(_entity);

	EButtonGroupConfirmActionDelete*
		confirm_group = static_cast<EButtonGroupConfirmActionDelete*>(confirm_button->parent_button_group->root_group);


	EButtonGroup*
		attribute_tab_group = static_cast<EntityButtonForListedSegment*>(confirm_group->button_invoker)->listed_group->parent_filter_block->pointer_to_attribute_tab;
	confirm_group->group_invoker->block_need_remove = true;

	//attribute_tab_group->block_need_remove = true;

	EntityButtonAttributeTab*
		selected_button = static_cast<EntityButtonAttributeTab*>(attribute_tab_group->selected_button);

	//selected_button->target_whole_listed_block->button_group_is_active = false;
	//static_cast<EntityButtonForListedSegment*>(confirm_button)listed_group->filter_block_need_remove = true;

	if (EWindowMain::registered_group_filter_error_list->is_this_group_active())
	{
		EWindowMain::registered_group_filter_error_list->check_errors();
	}

	if (selected_button != nullptr)
	{
		selected_button->entity_need_remove = true;
		attribute_tab_group->selected_button = nullptr;


		//deactivate all listed groups
		for (EButtonGroup* group : selected_button->parent_filter_block->pointer_to_listed_attributes->group_list)
		{
			group->button_group_is_active = true;
		}

		for (EntityButton* but : selected_button->parent_filter_block->pointer_to_attribute_tab->workspace_button_list)
		{

			if (!but->entity_need_remove)
			{
				//EDataActionCollection::action_select_this_attribute_tag(but, but->main_custom_data, _d);
				attribute_tab_group->selected_button = but;



				//static_cast<EntityButtonAttributeTab*>(but)->target_whole_listed_block->button_group_is_active = true;
				selected_button->parent_filter_block->need_change = true;
				break;
			}
		}


		//EWindowMain::loot_filter_editor->need_refresh = true;
	}
	//if (!attribute_tab_group->workspace_button_list.empty()) { attribute_tab_group->selected_button = attribute_tab_group->workspace_button_list.front(); }
	//attribute_tab_group->need_refresh = true;


	confirm_group->close_this_group();
}

void EDataActionCollection::action_open_delete_listed_buttons_confirmation(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EWindowMain::make_unsaved_loot_filter_changes();

	EWindowMain::confirm_deletion_group->button_invoker = static_cast<EntityButton*>(_entity);
	EWindowMain::confirm_deletion_group->group_invoker = static_cast<EntityButtonForListedSegment*>(_entity)->group_with_items;

	EWindowMain::confirm_deletion_group->pointer_to_confirm_button->stored_action = &EDataActionCollection::action_accept_deleting_listed_buttons;
	EWindowMain::confirm_deletion_group->pointer_to_decline_button->stored_action = &EDataActionCollection::action_close_root_group;

	EWindowMain::confirm_deletion_group->pointer_to_description_text_area->localisation_text.localisations[NSW_localisation_EN] = "Delete all buttons on this block. You sure?";
	EWindowMain::confirm_deletion_group->pointer_to_description_text_area->localisation_text.localisations[NSW_localisation_RU] = "Вы уверены, что хотите удалить удалить всё из этого блока?";
	EWindowMain::confirm_deletion_group->pointer_to_description_text_area->update_localisation();

	EWindowMain::confirm_deletion_group->activate_move_to_foreground_and_center();
	EWindowMain::confirm_deletion_group->make_this_group_superfocused();



}

void EDataActionCollection::action_accept_deleting_listed_buttons(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EWindowMain::confirm_deletion_group->group_invoker->remove_all_workspace_buttons();
	EWindowMain::confirm_deletion_group->group_invoker->need_change = true;
	EWindowMain::confirm_deletion_group->close_this_group();

}

void EDataActionCollection::action_draw_deleted_group(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EButtonGroup* target_group = static_cast<EntityButtonForListedSegment*>(_entity)->target_block_for_highlight;

	if ((target_group->lower_culling_line_for_group < target_group->higher_culling_line_for_group) && (EClickableArea::active_clickable_region == static_cast<EntityButtonForListedSegment*>(_entity)->main_clickable_area))
	{
		//NS_EGraphicCore::set_active_color_custom_alpha(NS_EColorUtils::COLOR_RED, 0.16f);

		//ERenderBatcher::if_have_space_for_data(NS_EGraphicCore::default_batcher_for_drawing, 1);
		//NS_ERenderCollection::add_data_to_vertex_buffer_textured_rectangle_with_custom_size
		//(
		//	NS_EGraphicCore::default_batcher_for_drawing->vertex_buffer,
		//	NS_EGraphicCore::default_batcher_for_drawing->last_vertice_buffer_index,

		//	target_group->region_gabarite->world_position_x + 0.0f,
		//	min(target_group->region_gabarite->world_position_y, target_group->higher_culling_line),

		//	target_group->region_gabarite->size_x - 0.0f,
		//	min(target_group->region_gabarite->size_y, target_group->higher_culling_line - target_group->lower_culling_line),

		//	NS_DefaultGabarites::texture_gabarite_white_pixel
		//);

		target_group->highlight_this_group_red_warning();
	}
}

void EDataActionCollection::action_open_data_entity_filter_group(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EWindowMain::make_unsaved_loot_filter_changes();
	//EInputCore::logger_simple_info("???");
	EDataContainer_Group_StoreFilterRuleForDataEntitySearcher*
		button_data_container = ((EDataContainer_Group_StoreFilterRuleForDataEntitySearcher*)_custom_data->data_container);

	EDataContainer_Group_DataEntitiesSearch*
		button_group_data_container = (EDataContainer_Group_DataEntitiesSearch*)EWindowMain::data_entity_filter->data_container;

	EWindowMain::data_entity_filter->activate_move_to_foreground_and_center();

	button_group_data_container->pointer_to_group_item_receiver = button_data_container->target_group_receiver;

	//button_group_data_container->target_rule = button_data_container->filter_rule;





	for (EntityButton* but : EWindowMain::data_entity_filter->right_side_for_filters->workspace_button_list)
	{
		EntityButtonFilterRule* button_rule = static_cast<EntityButtonFilterRule*>(but);
		if
			(
				(button_rule->target_filter_rule->tag == button_data_container->filter_rule->focused_by_data_type)
				||
				(button_rule->target_filter_rule->tag == "*ALL*")
				)
		{
			button_rule->entity_disabled = false;
		}
		else
		{
			button_rule->entity_disabled = true;
		}
	}








	//filter rule in group = stored filter rule on selected button
	if (button_group_data_container->pointer_to_group_with_filter_rules_list->selected_button != nullptr)
	{
		if (!button_group_data_container->pointer_to_group_with_filter_rules_list->selected_button->entity_is_active())
		{
			for (EntityButton* but : button_group_data_container->pointer_to_group_with_filter_rules_list->workspace_button_list)
			{
				EntityButtonFilterRule* button_rule = static_cast<EntityButtonFilterRule*>(but);

				if (button_rule->target_filter_rule->tag == button_data_container->filter_rule->focused_by_data_type)
				{
					button_group_data_container->pointer_to_group_with_filter_rules_list->selected_button = but;
					break;
				}
			}
		}

		EntityButtonFilterRule*
			filter_button = (EntityButtonFilterRule*)button_group_data_container->pointer_to_group_with_filter_rules_list->selected_button;

		button_group_data_container->target_rule = filter_button->target_filter_rule;
	}

	button_group_data_container->action_on_select_for_button = button_data_container->target_action_on_click;



	//EDataContainer_Group_DataEntitiesSearch* button_group_data_container = (EDataContainer_Group_DataEntitiesSearch*)EWindowMain::data_entity_filter->data_container;

	//{
	//	EntityButtonFilterRule*
	//	filter_button = (EntityButtonFilterRule*)_entity;

	//	button_group_data_container->target_rule = filter_button->target_filter_rule;

	//	filter_button->parent_button_group->selected_button = filter_button;
	//}


	EDataActionCollection::action_type_search_data_entity_text(button_group_data_container->filter_text_area);
	/* OUTDATED */
	//if
	//(
	//	(data_container_with_rule->target_rule != nullptr)
	//	&&
	//	(!data_container_with_rule->target_rule->required_tag_list.empty())
	//	&&
	//	(!data_container_with_rule->target_rule->required_tag_list[0]->suitable_values_list.empty())
	//)
	//{
	//	data_container_with_rule->target_rule->required_tag_list[0]->suitable_values_list[0] = data->search_tag;
	//}
}

void EDataActionCollection::action_change_separator_shrink_flag(Entity* _entity, ECustomData* _custom_data, float _d)
{
	//static_cast<EntityButton*>(_entity)->parent_button_group->root_group->scroll
	//EButtonGroup::change_group(static_cast<EntityButton*>(_entity)->parent_button_group->root_group);

	static_cast<EntityButton*>(_entity)->parent_button_group->root_group->need_change = true;
	static_cast<EntityButton*>(_entity)->parent_button_group->highlight_this_group_green_info();
}

void EDataActionCollection::action_change_force_field(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EntityButton* but = static_cast<EntityButton*>(_entity);
	but->parent_button_group->root_group->need_change = true;

	EButtonGroupFilterBlockSeparator*
		searator_line = static_cast<EButtonGroupFilterBlockSeparator*>(but->parent_button_group);

	searator_line->additional_y_distance = NSW_default_y_force_field_for_separator + NSW_additional_y_force_field_for_separator * searator_line->additional_force_field;


	static_cast<EntityButton*>(_entity)->parent_button_group->highlight_this_group_green_info();
}

void EDataActionCollection::action_clear_bottom_section_for_search_text(Entity* _entity, ECustomData* _custom_data, float _d)
{
	if (EWindowMain::bottom_filter_block_control->search_button != nullptr)
	{
		EWindowMain::bottom_filter_block_control->search_button->main_text_area->change_text("");
		EDataActionCollection::action_type_search_filter_block_text(EWindowMain::bottom_filter_block_control->search_button->main_text_area);
	}
}

void EDataActionCollection::action_clear_main_text_area(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EntityButton* but = static_cast<EntityButton*>(_entity);

	if (but->main_text_area != nullptr)
	{
		but->main_text_area->change_text("");

		for (text_actions_pointer dap : but->main_text_area->action_on_change_text)
		{
			dap(but->main_text_area);
		}
	}
}

void EDataActionCollection::action_clear_attached_text_area(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EntityButtonClearAttachedTextArea*
		but = static_cast<EntityButtonClearAttachedTextArea*>(_entity);

	ETextArea*
		clearable_text_area = but->attached_text_area;



	if (clearable_text_area != nullptr)
	{
		clearable_text_area->change_text("");

		for (text_actions_pointer dap : clearable_text_area->action_on_change_text)
		{
			dap(clearable_text_area);
		}
	}
}

void EDataActionCollection::action_expand_all_separators(Entity* _entity, ECustomData* _custom_data, float _d)
{
	for (EButtonGroup* group : EWindowMain::active_loot_filter_editor->group_list)
	{
		//if (dynamic_cast<const EButtonGroupFilterBlockSeparator*>(group) != nullptr)
		if
			(
				(dynamic_cast<const EButtonGroupFilterBlockSeparator*>(group) != nullptr)
				&&
				(!static_cast<EButtonGroupFilterBlockSeparator*>(group)->for_default_filter_block)
				)//filter block separator
		{
			static_cast<EButtonGroupFilterBlockSeparator*>(group)->is_expanded = true;
		}
	}

	EButtonGroup::refresh_button_group(EWindowMain::active_loot_filter_editor);
}

void EDataActionCollection::action_shrink_all_separators(Entity* _entity, ECustomData* _custom_data, float _d)
{

	for (EButtonGroup* group : EWindowMain::active_loot_filter_editor->group_list)
	{
		if (EButtonGroupFilterBlockSeparator* block = dynamic_cast<EButtonGroupFilterBlockSeparator*>(group))//filter block separator
		{
			dynamic_cast<EButtonGroupFilterBlockSeparator*>(group)->is_expanded = false;
		}
	}

	//EWindowMain::loot_filter_editor->need_refresh;
	EButtonGroup::refresh_button_group(EWindowMain::active_loot_filter_editor);
}

void EDataActionCollection::action_draw_loot_button(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EntityButton*
		entity_button = static_cast<EntityButton*>(_entity);

	EntityButtonLootItem*
		loot_button = static_cast<EntityButtonLootItem*>(_entity);

	HSVRGBAColor*
		target_temp_color = &EButtonGroupLootSimulator::temp_color;

	int
		selected_loot_filter_version = EButtonGroupLootSimulator::pointer_to_target_loot_filter_version_button->selected_variant;

	int
		selected_pattern_variant = -1;


	LootFilterVersionPattern::PatternStruct*
		target_version_pattern = nullptr;


	if
		((entity_button->entity_is_active())
			&&
			(loot_button != nullptr)
			&&
			(loot_button->matched_show_hide_block != nullptr)
			&&
			(!loot_button->matched_filter_blocks.empty())
			&&
			(loot_button->matched_show_hide_block != nullptr)
			)
	{
		selected_pattern_variant = loot_button->matched_show_hide_block->version_routers[selected_loot_filter_version]->selected_variant;

		target_version_pattern = LootFilterVersionPattern::registered_loot_filter_version_patterns[selected_pattern_variant];

		if
			(
				(loot_button->stored_game_item->warn_when_hidden)
				||
				(EButtonGroupLootSimulator::show_hidden)
				||
				(target_version_pattern->show_hide_mode == (int)(LootFilterVersionPattern::LootPatternParameterMode::FORCIBLY_ENABLE))
				||
				(
					(loot_button->matched_show_hide_block->button_show_hide->selected_variant == 1)//show by filter block
					&&
					(target_version_pattern->show_hide_mode != (int)(LootFilterVersionPattern::LootPatternParameterMode::FORCIBLY_DISABLE))//not forcebly hidden by version control
					)
				)
		{

			//is color changed?
			if
				(
					(loot_button->matched_text_color != nullptr)
					&&
					(
						(loot_button->main_text_area->stored_color.r != (*loot_button->matched_text_color)->r)
						||
						(loot_button->main_text_area->stored_color.g != (*loot_button->matched_text_color)->g)
						||
						(loot_button->main_text_area->stored_color.b != (*loot_button->matched_text_color)->b)
						||
						(loot_button->main_text_area->stored_color.a != (*loot_button->matched_text_color)->a)
						)
					)
			{
				loot_button->main_text_area->set_color(*loot_button->matched_text_color);
				loot_button->main_text_area->generate_text();
			}

			//BG
			if (loot_button->matched_bg_color != nullptr)
			{
				target_temp_color->set_color(*loot_button->matched_bg_color);
				//EWindowMain::set_color_version(target_temp_color, loot_button->matched_bg_color_block->version_routers[selected_loot_filter_version]->selected_variant);
				EWindowMain::set_color_focus(target_temp_color, target_version_pattern->focus_multiplier);
				NS_EGraphicCore::set_active_color(target_temp_color);

				ERenderBatcher::if_have_space_for_data(NS_EGraphicCore::default_batcher_for_drawing, 1);
				NS_ERenderCollection::add_data_to_vertex_buffer_textured_rectangle_with_custom_size
				(
					NS_EGraphicCore::default_batcher_for_drawing->vertex_buffer,
					NS_EGraphicCore::default_batcher_for_drawing->last_vertice_buffer_index,

					//x pos
					entity_button->button_gabarite->world_position_x,

					//y pos
					entity_button->button_gabarite->world_position_y,

					entity_button->button_gabarite->size_x,
					entity_button->button_gabarite->size_y,

					NS_DefaultGabarites::texture_gabarite_white_pixel
				);

			}
			else
			{
				//NS_EGraphicCore::set_active_color(NS_EColorUtils::COLOR_WHITE);
			}






			//		RAMA
			if (loot_button->matched_rama_color != nullptr)
			{


				target_temp_color->set_color(*loot_button->matched_rama_color);

				//target_version_pattern
				EWindowMain::set_color_focus(target_temp_color, target_version_pattern->focus_multiplier);

				NS_EGraphicCore::set_active_color(target_temp_color);

				ERenderBatcher::if_have_space_for_data(NS_EGraphicCore::default_batcher_for_drawing, 4);
				NS_ERenderCollection::add_data_to_vertex_buffer_rama
				(
					NS_EGraphicCore::default_batcher_for_drawing->vertex_buffer,
					NS_EGraphicCore::default_batcher_for_drawing->last_vertice_buffer_index,

					//x pos
					entity_button->button_gabarite->world_position_x,

					//y pos
					entity_button->button_gabarite->world_position_y,

					entity_button->button_gabarite->size_x,
					entity_button->button_gabarite->size_y,

					3.0f,

					NS_DefaultGabarites::texture_gabarite_white_pixel
				);
			}
			else
			{
				//NS_EGraphicCore::set_active_color(NS_EColorUtils::COLOR_RED);
			}







			if
				(
					//if block hidden by any way
					(loot_button != nullptr)
					&&
					(loot_button->matched_show_hide_block != nullptr)
					&&
					(
						(loot_button->matched_show_hide_block->button_show_hide->selected_variant != 1)//hidden by filter block
						||
						(loot_button->matched_show_hide_block->version_routers[selected_loot_filter_version]->selected_variant == 1)//forcebly hidden by version control
						)
					&&//and warn when item hidden
					(loot_button->stored_game_item->warn_when_hidden)
					)
			{

				//WARNING BG
				if (EWindowMain::loot_simulator_button_group->warning_sign_show_flag)
				{
					target_temp_color->set_color_RGBA(1.0f, 0.0f, 0.0f, 0.75f);
				}
				else
				{
					target_temp_color->set_color_RGBA(1.0f, 1.0f, 1.0f, 0.9f);
				}



				//if (loot_button->matched_bg_color_block != nullptr)
				//{
				//	EWindowMain::set_color_version(target_temp_color, loot_button->matched_bg_color_block->version_routers[selected_loot_filter_version]->selected_variant);
				//}
				//else
				//{
				//	//target_temp_color = target_temp_color;
				//	loot_button->main_text_area->localisation_text = loot_button->main_text_area->localisation_text;
				//}

				NS_EGraphicCore::set_active_color(target_temp_color);

				ERenderBatcher::if_have_space_for_data(NS_EGraphicCore::default_batcher_for_drawing, 1);
				NS_ERenderCollection::add_data_to_vertex_buffer_textured_rectangle_with_custom_size
				(
					NS_EGraphicCore::default_batcher_for_drawing->vertex_buffer,
					NS_EGraphicCore::default_batcher_for_drawing->last_vertice_buffer_index,

					//x pos
					entity_button->button_gabarite->world_position_x,

					//y pos
					entity_button->button_gabarite->world_position_y,

					entity_button->button_gabarite->size_x,
					entity_button->button_gabarite->size_y,

					NS_DefaultGabarites::texture_gabarite_white_pixel
				);


				//WARNING RAMA

				if (EWindowMain::loot_simulator_button_group->warning_sign_show_flag)
				{
					target_temp_color->set_color_RGBA(1.0f, 1.0f, 0.0f, 1.0f);
				}
				else
				{
					target_temp_color->set_color_RGBA(1.0f, 0.0f, 0.0f, 0.85f);
				}
				EWindowMain::set_color_version(target_temp_color, loot_button->matched_rama_color_block->version_routers[selected_loot_filter_version]->selected_variant);
				NS_EGraphicCore::set_active_color(target_temp_color);

				ERenderBatcher::if_have_space_for_data(NS_EGraphicCore::default_batcher_for_drawing, 4);
				NS_ERenderCollection::add_data_to_vertex_buffer_rama
				(
					NS_EGraphicCore::default_batcher_for_drawing->vertex_buffer,
					NS_EGraphicCore::default_batcher_for_drawing->last_vertice_buffer_index,

					//x pos
					entity_button->button_gabarite->world_position_x,

					//y pos
					entity_button->button_gabarite->world_position_y,

					entity_button->button_gabarite->size_x,
					entity_button->button_gabarite->size_y,

					6.0f,

					NS_DefaultGabarites::texture_gabarite_white_pixel
				);

				{
					float size_multiplier = 1.0f;
					ETextureGabarite*
						texture_gabarite = NS_DefaultGabarites::texture_WARNING;

					NS_EGraphicCore::set_active_color(1.0f, 1.0f, 1.0f, 1.0f);
					ERenderBatcher::if_have_space_for_data(NS_EGraphicCore::default_batcher_for_drawing, 1);
					NS_ERenderCollection::add_data_to_vertex_buffer_textured_rectangle_with_custom_size
					(
						NS_EGraphicCore::default_batcher_for_drawing->vertex_buffer,
						NS_EGraphicCore::default_batcher_for_drawing->last_vertice_buffer_index,

						//x pos
						entity_button->button_gabarite->world_position_x - texture_gabarite->size_x_in_pixels * 0.5f,

						//y pos
						entity_button->button_gabarite->world_position_y,

						texture_gabarite->size_x_in_pixels * size_multiplier,
						texture_gabarite->size_y_in_pixels * size_multiplier,

						texture_gabarite
					);
				}
			}
			else
			{
				//		MINIMAP ICON
				if
					(
						(loot_button->matched_minimap_icon_color != nullptr)
						&&
						(loot_button->matched_minimap_icon_block != nullptr)
						&&
						(loot_button->matched_minimap_icon_block->pointer_to_forcibly_disable_minimap_icon_variant_button->selected_variant == 0)
						)
				{
					float size_multiplier = 1.0f - loot_button->matched_minimap_icon_size->selected_variant * 0.25;
					ETextureGabarite* texture_gabarite = loot_button->matched_minimap_icon_shape->router_variant_list[loot_button->matched_minimap_icon_shape->selected_variant]->texture;

					NS_EGraphicCore::set_active_color(loot_button->matched_minimap_icon_color->router_variant_list[loot_button->matched_minimap_icon_color->selected_variant]->text_color);
					ERenderBatcher::if_have_space_for_data(NS_EGraphicCore::default_batcher_for_drawing, 1);
					NS_ERenderCollection::add_data_to_vertex_buffer_textured_rectangle_with_custom_size
					(
						NS_EGraphicCore::default_batcher_for_drawing->vertex_buffer,
						NS_EGraphicCore::default_batcher_for_drawing->last_vertice_buffer_index,

						//x pos
						entity_button->button_gabarite->world_position_x,

						//y pos
						entity_button->button_gabarite->world_position_y,

						texture_gabarite->size_x_in_pixels * size_multiplier + 4.0f,
						texture_gabarite->size_y_in_pixels * size_multiplier + 4.0f,

						texture_gabarite
					);
				}
			}
		}
	}


}

void EDataActionCollection::action_refresh_loot_simulator(Entity* _entity, ECustomData* _custom_data, float _d)
{


	EWindowMain::loot_simulator_button_group->delayed_execution = true;

	//

}

void EDataActionCollection::action_refresh_loot_simulator_when_release(Entity* _entity, ECustomData* _custom_data, float _d)
{
	if
		(
			(EInputCore::MOUSE_BUTTON_LEFT)
			&&
			(EClickableArea::active_clickable_region == static_cast<EntityButton*>(_entity)->main_clickable_area)
			//&&
			//(EInputCore::MOUSE_SPEED_X != 0.0)
			&&
			(EWindowMain::loot_simulator_button_group->pointer_to_patterns_buttons_segment->selected_button != nullptr)
			)
	{
		EWindowMain::loot_simulator_button_group->delayed_execution = true;
	}
}

void EDataActionCollection::action_refresh_loot_simulator_when_press(Entity* _entity, ECustomData* _custom_data, float _d)
{
	if (EWindowMain::loot_simulator_button_group->pointer_to_patterns_buttons_segment->selected_button != nullptr)
	{
		EWindowMain::loot_simulator_button_group->delayed_execution = true;
	}
}

void EDataActionCollection::action_refresh_loot_simulator_sizes(Entity* _entity, ECustomData* _custom_data, float _d)
{
	if
		(
			(EClickableArea::active_clickable_region == static_cast<EntityButton*>(_entity)->main_clickable_area)
			&&
			(EWindowMain::loot_simulator_button_group != nullptr)
			&&
			(EInputCore::MOUSE_BUTTON_LEFT)
			&&
			(EInputCore::MOUSE_SPEED_X != 0.0f)
			)
	{

		EButtonGroupLootSimulator::refresh_button_sizes();


		//EButtonGroup::change_group(EButtonGroupLootSimulator::pointer_to_loot_buttons_segment);
		EButtonGroupLootSimulator::pointer_to_loot_buttons_segment->need_change = true;
	}
}

void EDataActionCollection::action_select_loot_item_button(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EntityButtonLootItem*
		loot_button = static_cast<EntityButtonLootItem*>(_entity);

	if (false)
		for (EGameItemAttributeContainer attribute_container : loot_button->stored_game_item->attribute_container_list)
		{
			EInputCore::logger_param("attribute name", attribute_container.target_attribute->localisation.localisations[ELocalisationText::active_localisation]);

			if (attribute_container.attribute_value_int != 0) { EInputCore::logger_param("INT", attribute_container.attribute_value_int); }
			EInputCore::logger_param("BOOL", attribute_container.attribute_value_bool);
			if (attribute_container.attribute_value_str != "") { EInputCore::logger_param("STR", attribute_container.attribute_value_str); }

			if (!attribute_container.listed_value_list.empty())
			{
				EInputCore::logger_simple_info("Listed");
				for (ELocalisationText listed_value : attribute_container.listed_value_list)
				{
					EInputCore::logger_param("-------", listed_value.localisations[ELocalisationText::active_localisation]);
				}
			}

			std::cout << std::endl;
			std::cout << std::endl;

		}



	EWindowMain::loot_simulator_button_group->generate_info_buttons_for_right_side(loot_button);

	/*EInputCore::logger_param("size of suitable blocks", loot_button->matched_filter_blocks.size());
	for (EButtonGroup* group : loot_button->matched_filter_blocks)
	{
		group->highlight_time = 30.0f;
	}*/

	//if (loot_button->matched_filter_blocks.size() == 1)
	{
		if
			(
				(loot_button->matched_filter_blocks.back()->attached_separator != nullptr)
				&&
				!(loot_button->matched_filter_blocks.back()->attached_separator->is_expanded)
				)
		{
			loot_button->matched_filter_blocks.back()->attached_separator->is_expanded = true;

			EButtonGroup::refresh_button_group(EWindowMain::active_loot_filter_editor);
		}

		EWindowMain::active_loot_filter_editor->scroll_y = std::max(-loot_button->matched_filter_blocks.back()->region_gabarite->offset_y, 0.0f);
		EWindowMain::active_loot_filter_editor->slider->current_value = EWindowMain::active_loot_filter_editor->scroll_y;

		//EInputCore::logger_param("scroll_y", loot_button->matched_filter_blocks.back()->region_gabarite->offset_y);

		loot_button->matched_filter_blocks.back()->highlight_this_group_green_info();


		EButtonGroup::refresh_button_group(EWindowMain::active_loot_filter_editor);
	}

	for (EntityButton* but : loot_button->suitable_buttons_list)
	{
		//but->highlight_time = but->max_highlight_time;
		but->set_highlight(1.0f, 1.0f);
		but->parent_button_group->scroll_to_this_button(but);
	}



}

void EDataActionCollection::action_highlight_stored_block(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EntityButtonLootItemSuitableBlocks* loot_button = static_cast<EntityButtonLootItemSuitableBlocks*>(_entity);

	loot_button->target_filter_block->highlight_this_group_green_info();

	float need_translate = 0.0f;

	if (loot_button->target_filter_block != nullptr)
	{
		if
			(
				(loot_button->target_filter_block->attached_separator != nullptr)
				&&
				!(loot_button->target_filter_block->attached_separator->is_expanded)
				)
		{
			loot_button->target_filter_block->attached_separator->is_expanded = true;

			//EButtonGroup::refresh_button_group(EWindowMain::loot_filter_editor);
			/*for (EButtonGroup* group : EWindowMain::loot_filter_editor->group_list)
			{
				group->region_gabarite->have_phantom_translation = false;

				group->region_gabarite->phantom_translate_x = 0.0f;
				group->region_gabarite->phantom_translate_y = 0.0f;
				group->region_gabarite->phantom_translate_z = 0.0f;
			}*/
			//EWindowMain::loot_filter_editor->recursive_phantom_translate_if_need();

			//EWindowMain::loot_filter_editor->need_refresh = true;
			EButtonGroup::refresh_button_group(EWindowMain::active_loot_filter_editor);
		}

		EWindowMain::active_loot_filter_editor->scroll_y = std::max(-loot_button->target_filter_block->region_gabarite->offset_y, 0.0f);
		EWindowMain::active_loot_filter_editor->slider->current_value = EWindowMain::active_loot_filter_editor->scroll_y;

		EButtonGroup::refresh_button_group(EWindowMain::active_loot_filter_editor);
		//EWindowMain::loot_filter_editor->need_refresh = true;
	}
}

void EDataActionCollection::action_generate_items_from_this_loot_pattern(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EntityButtonLootPatternSelector*
		patter_button = static_cast<EntityButtonLootPatternSelector*>(_entity);

	EWindowMain::loot_simulator_button_group->seed = std::chrono::duration_cast<std::chrono::milliseconds>(std::chrono::system_clock::now().time_since_epoch()).count();

	EButtonGroupLootSimulator::pointer_to_patterns_buttons_segment->selected_button = patter_button;








	EButtonGroupLootSimulator::pointer_to_flag_configurator_group->remove_all_workspace_buttons();

	DataEntityFilterConfigurer::clear_router_vector(DETFConfigurerMode::LOOT_GENERATOR_PATTERN);


	if (patter_button->target_pattern->can_be_configured)
	{
		EButtonGroupLootSimulator::pointer_to_flag_configurator_group->button_group_is_active = true;

		for (GameItemGenerator* loot_generator : patter_button->target_pattern->game_item_generator_list)
			if (loot_generator->can_be_configured)
			{
				for (DataEntityTagFilter* tag_filter : loot_generator->filtered_by_tags)
				{
					DataEntityFilterConfigurer::create_configurer_buttons
					(
						tag_filter,
						DETFConfigurerMode::LOOT_GENERATOR_PATTERN,
						EButtonGroupLootSimulator::pointer_to_flag_configurator_group
					);
				}

				//add button caption for game item generator
				if (loot_generator->indicate)
				{
					EntityButton*
						generator_button = new EntityButton();

					generator_button->make_default_button_with_unedible_text
					(
						new ERegionGabarite(150.0f, 22.0f),
						EButtonGroupLootSimulator::pointer_to_flag_configurator_group,
						nullptr,
						loot_generator->generator_name
					);

					generator_button->have_simple_bg = true;
					generator_button->do_not_generate_bg = true;
					generator_button->can_be_stretched = true;
					generator_button->main_text_area->set_color(0.8f, 1.0f, 0.9f, 1.0f);

					generator_button->force_field_up = 16.0f;

					EButtonGroupLootSimulator::pointer_to_flag_configurator_group->add_button_to_working_group(generator_button);
				}
			}
	}
	else
	{
		EButtonGroupLootSimulator::pointer_to_flag_configurator_group->button_group_is_active = false;
	}

	EWindowMain::loot_simulator_button_group->pointer_to_right_side_info_buttons->scroll_y = 0.0f;
	//EWindowMain::loot_simulator_button_group->need_refresh = true;
	//LootSimulatorPattern::execute_loot_pattern(patter_button->target_pattern);
	EWindowMain::loot_simulator_button_group->delayed_execution = true;

}

void EDataActionCollection::action_switch_pattern_folder_state(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EntityButtonLootPatternSelector*
		folder_button = static_cast<EntityButtonLootPatternSelector*>(_entity);

	folder_button->folder_is_expanded = !folder_button->folder_is_expanded;

	folder_button->set_highlight(0.35f, 1.0f);
	//folder_button->highlight_time = folder_button->max_highlight_time * 0.2f;

	float scroll_correction = 0.0f;

	if (folder_button->target_loot_pattern_button_group != nullptr)
	{
		for (EntityButton* but : folder_button->target_loot_pattern_button_group->workspace_button_list)
		{
			EntityButtonLootPatternSelector*
				subfolder_button = static_cast<EntityButtonLootPatternSelector*>(but);

			if (subfolder_button->parent_folder_button == folder_button)
			{
				subfolder_button->hidden_by_folder = !folder_button->folder_is_expanded;
				//subfolder_button->entity_disabled	= !folder_button->folder_is_expanded;

				scroll_correction += subfolder_button->button_gabarite->size_y + subfolder_button->force_field_up + subfolder_button->force_field_bottom;
			}


		}

		if (folder_button->folder_is_expanded)
		{
			folder_button->target_loot_pattern_button_group->scroll_y -= scroll_correction - folder_button->button_gabarite->size_y * 0.0f;

			if (folder_button->offset_y < scroll_correction)
			{
				folder_button->target_loot_pattern_button_group->scroll_y += scroll_correction - folder_button->offset_y;
			}
			//folder_button->target_loot_pattern_button_group->scroll_y -= 20.0f;
		}
		else
		{
			folder_button->target_loot_pattern_button_group->scroll_y += scroll_correction - folder_button->button_gabarite->size_y * 0.0f;
		}


		folder_button->target_loot_pattern_button_group->need_change = true;
	}
}

void EDataActionCollection::action_create_or_delete_description_on_hover(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EntityButton*
		but = static_cast<EntityButton*>(_entity);

	EntityButtonLootItem*
		loot_button = static_cast<EntityButtonLootItem*>(_entity);



	if
		(
			(EButtonGroup::focused_button_group == ((EntityButton*)_entity)->parent_button_group)
			&&
			(but->button_gabarite->overlapped_by_mouse())
			&&
			(static_cast<EntityButton*>(_entity)->main_clickable_area->hover_time >= 0.25f)
			)
	{

		if (but->attached_description == nullptr)
		{
			//		MAIN GROUP

			//EInputCore::logger_simple_info("HOVER!");

			EButtonGroup*
				main_group = new EButtonGroup
				(
					new ERegionGabarite
					(
						but->button_gabarite->world_position_x * 1.0f,
						(but->button_gabarite->world_position_y + but->button_gabarite->size_y + 5.0f) * 1.0f,
						0.0f,

						500.0f,
						200.0f
					)
				);

			main_group->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_dynamic_autosize);
			main_group->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DARKEN, bgroup_with_slider);

			main_group->can_be_focused = false;
			main_group->can_be_moved = false;
			main_group->can_change_position_in_vector = false;
			main_group->parent_window = EWindowMain::link_to_main_window;
			main_group->root_group = main_group;
			//





			/////	PART FOR ITEM NAME, SOCKET INDICATOR, DESCRIPTION	//////////////////////////////////////////////////////////////////////////////////////////////////
			EButtonGroup*
				bottom_part_for_item_info = main_group->add_group(new EButtonGroup(new ERegionGabarite(200.0f, 200.0f)));

			bottom_part_for_item_info->set_parameters(ChildAlignMode::ALIGN_HORIZONTAL, NSW_dynamic_autosize, NSW_dynamic_autosize);
			bottom_part_for_item_info->init_button_group(EGUIStyle::active_style, BrickStyleID::NONE, bgroup_with_slider);
			////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

			/////	TOP PART FOR CLASS	//////////////////////////////////////////////////////////////////////////////////////////////////

			EButtonGroup*
				line_for_item_class = main_group->add_group(new EButtonGroup(new ERegionGabarite(200.0f, 20.0f)));

			line_for_item_class->set_parameters(ChildAlignMode::ALIGN_HORIZONTAL, NSW_dynamic_autosize, NSW_static_autosize);
			line_for_item_class->init_button_group(EGUIStyle::active_style, BrickStyleID::NONE, bgroup_with_slider);

			////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

			/////	TOP PART FOR NAME	//////////////////////////////////////////////////////////////////////////////////////////////////

			EButtonGroup*
				line_for_item_name = main_group->add_group(new EButtonGroup(new ERegionGabarite(200.0f, 24.0f)));

			line_for_item_name->set_parameters(ChildAlignMode::ALIGN_HORIZONTAL, NSW_dynamic_autosize, NSW_static_autosize);
			line_for_item_name->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DEFAULT, bgroup_with_slider);

			////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


			/////	SOCKETS	/////////////////////////////////////////////////////////////////////////////////////////////////////////
			EButtonGroupSocketPreview*
				left_part_for_sockets = new EButtonGroupSocketPreview(new ERegionGabarite(100.0f, 200.0f));

			bottom_part_for_item_info->add_group(left_part_for_sockets);

			left_part_for_sockets->icon_texture = loot_button->stored_game_item->icon;
			left_part_for_sockets->stored_game_item = loot_button->stored_game_item;

			left_part_for_sockets->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_static_autosize, NSW_dynamic_autosize);
			left_part_for_sockets->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DEFAULT, bgroup_with_slider);
			////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

			////	TEXT DESCRIPTION	/////////////////////////////////////////////////////////////////////////////////////////////////////////////
			EButtonGroup*
				right_part_for_description = bottom_part_for_item_info->add_group(new EButtonGroup(new ERegionGabarite(200.0f, 200.0f)));

			right_part_for_description->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_dynamic_autosize);
			right_part_for_description->init_button_group(EGUIStyle::active_style, BrickStyleID::NONE, bgroup_with_slider);
			/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

					// 
					//		BOTTOM PART FOR ATTRIBUTES
			EButtonGroup*
				description_bottom_part = right_part_for_description->add_group(new EButtonGroup(new ERegionGabarite(100.0f, 100.0f)));

			description_bottom_part->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_dynamic_autosize);
			description_bottom_part->init_button_group(EGUIStyle::active_style, BrickStyleID::NONE, bgroup_without_slider);
			//



			//		TOP PART FOR NAME
			/*EButtonGroup*
			description_top_part = right_part_for_description->add_group(new EButtonGroup(new ERegionGabarite(500.0f, 30.0f)));

			description_top_part->set_parameters(ChildAlignMode::ALIGN_HORIZONTAL, NSW_dynamic_autosize, NSW_static_autosize);
			description_top_part->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DEFAULT, bgroup_with_slider);*/
			//




			if ((true/*fatruelse*/) && (loot_button->matched_show_hide_block != nullptr))
			{
				int selected_version_router = EButtonGroupLootSimulator::pointer_to_target_loot_filter_version_button->selected_variant;

				//loot_button->matched_show_hide_block
				//LootFilterVersionPattern::PatternStruct*
				//target_version_pattern = LootFilterVersionPattern::registered_loot_filter_version_patterns[selected_version_router];
				LootFilterVersionPattern::PatternStruct*
					target_version_pattern = LootFilterVersionPattern::registered_loot_filter_version_patterns[loot_button->matched_show_hide_block->version_routers[selected_version_router]->selected_variant];
				//		WARNING PART FOR HIDDEN_BY_MISTAKE
				if
					(
						//if block hidden by any way
						(
							(target_version_pattern->show_hide_mode != (int)(LootFilterVersionPattern::LootPatternParameterMode::FORCIBLY_ENABLE))
							&&
							(
								(loot_button->matched_show_hide_block->button_show_hide->selected_variant != 1)//hidden by filter block
								||
								(target_version_pattern->show_hide_mode == (int)(LootFilterVersionPattern::LootPatternParameterMode::FORCIBLY_DISABLE))
								)//forcebly hidden by version control
							)
						&&//and warn when item hidden
						(loot_button->stored_game_item->warn_when_hidden)
						)
				{

					EButtonGroup*
						warning_part = main_group->add_group(new EButtonGroup(new ERegionGabarite(100.0f, 30.0f)));

					warning_part->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_static_autosize);
					warning_part->init_button_group(EGUIStyle::active_style, BrickStyleID::NONE, bgroup_without_slider);

					warning_part->add_default_clickable_region_with_text_area(ELocalisationText::get_localisation_by_key("warning_this_loot_hidden"));
					warning_part->clickable_area_list[0]->text_area->set_color(1.0f, 0.25f, 0.1f, 1.0f);

				}
				//




				/////////////		CLICKABLE AREA FOR BOTTOM PART (ATTRIBUTES)		/////////////
				if (true)
				{
					EClickableArea*
						clickable_area_for_bottom_attributes = EClickableArea::create_default_clickable_region(description_bottom_part->region_gabarite, main_group);
					description_bottom_part->clickable_area_list.push_back(clickable_area_for_bottom_attributes);

					std::string item_attributes_generated_text = "";

					//		ATTRIBUTES LIST
					for (int i = 0; i < loot_button->stored_game_item->attribute_container_list.size(); i++)
					{
						EGameItemAttributeContainer*
							attribute_container = &loot_button->stored_game_item->attribute_container_list[i];

						if (attribute_container->target_attribute->show_in_loot_item_description)
						{
							if
								(

									(attribute_container->target_attribute->filter_attribute_value_type == FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_BOOL_SWITCHER)
									//&&
									//(attribute_container->attribute_value_bool)
									)
							{
								item_attributes_generated_text += "\\n";
								item_attributes_generated_text += attribute_container->target_attribute->localisation.localisations[ELocalisationText::active_localisation];

							}
							else
								if
									(
										(attribute_container->target_attribute->filter_attribute_value_type == FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_NUMBER)
										)
								{
									item_attributes_generated_text += "\\n";
									item_attributes_generated_text += attribute_container->target_attribute->localisation.localisations[ELocalisationText::active_localisation];
									item_attributes_generated_text += " ";
									item_attributes_generated_text += std::to_string(attribute_container->attribute_value_int);

								}
								else
									if
										(
											(attribute_container->target_attribute->filter_attribute_value_type == FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_COLOURS_TEXT)
											)
									{
										item_attributes_generated_text += "\\n";
										item_attributes_generated_text += attribute_container->target_attribute->localisation.localisations[ELocalisationText::active_localisation];
										item_attributes_generated_text += " [";
										item_attributes_generated_text += attribute_container->attribute_value_str;
										item_attributes_generated_text += "]";

									}
									else
										if
											(
												(attribute_container->target_attribute->filter_attribute_value_type == FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_DATA_ENTITY)
												&&
												(true)
												)
										{
											item_attributes_generated_text += "\\n";
											item_attributes_generated_text += attribute_container->target_attribute->localisation.localisations[ELocalisationText::active_localisation];
											for (ELocalisationText listed_string : attribute_container->listed_value_list)
											{
												item_attributes_generated_text += " {";
												item_attributes_generated_text += listed_string.localisations[ELocalisationText::active_localisation];
												item_attributes_generated_text += "}";
											}


										}
						}
					}

					ETextArea*
						text_area_for_group = ETextArea::create_centered_text_area(clickable_area_for_bottom_attributes, EFont::font_list[0], ELocalisationText::generate_localization_with_base_name(item_attributes_generated_text));
					text_area_for_group->can_be_edited = false;
					clickable_area_for_bottom_attributes->text_area = text_area_for_group;




				}
				/////////////

				/////////////		CLICKABLE AREA FOR TOP PART (NAME)		/////////////
				if (true)
				{
					EClickableArea*
						clickable_area_for_top_name = EClickableArea::create_default_clickable_region(line_for_item_name->region_gabarite, main_group);
					line_for_item_name->clickable_area_list.push_back(clickable_area_for_top_name);

					ELocalisationText
						item_name_localisation = loot_button->stored_game_item->localised_name;

					if
						(
							(loot_button->stored_game_item->stored_data_entity != nullptr)
							&&
							(DataEntityUtils::is_exist_tag_by_name_and_value(0, "item tag", "Unique item", loot_button->stored_game_item->stored_data_entity))
							)
					{

						std::string
							base_for_unique = DataEntityUtils::get_tag_value_by_name(0, "base name", loot_button->stored_game_item->stored_data_entity);

						for (EDataEntity* de : EWindowMain::registered_data_entity_game_item_list)
							if (!DataEntityUtils::is_exist_tag_by_name_and_value(0, "item tag", "Unique item", de))
							{
								std::string
									item_EN_name = DataEntityUtils::get_tag_value_by_name(0, "base name", de);

								if (item_EN_name == "") { item_EN_name = DataEntityUtils::get_tag_value_by_name(0, "name EN", de); }

								if (item_EN_name == base_for_unique)
								{
									std::string
										item_RU_name = DataEntityUtils::get_tag_value_by_name(0, "name RU", de);

									item_name_localisation.localisations[NSW_localisation_EN] += " <" + item_EN_name + ">";
									item_name_localisation.localisations[NSW_localisation_RU] += " <" + item_RU_name + ">";

									break;
								}
							}

						//item_name_localisation.add_localisation_text_from_another()
					}

					ETextArea*
						text_area_for_group = ETextArea::create_centered_text_area
						(
							clickable_area_for_top_name,
							EFont::font_list[1],
							item_name_localisation
						);
					text_area_for_group->font_scale = 0.75f;
					text_area_for_group->can_be_edited = false;

					switch (loot_button->stored_game_item->rarity)
					{
					case 0:
					{
						text_area_for_group->set_color(1.0f, 0.9f, 0.8f, 1.0f);
						break;
					}
					case 1:
					{
						text_area_for_group->set_color(0.4f, 0.6f, 1.0f, 1.0f);
						break;
					}
					case 2:
					{
						text_area_for_group->set_color(1.0f, 0.9f, 0.35f, 1.0f);
						break;
					}
					case 3:
					{
						text_area_for_group->set_color(1.0f, 0.5f, 0.25f, 1.0f);
						break;
					}

					default:
					{
						text_area_for_group->set_color(1.0f, 0.2f, 0.1f, 1.0f);
						break;
					}
					}
					//text_area_for_group->set_color(1.0f, 0.2f, 0.1f, 1.0f);
					clickable_area_for_top_name->text_area = text_area_for_group;
				}

				//		CLASS
				{
					EClickableArea*
						clickable_area_for_class = EClickableArea::create_default_clickable_region(line_for_item_class->region_gabarite, main_group);
					line_for_item_class->clickable_area_list.push_back(clickable_area_for_class);

					ELocalisationText class_and_level;

					for (int i = 0; i < loot_button->stored_game_item->attribute_container_list.size(); i++)
					{
						if
							(
								(loot_button->stored_game_item->attribute_container_list[i].target_attribute->localisation.base_name == "Class")
								&&
								(!loot_button->stored_game_item->attribute_container_list[i].listed_value_list.empty())
								)
						{
							class_and_level = loot_button->stored_game_item->attribute_container_list[i].listed_value_list.front();
							break;
						}
					}




					//		ITEM LEVEL
					for (int i = 0; i < loot_button->stored_game_item->attribute_container_list.size(); i++)
					{
						if
							(loot_button->stored_game_item->attribute_container_list[i].target_attribute->localisation.base_name == "ItemLevel")
						{
							for (int j = 0; j < NSW_languages_count; j++)
							{
								class_and_level.localisations[j] +=
									",   "
									+
									loot_button->stored_game_item->attribute_container_list[i].target_attribute->localisation.localisations[j]
									+
									": "
									+
									std::to_string(loot_button->stored_game_item->attribute_container_list[i].attribute_value_int);
							}

							break;
						}
					}

					ETextArea*
						text_area_for_group = ETextArea::create_centered_text_area
						(
							clickable_area_for_class,
							EFont::font_list[0],
							class_and_level
						);

					text_area_for_group->can_be_edited = false;

					//text_area_for_group->set_color(1.0f, 0.2f, 0.1f, 1.0f);
					clickable_area_for_class->text_area = text_area_for_group;
				}



			}

			but->attached_description = main_group;
			EWindowMain::link_to_main_window->button_group_list.push_back(main_group);

			//EButtonGroup::refresh_button_group(main_group);
			main_group->need_refresh = true;

		}

	}
	else
	{
		if (but->attached_description != nullptr)
		{
			but->destroy_attached_description();
		}
	}
}

void EDataActionCollection::action_open_and_refresh_loot_simulator(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EWindowMain::loot_simulator_button_group->activate_move_to_foreground_and_center();
	//EWindowMain::loot_simulator_button_group->refresh_loot_simulator();
	EWindowMain::loot_simulator_button_group->delayed_execution = true;
}

void EDataActionCollection::action_open_and_refresh_error_list(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EWindowMain::registered_group_filter_error_list->check_errors();

	EWindowMain::registered_group_filter_error_list->activate_move_to_foreground_and_center();
	EWindowMain::registered_group_filter_error_list->need_refresh = true;

}

void EDataActionCollection::action_change_localisation(Entity* _entity, ECustomData* _custom_data, float _d)
{
	ELocalisationText::active_localisation = static_cast<EntityButtonLocalisationSelector*>(_entity)->stored_localisation;

	for (EWindow* w : EWindow::window_list)
		for (EButtonGroup* g : w->button_group_list)
		{
			g->recursive_change_localisation(ELocalisationText::active_localisation);

			//EButtonGroup::change_group(g);
			g->need_change = true;
		}

	EWindowMain::loot_simulator_button_group->delayed_execution = true;
}

void EDataActionCollection::action_remove_wide_button(Entity* _entity, ECustomData* _custom_data, float _d)
{
	_entity->entity_need_remove = true;
	EWindowMain::make_unsaved_loot_filter_changes();
}

void EDataActionCollection::action_make_unsave_filter_block_changes(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EWindowMain::make_unsaved_loot_filter_changes();
}

void EDataActionCollection::action_make_unsave_filter_block_changes_and_refresh_loot_simulator(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EWindowMain::make_unsaved_loot_filter_changes();
	EWindowMain::loot_simulator_button_group->delayed_execution = true;
}

void EDataActionCollection::action_add_wide_item_to_group_receiver(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EWindowMain::make_unsaved_loot_filter_changes();

	EButtonGroup* parent_group = ((EntityButton*)_entity)->parent_button_group;
	EButtonGroup* root_group = parent_group->root_group;
	EDataContainer_Group_DataEntitiesSearch* data = (EDataContainer_Group_DataEntitiesSearch*)root_group->data_container;
	EButtonGroup* receiver = data->pointer_to_group_item_receiver;
	EDataContainer_DataEntityHolder* data_entity_holder = (EDataContainer_DataEntityHolder*)_custom_data->data_container;

	//EInputCore::logger_simple_info("!!!");
	//EInputCore::logger_simple_info(std::to_string(_entity->custom_data_list[0]->ac));

	float temp_width = 220.0f;

	//if (data->target_rule. )

	bool
		already_have_this_item = false;

	for (EntityButton* but : receiver->workspace_button_list)
	{
		EntityButtonWideItem*
			wide_item_button = static_cast<EntityButtonWideItem*>(but);

		//EDataEntity*
		//stored_data_entity = static_cast<EDataContainer_DataEntityHolder*> (wide_item_button->main_custom_data->data_container)->stored_data_entity;



		if (wide_item_button->main_text_area->localisation_text.base_name == static_cast<EntityButtonWideItem*>(_entity)->main_text_area->localisation_text.base_name)
		{
			already_have_this_item = true;
			break;
		}
	}

	if (!already_have_this_item)
	{
		EntityButtonWideItem* jc_button = EntityButtonWideItem::create_wide_item_button
		(
			new ERegionGabarite(temp_width, 40.0f),
			receiver,
			data_entity_holder->stored_data_entity,
			EFont::font_list[0],
			true
		);

		jc_button->pointer_to_close_area->actions_on_click_list.push_back(&EDataActionCollection::action_make_unsave_filter_block_changes_and_refresh_loot_simulator);

		//jc_button->main_clickable_area->region_gabarite->child_gabarite_list[0]->actions_on_click_list.push_back(&EDataActionCollection::action_make_unsave_filter_block_changes);

		if (!EInputCore::key_pressed(GLFW_KEY_LEFT_SHIFT))
		{
			root_group->close_this_group();
		}

		receiver->add_button_to_working_group(jc_button);
		//receiver->button_list.clear();
		//EButtonGroup::change_group(receiver);
		receiver->parent_group->parent_group->parent_group->need_change = true;

		//EWindowMain::loot_simulator_button_group->refresh_loot_simulator();

		EWindowMain::loot_simulator_button_group->delayed_execution = true;
		EWindowMain::make_unsaved_loot_filter_changes();
	}
	else
	{
		static_cast<EntityButton*>(_entity)->set_highlight(1.0f, 1.0f);
		//static_cast<EntityButton*>(_entity)->highlight_time = static_cast<EntityButton*>(_entity)->max_highlight_time;
	}
}

void EDataActionCollection::action_show_hide_autogenerated_loot_filters(Entity* _entity, ECustomData* _custom_data, float _d)
{
	for (EntityButton* but : EWindowMain::existing_loot_filter_list->part_with_list->workspace_button_list)
	{
		EntityButtonForLootFilterSelector*
			loot_filter_selector_button = static_cast<EntityButtonForLootFilterSelector*>(but);

		but->entity_disabled = (loot_filter_selector_button->is_autogenerated_loot_filter) && (EWindowMain::existing_loot_filter_list->pointer_to_filtration_router->selected_variant == 0);
	}

	//EButtonGroup::change_group(EWindowMain::existing_loot_filter_list->part_with_list);
	EWindowMain::existing_loot_filter_list->part_with_list->need_change = true;
}

void EDataActionCollection::action_open_confirm_decline_window_for_autogenerated_loot_filter(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EWindowMain::confirm_load_autogenerated_block->target_filter_button = static_cast<EntityButtonForLootFilterSelector*>(_entity);
	EWindowMain::confirm_load_autogenerated_block->activate_move_to_foreground_and_center();
	EWindowMain::confirm_load_autogenerated_block->make_this_group_superfocused();

}

void EDataActionCollection::action_confirm_open_autogenerated_loot_filter(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EDataActionCollection::action_select_this_loot_filter_from_list
	(
		EWindowMain::confirm_load_autogenerated_block->target_filter_button,
		EWindowMain::confirm_load_autogenerated_block->target_filter_button->main_custom_data,
		_d
	);

	EWindowMain::confirm_load_autogenerated_block->close_this_group();
}

void EDataActionCollection::action_add_new_undefined_attribute(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EntityButtonForUndefinedAttribute*
		but = static_cast<EntityButtonForUndefinedAttribute*>(_entity);


	EntityButtonWideItem*
		wide_button = EntityButtonWideItem::create_wide_item_button
		(
			new ERegionGabarite(100.0f, 40.0f),
			but->target_part_with_buttons,
			nullptr,
			EFont::font_list[0],
			true
		);


	wide_button->main_text_area->can_be_edited = true;
	wide_button->main_text_area->localisation_text = ELocalisationText::get_localisation_by_key("button_press_me");
	wide_button->main_text_area->change_text(wide_button->main_text_area->localisation_text.localisations[ELocalisationText::active_localisation]);

	but->target_part_with_buttons->add_button_to_working_group(wide_button);
	but->parent_filter_block->need_change = true;
}

void EDataActionCollection::action_select_this_attribute_tag(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EntityButton*
		but = static_cast<EntityButton*>(_entity);

	if (but->parent_button_group != nullptr)
	{
		but->parent_button_group->selected_button = but;

		if (but->parent_button_group->root_group != nullptr)
		{
			but->parent_button_group->root_group->need_refresh = true;
		}
	}


}

void EDataActionCollection::action_switch_loot_version_flag(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EWindowMain::active_loot_filter_editor->need_refresh = true;

	EntityButtonVariantRouter*
		version_router = EWindowMain::loot_simulator_button_group->pointer_to_target_loot_filter_version_button;


	//refresh loot simulator version router button
	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	for (RouterVariant* rv : version_router->router_variant_list)
		if (rv != nullptr)
		{
			delete rv;
		}

	version_router->router_variant_list.clear();

	for (int i = 0; i < NSW_LOOT_FILTER_MAX_VERSIONS; i++)
		if (LootFilterVersionPattern::NSW_LOOT_FILTER_VERSION_ACTIVE[i])
		{
			version_router->add_router_variant_by_text_and_color(LootFilterVersionPattern::NSW_LOOT_VERSION_NAME[i], 0.9f, 0.8f, 0.7f, 1.0f);
		}


	if (version_router->router_variant_list.empty())
	{
		version_router->add_router_variant_by_text_and_color("<?>", 0.92f, 0.75f, 0.5f, 1.0f);

		if (version_router->suppressor == nullptr)
		{
			version_router->suppressor = new bool(false);
		}
		else
		{
			*version_router->suppressor = false;
		}
	}
	else
	{
		delete version_router->suppressor;
		version_router->suppressor = nullptr;
	}

	version_router->select_variant(0);
	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
}

void EDataActionCollection::action_select_loot_filter_version_pattern(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EntityButtonLootfilterVersionPattern*
		but = static_cast<EntityButtonLootfilterVersionPattern*> (_entity);

	LootFilterVersionPattern::PatternStruct*
		target_pattern_struct = but->attached_pattern;

	but->parent_button_group->selected_button = but;

	*(EWindowMain::registered_group_loot_version_configure->button_remove->suppressor) = !target_pattern_struct->is_default;

	EWindowMain::registered_group_loot_version_configure->part_with_pattern_configure->recursive_unsuppress();

	EDataContainer_Button_BoolSwitcher*
		data;

	/////////////////////////////////////////////////////////////////
	//	SET BOOL SWITCHERS


	//DISABLE MINIMAP ELEMENT
	data = static_cast<EDataContainer_Button_BoolSwitcher*>(EWindowMain::registered_group_loot_version_configure->button_disable_minimap_elements->main_custom_data->data_container);
	data->target_value = &target_pattern_struct->disable_minimap_elements;


	//DISABLE SOUND
	data = static_cast<EDataContainer_Button_BoolSwitcher*>(EWindowMain::registered_group_loot_version_configure->button_disable_sound->main_custom_data->data_container);
	data->target_value = &target_pattern_struct->disable_sound;


	//FULL IGNORE
	data = static_cast<EDataContainer_Button_BoolSwitcher*>(EWindowMain::registered_group_loot_version_configure->button_full_ignore->main_custom_data->data_container);
	data->target_value = &target_pattern_struct->full_ignore_mode;
	/////////////////////////////////////////////////////////////////




	/////////////////////////////////////////////////////////////////
	//	SET SUPPRESSORS
	data = static_cast<EDataContainer_Button_BoolSwitcher*>(EWindowMain::registered_group_loot_version_configure->button_full_ignore->main_custom_data->data_container);

	EntityButton*
		switcher_button_suppressor = EWindowMain::registered_group_loot_version_configure->button_full_ignore;

	bool*
		target_bool_suppressor = data->target_value;

	//button:[switcher] disable minimap
	EWindowMain::registered_group_loot_version_configure->button_disable_minimap_elements->suppressor = target_bool_suppressor;
	EWindowMain::registered_group_loot_version_configure->button_disable_minimap_elements->button_suppressor = switcher_button_suppressor;

	//button:[switcher] disable sound
	EWindowMain::registered_group_loot_version_configure->button_disable_sound->suppressor = target_bool_suppressor;
	EWindowMain::registered_group_loot_version_configure->button_disable_sound->button_suppressor = switcher_button_suppressor;

	//button:[slider] focus value
	EWindowMain::registered_group_loot_version_configure->button_focus_slider->suppressor = target_bool_suppressor;
	EWindowMain::registered_group_loot_version_configure->button_focus_slider->button_suppressor = switcher_button_suppressor;

	//button:[slider] icon
	EWindowMain::registered_group_loot_version_configure->button_router_icon->suppressor = target_bool_suppressor;
	EWindowMain::registered_group_loot_version_configure->button_router_icon->button_suppressor = switcher_button_suppressor;

	//button:[slider] router continue
	//EWindowMain::registered_group_loot_version_configure->button_router_continue->suppressor = target_bool_suppressor;
	//EWindowMain::registered_group_loot_version_configure->button_router_continue->button_suppressor = switcher_button_suppressor;

	//button:[slider] router show/hide
	EWindowMain::registered_group_loot_version_configure->button_router_show_hide->suppressor = target_bool_suppressor;
	EWindowMain::registered_group_loot_version_configure->button_router_show_hide->button_suppressor = switcher_button_suppressor;
	/////////////////////////////////////////////////////////////////



	//set target int in router buttons
	//EWindowMain::registered_group_loot_version_configure->button_router_continue->target_int_value = &(target_pattern_struct->continue_mode);
	EWindowMain::registered_group_loot_version_configure->button_router_show_hide->target_int_value = &(target_pattern_struct->show_hide_mode);

	//EWindowMain::registered_group_loot_version_configure->button_router_continue->select_variant(target_pattern_struct->continue_mode);
	EWindowMain::registered_group_loot_version_configure->button_router_show_hide->select_variant(target_pattern_struct->show_hide_mode);






	EDataContainer_VerticalNamedSlider*
		slider_data =
		static_cast<EDataContainer_VerticalNamedSlider*> (EWindowMain::registered_group_loot_version_configure->button_focus_slider->main_custom_data->data_container);

	slider_data->pointer_to_value = &target_pattern_struct->focus_multiplier;


	Helper::rgb2hsv(&but->main_text_area->stored_color);
	Helper::rgb2hsv(&but->main_text_area->color);

	EWindowMain::registered_group_loot_version_configure->button_text_color->stored_color = &but->main_text_area->color;
	EWindowMain::registered_group_loot_version_configure->button_text_color->list_of_forcibly_redrawing_buttons.clear();
	EWindowMain::registered_group_loot_version_configure->button_text_color->list_of_forcibly_redrawing_buttons.push_back(but);


	if (target_pattern_struct->icon != nullptr)
	{
		EWindowMain::registered_group_loot_version_configure->button_router_icon->select_variant_by_icon(target_pattern_struct->icon);
	}

}

void EDataActionCollection::action_delete_selected_filter_version_pattern(Entity* _entity, ECustomData* _custom_data, float _d)
{


	EntityButton*
		target_button = EWindowMain::registered_group_loot_version_configure->part_with_pattern_list->selected_button;




	if (target_button != nullptr)
	{


		std::vector<EntityButton*>
			* b_group = &(target_button->parent_button_group->workspace_button_list);

		EntityButton*
			selected_button = target_button->parent_button_group->selected_button;

		int
			selected_button_id =
			std::distance(b_group->begin(), std::find(b_group->begin(), b_group->end(), selected_button));

		//for (int i = 0; i < target_button->parent_button_group->workspace_button_list.size(); i++)
		//if (target_button->parent_button_group->workspace_button_list[i] == target_button->parent_button_group->selected_button)
		//{
		//	selected_button_id = i;
		//	break;
		//}

		EntityButtonLootfilterVersionPattern*
			pattern_button = (EntityButtonLootfilterVersionPattern*)(target_button);

		LootFilterVersionPattern::PatternStruct*
			target_pattern = pattern_button->attached_pattern;





		EInputCore::logger_param("selected_button_id", selected_button_id);

		//select default pattern, if currently selected deleted
		if ((selected_button_id >= 0) && (selected_button_id < b_group->size()))
		{
			for (EButtonGroup* group : EWindowMain::active_loot_filter_editor->group_list)
			{


				if (dynamic_cast<EButtonGroupFilterBlock*>(group) != nullptr)
				{


					EButtonGroupFilterBlock*
						filter_block = static_cast<EButtonGroupFilterBlock*>(group);

					filter_block->reselect_specific_variant_on_version_routers(selected_button_id);
					//filter_block->refresh_version_router_button();

				}
			}
		}
		else
		{
			EInputCore::logger_simple_error
			(
				"Have no suitable patterns to delete! "
				+
				EInputCore::border_this_text(selected_button_id, '[')
				+
				EInputCore::border_this_text(b_group->size(), '<')
			);
		}

		//delete selected button
		EWindowMain::registered_group_loot_version_configure->part_with_pattern_list->delete_exact_button(target_button);

		//erase deleted pattern
		if (target_pattern != nullptr)
		{
			//erase deleted pattern from list
			LootFilterVersionPattern::registered_loot_filter_version_patterns.erase
			(
				std::find
				(
					LootFilterVersionPattern::registered_loot_filter_version_patterns.begin(),
					LootFilterVersionPattern::registered_loot_filter_version_patterns.end(),
					target_pattern
				)
			);

			delete target_pattern;
		}

		EWindowMain::registered_group_loot_version_configure->need_refresh = true;

	}
}

void EDataActionCollection::action_create_new_loot_version_pattern(Entity* _entity, ECustomData* _custom_data, float _d)
{
	std::string
		free_name = "New pattern";

	bool
		name_collision = false;

	for (int i = 1; i < 100; i++)
	{
		if (i > 1)
		{

			free_name = "New pattern(" + std::to_string(i) + ")";
		}

		name_collision = false;

		for (LootFilterVersionPattern::PatternStruct* p_struct : LootFilterVersionPattern::registered_loot_filter_version_patterns)
		{
			if (p_struct->localised_name.base_name == free_name)
			{
				name_collision = true;

				break;
			}
		}

		if (!name_collision)
		{
			break;
		}
	}



	LootFilterVersionPattern::PatternStruct*
		new_pattern_struct = new LootFilterVersionPattern::PatternStruct();
	new_pattern_struct->default_text_color.set_color_RGBA(0.9f, 0.8f, 0.7f, 1.0f);
	new_pattern_struct->icon = NS_EGraphicCore::load_from_textures_folder("loot_versions/loot_version_default");
	new_pattern_struct->localised_name = ELocalisationText::generate_localization_with_base_name(free_name);

	LootFilterVersionPattern::registered_loot_filter_version_patterns.push_back(new_pattern_struct);

	////////////////////////////////////////////////////////////////////
	EntityButtonLootfilterVersionPattern*
		button_list_of_pattern = new EntityButtonLootfilterVersionPattern();
	button_list_of_pattern->make_default_button_with_unedible_text
	(
		new ERegionGabarite(120.0f, 22.0f),
		EWindowMain::registered_group_loot_version_configure->part_with_pattern_list,
		&EDataActionCollection::action_select_loot_filter_version_pattern,
		new_pattern_struct->localised_name
	);

	button_list_of_pattern->main_text_area->set_color(&new_pattern_struct->default_text_color);
	new_pattern_struct->color_pointer = &button_list_of_pattern->main_text_area->color;

	button_list_of_pattern->attached_pattern = new_pattern_struct;
	button_list_of_pattern->can_be_stretched = true;

	button_list_of_pattern->main_clickable_area->actions_on_right_click_list.push_back(&EDataActionCollection::action_active_text_area);
	button_list_of_pattern->main_text_area->action_on_finalize_text.push_back(&EDataActionCollection::action_change_version_pattern_name);

	EWindowMain::registered_group_loot_version_configure->part_with_pattern_list->add_button_to_working_group(button_list_of_pattern);
	////////////////////////////////////////////////////////////////////

	action_select_loot_filter_version_pattern
	(
		button_list_of_pattern,
		button_list_of_pattern->main_custom_data,
		_d
	);

	EWindowMain::registered_group_loot_version_configure->need_refresh = true;
}

void EDataActionCollection::action_change_selection_of_tag_configurer(Entity* _entity, ECustomData* _custom_data, float _d)
{


	EntityButtonVariantRouterPatternConfigurer*
		but = static_cast<EntityButtonVariantRouterPatternConfigurer*>(_entity);



	if
		(
			!(
				(EInputCore::key_pressed(GLFW_KEY_LEFT_SHIFT))
				||
				(EInputCore::key_pressed(GLFW_KEY_RIGHT_SHIFT))
				)
			)
	{


		//for (EntityButton* raw_button : but->target_group_with_configurer_buttons->workspace_button_list)
		//{
		//	EntityButtonVariantRouterPatternConfigurer*
		//	router_button = static_cast<EntityButtonVariantRouterPatternConfigurer*>(raw_button);

		//	router_button->select_variant(0);
		//}


		for (EntityButtonVariantRouterPatternConfigurer* router_vector_button : *but->router_button_vector_pointer)
		{
			router_vector_button->select_variant(0);

			for (int i = 0; i < router_vector_button->target_tag_filter->suitable_values.size(); i++)
			{
				router_vector_button->target_tag_filter->suitable_values[i].DETF_is_active = false;

				//but->main_text_area->change_text(std::to_string(i));
			}
		}





		but->select_variant(1);

		if (but->target_bool_value != nullptr)
		{
			*but->target_bool_value = true;
		}
	}

	if (but->DETF_mode == DETFConfigurerMode::LOOT_GENERATOR_PATTERN)
	{
		EWindowMain::loot_simulator_button_group->delayed_execution = true;
	}
	else
		if (but->DETF_mode == DETFConfigurerMode::DATA_ENTITY_FILTER)
		{
			EDataActionCollection::action_type_search_data_entity_text
			(static_cast<EDataContainer_Group_DataEntitiesSearch*>(EWindowMain::data_entity_filter->data_container)->pointer_to_search_bar->main_text_area);
			//EDataActionCollection::action_type_search_filter_block_text(EWindowMain::bottom_filter_block_control->search_button->main_text_area);
		}
}

void EDataActionCollection::action_remove_this_random_user_sound(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EWindowMain::make_unsaved_loot_filter_changes();
	EntityButtonFilterSound*
		sound_button = static_cast<EntityButtonFilterSound*>(_entity);

	sound_button->entity_need_remove = true;
	if (EButtonGroup::sound_list_group->target_sound_button != nullptr)
	{
		for (int j = 0; j < EButtonGroup::sound_list_group->target_sound_button->named_sound_vector.size(); j++)
			for (int i = 0; i < sound_button->named_sound_vector.size(); i++)
				if (EButtonGroup::sound_list_group->target_sound_button->named_sound_vector[j] == sound_button->named_sound_vector[i])
				{
					EButtonGroup::sound_list_group->target_sound_button->named_sound_vector.erase
					(
						EButtonGroup::sound_list_group->target_sound_button->named_sound_vector.begin() + j
					);

					j--;

					sound_button->named_sound_vector.erase(sound_button->named_sound_vector.begin() + i);
					break;
				}
	}

	if (EButtonGroup::sound_list_group->target_sound_button->named_sound_vector.empty())
	{
		EButtonGroup::sound_list_group->target_sound_button->parent_filter_block->custom_sound_suppressor_bool = false;
	}

	EButtonGroup::sound_list_group->set_colors_to_registered_buttons();
	EButtonGroup::sound_list_group->need_refresh = true;

}

void EDataActionCollection::action_open_filter_block_color_editor(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EntityButtonColorButtonForFilterBlock*
		color_button = static_cast<EntityButtonColorButtonForFilterBlock*>(_entity);

	//select assigned button on color editor
	NSWRegisteredButtonGroups::filter_block_colors->pointer_to_cosmetic_element_group->select_this_button(color_button->assigned_cosmetic_element_button);

	//set assigned color button from filter block
	//color_button->assigned_cosmetic_element_button->assigned_color_button_from_filter_block = color_button;
	NSWRegisteredButtonGroups::filter_block_colors->cosmetic_element_button_bg->assigned_color_button_from_filter_block = color_button->master_block->pointer_to_color_button[0];
	NSWRegisteredButtonGroups::filter_block_colors->cosmetic_element_button_text->assigned_color_button_from_filter_block = color_button->master_block->pointer_to_color_button[1];
	NSWRegisteredButtonGroups::filter_block_colors->cosmetic_element_button_rama->assigned_color_button_from_filter_block = color_button->master_block->pointer_to_color_button[2];

	//set HSVRGB color pointers (bg, text, rama)
	NSWRegisteredButtonGroups::filter_block_colors->cosmetic_element_button_bg->target_color = *(color_button->master_block->pointer_to_HRA_color[0]);
	NSWRegisteredButtonGroups::filter_block_colors->cosmetic_element_button_text->target_color = *(color_button->master_block->pointer_to_HRA_color[1]);
	NSWRegisteredButtonGroups::filter_block_colors->cosmetic_element_button_rama->target_color = *(color_button->master_block->pointer_to_HRA_color[2]);

	NSWRegisteredButtonGroups::filter_block_colors->assign_colors(color_button->stored_color);

	NSWRegisteredButtonGroups::filter_block_colors->activate_move_to_foreground_and_center();
}

void EDataActionCollection::action_select_cosmetic_element(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EntityButtonCosmeticElement*
	cosmetic_element_button = static_cast<EntityButtonCosmeticElement*>(_entity);

	//select button for filter block
	cosmetic_element_button->assigned_color_button_from_filter_block->parent_button_group->select_this_button(cosmetic_element_button->assigned_color_button_from_filter_block);

	//select button for color editor
	cosmetic_element_button->parent_button_group->select_this_button(cosmetic_element_button);

	NSWRegisteredButtonGroups::filter_block_colors->assign_colors(cosmetic_element_button->target_color);
}

void EDataActionCollection::action_create_color_pattern_for_filter_block_color_editor(Entity* _entity, ECustomData* _custom_data, float _d)
{
}

void EDataActionCollection::action_open_add_explicit_for_loot_simulator(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EButtonGroupAddExplicitToLootSimulatorItem*
	explicit_group = NSWRegisteredButtonGroups::add_explicit_to_simulator;

	EntityButtonWideItem*
	wide_item_button = static_cast<EntityButtonWideItem*>(_entity);

	if (explicit_group != nullptr)
	{
		explicit_group->button_group_is_active = true;

		explicit_group->region_gabarite->offset_x = std::clamp(wide_item_button->button_gabarite->world_position_x, 8.0f, NS_EGraphicCore::SCREEN_WIDTH		- explicit_group->region_gabarite->size_x - 8.0f);
		explicit_group->region_gabarite->offset_y = std::clamp(wide_item_button->button_gabarite->world_position_y, 8.0f, NS_EGraphicCore::SCREEN_HEIGHT	- explicit_group->region_gabarite->size_y - 8.0f);

		explicit_group->recursive_recalculate_culling_lines();

		explicit_group->move_to_foreground();
		explicit_group->activate_move_to_foreground_and_center();

		explicit_group->target_wide_button = wide_item_button;
	}
}

void EDataActionCollection::action_select_this_affix_for_loot_simulator(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EButtonGroupAddExplicitToLootSimulatorItem*
	explicit_group = NSWRegisteredButtonGroups::add_explicit_to_simulator;

	EntityButtonWideItem*
	wide_button = static_cast<EntityButtonWideItem*>(_entity);

	if
	(
		(explicit_group != nullptr)
		&&
		(explicit_group->target_wide_button != nullptr)
	)
	{
		explicit_group->target_wide_button->pointer_to_data_entity = wide_button->pointer_to_data_entity;
		explicit_group->target_wide_button->change_texture(wide_button->texture_icon);

		explicit_group->target_wide_button->main_text_area->localisation_text = ELocalisationText::generate_localization_with_base_name(wide_button->main_text_area->localisation_text.base_name);
		explicit_group->target_wide_button->main_text_area->change_text(explicit_group->target_wide_button->main_text_area->localisation_text.localisations[ELocalisationText::active_localisation]);
		
		explicit_group->close_this_group();

		explicit_group->target_wide_button->have_phantom_draw = true;

		EWindowMain::loot_simulator_button_group->delayed_execution = true;
	}
}

void EDataActionCollection::action_reset_affix_for_loot_simulator(Entity* _entity, ECustomData* _custom_data, float _d)
{

	EntityButtonWideItem*
	wide_button = static_cast<EntityButtonWideItem*>(_entity);


	wide_button->pointer_to_data_entity = nullptr;
	wide_button->change_texture(NS_EGraphicCore::load_from_textures_folder("undefined_item"));

	wide_button->main_text_area->localisation_text = ELocalisationText::get_localisation_by_key("empty_affix");
	wide_button->main_text_area->change_text(wide_button->main_text_area->localisation_text.localisations[ELocalisationText::active_localisation]);
	wide_button->main_text_area->localisation_text.base_name = "";
	wide_button->have_phantom_draw = true;

	EWindowMain::loot_simulator_button_group->delayed_execution = true;
}

void EDataActionCollection::action_get_poe_ninja_prices(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EWindowMain::get_poe_ninja_api_prices();
}

void EDataActionCollection::action_open_price_check_window(Entity* _entity, ECustomData* _custom_data, float _d)
{
	NSWRegisteredButtonGroups::poe_ninja_price_checker_group->activate_move_to_foreground_and_center();
}

//void EDataActionCollection::action_select_loot_filter_pattern(Entity* _entity, ECustomData* _custom_data, float _d)
//{
//}



void EDataActionCollection::action_type_search_filter_block_text(ETextArea* _text_area)
{


	for (EButtonGroup* group : EWindowMain::active_loot_filter_editor->group_list)
	{
		EButtonGroupFilterBlock* filter_block = static_cast<EButtonGroupFilterBlock*>(group);

		filter_block->group_search_status = GroupSearchStatus::SEARCH_STATUS_IGNORE;

		if (_text_area->original_text != "")
		{
			if (EButtonGroupFilterBlock* block = dynamic_cast<EButtonGroupFilterBlock*>(group))
			{
				if (EWindowMain::filter_block_contains_this_text(filter_block, &_text_area->original_text))
				{
					filter_block->group_search_status = GroupSearchStatus::SEARCH_STATUS_MATCHED;
				}
				else
				{
					filter_block->group_search_status = GroupSearchStatus::SEARCH_STATUS_REJECTED;
				}
			}
		}
		//group->recursive_phantom_translate_if_need();
		//filter_block->scroll_y = 0.0f;
	}


	EWindowMain::active_loot_filter_editor->scroll_y = 0.0f;
	EWindowMain::active_loot_filter_editor->slider->current_value = 0.0f;

	//EButtonGroup::change_group(EWindowMain::loot_filter_editor);
	EWindowMain::active_loot_filter_editor->need_change = true;
	//EButtonGroup::change_group(EWindowMain::loot_filter_editor);
}

void EDataActionCollection::action_refresh_loot_simulator_when_type(ETextArea* _text_area)
{
	if
		(
			(EStringUtils::if_text_is_number(_text_area->original_text))
			&&
			(EWindowMain::loot_simulator_button_group->pointer_to_patterns_buttons_segment->selected_button != nullptr)
			)
	{
		EWindowMain::loot_simulator_button_group->delayed_execution = true;
		//EWindowMain::loot_simulator_button_group->refresh_loot_simulator();
	}
}

void EDataActionCollection::action_set_unsave_changes_flag(ETextArea* _text_area)
{
	EWindowMain::make_unsaved_loot_filter_changes();
}

void EDataActionCollection::action_change_version_names(ETextArea* _text_area)
{
	EWindowMain::active_loot_filter_editor->need_refresh = true;

	int suitable_id = -1;
	for (int i = 0; i < NSW_LOOT_FILTER_MAX_VERSIONS; i++)
	{
		if (EWindowMain::registered_group_loot_version_configure->pointer_to_version_name_button[i] == _text_area->parent_entity_for_text_area)
		{
			suitable_id = i;
		}
	}

	if (suitable_id != -1)
	{
		LootFilterVersionPattern::NSW_LOOT_VERSION_NAME[suitable_id] = _text_area->original_text;
	}

	_text_area->localisation_text = ELocalisationText::generate_localization_only_languages(_text_area->original_text);
}

void EDataActionCollection::action_change_version_pattern_name(ETextArea* _text_area)
{
	EntityButtonLootfilterVersionPattern*
		but = static_cast<EntityButtonLootfilterVersionPattern*>(_text_area->parent_entity_for_text_area);

	but->attached_pattern->localised_name = ELocalisationText::generate_localization_with_base_name(_text_area->original_text);
	but->main_text_area->can_be_edited = false;
}

void EDataActionCollection::action_multisave_lootfilter(Entity* _entity, ECustomData* _custom_data, float _d)
{
	if (!static_cast<EntityButtonFilterBlockTab*>(EWindowMain::tab_list_group->selected_button)->is_empty)
	{
		std::string str = "";

		EButtonGroup::pointer_to_fast_message_group->activate_move_to_foreground_and_center();
		EButtonGroup::pointer_to_fast_message_group->clickable_area_list[0]->text_area->localisation_text.localisations[NSW_localisation_EN] = "Saved!";
		EButtonGroup::pointer_to_fast_message_group->clickable_area_list[0]->text_area->localisation_text.localisations[NSW_localisation_RU] = "Сохранено!";
		EButtonGroup::pointer_to_fast_message_group->clickable_area_list[0]->text_area->update_localisation();
		EButtonGroup::pointer_to_fast_message_group->exist_time = 1.0f;

		EWindowMain::remove_unsave_changes_flag_from_tab();
		//EButtonGroup* filter_block_massive = static_cast<EDataContainer_Button_StoreParentFilterBlock*>(_custom_data->data_container)->parent_filter_block->root_group;
		//for (EButtonGroup* group : EWindowMain::loot_filter_editor->group_list)
		//for (int i = EWindowMain::loot_filter_editor->group_list.size() - 1; i >= 0; i--)

		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//ORIGINAL
		for (int i = 0; i < EWindowMain::active_loot_filter_editor->group_list.size(); i++)
			if (!EWindowMain::active_loot_filter_editor->group_list[i]->group_is_suppressed)
			{

				if (EButtonGroupFilterBlock* block = dynamic_cast<EButtonGroupFilterBlock*>(EWindowMain::active_loot_filter_editor->group_list[i]))//filter block
				{
					str += generate_filter_block_text(EWindowMain::active_loot_filter_editor->group_list[i], -1);
					str += '\n';
					str += '\n';
				}
				else
					if (EButtonGroupFilterBlockSeparator* block = dynamic_cast<EButtonGroupFilterBlockSeparator*>(EWindowMain::active_loot_filter_editor->group_list[i]))//filter block
					{
						if (!static_cast<EButtonGroupFilterBlockSeparator*>(EWindowMain::active_loot_filter_editor->group_list[i])->autogenerated_do_dot_save)
						{
							str += generate_filter_block_separator_text(static_cast<EButtonGroupFilterBlockSeparator*>(EWindowMain::active_loot_filter_editor->group_list[i]), FilterBlockSaveMode::VERSION_ORIGINAL);
							str += '\n';
							str += '\n';
						}
					}
			}

		EWindowMain::write_loot_filter_to_disc(EWindowMain::path_of_exile_folder + "/" + EWindowMain::tab_list_group->selected_button->main_text_area->original_text + ".filter", &str);


		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//AUTOGENERATED_VERSIONS
		for (int j = 0; j < NSW_LOOT_FILTER_MAX_VERSIONS; j++)
		{
			str = "#AUTOGENERATED\n";
			if (*(EWindowMain::registered_group_loot_version_configure->pointer_to_version_name_button[j]->suppressor))
			{

				//str += generate_color_palette_text();
				for (int i = 0; i < EWindowMain::active_loot_filter_editor->group_list.size(); i++)
					if (!EWindowMain::active_loot_filter_editor->group_list[i]->group_is_suppressed)
					{
						if (EButtonGroupFilterBlock* block = dynamic_cast<EButtonGroupFilterBlock*>(EWindowMain::active_loot_filter_editor->group_list[i]))//filter block
						{

							str += generate_filter_block_text(EWindowMain::active_loot_filter_editor->group_list[i], j);
							str += '\n';
							str += '\n';
						}
						else if (EButtonGroupFilterBlockSeparator* block = dynamic_cast<EButtonGroupFilterBlockSeparator*>(EWindowMain::active_loot_filter_editor->group_list[i]))//filter block
						{
							if (!static_cast<EButtonGroupFilterBlockSeparator*>(EWindowMain::active_loot_filter_editor->group_list[i])->autogenerated_do_dot_save)
							{
								str += generate_filter_block_separator_text(static_cast<EButtonGroupFilterBlockSeparator*>(EWindowMain::active_loot_filter_editor->group_list[i]), FilterBlockSaveMode::VERSION_VERY_SOFT);
								str += '\n';
								str += '\n';
							}
						}
					}

				EWindowMain::write_loot_filter_to_disc
				(
					EWindowMain::path_of_exile_folder
					+
					"/"
					+
					EWindowMain::tab_list_group->selected_button->main_text_area->original_text
					+
					"["
					+
					EWindowMain::registered_group_loot_version_configure->pointer_to_version_name_button[j]->main_text_area->original_text
					+
					"].filter",
					&str
				);
			}
		}
	}

}

void EDataActionCollection::action_save_lootfilter(Entity* _entity, ECustomData* _custom_data, float _d)
{
	if (!static_cast<EntityButtonFilterBlockTab*>(EWindowMain::tab_list_group->selected_button)->is_empty)
	{
		std::string str = "";

		EButtonGroup::pointer_to_fast_message_group->activate_move_to_foreground_and_center();
		EButtonGroup::pointer_to_fast_message_group->clickable_area_list[0]->text_area->localisation_text.localisations[NSW_localisation_EN] = "Saved!";
		EButtonGroup::pointer_to_fast_message_group->clickable_area_list[0]->text_area->localisation_text.localisations[NSW_localisation_RU] = "Сохранено!";
		EButtonGroup::pointer_to_fast_message_group->clickable_area_list[0]->text_area->update_localisation();
		EButtonGroup::pointer_to_fast_message_group->exist_time = 1.0f;

		EWindowMain::remove_unsave_changes_flag_from_tab();
		//EButtonGroup* filter_block_massive = static_cast<EDataContainer_Button_StoreParentFilterBlock*>(_custom_data->data_container)->parent_filter_block->root_group;
		//for (EButtonGroup* group : EWindowMain::loot_filter_editor->group_list)
		//for (int i = EWindowMain::loot_filter_editor->group_list.size() - 1; i >= 0; i--)

		//ORIGINAL
		for (int i = 0; i < EWindowMain::active_loot_filter_editor->group_list.size(); i++)
			if (!EWindowMain::active_loot_filter_editor->group_list[i]->group_is_suppressed)
			{

				if (EButtonGroupFilterBlock* block = dynamic_cast<EButtonGroupFilterBlock*>(EWindowMain::active_loot_filter_editor->group_list[i]))//filter block
				{
					str += generate_filter_block_text(EWindowMain::active_loot_filter_editor->group_list[i], -1);
					str += '\n';
					str += '\n';
				}
				else
					if (EButtonGroupFilterBlockSeparator* block = dynamic_cast<EButtonGroupFilterBlockSeparator*>(EWindowMain::active_loot_filter_editor->group_list[i]))//filter block
					{
						if (!static_cast<EButtonGroupFilterBlockSeparator*>(EWindowMain::active_loot_filter_editor->group_list[i])->autogenerated_do_dot_save)
						{
							str += generate_filter_block_separator_text(static_cast<EButtonGroupFilterBlockSeparator*>(EWindowMain::active_loot_filter_editor->group_list[i]), FilterBlockSaveMode::VERSION_ORIGINAL);
							str += '\n';
							str += '\n';
						}
					}
			}


		EWindowMain::write_loot_filter_to_disc(EWindowMain::path_of_exile_folder + "/" + EWindowMain::tab_list_group->selected_button->main_text_area->original_text + ".filter", &str);
	}
}

void EDataActionCollection::action_on_closing_loot_versions_window(EButtonGroup* _group)
{
	for (EButtonGroup* group : EWindowMain::active_loot_filter_editor->group_list)
	{
		if (dynamic_cast<EButtonGroupFilterBlock*>(group) != nullptr)
		{
			EButtonGroupFilterBlock*
				filter_block = static_cast<EButtonGroupFilterBlock*>(group);

			filter_block->refresh_version_router_button();
		}
	}
}


void EWindowMain::register_loot_version_names()
{
	LootFilterVersionPattern::NSW_LOOT_VERSION_NAME[0] = "Very soft";
	LootFilterVersionPattern::NSW_LOOT_VERSION_NAME[1] = "Soft";
	LootFilterVersionPattern::NSW_LOOT_VERSION_NAME[2] = "Default";
	LootFilterVersionPattern::NSW_LOOT_VERSION_NAME[3] = "Strict";
	LootFilterVersionPattern::NSW_LOOT_VERSION_NAME[4] = "Very strict";

	LootFilterVersionPattern::NSW_LOOT_FILTER_VERSION_ACTIVE[0] = true;
	LootFilterVersionPattern::NSW_LOOT_FILTER_VERSION_ACTIVE[1] = true;
	LootFilterVersionPattern::NSW_LOOT_FILTER_VERSION_ACTIVE[2] = true;
	LootFilterVersionPattern::NSW_LOOT_FILTER_VERSION_ACTIVE[3] = true;
	LootFilterVersionPattern::NSW_LOOT_FILTER_VERSION_ACTIVE[4] = true;
}


size_t write_to_string(void* ptr, size_t size, size_t count, void* stream)
{
	((std::string*)stream)->append((char*)ptr, 0, size * count);
	return size * count;
}

void EWindowMain::get_poe_ninja_api_prices()
{
	std::cout << "Read poe.ninja API!\r\n";

	CURL* curl;
	CURLcode	code;

	//reset worth and remove specific tags (like [Good base for unique])
	for (int i = 0; i < EWindowMain::registered_data_entity_game_item_list.size(); i++)
	{
		EDataEntity*
		data_entity = EWindowMain::registered_data_entity_game_item_list[i];

		//if (DataEntityUtils::is_exist_tag_by_name_and_value(0, "item tag", "Unique item", data_entity))
		//{
		//	for (EDataTag* tag : data_entity->tag_list)
		//	{
		//		if (tag->tag_name.ID == ERegisteredStrings::worth.ID)
		//		{
		//			tag->tag_value_list[0] = ERegisteredStrings::trash;
		//		}
		//	}
		//}


		/*EDataTag*
		data_tag = new EDataTag();
		data_tag->tag_name.set_ID_by_string("base worth");

		ID_string
			id_string;

		id_string.set_ID_by_string("Trash");

		data_tag->tag_value_list.push_back(id_string);
		data_entity->tag_list.push_back(data_tag);*/

		DataEntityUtils::set_tag_value_by_name(0, "base worth", "Trash", data_entity);

		//remove all "good for unique" tags
		for (int k = 0; k < data_entity->tag_list.size(); k++)
		{
			if
			(
				(data_entity->tag_list[k]->tag_value_list[0].string_value == "Good base for unique")
				||
				(data_entity->tag_list[k]->tag_value_list[0].string_value == "Expensive base for unique")
			)
			{
				data_entity->tag_list.erase(data_entity->tag_list.begin() + k);
				k--;
			}
		}
		//data_tag->tag_value_list.

	}


	curl = curl_easy_init();
	//curl_easy_setopt(curl, CURLOPT_URL, url.c_str());

	std::string	url_content;
	std::string league_name = NSWRegisteredButtonGroups::poe_ninja_price_checker_group->league_name_button->main_text_area->stored_text;

	std::string	url = "https://poe.ninja/api/data/itemoverview?league=" + league_name + "&type=UniqueJewel";
	curl_easy_setopt(curl, CURLOPT_URL, url.c_str());
	curl_easy_setopt(curl, CURLOPT_WRITEDATA, &url_content);
	curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, write_to_string);


	NSWRegisteredButtonGroups::poe_ninja_price_checker_group->pointer_to_status_group->remove_all_workspace_buttons();

	code = curl_easy_perform(curl);
	NSWRegisteredButtonGroups::poe_ninja_price_checker_group->add_status_button(ELocalisationText::get_localisation_by_key("trade_type_unique_jewels"), code, url_content.length());

	if (code != CURLE_OK)
	{
		std::cout << "Something failed! [" << (CURLcode)code << "]\r\n";
	}
	else
	{
		parse_json_from_poe_ninja(url_content, PoeNinjaAPIMode::UNIQUES);
		url_content = "";
	}

	






	url = "https://poe.ninja/api/data/itemoverview?league=" + league_name + "&type=UniqueFlask";
	curl_easy_setopt(curl, CURLOPT_URL, url.c_str());
	curl_easy_setopt(curl, CURLOPT_WRITEDATA, &url_content);
	curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, write_to_string);

	code = curl_easy_perform(curl);
	NSWRegisteredButtonGroups::poe_ninja_price_checker_group->add_status_button(ELocalisationText::get_localisation_by_key("trade_type_unique_flasks"), code, url_content.length());

	if (code != CURLE_OK)
	{
		std::cout << "Something failed! [" << ((CURLcode)code) << "]\r\n";
	}
	else
	{
		parse_json_from_poe_ninja(url_content, PoeNinjaAPIMode::UNIQUES);
		url_content = "";
	}




	url = "https://poe.ninja/api/data/itemoverview?league=" + league_name + "&type=UniqueWeapon";
	curl_easy_setopt(curl, CURLOPT_URL, url.c_str());
	curl_easy_setopt(curl, CURLOPT_WRITEDATA, &url_content);
	curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, write_to_string);

	code = curl_easy_perform(curl);
	NSWRegisteredButtonGroups::poe_ninja_price_checker_group->add_status_button(ELocalisationText::get_localisation_by_key("trade_type_unique_weapon"), code, url_content.length());

	if (code != CURLE_OK)
	{
		std::cout << "Something failed! [" << (CURLcode)code << "]\r\n";
	}
	else
	{
		parse_json_from_poe_ninja(url_content, PoeNinjaAPIMode::UNIQUES);
		url_content = "";
	}






	url = "https://poe.ninja/api/data/itemoverview?league=" + league_name + "&type=UniqueArmour";
	curl_easy_setopt(curl, CURLOPT_URL, url.c_str());
	curl_easy_setopt(curl, CURLOPT_WRITEDATA, &url_content);
	curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, write_to_string);

	code = curl_easy_perform(curl);
	NSWRegisteredButtonGroups::poe_ninja_price_checker_group->add_status_button(ELocalisationText::get_localisation_by_key("trade_type_unique_armour"), code, url_content.length());

	if (code != CURLE_OK)
	{
		std::cout << "Something failed! [" << (CURLcode)code << "]\r\n";
	}
	else
	{
		parse_json_from_poe_ninja(url_content, PoeNinjaAPIMode::UNIQUES);
		url_content = "";
	}





	url = "https://poe.ninja/api/data/itemoverview?league=" + league_name + "&type=UniqueAccessory";
	curl_easy_setopt(curl, CURLOPT_URL, url.c_str());
	curl_easy_setopt(curl, CURLOPT_WRITEDATA, &url_content);
	curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, write_to_string);

	code = curl_easy_perform(curl);
	NSWRegisteredButtonGroups::poe_ninja_price_checker_group->add_status_button(ELocalisationText::get_localisation_by_key("trade_type_unique_accessory"), code, url_content.length());

	if (code != CURLE_OK)
	{
		std::cout << "Something failed! [" << (CURLcode)code << "]\r\n";
	}
	else
	{
		parse_json_from_poe_ninja(url_content, PoeNinjaAPIMode::UNIQUES);
		url_content = "";
	}




	url = "https://poe.ninja/api/data/itemoverview?league=" + league_name + "&type=DivinationCard";
	curl_easy_setopt(curl, CURLOPT_URL, url.c_str());
	curl_easy_setopt(curl, CURLOPT_WRITEDATA, &url_content);
	curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, write_to_string);

	code = curl_easy_perform(curl);
	NSWRegisteredButtonGroups::poe_ninja_price_checker_group->add_status_button(ELocalisationText::get_localisation_by_key("trade_type_divinations"), code, url_content.length());

	if (code != CURLE_OK)
	{
		std::cout << "Something failed! [" << (CURLcode)code << "]\r\n";
	}
	else
	{

		parse_json_from_poe_ninja(url_content, PoeNinjaAPIMode::DIVINATIONS);
		url_content = "";
	}





	url = "https://poe.ninja/api/data/currencyoverview?league=" + league_name + "&type=Currency";
	curl_easy_setopt(curl, CURLOPT_URL, url.c_str());
	curl_easy_setopt(curl, CURLOPT_WRITEDATA, &url_content);
	curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, write_to_string);

	code = curl_easy_perform(curl);
	NSWRegisteredButtonGroups::poe_ninja_price_checker_group->add_status_button(ELocalisationText::get_localisation_by_key("trade_type_currency"), code, url_content.length());

	if (code != CURLE_OK)
	{
		std::cout << "Something failed! [" << (CURLcode)code << "]\r\n";
	}
	else
	{

		parse_json_from_poe_ninja(url_content, PoeNinjaAPIMode::CURRENCY);
		url_content = "";
	}
	





	url = "https://poe.ninja/api/data/currencyoverview?league=" + league_name + "&type=Fragment";
	curl_easy_setopt(curl, CURLOPT_URL, url.c_str());
	curl_easy_setopt(curl, CURLOPT_WRITEDATA, &url_content);
	curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, write_to_string);

	code = curl_easy_perform(curl);
	NSWRegisteredButtonGroups::poe_ninja_price_checker_group->add_status_button(ELocalisationText::get_localisation_by_key("trade_type_fragment"), code, url_content.length());

	if (code != CURLE_OK)
	{
		std::cout << "Something failed! [" << (CURLcode)code << "]\r\n";
	}
	else
	{

		parse_json_from_poe_ninja(url_content, PoeNinjaAPIMode::CURRENCY);
		url_content = "";
	}
	
	





	url = "https://poe.ninja/api/data/itemoverview?league=" + league_name + "&type=Incubator";
	curl_easy_setopt(curl, CURLOPT_URL, url.c_str());
	curl_easy_setopt(curl, CURLOPT_WRITEDATA, &url_content);
	curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, write_to_string);

	code = curl_easy_perform(curl);
	NSWRegisteredButtonGroups::poe_ninja_price_checker_group->add_status_button(ELocalisationText::get_localisation_by_key("trade_type_incubator"), code, url_content.length());

	if (code != CURLE_OK)
	{
		std::cout << "Something failed! [" << (CURLcode)code << "]\r\n";
	}
	else
	{

		parse_json_from_poe_ninja(url_content, PoeNinjaAPIMode::CURRENCY);
		url_content = "";
	}
	
	





	url = "https://poe.ninja/api/data/itemoverview?league=" + league_name + "&type=Scarab";
	curl_easy_setopt(curl, CURLOPT_URL, url.c_str());
	curl_easy_setopt(curl, CURLOPT_WRITEDATA, &url_content);
	curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, write_to_string);

	code = curl_easy_perform(curl);
	NSWRegisteredButtonGroups::poe_ninja_price_checker_group->add_status_button(ELocalisationText::get_localisation_by_key("trade_type_scarab"), code, url_content.length());

	if (code != CURLE_OK)
	{
		std::cout << "Something failed! [" << (CURLcode)code << "]\r\n";
	}
	else
	{

		parse_json_from_poe_ninja(url_content, PoeNinjaAPIMode::CURRENCY);
		url_content = "";
	}
	
	





	url = "https://poe.ninja/api/data/itemoverview?league=" + league_name + "&type=Fossil";
	curl_easy_setopt(curl, CURLOPT_URL, url.c_str());
	curl_easy_setopt(curl, CURLOPT_WRITEDATA, &url_content);
	curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, write_to_string);

	code = curl_easy_perform(curl);
	NSWRegisteredButtonGroups::poe_ninja_price_checker_group->add_status_button(ELocalisationText::get_localisation_by_key("trade_type_fossils"), code, url_content.length());

	if (code != CURLE_OK)
	{
		std::cout << "Something failed! [" << (CURLcode)code << "]\r\n";
	}
	else
	{

		parse_json_from_poe_ninja(url_content, PoeNinjaAPIMode::CURRENCY);
		url_content = "";
	}
	
	





	url = "https://poe.ninja/api/data/itemoverview?league=" + league_name + "&type=SkillGem";
	curl_easy_setopt(curl, CURLOPT_URL, url.c_str());
	curl_easy_setopt(curl, CURLOPT_WRITEDATA, &url_content);
	curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, write_to_string);

	code = curl_easy_perform(curl);
	NSWRegisteredButtonGroups::poe_ninja_price_checker_group->add_status_button(ELocalisationText::get_localisation_by_key("trade_type_skill_gem"), code, url_content.length());

	if (code != CURLE_OK)
	{
		std::cout << "Something failed! [" << (CURLcode)code << "]\r\n";
	}
	else
	{

		parse_json_from_poe_ninja(url_content, PoeNinjaAPIMode::GEMS);
		url_content = "";
	}














	std::ofstream writabro;
	writabro.open("data/Uniques_with_details_ID.txt");


	for (EDataEntity* de : EDataEntity::data_entity_global_list)
	{
		std::string
		details_ID = DataEntityUtils::get_tag_value_by_name(0, "detailsId", de);

	if (details_ID != "")
		{
				writabro << "ADD_NEW_DATA_ENTITY" << std::endl;

				for (EDataTag* tag : de->tag_list)
				{
					writabro << '\t' << "[tag]" << '"' << tag->tag_name.string_value << '"' << '\t' << "[value]" << '"' << tag->tag_value_list[0].string_value << '"' << std::endl;;
				}

				writabro << std::endl << std::endl << std::endl;
		}

	}
	writabro.close();
	curl_easy_cleanup(curl);




}

void EWindowMain::parse_json_from_poe_ninja(std::string _url_content, PoeNinjaAPIMode _mode)
{
	//	PARSER
	//########################################
	bool raw_read_mode = false;
	//bool read_as_parameter = true;
	int read_mode = 0;
	int depth = 0;
	int links = 0;
	int count = 0;
	int gem_level = 0;

	std::string buff = "", param = "", value = "";
	std::string read_buffer[16]{ "" };

	std::string item_name = "";
	std::string details_id = "";
	float item_value = 0;

	bool is_banned = false;

	static std::string banned_detail_id[]
	{
		"asphyxias-wrath-two-point-arrow-quiver",
		""
	};

	//std::vector<EDataEntity*> data_entity_vector;

	//reset cost of all uniques
	if (_mode == PoeNinjaAPIMode::UNIQUES)
	{

	}


	for (int i = 0; i < _url_content.length(); i++)
	{
		char chr = _url_content.at(i);

		if (chr == '"') { raw_read_mode = !raw_read_mode; }

		//add char to buff
		if
			(
				(
					((chr != '{') && (chr != '}') && (chr != ':') && (chr != ','))
					||
					(raw_read_mode)
					)
				&&
				(chr != '"')
				)
		{
			buff += chr;
		}



		if (chr == '{') { depth++; }
		if (chr == '}') { depth--; }

		//finalize buff, read to param or value
		if
			(
				(
					((chr == '{') || (chr == '}') || (chr == ':') || (chr == ','))
					&&
					(!raw_read_mode)
					)
				)
		{
			read_buffer[read_mode] = buff;
			//read_mode++;
			buff = "";

			/*if (read_mode == 1)
			{
				EInputCore::logger_param(read_buffer[0], read_buffer[1]);
			}*/

			if
				(
					(
						((read_buffer[0] == "currencyTypeName") && (_mode == PoeNinjaAPIMode::CURRENCY))
						||
						(
							(read_buffer[0] == "name")
							&&
							(
								(_mode == PoeNinjaAPIMode::UNIQUES)
								||
								(_mode == PoeNinjaAPIMode::DIVINATIONS)
								||
								(_mode == PoeNinjaAPIMode::GEMS)
							)
						)
					)
					&& (read_mode == 1)
				)
			{
				links = 0;
				count = 0;
				gem_level = 0;
				is_banned = false;

				details_id = "";
				item_name = read_buffer[1];

				if (_mode == PoeNinjaAPIMode::CURRENCY)
				{
					_mode = _mode;
				}
			}


			//links
			if
				(
					(read_buffer[0] == "links")
					&&
					(_mode == PoeNinjaAPIMode::UNIQUES)
					&&
					(read_mode == 1)
					)
			{
				links = EStringUtils::safe_convert_string_to_number(read_buffer[1], 0, 6);
			}

			//count
			if
				(
					(read_buffer[0] == "listingCount")
					&&
					(read_mode == 1)
					)
			{
				count = EStringUtils::safe_convert_string_to_number(read_buffer[1], 0, 999999);
			}

			//detailsId
			if
				(
					(read_buffer[0] == "detailsId")
					&&
					(read_mode == 1)
				)
			{
				details_id = read_buffer[1];
			}

			//detailsId
			if
				(
					(read_buffer[0] == "gemLevel")
					&&
					(read_mode == 1)
				)
			{
				gem_level = EStringUtils::safe_convert_string_to_number(read_buffer[1], 0, 30);
			}

			//READ WORTH
			if
			(
				(
					((read_buffer[0] == "chaosEquivalent") && (_mode == PoeNinjaAPIMode::CURRENCY))
					||
					(
						(read_buffer[0] == "chaosValue")
						&&
						(
							(_mode == PoeNinjaAPIMode::UNIQUES)
							||
							(_mode == PoeNinjaAPIMode::DIVINATIONS)
							||
							(_mode == PoeNinjaAPIMode::GEMS)
						)
					)

					)
					&&
					(read_mode == 1)
			)
			{
				item_value = std::stof(read_buffer[1]);
			}
				//EInputCore::logger_param(item_name, item_value);
			
			
			//FINALIZE READ, PREPARE ITEM
			if ((read_buffer[0] == "detailsId") &&(read_mode == 1))
			{
				bool existed_item = false;



				//for (int k = 0; k < 1000; k++)
				//{
				//	if (banned_detail_id[k] == "") { break; }
				//	if (banned_detail_id[k] == details_id) { is_banned = true; break; }
				//}



				//only 1-4 links, if that weapon or armour
				if
				(
					((links <= 4) || (_mode != PoeNinjaAPIMode::UNIQUES))
					&&
					((gem_level <= 1) || (_mode != PoeNinjaAPIMode::GEMS))
				)
				{
					for (int i = 0; i < EWindowMain::registered_data_entity_game_item_list.size(); i++)
					{
						EDataEntity*
						data_entity = EWindowMain::registered_data_entity_game_item_list[i];



						//set new
						if
							(
								(
									(_mode == PoeNinjaAPIMode::UNIQUES)
									&&
									(DataEntityUtils::is_exist_tag_by_name_and_value(0, "item tag", "Unique item", data_entity))
									&&
									(DataEntityUtils::is_exist_tag_by_name_and_value(0, "detailsId", details_id, data_entity))
								)
								||
								(
									((_mode == PoeNinjaAPIMode::DIVINATIONS))
									&&
									(DataEntityUtils::is_exist_tag_by_name_and_value(0, "base class", "Divination Cards", data_entity))
									&&
									(DataEntityUtils::is_exist_tag_by_name_and_value(0, "name EN", item_name, data_entity))
								)
								||
								(
									((_mode == PoeNinjaAPIMode::CURRENCY))
									&&
									(DataEntityUtils::is_exist_tag_by_name_and_value(0, "base class", "Stackable Currency", data_entity))
									&&
									(DataEntityUtils::is_exist_tag_by_name_and_value(0, "name EN", item_name, data_entity))
								)
								||
								(
									((_mode == PoeNinjaAPIMode::GEMS))
									&&
									(DataEntityUtils::is_exist_tag_by_name_and_value(0, "base class", "Support Gems", data_entity))
									&&
									(DataEntityUtils::is_exist_tag_by_name_and_value(0, "name EN", item_name, data_entity))
									)
								)
						{

							existed_item = true;

							//STACK MULTIPLIER
							std::string
							stack_multiplier_text = DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::stack_multiplier, data_entity);
							float stack_multiplier = 1.0f;

							if (_mode == PoeNinjaAPIMode::CURRENCY)
							{
								if (stack_multiplier_text != "")
								{
									stack_multiplier = std::stof(stack_multiplier_text);
								}
							}
							else
							{
								stack_multiplier = 1.0f;
							}

							int total_cost = round(item_value * stack_multiplier);

							ID_string new_worth_ID_string;
							int old_worth_id = -1;
							int new_worth_id = -1;

							if (total_cost <= 1) { new_worth_id = 0; new_worth_ID_string = ERegisteredStrings::trash; }
							else
								if (total_cost <= 3) { new_worth_id = 1; new_worth_ID_string = ERegisteredStrings::common; }
								else
									if (total_cost <= 10) { new_worth_id = 2; new_worth_ID_string = ERegisteredStrings::moderate; }
									else
										if (total_cost <= 100) { new_worth_id = 3; new_worth_ID_string = ERegisteredStrings::rare; }
										else
											if (total_cost <= 300) { new_worth_id = 4; new_worth_ID_string = ERegisteredStrings::expensive; }
											else
												/*__________________*/ {
												new_worth_id = 5; new_worth_ID_string = ERegisteredStrings::very_expensive;
											}


							std::string
							base_worth_value = DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::base_worth, data_entity);

							if (base_worth_value == "Trash") { old_worth_id = 0; }
							else
								if (base_worth_value == "Common") { old_worth_id = 1; }
								else
									if (base_worth_value == "Moderate") { old_worth_id = 2; }
									else
										if (base_worth_value == "Rare") { old_worth_id = 3; }
										else
											if (base_worth_value == "Expensive") { old_worth_id = 4; }
											else
												if (base_worth_value == "Very expensive") { old_worth_id = 5; }

							//if (item_name == "Blightwell")
							//{ old_worth_id = old_worth_id; }
							//set new worth if new higher that old
							if
							(
								(old_worth_id != -1)
								//&&
								//(new_worth_id > old_worth_id)
							)
							{
								std::cout << green << "Item [" << yellow << item_name << green << "]" << " cost is <";
								
								if (new_worth_id == 0){std::cout << white;} else
								if (new_worth_id == 1){std::cout << green;} else
								if (new_worth_id == 2){std::cout << blue;} else
								if (new_worth_id == 3){std::cout << purple;} else
								if (new_worth_id >= 4){std::cout << yellow;}

								std::cout << new_worth_ID_string.string_value << green << ">" << std::endl;

								DataEntityUtils::set_tag_value_by_name(0, "worth", new_worth_ID_string.string_value, data_entity);
								DataEntityUtils::set_tag_value_by_name(0, "base worth", new_worth_ID_string.string_value, data_entity);

								//for (EDataTag* tag : data_entity->tag_list)
								//{
								//	EDataTag*
								//		base_worth_tag = nullptr;

								//	if ((tag->tag_name.ID == ERegisteredStrings::worth.ID) || (tag->tag_name.ID == ERegisteredStrings::base_worth.ID))
								//	{
								//		tag->tag_value_list[0] = new_worth_ID_string;
								//		break;
								//	}

								//}
							}

							//chance cost of base item [for uniques]
							if ((_mode == PoeNinjaAPIMode::UNIQUES))
							{

								DataEntityUtils::set_tag_value_by_name(0, "detailsId", details_id, data_entity);

								std::string
								base_item_name = DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::base_name, data_entity);

								if (base_item_name == "")
								{
									base_item_name = DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::name_EN, data_entity);
								}

								for (int j = 0; j < EWindowMain::registered_data_entity_game_item_list.size(); j++)
								{
									EDataEntity*
									sub_data_entity = EWindowMain::registered_data_entity_game_item_list[j];

									std::string
										sub_base_item_name = DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::base_name, sub_data_entity);

									if (sub_base_item_name == "")
									{
										sub_base_item_name = DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::name_EN, sub_data_entity);
									}

									if ((sub_base_item_name == "Steelscale Gauntlets") && (base_item_name == "Steelscale Gauntlets"))
									{
										sub_base_item_name = sub_base_item_name;
									}
									//MATCHED BASE ITEM
									if
									(
										(sub_base_item_name == base_item_name)
										&&
										(!DataEntityUtils::is_exist_tag_by_name_and_value(0, "item tag", "Unique item", sub_data_entity))
									)
									{
										//
										if
										(
												(new_worth_id >= 2) && (new_worth_id <= 3)
												&&
												(!DataEntityUtils::is_exist_tag_by_name_and_value(0, "item tag", "Expensive base for unique", sub_data_entity))//protect overriding expensive bases
												&&
												(!DataEntityUtils::is_exist_tag_by_name_and_value(0, "item tag", "Good base for unique", sub_data_entity))//protect adding same tag
										)
										{
											EDataTag*
												data_tag = new EDataTag();
											data_tag->tag_name.set_ID_by_string("item tag");

											ID_string
												id_string;

											id_string.set_ID_by_string("Good base for unique");

											data_tag->tag_value_list.push_back(id_string);
											sub_data_entity->tag_list.push_back(data_tag);

											std::cout << white << "Base [" << yellow << sub_base_item_name << green << "]" << " raise cost to <" << yellow << "Good" << green << ">" << std::endl;
										}
										else
											//
											if
											(
												(new_worth_id >= 4)
												&&
												(!DataEntityUtils::is_exist_tag_by_name_and_value(0, "item tag", "Expensive base for unique", sub_data_entity))//protect adding same tag
											)
											{
												EDataTag*
													data_tag = new EDataTag();
												data_tag->tag_name.set_ID_by_string("item tag");

												ID_string
													id_string;

												id_string.set_ID_by_string("Expensive base for unique");

												std::cout << white << "Base [" << yellow << sub_base_item_name << green << "]" << " raise cost to <" << yellow << "Expensive" << green << ">" << std::endl;

												data_tag->tag_value_list.push_back(id_string);
												sub_data_entity->tag_list.push_back(data_tag);
											}

											DataEntityUtils::set_tag_value_by_name(0, "worth", new_worth_ID_string.string_value, data_entity);
										break;
									}
								}


							}

							break;
						}


					}

					if (!existed_item)
					{
						EInputCore::logger_simple_error(item_name);
						EInputCore::logger_simple_error(details_id);
						std::cout << std::endl;
					}
				}


			}


		}

		if (chr == ':') { read_mode = 1; }
		if ((chr == ',') || (chr == '{') || (chr == '}'))
		{
			read_mode = 0;

			//links = 0;

			for (int k = 0; k < 16; k++)
			{
				read_buffer[k] = "";
			}
		}
	}
}

void EWindowMain::export_loot_patterns_to_file()
{
	std::ofstream writabro;

	std::string buffer = "";

	writabro.open("exported_loot_filter_patterns.txt");

	for (LootSimulatorPattern* pattern : LootSimulatorPattern::registered_loot_simulater_pattern_list)
	{
		writabro << "REGISTER_NEW_PATTERN" << std::endl;

		writabro << "name_EN" << '\t' << '"' << pattern->localised_name.localisations[NSW_localisation_EN] << '"' << std::endl;
		writabro << "name_RU" << '\t' << '"' << pattern->localised_name.localisations[NSW_localisation_RU] << '"' << std::endl;
		writabro << "icon"	<< '\t' << '"' << pattern->icon->get_full_path() << '"' << std::endl;

		for (ID_string str : pattern->activate_attribute_group_by_ID_string_list)
		{
			writabro << "activate_attribute_group_by_name" << '\t' << '"' << str.string_value << '"' << std::endl;
		}

		if (pattern->additional_force_field_for_buttons)	{ writabro << "add_additional_force_field" << std::endl; }
		if (pattern->always_show)							{ writabro << "always_show" << std::endl; }
		if (pattern->is_folder)								{ writabro << "is_folder" << std::endl; }
		if (pattern->have_force_field)						{ writabro << "have_force_field" << std::endl; }
		if (!pattern->can_be_configured)					{ writabro << "cannot_be_configured" << std::endl; }
		if (pattern->rarity_override != -1)					{ writabro << "rarity_override" << '\t' << std::to_string(pattern->rarity_override) << std::endl; }

		for (GameItemGenerator* item_generator : pattern->game_item_generator_list)
		{
			writabro << std::endl << "REGISTER_NEW_GENERATOR" << std::endl;

			writabro << "generations_count"		<< '\t' << std::to_string(item_generator->generations_count)		<< std::endl;
			writabro << "random_selection_count"	<< '\t' << std::to_string(item_generator->random_selection_count)	<< std::endl;

			writabro << "generator_mode"			<< '\t';
			if (item_generator->generator_mode == GameItemGeneratorMode::GAME_ITEM_GENERATOR_MODE_ALL) { writabro << "MODE_ALL"; } else
			if (item_generator->generator_mode == GameItemGeneratorMode::GAME_ITEM_GENERATOR_MODE_RANDOM_COUNT) { writabro << "RANDOM_COUNT"; } else
			if (item_generator->generator_mode == GameItemGeneratorMode::GAME_ITEM_GENERATOR_MODE_RANDOM_COUNT_ERASE) { writabro << "RANDOM_COUNT_ERASE"; }
			writabro << std::endl;

			if (item_generator->generator_name.localisations[NSW_localisation_EN] != "")
			{writabro << "generator_name_EN" << '\t' << '"' << (item_generator->generator_name.localisations[NSW_localisation_EN]) << '"' << std::endl;}

			if (item_generator->generator_name.localisations[NSW_localisation_RU] != "")
			{writabro << "generator_name_RU" << '\t' << '"' << (item_generator->generator_name.localisations[NSW_localisation_RU]) << '"' << std::endl;}

			if (item_generator->forceful_warn_when_hided)		{writabro << "generator_forceful_warn_when_hided" << std::endl;}
			if (!item_generator->can_be_configured)				{writabro << "generator_cannot_be_configured" << std::endl;}
			if (!item_generator->indicate)						{writabro << "generator_cannot_be_indicate" << std::endl;}
			if (item_generator->always_6_linked)				{writabro << "generator_forceful_6_linked" << std::endl;}
			if (item_generator->always_unique)					{writabro << "generator_forceful_unique" << std::endl;}

			if (item_generator->filtered_by_exact_name.base_name != "")
			{writabro << "generator_filtered_base" << '\t' << '"' << item_generator->filtered_by_exact_name.base_name << '"' << std::endl; }

			if (item_generator->filtered_by_exact_name.localisations[NSW_localisation_EN] != "")
			{writabro << "generator_filtered_EN" << '\t' << '"' << item_generator->filtered_by_exact_name.localisations[NSW_localisation_EN] << '"' << std::endl; }

			if (item_generator->filtered_by_exact_name.localisations[NSW_localisation_RU] != "")
			{writabro << "generator_filtered_RU" << '\t' << '"' << item_generator->filtered_by_exact_name.localisations[NSW_localisation_RU] << '"' << std::endl; }

			//for (GameAttributeGenerator* attribute_generator)

			for (DataEntityTagFilter* tag : item_generator->filtered_by_tags)
			{
				writabro << std::endl << "REGISTER_NEW_FILTER_TAG" << std::endl;
				writabro << "target_tag" << '\t' << '"' << tag->target_tag.string_value << '"' << std::endl;

				if (!tag->can_be_configured)	{ writabro << "tag_cannot_be_configured" << std::endl; }
				if (tag->merge_with_prev)		{ writabro << "tag_merge_with_prev" << std::endl; }

				for (DETF_Value suitable_DETF : tag->suitable_values)
				{
					writabro << std::endl << "REGISTER_NEW_SUITABLE_VALUES" << std::endl;


					if (suitable_DETF.target_value_key.string_value != "")
					{writabro << "DETF_value_key" << '\t' << '"' << suitable_DETF.target_value_key.string_value << '"' << std::endl;}

					if (suitable_DETF.localised_attribute_name.localisations[NSW_localisation_EN] != "")
					{writabro << "DETF_localised_attribute_name_EN"	<< '\t' << '"' << suitable_DETF.localised_attribute_name.localisations[NSW_localisation_EN] << '"' << std::endl;}

					if (suitable_DETF.localised_attribute_name.localisations[NSW_localisation_RU] != "")
					{writabro << "DETF_localised_attribute_name_RU"	<< '\t' << '"' << suitable_DETF.localised_attribute_name.localisations[NSW_localisation_RU] << '"' << std::endl;}

					writabro << "DETF_color"
					<<'\t' << std::to_string((int)round(suitable_DETF.text_color.r * 255.0f))
					<<'\t' << std::to_string((int)round(suitable_DETF.text_color.g * 255.0f))
					<<'\t' << std::to_string((int)round(suitable_DETF.text_color.b * 255.0f))
					<<'\t' << std::to_string((int)round(suitable_DETF.text_color.a * 255.0f));
					writabro << std::endl;
					//if (!suitable_DETF.DETF_is_active)	{ buffer <<= "DETF_inactive" << std::endl; }
					//if (suitable_DETF.always_suitable)	{ buffer <<= "DETF_inactive" << std::endl; }

				}

				for (DETF_Value banned_DETF : tag->banned_tags)
				{
					writabro << std::endl << "REGISTER_NEW_BANNED_VALUES" << std::endl;

					if (banned_DETF.target_value_key.string_value != "")
					{writabro << "DETF_value_key" << '\t' << '"' << banned_DETF.target_value_key.string_value << '"' << std::endl;}
					
					if (banned_DETF.localised_attribute_name.localisations[NSW_localisation_EN] != "")
					{writabro << "DETF_localised_attribute_name_EN" << '\t' << '"' << banned_DETF.localised_attribute_name.localisations[NSW_localisation_EN] << '"' << std::endl; }

					if (banned_DETF.localised_attribute_name.localisations[NSW_localisation_RU] != "")
					{writabro << "DETF_localised_attribute_name_RU" << '\t' << '"' << banned_DETF.localised_attribute_name.localisations[NSW_localisation_RU] << '"'<< std::endl;}

					writabro << "DETF_color"
					<< '\t' << std::to_string((int)round(banned_DETF.text_color.r * 255.0f))
					<< '\t' << std::to_string((int)round(banned_DETF.text_color.g * 255.0f))
					<< '\t' << std::to_string((int)round(banned_DETF.text_color.b * 255.0f))
					<< '\t' << std::to_string((int)round(banned_DETF.text_color.a * 255.0f));
					writabro << std::endl;
					//if (!suitable_DETF.DETF_is_active)	{ buffer += "DETF_inactive" + '\r' + '\n'; }
					//if (suitable_DETF.always_suitable)	{ buffer += "DETF_inactive" + '\r' + '\n'; }

				}


			}


		}

		writabro << std::endl << std::endl << std::endl << std::endl << std::endl;
	}
	//writabro << buffer;
	writabro.close();
}

void EWindowMain::import_loot_patterns_from_file()
{
	if (std::filesystem::exists("data/LootPatterns.txt"))
	{
		for (int i = 0; i < LootSimulatorPattern::registered_loot_simulater_pattern_list.size(); i++)
		{
			delete LootSimulatorPattern::registered_loot_simulater_pattern_list[i];
		}

		LootSimulatorPattern::registered_loot_simulater_pattern_list.clear();
		LootSimulatorPattern::registered_loot_simulater_pattern_list.shrink_to_fit();
		//first_time_open = false;

		std::ifstream file;
		std::string str;

		LootSimulatorPattern*
		just_created_pattern = nullptr;

		GameItemGenerator*
		just_created_generator = nullptr;

		DataEntityTagFilter*
		just_created_tag_filter = nullptr;

		DETF_Value*
		just_created_DETF = nullptr;

		file.open("data/LootPatterns.txt");

		int version_id = 0;

		while (std::getline(file, str))
		{
			EStringUtils::split_line_to_array(str);


			if (EStringUtils::string_array[0] == "REGISTER_NEW_PATTERN")
			{
				just_created_pattern = new LootSimulatorPattern;
				LootSimulatorPattern::registered_loot_simulater_pattern_list.push_back(just_created_pattern);
			}
			else
			if (EStringUtils::string_array[0] == "name_EN")
			{
				just_created_pattern->localised_name.localisations[NSW_localisation_EN] = EStringUtils::string_array[1];
			}
			else
			if (EStringUtils::string_array[0] == "name_RU")
			{
				just_created_pattern->localised_name.localisations[NSW_localisation_RU] = EStringUtils::string_array[1];
			}
			else
			if (EStringUtils::string_array[0] == "icon")
			{
				just_created_pattern->icon = NS_EGraphicCore::put_texture_to_atlas(EStringUtils::string_array[1], NS_EGraphicCore::default_texture_atlas);
			}
			else
			if (EStringUtils::string_array[0] == "activate_attribute_group_by_name")
			{
				ID_string id_string;
				id_string.set_ID_by_string(EStringUtils::string_array[1]);

				just_created_pattern->activate_attribute_group_by_ID_string_list.push_back(id_string);
			}
			else
			if (EStringUtils::string_array[0] == "add_additional_force_field")
			{
				just_created_pattern->additional_force_field_for_buttons = true;
			}
			else
			if (EStringUtils::string_array[0] == "always_show")
			{
				just_created_pattern->always_show = true;
			}
			else
			if (EStringUtils::string_array[0] == "is_folder")
			{
				just_created_pattern->is_folder = true;
			}
			else
			if (EStringUtils::string_array[0] == "have_force_field")
			{
				just_created_pattern->have_force_field = true;
			}
			else
			if (EStringUtils::string_array[0] == "cannot_be_configured")
			{
				just_created_pattern->can_be_configured = false;
			}
			else
			if (EStringUtils::string_array[0] == "rarity_override")
			{
				just_created_pattern->rarity_override = EStringUtils::safe_convert_string_to_number(EStringUtils::string_array[1], 0, 3);
			}
			else
			if (EStringUtils::string_array[0] == "REGISTER_NEW_GENERATOR")
			{
				just_created_generator = new GameItemGenerator();

				just_created_pattern->game_item_generator_list.push_back(just_created_generator);
			}
			else
			if (EStringUtils::string_array[0] == "generations_count")
			{
				just_created_generator->generations_count = EStringUtils::safe_convert_string_to_number(EStringUtils::string_array[1], 0, 99);
			}
			else
			if (EStringUtils::string_array[0] == "random_selection_count")
			{
				just_created_generator->random_selection_count = EStringUtils::safe_convert_string_to_number(EStringUtils::string_array[1], 0, 99);
			}
			else
			if (EStringUtils::string_array[0] == "generator_mode")
			{
				if (EStringUtils::string_array[1] == "MODE_ALL")									{ just_created_generator->generator_mode = GameItemGeneratorMode::GAME_ITEM_GENERATOR_MODE_ALL; }
				if (EStringUtils::string_array[1] == "RANDOM_COUNT")								{ just_created_generator->generator_mode = GameItemGeneratorMode::GAME_ITEM_GENERATOR_MODE_RANDOM_COUNT; }
				if (EStringUtils::string_array[1] == "GAME_ITEM_GENERATOR_MODE_RANDOM_COUNT_ERASE")	{ just_created_generator->generator_mode = GameItemGeneratorMode::GAME_ITEM_GENERATOR_MODE_RANDOM_COUNT_ERASE; }
			}
			else
			if (EStringUtils::string_array[0] == "generator_name_EN")
			{
				just_created_generator->generator_name.localisations[NSW_localisation_EN] = EStringUtils::string_array[1];
			}
			else
			if (EStringUtils::string_array[0] == "generator_name_RU")
			{
				just_created_generator->generator_name.localisations[NSW_localisation_RU] = EStringUtils::string_array[1];
			}
			else
			if (EStringUtils::string_array[0] == "generator_forceful_warn_when_hided")
			{
				just_created_generator->forceful_warn_when_hided = true;
			}
			else
			if (EStringUtils::string_array[0] == "generator_cannot_be_configured")
			{
				just_created_generator->can_be_configured = false;
			}
			else
			if (EStringUtils::string_array[0] == "generator_cannot_be_indicate")
			{
				just_created_generator->indicate = false;
			}
			else
			if (EStringUtils::string_array[0] == "generator_forceful_6_linked")
			{
				just_created_generator->always_6_linked = true;
			}
			else
			if (EStringUtils::string_array[0] == "generator_forceful_unique")
			{
				just_created_generator->always_unique = true;
			}
			else
			if (EStringUtils::string_array[0] == "generator_filtered_base")
			{
				just_created_generator->filtered_by_exact_name.base_name = EStringUtils::string_array[1];
			}
			else
			if (EStringUtils::string_array[0] == "generator_filtered_EN")
			{
				just_created_generator->filtered_by_exact_name.localisations[NSW_localisation_EN] = EStringUtils::string_array[1];
			}
			else
			if (EStringUtils::string_array[0] == "generator_filtered_RU")
			{
				just_created_generator->filtered_by_exact_name.localisations[NSW_localisation_RU] = EStringUtils::string_array[1];
			}
			else
			if (EStringUtils::string_array[0] == "REGISTER_NEW_FILTER_TAG")
			{
				just_created_tag_filter = new DataEntityTagFilter;

				just_created_generator->filtered_by_tags.push_back(just_created_tag_filter);
			}
			else
			if (EStringUtils::string_array[0] == "target_tag")
			{
				just_created_tag_filter->target_tag.set_ID_by_string(EStringUtils::string_array[1]);
			}
			else
			if (EStringUtils::string_array[0] == "tag_cannot_be_configured")
			{
				just_created_tag_filter->can_be_configured = false;
			}
			else
			if (EStringUtils::string_array[0] == "tag_merge_with_prev")
			{
				just_created_tag_filter->merge_with_prev = true;
			}
			else
			if (EStringUtils::string_array[0] == "REGISTER_NEW_SUITABLE_VALUES")
			{
				
				just_created_tag_filter->suitable_values.push_back(DETF_Value());
				just_created_DETF = &(just_created_tag_filter->suitable_values.back());
			}
			else
			if (EStringUtils::string_array[0] == "DETF_value_key")
			{
				just_created_DETF->target_value_key.set_ID_by_string(EStringUtils::string_array[1]);
			}
			else
			if (EStringUtils::string_array[0] == "DETF_value_key")
			{
				just_created_DETF->target_value_key.set_ID_by_string(EStringUtils::string_array[1]);
			}
			else
			if (EStringUtils::string_array[0] == "DETF_localised_attribute_name_EN")
			{
				just_created_DETF->localised_attribute_name.localisations[NSW_localisation_EN] = EStringUtils::string_array[1];
			}
			else
			if (EStringUtils::string_array[0] == "DETF_localised_attribute_name_RU")
			{
				just_created_DETF->localised_attribute_name.localisations[NSW_localisation_RU] = EStringUtils::string_array[1];
			}
			else
			if (EStringUtils::string_array[0] == "DETF_color")
			{
				just_created_DETF->text_color.r = EStringUtils::safe_convert_string_to_number(EStringUtils::string_array[1], 0, 255) / 255.0f;
				just_created_DETF->text_color.g = EStringUtils::safe_convert_string_to_number(EStringUtils::string_array[2], 0, 255) / 255.0f;
				just_created_DETF->text_color.b = EStringUtils::safe_convert_string_to_number(EStringUtils::string_array[3], 0, 255) / 255.0f;
				just_created_DETF->text_color.a = EStringUtils::safe_convert_string_to_number(EStringUtils::string_array[4], 0, 255) / 255.0f;
			}
			else
			if (EStringUtils::string_array[0] == "REGISTER_NEW_BANNED_VALUES")
			{
				just_created_tag_filter->banned_tags.push_back(DETF_Value());
				just_created_DETF = &(just_created_tag_filter->banned_tags.back());
			}
		}
	}
}

void EWindowMain::add_all_loot_patter_to_loot_simulator(EButtonGroup* left_part_for_patterns)
{
	std::vector< EntityButtonLootPatternSelector*>	folder_vector;

	left_part_for_patterns->remove_all_workspace_buttons();
	left_part_for_patterns->selected_button = nullptr;

	for (LootSimulatorPattern* loot_pattern : LootSimulatorPattern::registered_loot_simulater_pattern_list)
	{
		EntityButtonLootPatternSelector*
		pattern_button = new EntityButtonLootPatternSelector();
		pattern_button->make_as_default_button_with_icon_and_text
		(
			new ERegionGabarite(230.0f, 40.0f),
			left_part_for_patterns,
			((!loot_pattern->is_folder) ? (&EDataActionCollection::action_generate_items_from_this_loot_pattern) : (&EDataActionCollection::action_switch_pattern_folder_state)),
			loot_pattern->icon,
			loot_pattern->localised_name.localisations[ELocalisationText::active_localisation]
		);

		if (loot_pattern->have_force_field) { pattern_button->force_field_up = 16.0f; }

		pattern_button->target_loot_pattern_button_group = left_part_for_patterns;

		//loot pattern folder, do not generate loot, just show/hide associated pattens
		if ((loot_pattern->is_folder))
		{
			pattern_button->hidden_by_folder = false;

			for (EntityButtonLootPatternSelector* vector_button : folder_vector)
			{
				vector_button->parent_folder_button = pattern_button;
				vector_button->hidden_by_folder = true;
			}

			folder_vector.clear();
		}
		else
		{
			folder_vector.push_back(pattern_button);
		}

		//if (loot_pattern->additional_force_field_for_buttons) { pattern_button->force_field_up = 32.0f; }
		if (!loot_pattern->is_folder) { pattern_button->force_field_left = 16.0f; }
		pattern_button->target_pattern = loot_pattern;
		pattern_button->main_text_area->localisation_text = loot_pattern->localised_name;
		pattern_button->add_default_description_by_key("description_loot_simulator_pattern");
		pattern_button->can_be_stretched = true;

		left_part_for_patterns->add_button_to_working_group(pattern_button);
	}
}

void EWindowMain::register_loot_simulator_group()
{
	
	
		////////////////////////////////
		EButtonGroupLootSimulator*
			whole_loot_simulator_group = new EButtonGroupLootSimulator(new ERegionGabarite(100.0f, 100.0f, 1400.0f, 700.0f));

		whole_loot_simulator_group->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DARKEN, bgroup_with_slider);
		whole_loot_simulator_group->root_group = whole_loot_simulator_group;
		whole_loot_simulator_group->parent_window = this;
		whole_loot_simulator_group->button_group_is_active = false;

		loot_simulator_button_group = whole_loot_simulator_group;
		////////////////////////////////
		EButtonGroup*
			workspace_part = whole_loot_simulator_group->add_close_group_and_return_workspace_group(new ERegionGabarite(20.0f, 20.0f), EGUIStyle::active_style);

		whole_loot_simulator_group->add_help_button(NS_EGraphicCore::load_from_textures_folder("buttons/button_info"), "description_help_info_loot_simulator");

		whole_loot_simulator_group->add_caption_by_localistation_key("window_header_loot_simulator");




		//______MAIN SECTION______(BOTTOM)
		/////////		BOTTOM SECTON FOR GENERATET LOOT BUTTONS AND WARN_WHEN_HIDDEN TEXT		//////////
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		EButtonGroup*
			bottom_loot_part = new EButtonGroup(new ERegionGabarite(90.0f, 90.0f));
		bottom_loot_part->init_button_group(EGUIStyle::active_style, BrickStyleID::NONE, bgroup_with_slider);
		bottom_loot_part->set_parameters(ChildAlignMode::ALIGN_HORIZONTAL, NSW_dynamic_autosize, NSW_dynamic_autosize);
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////




		workspace_part->add_group(bottom_loot_part);

		//______MAIN SECTION______(TOP)
		/////////		CONTROL PART FOR BUTTONS WHICH CAN (FOR EXAMPLE) CHANGE LUCK> MADE ITEMS CORRUPTED AND ETC.		//////////
		EButtonGroup*
		top_control_part = new EButtonGroup(new ERegionGabarite(90.0f, 25.0f));
		top_control_part->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DEFAULT, bgroup_with_slider);
		top_control_part->set_parameters(ChildAlignMode::ALIGN_HORIZONTAL, NSW_dynamic_autosize, NSW_static_autosize);
		workspace_part->add_group(top_control_part);
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


		//=HORIZONTAL=
		// 
		// 
		// 
		//_________CHILD_________
		/////////		PATTERNS FOR LEFT SIDE (VERTICAL LIST OF REGISTERED PATTERNS)		//////////
		EButtonGroup*
			left_part_for_patterns = new EButtonGroup(new ERegionGabarite(250.0f, 500.0f));
		left_part_for_patterns->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DEFAULT, bgroup_with_slider);
		left_part_for_patterns->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_static_autosize, NSW_dynamic_autosize);

		//left_part_for_patterns->child_align_direction = ChildElementsAlignDirection::TOP_TO_BOTTOM;

		whole_loot_simulator_group->pointer_to_patterns_buttons_segment = left_part_for_patterns;

		bottom_loot_part->add_group(left_part_for_patterns);
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


		/////////		FLAG TAGS		//////////
		EButtonGroup*
			flag_configurer_group = new EButtonGroup(new ERegionGabarite(200.0f, 10.0f));
		flag_configurer_group->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DEFAULT, bgroup_with_slider);
		flag_configurer_group->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_static_autosize, NSW_dynamic_autosize);
		bottom_loot_part->add_group(flag_configurer_group);
		whole_loot_simulator_group->pointer_to_flag_configurator_group = flag_configurer_group;
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////






		/////////		MIDDLE LOOT CONTAINER		//////////
		EButtonGroup*
			middle_loot_and_warning_container = new EButtonGroup(new ERegionGabarite(10.0f, 10.0f));
		middle_loot_and_warning_container->init_button_group(EGUIStyle::active_style, BrickStyleID::NONE, bgroup_with_slider);
		middle_loot_and_warning_container->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_dynamic_autosize);
		middle_loot_and_warning_container->button_align_type = ButtonAlignType::BUTTON_ALIGN_MID;

		bottom_loot_part->add_group(middle_loot_and_warning_container);
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////




		//_________CHILD_________
		/////////		BOTTOM LOOT ITEM BUTTONS		//////////
		EButtonGroup*
			bottom_part_for_loot = new EButtonGroup(new ERegionGabarite(10.0f, 10.0f));
		bottom_part_for_loot->init_button_group(EGUIStyle::active_style, BrickStyleID::NONE, bgroup_with_slider);
		bottom_part_for_loot->set_parameters(ChildAlignMode::ALIGN_HORIZONTAL, NSW_dynamic_autosize, NSW_dynamic_autosize);
		bottom_part_for_loot->button_align_type = ButtonAlignType::BUTTON_ALIGN_MID;

		middle_loot_and_warning_container->add_group(bottom_part_for_loot);

		whole_loot_simulator_group->pointer_to_loot_buttons_segment = bottom_part_for_loot;
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////






		/////////		UPPER WARNING LOOT ITEM BUTTONS		//////////
		EButtonGroup*
			upper_part_for_warning = new EButtonGroup(new ERegionGabarite(10.0f, 30.0f));
		upper_part_for_warning->init_button_group(EGUIStyle::active_style, BrickStyleID::NONE, bgroup_with_slider);
		upper_part_for_warning->set_parameters(ChildAlignMode::ALIGN_HORIZONTAL, NSW_dynamic_autosize, NSW_static_autosize);
		upper_part_for_warning->button_align_type = ButtonAlignType::BUTTON_ALIGN_MID;
		upper_part_for_warning->button_group_is_active = false;
		whole_loot_simulator_group->pointer_to_warning_group = upper_part_for_warning;

		upper_part_for_warning->add_default_clickable_region_with_text_area(ELocalisationText::get_localisation_by_key("valuable_loot_hidden_warning"));
		upper_part_for_warning->clickable_area_list.back()->text_area->font = EFont::font_list[1];
		upper_part_for_warning->clickable_area_list.back()->text_area->set_color(NS_EColorUtils::COLOR_RED);

		middle_loot_and_warning_container->add_group(upper_part_for_warning);
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////




		/////////		USED BLOCKS INF, RIGHT PART WHER USED CAN FIND ASSOTIATIONS BETWEEN COSMETIC ELEMENT AND FILTER BLOCK		//////////
		EButtonGroup*
			right_loot_part = new EButtonGroup(new ERegionGabarite(200.0f, 10.0f));
		right_loot_part->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DEFAULT, bgroup_with_slider);
		right_loot_part->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_static_autosize, NSW_dynamic_autosize);
		right_loot_part->child_align_direction = ChildElementsAlignDirection::TOP_TO_BOTTOM;

		bottom_loot_part->add_group(right_loot_part);
		whole_loot_simulator_group->pointer_to_right_side_info_buttons = right_loot_part;
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////




		/////////		RARITY GROUP																								//////////
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		{
			EButtonGroupAttributeGeneratorGroup_Rarity*
				rarity_group = new EButtonGroupAttributeGeneratorGroup_Rarity(new ERegionGabarite(200.0f, 30.0f));
			rarity_group->additional_y_distance = 10.0f;
			rarity_group->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DEFAULT, bgroup_without_slider);
			rarity_group->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_static_autosize);

			right_loot_part->add_group(rarity_group);
			rarity_group->init();
		}




		/////////		ITEM LEVEL GROUP																								//////////
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		{
			EButtonGroupAttributeGeneratorGroup_ItemLevel*
				item_level_group = new EButtonGroupAttributeGeneratorGroup_ItemLevel(new ERegionGabarite(200.0f, 40.0f));
			item_level_group->init();
			item_level_group->additional_y_distance = 10.0f;

			item_level_group->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DEFAULT, bgroup_without_slider);
			item_level_group->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_static_autosize);

			right_loot_part->add_group(item_level_group);

		}

		/////////		QUALITY																								//////////
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		{
			EButtonGroupAttributeGeneratorGroup_Quality*
				quality_group = new EButtonGroupAttributeGeneratorGroup_Quality(new ERegionGabarite(200.0f, 0.0f));
			quality_group->init();
			quality_group->additional_y_distance = 10.0f;

			quality_group->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DEFAULT, bgroup_without_slider);
			quality_group->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_static_autosize);

			right_loot_part->add_group(quality_group);

		}

		/////////		GEM ATTRIBUTES																								//////////
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		{
			EButtonGroupAttributeGeneratorGroup_GemAttributes*
				gem_attribute_group = new EButtonGroupAttributeGeneratorGroup_GemAttributes(new ERegionGabarite(200.0f, 0.0f));
			gem_attribute_group->init();
			gem_attribute_group->additional_y_distance = 10.0f;

			gem_attribute_group->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DEFAULT, bgroup_without_slider);
			gem_attribute_group->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_static_autosize);

			right_loot_part->add_group(gem_attribute_group);

		}

		/////////		MAP ATTRIBUTES																								//////////
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		{
			EButtonGroupAttributeGeneratorGroup_MapAttributes*
				map_attribute_group = new EButtonGroupAttributeGeneratorGroup_MapAttributes(new ERegionGabarite(200.0f, 0.0f));
			map_attribute_group->init();
			map_attribute_group->additional_y_distance = 10.0f;

			map_attribute_group->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DEFAULT, bgroup_without_slider);
			map_attribute_group->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_static_autosize);

			right_loot_part->add_group(map_attribute_group);

		}

		/////////		PROCENTILE																							//////////
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		{
			EButtonGroupAttributeGeneratorGroup_DefenceProcentile*
				map_attribute_group = new EButtonGroupAttributeGeneratorGroup_DefenceProcentile(new ERegionGabarite(200.0f, 0.0f));
			map_attribute_group->init();
			map_attribute_group->additional_y_distance = 10.0f;

			map_attribute_group->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DEFAULT, bgroup_without_slider);
			map_attribute_group->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_static_autosize);

			right_loot_part->add_group(map_attribute_group);

		}


		/////////		QUANTITY																							//////////
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		{
			EButtonGroupAttributeGeneratorGroup_Quantity*
				quantity_group = new EButtonGroupAttributeGeneratorGroup_Quantity(new ERegionGabarite(200.0f, 0.0f));
			quantity_group->init();
			quantity_group->additional_y_distance = 10.0f;

			quantity_group->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DEFAULT, bgroup_without_slider);
			quantity_group->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_static_autosize);

			right_loot_part->add_group(quantity_group);

		}




		/////////		SOCKETS LINKS COLOURS																								//////////
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		{
			EButtonGroupAttributeGeneratorGroup_SocketsAndLinks*
				socket_link_color_group = new EButtonGroupAttributeGeneratorGroup_SocketsAndLinks(new ERegionGabarite(200.0f, 0.0f));
			socket_link_color_group->init();
			socket_link_color_group->additional_y_distance = 10.0f;

			socket_link_color_group->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DEFAULT, bgroup_without_slider);
			socket_link_color_group->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_static_autosize);

			right_loot_part->add_group(socket_link_color_group);

		}

		/////////		SYNTHESISED																								//////////
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		{
			EButtonGroupAttributeGeneratorGroup_FlagAttributes*
				socket_link_color_group = new EButtonGroupAttributeGeneratorGroup_FlagAttributes(new ERegionGabarite(200.0f, 0.0f));
			socket_link_color_group->init();
			socket_link_color_group->additional_y_distance = 10.0f;

			socket_link_color_group->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DEFAULT, bgroup_without_slider);
			socket_link_color_group->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_static_autosize);

			right_loot_part->add_group(socket_link_color_group);

		}

		/////////		INFLUENCE																								//////////
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		{
			EButtonGroupAttributeGeneratorGroup_Influense*
				socket_link_color_group = new EButtonGroupAttributeGeneratorGroup_Influense(new ERegionGabarite(200.0f, 0.0f));
			socket_link_color_group->init();
			socket_link_color_group->additional_y_distance = 10.0f;

			socket_link_color_group->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DEFAULT, bgroup_without_slider);
			socket_link_color_group->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_static_autosize);

			right_loot_part->add_group(socket_link_color_group);

		}

		/////////		EXPLICIT																								//////////
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		{
			EButtonGroupAttributeGeneratorGroup_Explicit*
				socket_link_color_group = new EButtonGroupAttributeGeneratorGroup_Explicit(new ERegionGabarite(200.0f, 0.0f));
			socket_link_color_group->init();
			socket_link_color_group->additional_y_distance = 10.0f;

			socket_link_color_group->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DEFAULT, bgroup_without_slider);
			socket_link_color_group->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_static_autosize);

			right_loot_part->add_group(socket_link_color_group);

		}


		//||
		//||
		//||
		//END OF BUTTON GROUPS


		add_all_loot_patter_to_loot_simulator(left_part_for_patterns);


		//		SELECTED VERSION
		/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		{
			EntityButtonVariantRouter*
			variant_router_button = new EntityButtonVariantRouter();
			
			top_control_part->add_button_to_working_group(variant_router_button);
			whole_loot_simulator_group->pointer_to_target_loot_filter_version_button = variant_router_button;

			variant_router_button->make_as_default_router_variant_button (new ERegionGabarite(256.0f, 25.0f));
			variant_router_button->rotate_variant_mode = RotateVariantMode::OPEN_CHOOSE_WINDOW;
			variant_router_button->action_on_choose_variant_from_window.push_back(&EDataActionCollection::action_refresh_loot_simulator);
			for (int i = 0; i < NSW_LOOT_FILTER_MAX_VERSIONS; i++)
				if (LootFilterVersionPattern::NSW_LOOT_FILTER_VERSION_ACTIVE[i])
				{
					variant_router_button->add_router_variant_by_text_and_color(LootFilterVersionPattern::NSW_LOOT_VERSION_NAME[i], 0.9f, 0.8f, 0.7f, 1.0f);
				}

			variant_router_button->select_variant(0);
		}

		{
			EntityButton*
			poe_ninja_price_check_button = new EntityButton();

			poe_ninja_price_check_button->make_as_default_button_with_icon_and_localisation_by_key
			(
				new ERegionGabarite(200.0f, 25.0f),
				top_control_part,
				&EDataActionCollection::action_open_price_check_window,
				NS_EGraphicCore::load_from_textures_folder("buttons/ninja-logo"),
				"update_poe_ninja_prices"
			);

			top_control_part->add_button_to_working_group(poe_ninja_price_check_button);
		}

		button_group_list.push_back(whole_loot_simulator_group);
		//EButtonGroup::refresh_button_group(main_loot_buttons_group);
		whole_loot_simulator_group->need_refresh = true;
	
}

void EWindowMain::register_add_content_to_filter_block_group()
{
	{
		EntityButton*
		jc_button = nullptr;

		EButtonGroup*
			//add_content_group = EButtonGroup::create_root_button_group(new ERegionGabarite(100.0f, 100.0f, 700.0f, 400.0f), EGUIStyle::active_style);
			add_content_group = new EButtonGroup(new ERegionGabarite(700.0f, 500.0f));
		add_content_group->init_as_root_group(this);

		add_content_group->child_align_mode = ChildAlignMode::ALIGN_VERTICAL;

		add_content_group->stretch_x_by_parent_size = false;
		add_content_group->dynamic_size_y = false;

		EButtonGroup::add_content_to_filter_block_group = add_content_group;
		add_content_group->button_group_is_active = false;

		EDataContainer_Group_AddContentToFilterBlock* content_group_data_container = new EDataContainer_Group_AddContentToFilterBlock();
		add_content_group->data_container = content_group_data_container;

		////////////////////////////////////////////////////////////////////////////////////////////////////
		EButtonGroup* workspace_group
			=
			add_content_group->add_close_group_and_return_workspace_group(new ERegionGabarite(10.0f, 20.0f), EGUIStyle::active_style);
		workspace_group->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_dynamic_autosize);
		add_content_group->add_caption_by_localistation_key("window_header_add_content_to_filter_block");
		////////////////////////////////////////////////////////////////////////////////////////////////////
		EButtonGroup*
			content_list_group
			=
			workspace_group->add_group
			(
				EButtonGroup::create_default_button_group
				(
					new ERegionGabarite(10.0f, 10.0f),
					EGUIStyle::active_style
				)
			);
		content_list_group->set_parameters(ChildAlignMode::ALIGN_HORIZONTAL, NSW_dynamic_autosize, NSW_dynamic_autosize);

		////////////////////////////////////////////////////////////////////////////////////////////////////
		EButtonGroup* search_bar_group
			=
			workspace_group->add_group
			(
				EButtonGroup::create_default_button_group
				(
					new ERegionGabarite(10.0f, 30.0f),
					EGUIStyle::active_style
				)
			);
		search_bar_group->button_align_type = ButtonAlignType::BUTTON_ALIGN_MID;

		EntityButtonMultiSearch*
			button_multisearch = new EntityButtonMultiSearch();
		button_multisearch->make_default_button_with_edible_text
		(
			new ERegionGabarite(400.0f, 30.0f),
			search_bar_group,
			nullptr,
			""
		);
		button_multisearch->can_be_stretched = true;
		button_multisearch->main_text_area->gray_text = ELocalisationText();
		button_multisearch->main_text_area->gray_text.localisations[NSW_localisation_EN] = "Filter attributes";
		button_multisearch->main_text_area->gray_text.localisations[NSW_localisation_RU] = "Поиск по названию";

		//add pointer to clickable are in "add content to filter block group"
		content_group_data_container->typing_text_area = button_multisearch->main_text_area;

		//auto multi_search_data_container = new EntityButtonMultiSearch();

		Entity::get_last_clickable_area(button_multisearch)->text_area->action_on_change_text.push_back(&EDataActionCollection::action_type_text_multiblock_searcher);

		search_bar_group->add_button_to_working_group(button_multisearch);
		search_bar_group->set_parameters(ChildAlignMode::ALIGN_HORIZONTAL, NSW_dynamic_autosize, NSW_static_autosize);

		////////////////////////////////////////////////////////////////////////////////////////////////////
		EButtonGroup*
			filter_block_operation_segment
			=
			content_list_group->add_group
			(
				EButtonGroup::create_default_button_group(new ERegionGabarite(150.0f, 100.0f), EGUIStyle::active_style)
				->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_static_autosize, NSW_dynamic_autosize)
			);
		filter_block_operation_segment->button_size_x_override = 150.0f;
		filter_block_operation_segment->group_have_button_lines = true;
		filter_block_operation_segment->button_align_type = ButtonAlignType::BUTTON_ALIGN_MID;


		/////////////////////	ADD NEW BLOCK	///////////////////////////////////////////
		ELocalisationText l_text;
		l_text.localisations[NSW_localisation_EN] = "Add new block";
		l_text.localisations[NSW_localisation_RU] = "Создать новый блок";

		jc_button = new EntityButton();
		jc_button->make_default_button_with_unedible_text
		(
			new ERegionGabarite(160.0f, 35.0f),
			filter_block_operation_segment,
			&EDataActionCollection::action_add_new_filter_block,
			l_text
		);
		jc_button->can_be_stretched = true;
		jc_button->new_line_method = NewLineMethod::FORCIBLY;

		jc_button->can_be_stretched = true;
		jc_button->main_text_area->localisation_text = l_text;
		jc_button->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_make_unsave_filter_block_changes_and_refresh_loot_simulator);

		filter_block_operation_segment->add_button_to_working_group(jc_button);
		/////////////////////	CLONE	///////////////////////////////////////////
		EntityButtonForFilterBlock* clone_button = new EntityButtonForFilterBlock();

		l_text.localisations[NSW_localisation_EN] = "Clone block";
		l_text.localisations[NSW_localisation_RU] = "Дублировать блок";

		clone_button->make_default_button_with_unedible_text
		(
			new ERegionGabarite(160.0f, 35.0f),
			filter_block_operation_segment,
			&EDataActionCollection::action_clone_block,
			l_text
		);
		clone_button->can_be_stretched = true;
		clone_button->new_line_method = NewLineMethod::FORCIBLY;

		clone_button->can_be_stretched = true;
		clone_button->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_make_unsave_filter_block_changes_and_refresh_loot_simulator);
		clone_button->main_text_area->localisation_text = l_text;
		//clone_button->parent_filter_block = 

		filter_block_operation_segment->add_button_to_working_group(clone_button);
		////////////////////////////////////////////////////////////////////////////////////////////////////



		/////////////////////	SEPARATOR	///////////////////////////////////////////
		l_text.localisations[NSW_localisation_EN] = "Add separator";
		l_text.localisations[NSW_localisation_RU] = "Добавить разделитель";
		EntityButtonForFilterBlock*
			separator_button = new EntityButtonForFilterBlock();
		separator_button->make_default_button_with_unedible_text
		(
			new ERegionGabarite(160.0f, 35.0f),
			filter_block_operation_segment,
			&EDataActionCollection::action_add_separator_block,
			l_text
		);
		separator_button->can_be_stretched = true;
		separator_button->new_line_method = NewLineMethod::FORCIBLY;

		separator_button->can_be_stretched = true;
		separator_button->main_text_area->localisation_text = l_text;
		separator_button->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_make_unsave_filter_block_changes_and_refresh_loot_simulator);

		//##//##//##//##//##	DESCRIPTION		//##//##//##//##//##//##//##//##
		separator_button->description_container = new DescriptionContainerSeparatorExample(600.0f, 500.0f);
		separator_button->description_container->localisation_text = ELocalisationText::get_localisation_by_key("Description_add_new_separator");
		separator_button->description_container->parent_button = separator_button;
		//##//##//##//##//##//##//##//##//##//##//##//##//##//##//##//##//##//##//##//##//##
		//clone_button->parent_filter_block = 

		filter_block_operation_segment->add_button_to_working_group(separator_button);
		////////////////////////////////////////////////////////////////////////////////////////////////////




		////////////////////////////////////////////////////////////////////////////////////////////////////
		//jc_button = EntityButton::create_default_clickable_button_with_unedible_text(new ERegionGabarite(160.0f, 20.0f), filter_block_operation_segment, nullptr, "Клонировать этот блок");
		//filter_block_operation_segment->button_list.push_back(jc_button);

		///
		EButtonGroup*
			non_listed_segment
			=
			content_list_group->add_group
			(
				EButtonGroup::create_default_button_group(new ERegionGabarite(100.0f, 100.0f), EGUIStyle::active_style)
				->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_dynamic_autosize)
			);
		//non_listed_segment->button_size_x_override = 150.0f;
		non_listed_segment->button_align_type = ButtonAlignType::BUTTON_ALIGN_LEFT;
		non_listed_segment->group_have_button_lines = true;

		///
		EButtonGroup*
			listed_segment
			=
			content_list_group->add_group
			(
				EButtonGroup::create_default_button_group(new ERegionGabarite(100.0f, 100.0f), EGUIStyle::active_style)
				->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_dynamic_autosize)
			);
		//listed_segment->button_size_x_override = 150.0f;
		listed_segment->group_have_background = true;
		listed_segment->button_align_type = ButtonAlignType::BUTTON_ALIGN_LEFT;




		button_multisearch->target_group_list.push_back(content_list_group);
		button_multisearch->target_group_list.push_back(non_listed_segment);
		button_multisearch->target_group_list.push_back(listed_segment);

		EButtonGroup* target_group = nullptr;
		for (GameItemAttribute* game_attribute : registered_game_item_attributes)
			if ((!game_attribute->always_present) && (!game_attribute->commentary_config))
			{
				EDataContainer_Button_AddContentToFilterBlock* add_content_data = new EDataContainer_Button_AddContentToFilterBlock();
				add_content_data->target_attribute = game_attribute;

				if (game_attribute->filter_attribute_type == FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED) { target_group = non_listed_segment; }
				if (game_attribute->filter_attribute_type == FilterAttributeType::FILTER_ATTRIBUTE_TYPE_LISTED) { target_group = listed_segment; }
				//if (fba->filter_attribute_type == FilterAttributeType::FILTER_ATTRIBUTE_TYPE_COSMETIC) { target_group = cosmetic_segment; }

				jc_button = new EntityButton();
				jc_button->make_as_default_button_with_icon_and_text
				(
					new ERegionGabarite(150.0f, 35.0f),
					target_group,
					&EDataActionCollection::action_add_selected_content_to_filter_block,
					game_attribute->icon,
					game_attribute->localisation.localisations[ELocalisationText::active_localisation]
				);
				jc_button->force_field_left = 2.0f;
				jc_button->force_field_right = 2.0f;
				jc_button->force_field_bottom = 2.0f;
				jc_button->force_field_up = 2.0f;

				jc_button->main_text_area->localisation_text = game_attribute->localisation;

				jc_button->can_be_stretched = true;

				EntityButton::get_last_custom_data(jc_button)->data_container = add_content_data;

				//set localisations to text area
				EntityButton::get_last_clickable_area(jc_button)->text_area->localisation_text = game_attribute->localisation;

				target_group->add_button_to_working_group(jc_button);




				if (game_attribute->header_localistaion_key != "")
				{
					EntityButton*
						atrribute_header_button = new EntityButton();

					atrribute_header_button->make_default_button_with_unedible_text
					(
						new ERegionGabarite(250.0f, 20.0f),
						target_group,
						nullptr,
						ELocalisationText::get_localisation_by_key(game_attribute->header_localistaion_key)
					);

					atrribute_header_button->have_simple_bg = true;
					atrribute_header_button->button_search_mode = ButtonSearchMode::ALWAYS_HIDDEN;
					atrribute_header_button->can_be_stretched = true;
					atrribute_header_button->new_line_method = NewLineMethod::FORCIBLY;
					atrribute_header_button->do_not_generate_bg = true;
					atrribute_header_button->force_field_bottom = 4.0f;
					atrribute_header_button->force_field_up = 16.0f;
					atrribute_header_button->max_stretch_factor = 3.0f;
					target_group->add_button_to_working_group(atrribute_header_button);


				}

				if (game_attribute->description_localisation_key != "")
				{
					jc_button->add_default_description_by_key(game_attribute->description_localisation_key);
				}



			}



		button_group_list.push_back(add_content_group);
		//EButtonGroup::refresh_button_group(add_content_group);
		add_content_group->need_refresh = true;
	}
}

void EWindowMain::register_sound_group()
{
	{
		EWindowMain::load_ingame_sound_list();
		EWindowMain::load_custom_sound_list();

		EButtonGroupSoundList*
			main_sound_group = new EButtonGroupSoundList(new ERegionGabarite(512.0f, 256.0f, 1020.0f, 512.0f));
		main_sound_group->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DARKEN, bgroup_with_slider);
		main_sound_group->button_group_is_active = false;
		main_sound_group->auto_superfocused = true;

		EButtonGroup::sound_list_group = main_sound_group;
		EButtonGroup::sound_list_group->action_on_select_for_button = &EDataActionCollection::action_select_this_sound_for_target_button;

		//auto whole_loot_filter_group = static_cast<EButtonGroupLootFilterList*>(main_sound_group);


		main_sound_group->parent_window = this;

		main_sound_group->root_group = main_sound_group;
		main_sound_group->can_be_moved = true;
		main_sound_group->can_resize_to_workspace_size_x = true;
		main_sound_group->can_resize_to_workspace_size_y = true;

		main_sound_group->child_align_mode = ChildAlignMode::ALIGN_VERTICAL;

		EButtonGroup* sound_list_workspace_part = main_sound_group->add_close_group_and_return_workspace_group
		(
			new ERegionGabarite(1.0f, 20.0f),
			EGUIStyle::active_style
		)->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_dynamic_autosize);
		main_sound_group->add_caption_by_localistation_key("window_header_select_sound");
		///////////////		MAIN SOUNDS LIST PART		///////////////
		EButtonGroup* sound_list_part = sound_list_workspace_part->add_group
		(
			EButtonGroup::create_default_button_group
			(
				new ERegionGabarite(1.0f, 1.0f),
				EGUIStyle::active_style
			)->set_parameters(ChildAlignMode::ALIGN_HORIZONTAL, NSW_dynamic_autosize, NSW_dynamic_autosize)
		);
		//
		///////////////		LEFT SOUNDS LIST PART		///////////////
		EButtonGroup* left_sound_list_part = sound_list_part->add_group
		(
			EButtonGroup::create_default_button_group
			(
				new ERegionGabarite(1.0f, 1.0f),
				EGUIStyle::active_style
			)->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_dynamic_autosize)
		);

		left_sound_list_part->button_size_x_override = 300.0f;
		//

		///////////////		RIGHT SELECTED SOUNDS LIST PART		///////////////
		EButtonGroup* right_selected_sound_list_part = sound_list_part->add_group
		(
			EButtonGroup::create_default_button_group
			(
				new ERegionGabarite(220.0f, 1.0f),
				EGUIStyle::active_style
			)->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_static_autosize, NSW_dynamic_autosize)
		);
		//

		///////////////		SEARCH INPUT PART		///////////////
		EButtonGroup* search_input_part = sound_list_workspace_part->add_group
		(
			EButtonGroup::create_default_button_group
			(
				new ERegionGabarite(1.0f, 32.0f),
				EGUIStyle::active_style
			)->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_static_autosize)
		);
		search_input_part->button_align_type = ButtonAlignType::BUTTON_ALIGN_MID;



		EntityButtonMultiSearch*
			button_multisearch = new EntityButtonMultiSearch();
		button_multisearch->make_default_button_with_edible_text
		(
			new ERegionGabarite(800.0f, 28.0f),
			search_input_part,
			nullptr,
			""
		);

		button_multisearch->main_text_area->gray_text = ELocalisationText();
		button_multisearch->main_text_area->gray_text.localisations[NSW_localisation_EN] = "Type sound name...";
		button_multisearch->main_text_area->gray_text.localisations[NSW_localisation_RU] = "Напишите название звука...";

		button_multisearch->target_group_list.push_back(sound_list_part);
		button_multisearch->main_text_area->action_on_change_text.push_back(&EDataActionCollection::action_type_text_multiblock_searcher);


		search_input_part->add_button_to_working_group(button_multisearch);



		/// set data parameters
		main_sound_group->part_with_registered_sound = left_sound_list_part;
		main_sound_group->part_with_selected_sound = right_selected_sound_list_part;



		button_group_list.push_back(main_sound_group);
		//EButtonGroup::refresh_button_group(main_sound_group);
		main_sound_group->need_refresh = true;
	}
}

void EWindowMain::register_about_group()
{
	{
		EButtonGroup*
		about_whole_group = new EButtonGroup(new ERegionGabarite(500.0f, 400.0f));
		about_whole_group->button_group_is_active = false;

		about_whole_group->init_as_root_group(this);


		info_button_group = about_whole_group;

		EButtonGroup*
			about_workspace_part = about_whole_group->add_close_group_and_return_workspace_group(new ERegionGabarite(100.0f, 20.0f), EGUIStyle::active_style);
		about_workspace_part->init_button_group(EGUIStyle::active_style, BrickStyleID::NONE, bgroup_with_slider);
		about_workspace_part->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_dynamic_autosize);
		about_whole_group->add_caption_by_localistation_key("window_header_info");

		EButtonGroup*
			used_resoures_part = about_workspace_part->add_group(new EButtonGroup(new ERegionGabarite(50.0f, 200.0f)));
		used_resoures_part->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DEFAULT, bgroup_with_slider);
		used_resoures_part->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_dynamic_autosize);
		used_resoures_part->button_size_x_override = 200.0f;
		used_resoures_part->group_have_button_lines = true;

		EButtonGroup*
			contact_info_part = about_workspace_part->add_group(new EButtonGroup(new ERegionGabarite(50.0f, 200.0f)));
		contact_info_part->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DEFAULT, bgroup_with_slider);
		contact_info_part->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_dynamic_autosize);
		contact_info_part->button_size_x_override = 200.0f;
		contact_info_part->group_have_button_lines = true;

		/*---------------	VK	----------------------*/
		{
			EntityButtonOpenURL*
				contact_VK = new EntityButtonOpenURL();
			contact_VK->stored_url = "https://vk.com/pathtoexalted";

			contact_info_part->add_button_to_working_group(contact_VK);

			ELocalisationText
				ltext;
			ltext.localisations[NSW_localisation_EN] = "VK\nvk.com/pathtoexalted";
			ltext.localisations[NSW_localisation_RU] = "VK\nvk.com/pathtoexalted";

			contact_VK->make_as_default_button_with_icon_and_text
			(
				new ERegionGabarite(200.0f, 44.0f),
				contact_info_part,
				&EDataActionCollection::action_open_url,
				NS_EGraphicCore::load_from_textures_folder("buttons/button_VK"),
				ltext.localisations[ELocalisationText::active_localisation]
			);
			contact_VK->main_text_area->localisation_text = ltext;
			contact_VK->can_be_stretched = true;
		}
		/*-----------------------------------------------------------------*/


		/*---------------	BMFont	----------------------*/
		{
			EntityButtonOpenURL*
				used_BMFont = new EntityButtonOpenURL();
			used_BMFont->stored_url = "www.angelcode.com";

			used_resoures_part->add_button_to_working_group(used_BMFont);

			ELocalisationText
				ltext;
			ltext.localisations[NSW_localisation_EN] = "BMFont\nwww.angelcode.com";
			ltext.localisations[NSW_localisation_RU] = "BMFont\nwww.angelcode.com";

			used_BMFont->make_as_default_button_with_icon_and_text
			(
				new ERegionGabarite(200.0f, 44.0f),
				used_resoures_part,
				&EDataActionCollection::action_open_url,
				NS_EGraphicCore::load_from_textures_folder("buttons/button_BMFont"),
				ltext.localisations[ELocalisationText::active_localisation]
			);
			used_BMFont->main_text_area->localisation_text = ltext;
			used_BMFont->can_be_stretched = true;
		}
		/*-----------------------------------------------------------------*/




		/*---------------	GLFW	----------------------*/
		{
			EntityButtonOpenURL*
				used_GLFW = new EntityButtonOpenURL();
			used_GLFW->stored_url = "www.glfw.org";

			used_resoures_part->add_button_to_working_group(used_GLFW);

			ELocalisationText
				ltext;
			ltext.localisations[NSW_localisation_EN] = "GLFW\nwww.glfw.org";
			ltext.localisations[NSW_localisation_RU] = "GLFW\nwww.glfw.org";

			used_GLFW->make_as_default_button_with_icon_and_text
			(
				new ERegionGabarite(200.0f, 44.0f),
				used_resoures_part,
				&EDataActionCollection::action_open_url,
				NS_EGraphicCore::load_from_textures_folder("buttons/button_GLFW"),
				ltext.localisations[ELocalisationText::active_localisation]
			);
			used_GLFW->main_text_area->localisation_text = ltext;
			used_GLFW->can_be_stretched = true;
		}
		/*-----------------------------------------------------------------*/



		/*---------------	IRRKlang	----------------------*/
		{
			EntityButtonOpenURL*
				used_IRRKLang = new EntityButtonOpenURL();
			used_IRRKLang->stored_url = "www.ambiera.com";

			used_resoures_part->add_button_to_working_group(used_IRRKLang);

			ELocalisationText
				ltext;
			ltext.localisations[NSW_localisation_EN] = "IRRKlang\nwww.ambiera.com";
			ltext.localisations[NSW_localisation_RU] = "IRRKlang\nwww.ambiera.com";

			used_IRRKLang->make_as_default_button_with_icon_and_text
			(
				new ERegionGabarite(200.0f, 44.0f),
				used_resoures_part,
				&EDataActionCollection::action_open_url,
				NS_EGraphicCore::load_from_textures_folder("buttons/button_IRRKlang"),
				ltext.localisations[ELocalisationText::active_localisation]
			);
			used_IRRKLang->main_text_area->localisation_text = ltext;
			used_IRRKLang->can_be_stretched = true;
		}
		/*-----------------------------------------------------------------*/



		/*---------------	assimp	----------------------*/
		{
			EntityButtonOpenURL*
				used_assimp = new EntityButtonOpenURL();
			used_assimp->stored_url = "www.assimp.org";

			used_resoures_part->add_button_to_working_group(used_assimp);

			ELocalisationText
				ltext;
			ltext.localisations[NSW_localisation_EN] = "assimp\nwww.assimp.org";
			ltext.localisations[NSW_localisation_RU] = "assimp\nwww.assimp.org";

			used_assimp->make_as_default_button_with_icon_and_text
			(
				new ERegionGabarite(200.0f, 44.0f),
				used_resoures_part,
				&EDataActionCollection::action_open_url,
				NS_EGraphicCore::load_from_textures_folder("buttons/button_assimp"),
				ltext.localisations[ELocalisationText::active_localisation]
			);
			used_assimp->main_text_area->localisation_text = ltext;
			used_assimp->can_be_stretched = true;

		}
		/*-----------------------------------------------------------------*/



		/*---------------	stb_image	----------------------*/
		{
			EntityButtonOpenURL*
				used_stb_image = new EntityButtonOpenURL();
			used_stb_image->stored_url = "http://nothings.org/";

			used_resoures_part->add_button_to_working_group(used_stb_image);

			ELocalisationText
				ltext;
			ltext.localisations[NSW_localisation_EN] = "stb_image\nnothings.org";
			ltext.localisations[NSW_localisation_RU] = "stb_image\nnothings.org";

			used_stb_image->make_as_default_button_with_icon_and_text
			(
				new ERegionGabarite(200.0f, 44.0f),
				used_resoures_part,
				&EDataActionCollection::action_open_url,
				NS_EGraphicCore::load_from_textures_folder("buttons/button_stb_image"),
				ltext.localisations[ELocalisationText::active_localisation]
			);
			used_stb_image->main_text_area->localisation_text = ltext;
			used_stb_image->can_be_stretched = true;
		}
		/*-----------------------------------------------------------------*/



		/*---------------	TEXT AREA(used resource)	----------------------*/
		{
			EClickableArea*
				clickable_area_for_group = EClickableArea::create_default_clickable_region(used_resoures_part->region_gabarite, used_resoures_part);
			used_resoures_part->clickable_area_list.push_back(clickable_area_for_group);

			ELocalisationText
				ltext;

			ltext.localisations[NSW_localisation_EN] = "Used resources";
			ltext.localisations[NSW_localisation_RU] = "Использованные ресурсы";

			ETextArea*
				text_area_for_group = ETextArea::create_centered_to_up_text_area(clickable_area_for_group, EFont::font_list[0], ltext.localisations[ELocalisationText::active_localisation]);
			text_area_for_group->localisation_text = ltext;
			text_area_for_group->can_be_edited = false;
			clickable_area_for_group->text_area = text_area_for_group;
		}
		/*-----------------------------------------------------------------*/

		/*---------------	TEXT AREA (contacts)	----------------------*/
		{
			EClickableArea*
				clickable_area_for_group = EClickableArea::create_default_clickable_region(contact_info_part->region_gabarite, contact_info_part);
			contact_info_part->clickable_area_list.push_back(clickable_area_for_group);

			ELocalisationText
				ltext;

			ltext.localisations[NSW_localisation_EN] = "Contact with us";
			ltext.localisations[NSW_localisation_RU] = "Связаться с нами";

			ETextArea*
				text_area_for_group = ETextArea::create_centered_to_up_text_area(clickable_area_for_group, EFont::font_list[0], ltext.localisations[ELocalisationText::active_localisation]);
			text_area_for_group->localisation_text = ltext;
			text_area_for_group->can_be_edited = false;
			clickable_area_for_group->text_area = text_area_for_group;
		}
		/*-----------------------------------------------------------------*/

		about_whole_group->move_to_foreground_and_center();


		//EButtonGroup::refresh_button_group(about_whole_group);
		about_whole_group->need_refresh = true;

		button_group_list.push_back(about_whole_group);

	}
}

void EWindowMain::register_world_parameters_group()
{
	EButtonGroup*
	main_button_group = nullptr;

	EButtonGroup*
	jc_button_group = nullptr;

	EntityButton*
	jc_button = nullptr;

	if (true)
	{
		///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		/////		world parameter		///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

		main_button_group = new EButtonGroup(new ERegionGabarite(512, 700.0f));
		main_button_group->init_as_root_group(this);
		main_button_group->child_align_mode = ChildAlignMode::ALIGN_VERTICAL;

		main_button_group->button_group_is_active = false;
		world_parameters = main_button_group;

		EButtonGroup*
			world_parameters_workspace_part = main_button_group->add_close_group_and_return_workspace_group(new ERegionGabarite(1.0f, 20.0f), EGUIStyle::active_style);
		main_button_group->add_caption_by_localistation_key("window_header_world_parameters");
		//**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**//
		//*----------------------------		SUN SECTION		-------------------------------------------------------*//
		//**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**//
		jc_button_group = world_parameters_workspace_part->add_group
		(EButtonGroup::create_default_button_group(new ERegionGabarite(890.0f, 120.0f), EGUIStyle::active_style));
		jc_button_group->stretch_x_by_parent_size = true;
		jc_button_group->dynamic_size_y = false;



		// // // // // // //// // // // // // //// // // // // // //
		jc_button = EntityButton::create_horizontal_named_slider
		(

			new ERegionGabarite(300.0f, 38.0f),
			jc_button_group,
			EFont::font_list[0],
			EGUIStyle::active_style,
			ELocalisationText::get_localisation_by_key("Plastic/Metal_slider")
		);
		jc_button->can_be_stretched = true;
		static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(jc_button)->data_container)->pointer_to_value = &NS_EGraphicCore::plastic_or_metal_multiplier;
		static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(jc_button)->data_container)->mid_value = 1.0f;
		static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(jc_button)->data_container)->max_value = 10.0f;
		jc_button_group->add_button_to_working_group(jc_button);
		// // // // // // //// // // // // // //// // // // // // //

		// // // // // // //// // // // // // //// // // // // // //
		jc_button = EntityButton::create_horizontal_named_slider
		(

			new ERegionGabarite(300.0f, 38.0f),
			jc_button_group,
			EFont::font_list[0],
			EGUIStyle::active_style,
			ELocalisationText::get_localisation_by_key("matte/gloss_multiplier")
		);
		jc_button->can_be_stretched = true;
		static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(jc_button)->data_container)->pointer_to_value = &NS_EGraphicCore::global_gloss_multiplier;
		static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(jc_button)->data_container)->mid_value = 1.0f;
		static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(jc_button)->data_container)->max_value = 10.0f;
		jc_button_group->add_button_to_working_group(jc_button);
		// // // // // // //// // // // // // //// // // // // // //






		// // // // // // //// // // // // // //// // // // // // //
		jc_button = EntityButton::create_horizontal_named_slider
		(

			new ERegionGabarite(300.0f, 38.0f),
			jc_button_group,
			EFont::font_list[0],
			EGUIStyle::active_style,
			ELocalisationText::get_localisation_by_key("normal_slider_value")
		);
		jc_button->can_be_stretched = true;
		static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(jc_button)->data_container)->pointer_to_value = &NS_EGraphicCore::global_normal_multiplier;
		static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(jc_button)->data_container)->mid_value = 1.0f;
		static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(jc_button)->data_container)->max_value = 10.0f;
		jc_button_group->add_button_to_working_group(jc_button);
		// // // // // // //// // // // // // //// // // // // // //






		//**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**//
		//*----------------------------		SUN SECTION		-------------------------------------------------------*//
		//**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**//
		EButtonGroup* button_group_sun_main = world_parameters_workspace_part->add_group
		(EButtonGroup::create_default_button_group(new ERegionGabarite(890.0f, 256.0f), EGUIStyle::active_style));
		button_group_sun_main->child_align_mode = ChildAlignMode::ALIGN_HORIZONTAL;
		button_group_sun_main->stretch_x_by_parent_size = true;
		button_group_sun_main->dynamic_size_y = false;
		//**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**//

		//**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**//
		jc_button_group = button_group_sun_main->add_group(EButtonGroup::create_default_button_group(new ERegionGabarite(256.0f, 256.0f), EGUIStyle::active_style));
		jc_button_group->child_align_mode = ChildAlignMode::ALIGN_HORIZONTAL;
		jc_button_group->stretch_x_by_parent_size = false;
		jc_button_group->dynamic_size_y = true;
		//**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**//

		// // // // // // //
		jc_button = EntityButton::create_default_crosshair_slider
		(
			new ERegionGabarite(255.0f, 255.0f),
			jc_button_group,
			&NS_EGraphicCore::sun_x,
			&NS_EGraphicCore::sun_y,
			"sun_position"
		);
		jc_button->can_be_stretched = false;

		EDataContainer_CrosshairSlider* crosshair_data = (EDataContainer_CrosshairSlider*)EntityButton::get_last_custom_data(jc_button)->data_container;
		crosshair_data->min_x = 0.0f;
		crosshair_data->max_x = 1.0f;

		crosshair_data->min_y = 0.0f;
		crosshair_data->max_y = 1.0f;
		jc_button_group->add_button_to_working_group(jc_button);
		// // // // // // //

		//**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**//
		jc_button_group = button_group_sun_main->add_group(EButtonGroup::create_default_button_group(new ERegionGabarite(160.0f, 160.0f), EGUIStyle::active_style));
		jc_button_group->child_align_mode = ChildAlignMode::ALIGN_VERTICAL;
		jc_button_group->stretch_x_by_parent_size = true;
		jc_button_group->dynamic_size_y = true;
		//**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**//

		// // // // // // // //
		jc_button = EntityButton::create_default_radial_button
		(
			new ERegionGabarite(170.0f, 38.0f),
			jc_button_group,
			"Размер:"
		);
		jc_button->can_be_stretched = true;

		((EDataContainerRadialButton*)EntityButton::get_last_custom_data(jc_button)->data_container)->value_pointer = &NS_EGraphicCore::sun_size;
		((EDataContainerRadialButton*)EntityButton::get_last_custom_data(jc_button)->data_container)->max_value = 1.0f;
		jc_button_group->add_button_to_working_group(jc_button);
		// // // // // // // //

		// // // // // // // //
		jc_button = EntityButton::create_default_radial_button
		(
			new ERegionGabarite(170.0f, 38.0f),
			jc_button_group,
			"Затухание:"
		);
		jc_button->can_be_stretched = true;

		((EDataContainerRadialButton*)EntityButton::get_last_custom_data(jc_button)->data_container)->value_pointer = &NS_EGraphicCore::sun_blur;
		((EDataContainerRadialButton*)EntityButton::get_last_custom_data(jc_button)->data_container)->max_value = 1.0f;
		jc_button_group->add_button_to_working_group(jc_button);
		// // // // // // // //
		// 
		// // // // // // // //
		jc_button = EntityButton::create_default_radial_button
		(
			new ERegionGabarite(170.0f, 38.0f),
			jc_button_group,
			"Яркость:"
		);
		jc_button->can_be_stretched = true;

		((EDataContainerRadialButton*)EntityButton::get_last_custom_data(jc_button)->data_container)->value_pointer = &NS_EGraphicCore::sun_bright;
		((EDataContainerRadialButton*)EntityButton::get_last_custom_data(jc_button)->data_container)->max_value = 100.0f;
		jc_button_group->add_button_to_working_group(jc_button);
		// // // // // // // //

		// // // // // // // //
		jc_button = EntityButton::create_default_radial_button
		(
			new ERegionGabarite(170.0f, 38.0f),
			jc_button_group,
			"Степень:"
		);
		jc_button->can_be_stretched = true;

		((EDataContainerRadialButton*)EntityButton::get_last_custom_data(jc_button)->data_container)->value_pointer = &NS_EGraphicCore::sun_exp;
		((EDataContainerRadialButton*)EntityButton::get_last_custom_data(jc_button)->data_container)->max_value = 10.0f;
		jc_button_group->add_button_to_working_group(jc_button);
		// // // // // // // //

		//MATTE DECAY <EntityButton>
		////////////////////////////////////////////////////////////////////////////////////////////////
		jc_button = EntityButton::create_default_radial_button
		(
			new ERegionGabarite(170.0f, 38.0f),
			jc_button_group,
			"Матовое затухание:"
		);
		jc_button->can_be_stretched = true;

		((EDataContainerRadialButton*)EntityButton::get_last_custom_data(jc_button)->data_container)->value_pointer = &NS_EGraphicCore::sun_flat_decay;
		((EDataContainerRadialButton*)EntityButton::get_last_custom_data(jc_button)->data_container)->max_value = 1.0f;
		jc_button_group->add_button_to_working_group(jc_button);
		////////////////////////////////////////////////////////////////////////////////////////////////




		//SUN COLOR <EntityButtonColorButton>
		////////////////////////////////////////////////////////////////////////////////////////////////
		ELocalisationText l_text;
		l_text.localisations[NSW_localisation_EN] = "Sun color";
		l_text.localisations[NSW_localisation_RU] = "Цвет солнца";

		EntityButtonColorButton*
			sun_color_button = new EntityButtonColorButton();

		sun_color_button->make_as_named_color_button
		(
			new ERegionGabarite(170.0f, 38.0f),
			jc_button_group,
			EFont::font_list[0],
			EGUIStyle::active_style,
			l_text,
			nullptr,
			&NS_EGraphicCore::sun_color,
			ColorButtonMode::CBM_OPEN_WINDOW
		);

		sun_color_button->can_be_stretched = true;

		jc_button_group->add_button_to_working_group(sun_color_button);
		////////////////////////////////////////////////////////////////////////////////////////////////


		//**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**//
		//*----------------------------		SKYDOME SECTION		-------------------------------------------------------*//
		//**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**//
		jc_button_group = world_parameters_workspace_part->add_group
		(EButtonGroup::create_default_button_group(new ERegionGabarite(890.0f, 120.0f), EGUIStyle::active_style));
		jc_button_group->stretch_x_by_parent_size = true;
		jc_button_group->dynamic_size_y = false;
		//**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**//

		// // // // // // //
		jc_button = EntityButton::create_default_radial_button
		(
			new ERegionGabarite(170.0f, 38.0f),
			jc_button_group,
			"Уровень грунта:"
		);
		jc_button->can_be_stretched = true;

		((EDataContainerRadialButton*)EntityButton::get_last_custom_data(jc_button)->data_container)->value_pointer = &NS_EGraphicCore::ground_level;
		((EDataContainerRadialButton*)EntityButton::get_last_custom_data(jc_button)->data_container)->max_value = 1.0f;
		jc_button_group->add_button_to_working_group(jc_button);
		// // // // // // //

		// // // // // // //
		jc_button = EntityButton::create_default_radial_button
		(
			new ERegionGabarite(170.0f, 38.0f),
			jc_button_group,
			"Скорость смещения:"
		);
		jc_button->can_be_stretched = true;

		((EDataContainerRadialButton*)EntityButton::get_last_custom_data(jc_button)->data_container)->value_pointer = &NS_EGraphicCore::move_multiplier;
		((EDataContainerRadialButton*)EntityButton::get_last_custom_data(jc_button)->data_container)->max_value = 10.0f;
		jc_button_group->add_button_to_working_group(jc_button);
		// // // // // // //



		// // // // // // //// // // // // // //// // // // // // //
		jc_button = EntityButton::create_horizontal_named_slider
		(
			new ERegionGabarite(170.0f, 38.0f),
			jc_button_group,
			EFont::font_list[0],
			EGUIStyle::active_style,
			ELocalisationText::get_localisation_by_key("sky_light_slider")
		);
		jc_button->can_be_stretched = true;

		static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(jc_button)->data_container)->pointer_to_value = &NS_EGraphicCore::global_free_sky_light_multiplier;
		static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(jc_button)->data_container)->mid_value = 1.0f;
		static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(jc_button)->data_container)->max_value = 10.0f;
		//EntityButton::get_last_custom_data(jc_button)->actions_on_update.push_back(&EDataActionCollection::action_force_resize_callback);
		jc_button_group->add_button_to_working_group(jc_button);
		// // // // // // //// // // // // // //// // // // // // //

		// // // // // // //// // // // // // //// // // // // // //
		jc_button = EntityButton::create_horizontal_named_slider
		(
			new ERegionGabarite(170.0f, 38.0f),
			jc_button_group,
			EFont::font_list[0],
			EGUIStyle::active_style,
			ELocalisationText::get_localisation_by_key("sun_light_slider")
		);
		jc_button->can_be_stretched = true;

		static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(jc_button)->data_container)->pointer_to_value = &NS_EGraphicCore::global_free_sun_light_multiplier;
		static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(jc_button)->data_container)->mid_value = 1.0f;
		static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(jc_button)->data_container)->max_value = 10.0f;
		//EntityButton::get_last_custom_data(jc_button)->actions_on_update.push_back(&EDataActionCollection::action_force_resize_callback);
		jc_button_group->add_button_to_working_group(jc_button);
		// // // // // // //// // // // // // //// // // // // // //



		// // // // // // //// // // // // // //// // // // // // //
		jc_button = EntityButton::create_horizontal_named_slider
		(
			new ERegionGabarite(170.0f, 38.0f),
			jc_button_group,
			EFont::font_list[0],
			EGUIStyle::active_style,
			ELocalisationText::get_localisation_by_key("reflection_value_slider")
		);
		jc_button->can_be_stretched = true;

		static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(jc_button)->data_container)->pointer_to_value = &NS_EGraphicCore::global_reflection_multiplier;
		static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(jc_button)->data_container)->mid_value = 1.0f;
		static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(jc_button)->data_container)->max_value = 10.0f;
		//EntityButton::get_last_custom_data(jc_button)->actions_on_update.push_back(&EDataActionCollection::action_force_resize_callback);
		jc_button_group->add_button_to_working_group(jc_button);
		// // // // // // //// // // // // // //// // // // // // //


		//**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**//
		//*----------------------------		INTERFACE SECTION		-----------------------------------------------*//
		//**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**//
		jc_button_group = world_parameters_workspace_part->add_group
		(EButtonGroup::create_default_button_group(new ERegionGabarite(890.0f, 60.0f), EGUIStyle::active_style));
		jc_button_group->stretch_x_by_parent_size = true;
		jc_button_group->dynamic_size_y = false;
		//**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**////**//**//
		// // // // // // //// // // // // // //// // // // // // //
		jc_button = EntityButton::create_horizontal_named_slider
		(

			new ERegionGabarite(170.0f, 38.0f),
			jc_button_group,
			EFont::font_list[0],
			EGUIStyle::active_style,
			ELocalisationText::get_localisation_by_key("zoom_slider")
		);
		jc_button->can_be_stretched = true;

		static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(jc_button)->data_container)->pointer_to_value = &NS_EGraphicCore::stored_zoom;
		static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(jc_button)->data_container)->max_value = 2.0f;
		static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(jc_button)->data_container)->force_shift = true;
		EntityButton::get_last_custom_data(jc_button)->actions_on_update.push_back(&EDataActionCollection::action_force_resize_callback);
		jc_button_group->add_button_to_working_group(jc_button);
		// // // // // // //// // // // // // //// // // // // // //



		// // // // // // //// // // // // // //// // // // // // //
		//TEST
		jc_button = new EntityButtonForFilterBlock();
		jc_button->make_default_bool_switcher_button
		(
			new ERegionGabarite(22.0f, 22.0f),
			jc_button_group,
			EDataActionCollection::action_switch_boolean_value,
			NS_DefaultGabarites::texture_bool_switcher_activated_box,
			NS_DefaultGabarites::texture_bool_switcher_deactivated_box
		);

		jc_button_group->add_button_to_working_group(jc_button);


		button_group_list.push_back(main_button_group);
		//EButtonGroup::refresh_button_group(main_button_group);
		main_button_group->need_refresh = true;
	}
}

void EWindowMain::register_add_data_entity_group()
{
	EntityButton*
	jc_button = nullptr;
	//DATA ENTITY
	if (true)
	{
		EButtonGroupDataEntity*
			data_entity_main_group = new EButtonGroupDataEntity(new ERegionGabarite(900.0f, 100.0f, 0.0f, 1500.0f, 600.0f));
		data_entity_main_group->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DARKEN, bgroup_without_slider);

		data_entity_main_group->parent_window = this;
		data_entity_main_group->root_group = data_entity_main_group;
		data_entity_main_group->child_align_mode = ChildAlignMode::ALIGN_VERTICAL;
		EWindowMain::data_entity_filter = data_entity_main_group;



		EDataContainer_Group_DataEntitiesSearch* jc_data_container_for_search_group = new EDataContainer_Group_DataEntitiesSearch();
		data_entity_main_group->data_container = jc_data_container_for_search_group;
		data_entity_main_group->button_group_is_active = false;



		////////////////////////////////////////////////////////
		DataEntityTagFilter
			data_entity_filter;
		data_entity_filter.target_tag.set_ID_by_string("data type");
		data_entity_filter.add_new_suitable_value("Game item");

		EFilterRule*
			jc_filter_rule = new EFilterRule();
		jc_filter_rule->required_tag_list.push_back(data_entity_filter);

		jc_data_container_for_search_group->target_rule = new EFilterRule();
		////////////////////////////////////////////////////////


		EButtonGroup*
			workspace_part = data_entity_main_group->add_close_group_and_return_workspace_group(new ERegionGabarite(200.0f, 20.0f), EGUIStyle::active_style);
		data_entity_main_group->add_help_button(NS_EGraphicCore::load_from_textures_folder("buttons/button_info"), "description_help_info_data_entity");
		data_entity_main_group->add_caption_by_localistation_key("window_header_data_entity");

		///		DATA ENTITY LIST	///
		EButtonGroup*
			workspace_child_A_for_items = workspace_part->add_group
			(EButtonGroup::create_default_button_group(new ERegionGabarite(890.0f, 480.0f), EGUIStyle::active_style));
		workspace_child_A_for_items->child_align_mode = ChildAlignMode::ALIGN_HORIZONTAL;
		workspace_child_A_for_items->stretch_x_by_parent_size = true;
		workspace_child_A_for_items->dynamic_size_y = true;
		workspace_child_A_for_items->button_align_type = ButtonAlignType::BUTTON_ALIGN_MID;








		///		LEFT SIDE FOR BUTTONS
		EButtonGroup* left_side_for_data_entity_buttons = workspace_child_A_for_items->add_group
		(
			EButtonGroup::create_default_button_group
			(
				new ERegionGabarite(250.0f, 480.0f),
				EGUIStyle::active_style
			)
		)->set_parameters
		(
			ChildAlignMode::ALIGN_HORIZONTAL,
			NSW_dynamic_autosize,
			NSW_dynamic_autosize
		);

		left_side_for_data_entity_buttons->button_size_x_override = 350.0f;
		left_side_for_data_entity_buttons->group_have_button_lines = true;

		data_entity_main_group->main_left_side = left_side_for_data_entity_buttons;






		///		RIGHT SIDE FOR FILTERS
		EButtonGroup* right_side_for_filter_rule_buttons = workspace_child_A_for_items->add_group
		(
			EButtonGroup::create_default_button_group
			(
				new ERegionGabarite(250.0f, 480.0f),
				EGUIStyle::active_style
			)
		)->set_parameters
		(
			ChildAlignMode::ALIGN_VERTICAL,
			NSW_static_autosize,
			NSW_dynamic_autosize
		);

		data_entity_main_group->right_side_for_filters = right_side_for_filter_rule_buttons;
		/////////////////////////////////////////////////////////////////////////////////////////////////////////

		///		RIGHT SIDE FOR CONFIGURERS
		EButtonGroup*
			right_side_for_configure = workspace_child_A_for_items->add_group
			(
				EButtonGroup::create_default_button_group
				(
					new ERegionGabarite(250.0f, 480.0f),
					EGUIStyle::active_style
				)
			)->set_parameters
			(
				ChildAlignMode::ALIGN_VERTICAL,
				NSW_static_autosize,
				NSW_dynamic_autosize
			);

		data_entity_main_group->right_side_for_configure = right_side_for_configure;
		/////////////////////////////////////////////////////////////////////////////////////////////////////////


		//right_side_for_filter_rule_buttons->button_size_x_override = 100.0f;

		//right_side_for_filter_rule_buttons->button_size_x_override = 150.0f;


		//right_side_for_filter_rule_buttons->can

		jc_data_container_for_search_group->pointer_to_group_with_data_entities = left_side_for_data_entity_buttons;
		jc_data_container_for_search_group->pointer_to_group_with_filter_rules_list = right_side_for_filter_rule_buttons;

		for (int i = 0; i < EFilterRule::registered_filter_rules_for_list.size(); i++)
		{
			EntityButtonFilterRule*
				filter_button = new EntityButtonFilterRule();

			filter_button->make_as_default_button_with_icon_and_text
			(
				new ERegionGabarite(200.0f, 40.0f),
				right_side_for_filter_rule_buttons,
				(!EFilterRule::registered_filter_rules_for_list[i]->is_folder) ? (&EDataActionCollection::action_select_this_filter_variant) : (&EDataActionCollection::action_switch_folder_for_data_entity_filter),
				EFilterRule::registered_filter_rules_for_list[i]->icon_texture,
				EFilterRule::registered_filter_rules_for_list[i]->localisation_text->localisations[ELocalisationText::active_localisation]
			);

			filter_button->folder_named_id = EFilterRule::registered_filter_rules_for_list[i]->named_id;
			filter_button->is_folder = EFilterRule::registered_filter_rules_for_list[i]->is_folder;

			filter_button->can_be_stretched = true;

			/*if ((i > 0) && (EFilterRule::registered_filter_rules_for_list[i]->category_id != EFilterRule::registered_filter_rules_for_list[i - 1]->category_id))
			{
			filter_button->force_field_bottom = 32.0f;
			}*/

			//filter_button->

			filter_button->main_text_area->localisation_text = *EFilterRule::registered_filter_rules_for_list[i]->localisation_text;
			filter_button->main_text_area->offset_by_gabarite_size_x = 0.0f;
			filter_button->main_text_area->offset_by_text_size_x = 0.0f;
			filter_button->target_filter_rule = EFilterRule::registered_filter_rules_for_list[i];
			filter_button->target_data_container = jc_data_container_for_search_group;

			right_side_for_filter_rule_buttons->add_button_to_working_group(filter_button);
		}


		//push buttons to folder
		for (EntityButton* but : right_side_for_filter_rule_buttons->workspace_button_list)
		{
			EntityButtonFilterRule*
				filter_rule_button = static_cast<EntityButtonFilterRule*>(but);

			std::string target_named_id = "";

			if (filter_rule_button->is_folder)
			{
				target_named_id = filter_rule_button->folder_named_id;

				for (EntityButton* child_but : right_side_for_filter_rule_buttons->workspace_button_list)
				{
					EntityButtonFilterRule*
						child_filter_rule_button = static_cast<EntityButtonFilterRule*>(child_but);

					if ((!child_filter_rule_button->is_folder) && (filter_rule_button->folder_named_id == child_filter_rule_button->folder_named_id))
					{
						filter_rule_button->child_button_list.push_back(child_filter_rule_button);

						child_filter_rule_button->parent_folder = filter_rule_button;
						child_filter_rule_button->hidden_by_folder = true;
						child_filter_rule_button->force_field_left = 8.0f;
						child_filter_rule_button->button_gabarite->size_x -= 8.0f;
					}
				}
			}
		}

		if (!right_side_for_filter_rule_buttons->workspace_button_list.empty())
		{
			right_side_for_filter_rule_buttons->selected_button = right_side_for_filter_rule_buttons->workspace_button_list.front();
		}

		////////////////////////////////////		DATA ENTITY SEARCH		////////////////////////////////////
		EButtonGroup*
			workspace_child_B_for_control = workspace_part->add_group
			(EButtonGroup::create_default_button_group(new ERegionGabarite(800.0f, 50.0f), EGUIStyle::active_style));
		workspace_child_B_for_control->stretch_x_by_parent_size = true;
		workspace_child_B_for_control->dynamic_size_y = false;



		////////////////////////////////////
		EntityButtonClearAttachedTextArea*
			clear_text_button = new EntityButtonClearAttachedTextArea();
		workspace_child_B_for_control->add_button_to_working_group(clear_text_button);
		clear_text_button->do_not_generate_bg = true;
		clear_text_button->make_as_default_button_with_icon
		(
			new ERegionGabarite(25.0f, 25.0f),
			workspace_child_B_for_control,
			&EDataActionCollection::action_clear_attached_text_area,
			NS_EGraphicCore::load_from_textures_folder("button_close")
		);
		////////////////////////////////////


		//	INPUT FIELD (FILTER DATA ENTITY BY NAME)
		{
			EntityButton*
				filter_text_button = new EntityButton();
			filter_text_button->make_default_button_with_edible_text
			(
				new ERegionGabarite(600.0f, 25.0f),
				workspace_child_B_for_control,
				nullptr,
				""
			);
			//jc_button->can_be_stretched = true;
			data_entity_main_group->main_input_field = filter_text_button;

			jc_data_container_for_search_group->filter_text_area = filter_text_button->main_text_area;

			filter_text_button->main_text_area->gray_text = ELocalisationText();
			filter_text_button->main_text_area->gray_text.localisations[NSW_localisation_EN] = "Type search text...";
			filter_text_button->main_text_area->gray_text.localisations[NSW_localisation_RU] = "Напишите текст поиска...";

			filter_text_button->can_be_stretched = true;

			filter_text_button->main_text_area->action_on_change_text.push_back(&EDataActionCollection::action_type_search_data_entity_text);
			filter_text_button->add_default_description_by_key("description_data_entity_search");
			jc_data_container_for_search_group->pointer_to_search_bar = filter_text_button;

			workspace_child_B_for_control->add_button_to_working_group(filter_text_button);

			clear_text_button->attached_text_area = filter_text_button->main_text_area;
		}
		////////////////////////////////////




















		button_group_list.push_back(data_entity_main_group);

		///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	
		{
			jc_button = new EntityButton();
			jc_button->make_default_button_with_unedible_text
			(
				new ERegionGabarite(256.0f, 25.0f),
				workspace_child_B_for_control,
				&EDataActionCollection::action_add_text_as_item,
				ELocalisationText::get_localisation_by_key("button_add_this_text_as_item")
			);

			jc_button->add_default_description_by_key("description_add_search_text_as_item");
			data_entity_main_group->add_as_item_button = jc_button;
			jc_data_container_for_search_group->pointer_to_add_as_item_button = jc_button;
			workspace_child_B_for_control->add_button_to_working_group(jc_button);
		}
		///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	

		///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	
		jc_button = new EntityButton();
		jc_button->make_default_button_with_unedible_text
		(
			new ERegionGabarite(256.0f, 25.0f),
			workspace_child_B_for_control,
			&EDataActionCollection::action_add_all_entity_buttons_to_filter_block,
			ELocalisationText::get_localisation_by_key("button_add_all_these_items")
		);

		jc_button->add_default_description_by_key("description_add_all_items");

		workspace_child_B_for_control->add_button_to_working_group(jc_button);
		///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	///	

		//EButtonGroup::refresh_button_group(data_entity_main_group);
		data_entity_main_group->need_refresh = true;
	}
}

void EWindowMain::register_create_new_loot_filter_group()
{
	if (true)
	{
		EButtonGroupNewLootFilter*
			main_loot_filter_group = new EButtonGroupNewLootFilter(new ERegionGabarite(100.0f, 100.0f, 350.0f, 80.0f));
		main_loot_filter_group->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DARKEN, bgroup_with_slider);
		main_loot_filter_group->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_dynamic_autosize);
		main_loot_filter_group->root_group = main_loot_filter_group;
		main_loot_filter_group->button_group_is_active = false;
		main_loot_filter_group->parent_window = this;

		main_loot_filter_group->can_resize_to_workspace_size_x = true;
		main_loot_filter_group->can_resize_to_workspace_size_y = true;

		EWindowMain::create_new_loot_filter_group = main_loot_filter_group;
		EButtonGroup*
			new_loot_filter_workspace_group = main_loot_filter_group->add_close_group_and_return_workspace_group(new ERegionGabarite(100, 20.0f), EGUIStyle::active_style);
		new_loot_filter_workspace_group->set_parameters(ChildAlignMode::ALIGN_HORIZONTAL, NSW_dynamic_autosize, NSW_dynamic_autosize);
		new_loot_filter_workspace_group->can_resize_to_workspace_size_x = true;
		new_loot_filter_workspace_group->can_resize_to_workspace_size_y = true;
		main_loot_filter_group->add_caption_by_localistation_key("window_header_create_new_loot_filter");

		////////		NEW LOOT-FILTER NAME		////////////////
		EntityButton*
			button_input_field = new EntityButton();
		button_input_field->make_default_button_with_edible_text
		(
			new ERegionGabarite(240.0f, 30.0f),
			new_loot_filter_workspace_group,
			nullptr,
			""
		);
		button_input_field->can_be_stretched = true;

		ELocalisationText ltext;;
		ltext.base_name = "Type new loot filter name";
		ltext.localisations[NSW_localisation_EN] = "Type new loot filter name";
		ltext.localisations[NSW_localisation_RU] = "Напишите название лут-фильтра";

		button_input_field->main_text_area->gray_text = ltext;

		new_loot_filter_workspace_group->add_button_to_working_group(button_input_field);
		////////////////////////

		////////////////////////
		EntityButton*
			button_accept = new EntityButton();
		button_accept->make_default_button_with_unedible_text
		(
			new ERegionGabarite(50.0f, 30.0f),
			new_loot_filter_workspace_group,
			&EDataActionCollection::action_create_new_loot_filter_with_name,
			ELocalisationText::get_localisation_by_key("OK")
		);

		new_loot_filter_workspace_group->add_button_to_working_group(button_accept);
		////////////////////////

		main_loot_filter_group->input_field_button = button_input_field;

		button_group_list.push_back(main_loot_filter_group);
		//EButtonGroup::refresh_button_group(main_loot_filter_group);
		main_loot_filter_group->need_refresh = true;
	}
}

void EWindowMain::register_loot_version_configurator()
{
	{
		registered_group_loot_version_configure = new EButtonGroupVersionControlConfigure(new ERegionGabarite(700.0f, 360.0f));
		registered_group_loot_version_configure->init_as_root_group(this);
		registered_group_loot_version_configure->auto_superfocused = true;
		registered_group_loot_version_configure->button_group_is_active = false;

		registered_group_loot_version_configure->actions_on_close.push_back(&EDataActionCollection::action_on_closing_loot_versions_window);

		EButtonGroup*
			version_config_working_part = registered_group_loot_version_configure->add_close_group_and_return_workspace_group(new ERegionGabarite(20.0f, 20.0f), EGUIStyle::active_style);

		version_config_working_part->set_parameters
		(
			ChildAlignMode::ALIGN_HORIZONTAL,
			NSW_dynamic_autosize,
			NSW_dynamic_autosize
		);

		registered_group_loot_version_configure->add_caption_by_localistation_key("window_header_version_configurator");

		button_group_list.push_back(registered_group_loot_version_configure);
		registered_group_loot_version_configure->need_refresh = true;



		//	LEFT PART FOR VERSIONS	//////////////////////////////////////////////////////////////////////////////////
		EButtonGroup*
			left_part_for_filter_versions = version_config_working_part->add_group
			(
				EButtonGroup::create_default_button_group
				(
					new ERegionGabarite(250.0f, 480.0f),
					EGUIStyle::active_style
				)
			)->set_parameters
			(
				ChildAlignMode::ALIGN_HORIZONTAL,
				NSW_static_autosize,
				NSW_dynamic_autosize
			);
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////



		//	RIGHT PART FOR PATTERNS	//////////////////////////////////////////////////////////////////////////////////
		EButtonGroup*
			right_part_for_pattern = version_config_working_part->add_group
			(
				EButtonGroup::create_default_button_group
				(
					new ERegionGabarite(250.0f, 480.0f),
					EGUIStyle::active_style
				)
			)->set_parameters
			(
				ChildAlignMode::ALIGN_HORIZONTAL,
				NSW_dynamic_autosize,
				NSW_dynamic_autosize
			);
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////

		//	LOOT VERSION PATTERN: REGISTERED PATTERNS	//////////////////////////////////////////////////////////////////////////////////
		EButtonGroup*
			loot_filter_verion_pattern_list = right_part_for_pattern->add_group
			(
				EButtonGroup::create_button_group_without_bg
				(
					new ERegionGabarite(180.0f, 480.0f),
					EGUIStyle::active_style
				)
			)->set_parameters
			(
				ChildAlignMode::ALIGN_VERTICAL,
				NSW_static_autosize,
				NSW_dynamic_autosize
			);

		//loot_filter_verion_pattern_list->have_rama = true;

		//registered_group_loot_version_configure->part_with_pattern_list = loot_filter_verion_pattern_list;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////

		//	NEW PATTERN SECTION	//////////////////////////////////////////////////////////////////////////////////
		EButtonGroup*
			loot_filter_verion_pattern_list_bottom_for_new = loot_filter_verion_pattern_list->add_group
			(
				EButtonGroup::create_button_group_without_bg
				(
					new ERegionGabarite(180.0f, 28.0f),
					EGUIStyle::active_style
				)
			)->set_parameters
			(
				ChildAlignMode::ALIGN_HORIZONTAL,
				NSW_dynamic_autosize,
				NSW_static_autosize
			);

		loot_filter_verion_pattern_list_bottom_for_new->button_align_type = ButtonAlignType::BUTTON_ALIGN_MID;
		//loot_filter_verion_pattern_list->have_rama = true;

		//registered_group_loot_version_configure->part_with_pattern_list = loot_filter_verion_pattern_list;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////



		//	LOOT VERSION PATTERN: REGISTERED PATTERNS	//////////////////////////////////////////////////////////////////////////////////
		EButtonGroup*
			loot_filter_verion_pattern_list_top_for_list = loot_filter_verion_pattern_list->add_group
			(
				EButtonGroup::create_button_group_without_bg
				(
					new ERegionGabarite(180.0f, 210.0f),
					EGUIStyle::active_style
				)
			)->set_parameters
			(
				ChildAlignMode::ALIGN_HORIZONTAL,
				NSW_dynamic_autosize,
				NSW_dynamic_autosize
			);


		//loot_filter_verion_pattern_list->have_rama = true;

		registered_group_loot_version_configure->part_with_pattern_list = loot_filter_verion_pattern_list_top_for_list;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////

		//	LOOT VERSION PATTERN: CONFIGURE				//////////////////////////////////////////////////////////////////////////////////
		EButtonGroup*
			loot_filter_verion_configure = right_part_for_pattern->add_group
			(
				EButtonGroup::create_button_group_without_bg
				(
					new ERegionGabarite(250.0f, 480.0f),
					EGUIStyle::active_style
				)
			)->set_parameters
			(
				ChildAlignMode::ALIGN_HORIZONTAL,
				NSW_dynamic_autosize,
				NSW_dynamic_autosize
			);

		loot_filter_verion_configure->recursive_set_suppressed();

		registered_group_loot_version_configure->part_with_pattern_configure = loot_filter_verion_configure;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////



		for (int i = 0; i < NSW_LOOT_FILTER_MAX_VERSIONS; i++)
		{

			//NAME BUTTON
			EntityButton*
				version_button = new EntityButton();
			version_button->make_default_button_with_edible_text
			(
				new ERegionGabarite(150.0f, 22.0f),
				left_part_for_filter_versions,
				nullptr,
				""
			);
			version_button->can_be_stretched = true;
			version_button->suppressor = new bool(false);
			version_button->new_line_method = NewLineMethod::WHEN_OUT_OF_GABARITE;
			version_button->main_text_area->action_on_finalize_text.push_back(&EDataActionCollection::action_change_version_names);


			version_button->main_text_area->localisation_text = ELocalisationText::generate_localization_with_base_name(LootFilterVersionPattern::NSW_LOOT_VERSION_NAME[i]);
			version_button->main_text_area->change_text(LootFilterVersionPattern::NSW_LOOT_VERSION_NAME[i]);
			version_button->main_text_area->set_align_to_left_middle();

			//version_button->main_text_area->localisation_text.base_name = "version_" + std::to_string(i);

			version_button->main_text_area->gray_text = ELocalisationText::get_localisation_by_key("gray_text_input_loot_version_name");

			left_part_for_filter_versions->add_button_to_working_group(version_button);

			registered_group_loot_version_configure->pointer_to_version_name_button[i] = version_button;

			//BOOL SUPPRESSOR BUTTON
			EntityButton*
				version_suppressor_button = new EntityButton();

			version_suppressor_button->make_default_bool_switcher_button
			(
				new ERegionGabarite(22.0f, 22.0f),
				left_part_for_filter_versions,
				EDataActionCollection::action_switch_boolean_value,
				NS_DefaultGabarites::texture_bool_switcher_activated_box,
				NS_DefaultGabarites::texture_bool_switcher_deactivated_box,
				&(LootFilterVersionPattern::NSW_LOOT_FILTER_VERSION_ACTIVE[i])

			);
			version_suppressor_button->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_switch_loot_version_flag);

			version_button->button_suppressor = version_suppressor_button;
			version_suppressor_button->new_line_method = NewLineMethod::FORBIDDEN;
			left_part_for_filter_versions->add_button_to_working_group(version_suppressor_button);

			version_button->suppressor = &LootFilterVersionPattern::NSW_LOOT_FILTER_VERSION_ACTIVE[i];

			registered_group_loot_version_configure->pointer_to_version_name_button_switcher[i] = version_suppressor_button;



		}


		float offset_left_for_buttons = 4.0f;

		//	button remove		//////////////////////////////////////////////////////////////////////////////////////
		EntityButton*
			button_new_pattern = new EntityButton();
		button_new_pattern->make_default_button_with_unedible_text
		(
			new ERegionGabarite(150.0f, 25.0f),
			loot_filter_verion_pattern_list_bottom_for_new,
			&EDataActionCollection::action_create_new_loot_version_pattern,
			ELocalisationText::get_localisation_by_key("add_new_loot_version_pattern")
		);
		button_new_pattern->can_be_stretched = true;

		registered_group_loot_version_configure->button_new_pattern = button_new_pattern;

		loot_filter_verion_pattern_list_bottom_for_new->add_button_to_working_group(button_new_pattern);
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////




		//	button remove		//////////////////////////////////////////////////////////////////////////////////////


		for (int i = 0; i < LootFilterVersionPattern::registered_loot_filter_version_patterns.size(); i++)
		{

			LootFilterVersionPattern::PatternStruct*
				target_pattern = LootFilterVersionPattern::registered_loot_filter_version_patterns[i];


			EntityButtonLootfilterVersionPattern*
				button_list_of_pattern = new EntityButtonLootfilterVersionPattern();
			button_list_of_pattern->make_default_button_with_unedible_text
			(
				new ERegionGabarite(120.0f, 22.0f),
				loot_filter_verion_pattern_list_top_for_list,
				&EDataActionCollection::action_select_loot_filter_version_pattern,
				target_pattern->localised_name
			);

			button_list_of_pattern->main_text_area->set_color(&target_pattern->default_text_color);
			target_pattern->color_pointer = &button_list_of_pattern->main_text_area->color;

			button_list_of_pattern->attached_pattern = target_pattern;
			button_list_of_pattern->can_be_stretched = true;

			button_list_of_pattern->main_clickable_area->actions_on_right_click_list.push_back(&EDataActionCollection::action_active_text_area);
			button_list_of_pattern->main_text_area->action_on_finalize_text.push_back(&EDataActionCollection::action_change_version_pattern_name);
			button_list_of_pattern->add_default_description_by_key("description_loot_version_pattern_name");

			loot_filter_verion_pattern_list_top_for_list->add_button_to_working_group(button_list_of_pattern);


			//if (i == 3)
			//{
			//	loot_filter_verion_pattern_list->selected_button = switcher_with_text_button;
			//}
		}


		//	button remove		//////////////////////////////////////////////////////////////////////////////////////
		EntityButton*
			button_remove_pattern = new EntityButton();

		button_remove_pattern->make_default_button_with_unedible_text
		(
			new ERegionGabarite(150.0f, 22.0f),
			loot_filter_verion_configure,
			&EDataActionCollection::action_delete_selected_filter_version_pattern,
			ELocalisationText::get_localisation_by_key("remove_loot_version_pattern")
		);

		button_remove_pattern->suppressor = new bool(true);


		button_remove_pattern->main_text_area->offset_by_gabarite_size_x = 0.0f;
		button_remove_pattern->main_text_area->offset_by_text_size_x = 0.0f;

		button_remove_pattern->force_field_left = offset_left_for_buttons;
		button_remove_pattern->force_field_up = 8.0f;

		button_remove_pattern->can_be_stretched = true;
		button_remove_pattern->main_text_area->set_color(0.8f, 0.2f, 0.1f, 1.0f);
		button_remove_pattern->add_default_description_by_key("description_remove_loot_version_pattern");

		loot_filter_verion_configure->add_button_to_working_group(button_remove_pattern);

		registered_group_loot_version_configure->button_remove = button_remove_pattern;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////



		//	button switcher full ignore	//////////////////////////////////////////////////////////////////
		EntityButton*
			button_full_ignore = new EntityButton();

		button_full_ignore->make_default_bool_switcher_button_with_unedible_text
		(
			new ERegionGabarite(150.0f, 22.0f),
			loot_filter_verion_configure,
			EDataActionCollection::action_switch_boolean_value,
			NS_DefaultGabarites::texture_bool_switcher_activated_box,
			NS_DefaultGabarites::texture_bool_switcher_deactivated_box,
			ELocalisationText::get_localisation_by_key("switcher_full_ignore")
		);
		button_full_ignore->main_text_area->set_color(0.9f, 0.45f, 0.225f, 1.0f);

		button_full_ignore->main_text_area->offset_by_gabarite_size_x = 0.0f;
		button_full_ignore->main_text_area->offset_by_text_size_x = 0.0f;


		button_full_ignore->force_field_left = offset_left_for_buttons;
		button_full_ignore->force_field_bottom = 4.0f;
		button_full_ignore->force_field_up = 8.0f;

		button_full_ignore->can_be_stretched = true;

		button_full_ignore->add_default_description_by_key("description_full_ignore_mode");


		loot_filter_verion_configure->add_button_to_working_group(button_full_ignore);

		registered_group_loot_version_configure->button_full_ignore = button_full_ignore;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////



		//	button switcher disable minimap elements	//////////////////////////////////////////////////////////////////
		EntityButton*
			button_disable_minimap_elements = new EntityButton();

		button_disable_minimap_elements->make_default_bool_switcher_button_with_unedible_text
		(
			new ERegionGabarite(150.0f, 22.0f),
			loot_filter_verion_configure,
			EDataActionCollection::action_switch_boolean_value,
			NS_DefaultGabarites::texture_bool_switcher_activated_box,
			NS_DefaultGabarites::texture_bool_switcher_deactivated_box,
			ELocalisationText::get_localisation_by_key("switcher_disable_minimap_elements")
		);

		button_disable_minimap_elements->main_text_area->offset_by_gabarite_size_x = 0.0f;
		button_disable_minimap_elements->main_text_area->offset_by_text_size_x = 0.0f;


		button_disable_minimap_elements->force_field_left = offset_left_for_buttons;
		button_disable_minimap_elements->can_be_stretched = true;
		button_disable_minimap_elements->invert_suppression = true;

		button_disable_minimap_elements->add_default_description_by_key("description_disable_minimap_elements");

		loot_filter_verion_configure->add_button_to_working_group(button_disable_minimap_elements);

		registered_group_loot_version_configure->button_disable_minimap_elements = button_disable_minimap_elements;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////




		//	button switcher disable sound	//////////////////////////////////////////////////////////////////
		EntityButton*
			button_disable_sound_elements = new EntityButton();

		button_disable_sound_elements->make_default_bool_switcher_button_with_unedible_text
		(
			new ERegionGabarite(150.0f, 22.0f),
			loot_filter_verion_configure,
			EDataActionCollection::action_switch_boolean_value,
			NS_DefaultGabarites::texture_bool_switcher_activated_box,
			NS_DefaultGabarites::texture_bool_switcher_deactivated_box,
			ELocalisationText::get_localisation_by_key("switcher_disable_sound")
		);

		button_disable_sound_elements->main_text_area->offset_by_gabarite_size_x = 0.0f;
		button_disable_sound_elements->main_text_area->offset_by_text_size_x = 0.0f;

		button_disable_sound_elements->force_field_left = offset_left_for_buttons;
		button_disable_sound_elements->force_field_up = 4.0f;
		button_disable_sound_elements->can_be_stretched = true;
		button_disable_sound_elements->invert_suppression = true;

		button_disable_sound_elements->add_default_description_by_key("description_disable_sounds");

		loot_filter_verion_configure->add_button_to_working_group(button_disable_sound_elements);

		registered_group_loot_version_configure->button_disable_sound = button_disable_sound_elements;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////









		//	focus slider	//////////////////////////////////////////////////////////////////////////
		EntityButton* focus_slider = EntityButton::create_horizontal_named_slider
		(
			new ERegionGabarite(150.0f, 38.0f),
			loot_filter_verion_configure,
			EFont::font_list[0],
			EGUIStyle::active_style,
			ELocalisationText::get_localisation_by_key("verion_pattern_focus_slider")
		);

		focus_slider->main_custom_data->actions_on_update.push_back(&EDataActionCollection::action_refresh_loot_simulator_sizes);

		focus_slider->can_be_stretched = true;
		focus_slider->invert_suppression = true;
		focus_slider->force_field_left = offset_left_for_buttons;

		EDataContainer_VerticalNamedSlider*
			slider_data = static_cast<EDataContainer_VerticalNamedSlider*>(focus_slider->main_custom_data->data_container);

		slider_data->pointer_to_value = new float(1.0f);
		slider_data->mid_value = 1.0f;
		slider_data->max_value = 2.0f;





		focus_slider->add_default_description_by_key("description_focus_slider");

		loot_filter_verion_configure->add_button_to_working_group(focus_slider);

		registered_group_loot_version_configure->button_focus_slider = focus_slider;
		/////////////////////////////////////////////////////////////////////////////////////////

		if (false)
		{
			//	forcibly continue	//////////////////////////////////////////////////////////////////////////
			EntityButtonVariantRouter*
				button_router_continue_action = new EntityButtonVariantRouter();

			button_router_continue_action->force_field_left = offset_left_for_buttons;
			button_router_continue_action->force_field_bottom = 4.0f;

			loot_filter_verion_configure->add_button_to_working_group(button_router_continue_action);
			button_router_continue_action->make_as_default_router_variant_button(new ERegionGabarite(150.0f, 22.0f));

			button_router_continue_action->main_text_area->set_align_to_left_middle();

			button_router_continue_action->can_be_stretched = true;
			button_router_continue_action->invert_suppression = true;



			button_router_continue_action->add_router_variant_with_localization_key_and_color("version_continue_do_not_change", 0.9f, 0.8f, 0.7f, 1.0f);
			button_router_continue_action->add_router_variant_with_localization_key_and_color("version_continue_forcibly_enable", 0.5f, 0.8f, 0.5f, 1.0f);
			button_router_continue_action->add_router_variant_with_localization_key_and_color("version_continue_forcibly_disable", 0.9f, 0.5f, 0.5f, 1.0f);

			focus_slider->add_default_description_by_key("description_router_variant_continue_mode");

			button_router_continue_action->select_variant(0);


			registered_group_loot_version_configure->button_router_continue = button_router_continue_action;
			//////////////////////////////////////////////////////////////////////////////////////////////////////////////
		}


		{
			//	forcibly hide	//////////////////////////////////////////////////////////////////////////
			EntityButtonVariantRouter*
				button_router_show_hide_action = new EntityButtonVariantRouter();

			button_router_show_hide_action->force_field_left = offset_left_for_buttons;
			//button_router_show_hide_action->force_field_bottom = 4.0f;

			loot_filter_verion_configure->add_button_to_working_group(button_router_show_hide_action);
			button_router_show_hide_action->make_as_default_router_variant_button(new ERegionGabarite(150.0f, 22.0f));

			button_router_show_hide_action->main_text_area->set_align_to_left_middle();

			button_router_show_hide_action->can_be_stretched = true;
			button_router_show_hide_action->invert_suppression = true;

			button_router_show_hide_action->add_router_variant_with_localization_key_and_color("version_show_hide_do_not_change", 0.9f, 0.8f, 0.7f, 1.0f);
			button_router_show_hide_action->add_router_variant_with_localization_key_and_color("version_show_hide_forcibly_enable", 0.5f, 0.8f, 0.5f, 1.0f);
			button_router_show_hide_action->add_router_variant_with_localization_key_and_color("version_show_hide_forcibly_disable", 0.9f, 0.5f, 0.5f, 1.0f);

			button_router_show_hide_action->select_variant(0);


			button_router_show_hide_action->add_default_description_by_key("description_router_variant_show_hide_mode");

			registered_group_loot_version_configure->button_router_show_hide = button_router_show_hide_action;
			//////////////////////////////////////////////////////////////////////////////////////////////////////////////
		}



		//	button icon	//////////////////////////////////////////////////////////////////////////
		EntityButtonVariantRouter*
			button_router_pattern_icon = new EntityButtonVariantRouter();

		button_router_pattern_icon->force_field_left = offset_left_for_buttons;
		button_router_pattern_icon->force_field_bottom = 4.0f;

		loot_filter_verion_configure->add_button_to_working_group(button_router_pattern_icon);
		button_router_pattern_icon->make_as_default_router_variant_button(new ERegionGabarite(150.0f, 22.0f));

		button_router_pattern_icon->can_be_stretched = true;
		button_router_pattern_icon->rotate_variant_mode = RotateVariantMode::OPEN_CHOOSE_WINDOW;
		button_router_pattern_icon->invert_suppression = true;

		button_router_pattern_icon->add_router_variant_with_localization_key_color_and_icon("version_icon_full_ignore", "version_icon_full_ignore", 0.9f, 0.8f, 0.7f, 1.0f, NS_EGraphicCore::load_from_textures_folder("loot_versions/loot_version_full_ignore"));
		button_router_pattern_icon->add_router_variant_with_localization_key_color_and_icon("version_icon_soft_ignore", "version_icon_soft_ignore", 0.9f, 0.8f, 0.7f, 1.0f, NS_EGraphicCore::load_from_textures_folder("loot_versions/loot_version_soft_ignore"));
		button_router_pattern_icon->add_router_variant_with_localization_key_color_and_icon("version_icon_ignore", "version_icon_ignore", 0.9f, 0.8f, 0.7f, 1.0f, NS_EGraphicCore::load_from_textures_folder("loot_versions/loot_version_strong_ignore"));
		button_router_pattern_icon->add_router_variant_with_localization_key_color_and_icon("version_icon_hide", "version_icon_hide", 0.9f, 0.8f, 0.7f, 1.0f, NS_EGraphicCore::load_from_textures_folder("loot_versions/loot_version_hide"));

		button_router_pattern_icon->add_router_variant_with_localization_key_color_and_icon("version_icon_default", "version_icon_default", 0.9f, 0.8f, 0.7f, 1.0f, NS_EGraphicCore::load_from_textures_folder("loot_versions/loot_version_default"));

		button_router_pattern_icon->add_router_variant_with_localization_key_color_and_icon("version_icon_soft_focus", "version_icon_soft_focus", 0.9f, 0.8f, 0.7f, 1.0f, NS_EGraphicCore::load_from_textures_folder("loot_versions/loot_version_soft_focus"));
		button_router_pattern_icon->add_router_variant_with_localization_key_color_and_icon("version_icon_focus", "version_icon_focus", 0.9f, 0.8f, 0.7f, 1.0f, NS_EGraphicCore::load_from_textures_folder("loot_versions/loot_version_strong_focus"));

		button_router_pattern_icon->select_variant(0);

		button_router_pattern_icon->add_default_description_by_key("description_version_pattern_icon");

		registered_group_loot_version_configure->button_router_icon = button_router_pattern_icon;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////


		//	BUTTON TEXT COLOR	//////////////////////////////////////////////////////////////////////////////////////////
		EntityButtonColorButton*
			color_button = new EntityButtonColorButton();

		color_button->EntityButtonColorButton::make_as_named_color_button
		(
			new ERegionGabarite(150.0f, 38.0f),
			loot_filter_verion_configure,
			EFont::font_list[0],
			EGUIStyle::active_style,
			ELocalisationText::get_localisation_by_key("color_button_pattern_text"),
			nullptr,
			&NS_EGraphicCore::sun_color,
			ColorButtonMode::CBM_OPEN_WINDOW
		);

		color_button->force_field_left = offset_left_for_buttons;
		color_button->can_be_stretched = true;
		//color_button->force_field_bottom = 4.0f;

		loot_filter_verion_configure->add_button_to_working_group(color_button);

		registered_group_loot_version_configure->button_text_color = color_button;
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	}
}

void EWindowMain::register_loot_filter_error_list_group()
{
	if (true)
	{
		//WHOLE GROUP
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		registered_group_filter_error_list = new EButtonGroupLootFilterErrors(new ERegionGabarite(300.0f, 400.0f));
		registered_group_filter_error_list->init_as_root_group(this);
		registered_group_filter_error_list->button_group_is_active = false;
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


		//TEXT PART
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		EButtonGroup*
			loot_filter_error_workspace = registered_group_filter_error_list->add_close_group_and_return_workspace_group(new ERegionGabarite(100.0f, 20.0f), EGUIStyle::active_style);

		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////



		//BOTTOM PART
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		EButtonGroup*
			loot_filter_error_bottom_part_fot_buttons = new EButtonGroup(new ERegionGabarite(300.0f, 40.0f));
		loot_filter_error_bottom_part_fot_buttons->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DEFAULT, bgroup_without_slider);
		loot_filter_error_bottom_part_fot_buttons->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_dynamic_autosize);
		loot_filter_error_bottom_part_fot_buttons->button_align_type = ButtonAlignType::BUTTON_ALIGN_MID;

		loot_filter_error_workspace->add_group(loot_filter_error_bottom_part_fot_buttons);
		registered_group_filter_error_list->part_with_buttons = loot_filter_error_bottom_part_fot_buttons;
		/*for (int i = 0; i < 10; i++)
		{
		EntityButtonFilterBlockError*
		error_button = new EntityButtonFilterBlockError();

		error_button->make_default_button_with_unedible_text
		(
		new ERegionGabarite (250.0f, 25.0f),
		loot_filter_error_bottom_part_fot_buttons,
		nullptr,
		ELocalisationText::get_localisation_by_key("button_loot_filter_error")
		);
		error_button->can_be_stretched = true;

		loot_filter_error_bottom_part_fot_buttons->add_button_to_working_group(error_button);
		}*/

		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

		//TOP PART
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		EButtonGroup*
			loot_filter_error_top_part_fot_text = new EButtonGroup(new ERegionGabarite(300.0f, 25.0f));
		loot_filter_error_top_part_fot_text->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DEFAULT, bgroup_without_slider);
		loot_filter_error_top_part_fot_text->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_static_autosize);

		loot_filter_error_workspace->add_group(loot_filter_error_top_part_fot_text);

		loot_filter_error_top_part_fot_text->add_default_clickable_region_with_text_area(ELocalisationText::get_localisation_by_key("description_loot_filter_errors"));
		registered_group_filter_error_list->status_text_area = loot_filter_error_top_part_fot_text->clickable_area_list.back()->text_area;
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////





		button_group_list.push_back(registered_group_filter_error_list);
		registered_group_filter_error_list->need_refresh = true;
	}
}

void EWindowMain::register_2013_april_fool_group()
{
	{
		EButtonGroup*
			whole_joke_AD_group = new EButtonGroup(new ERegionGabarite(500.0f, 559.0f));
		pointer_to_joke_AD = whole_joke_AD_group;
		whole_joke_AD_group->root_group = whole_joke_AD_group;
		whole_joke_AD_group->parent_window = this;
		whole_joke_AD_group->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DARKEN, bgroup_without_slider);
		whole_joke_AD_group->button_group_is_active = false;

		EButtonGroup* workspace_joke_part = whole_joke_AD_group->add_close_group_and_return_workspace_group(new ERegionGabarite(20.0f, 20.0f), EGUIStyle::active_style);
		whole_joke_AD_group->add_caption_by_localistation_key("window_header_joke_AD");
		EntityButton*
			joke_AD_button = new EntityButton();
		joke_AD_button->make_as_default_button_with_full_icon
		(
			new ERegionGabarite(500.0f, 559.0f),
			workspace_joke_part,
			nullptr,
			NS_EGraphicCore::load_from_textures_folder("help/OH_MY_TOTEM")
		);
		workspace_joke_part->add_button_to_working_group(joke_AD_button);

		button_group_list.push_back(whole_joke_AD_group);
		whole_joke_AD_group->need_refresh = true;







		EButtonGroup*
			whole_battlepass_group = new EButtonGroup(new ERegionGabarite(637.0f, 320.0f));
		pointer_to_battlepass = whole_battlepass_group;
		whole_battlepass_group->root_group = whole_battlepass_group;
		whole_battlepass_group->parent_window = this;
		whole_battlepass_group->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DARKEN, bgroup_without_slider);
		whole_battlepass_group->button_group_is_active = false;

		EButtonGroup* workspace_battlepass_part = whole_battlepass_group->add_close_group_and_return_workspace_group(new ERegionGabarite(20.0f, 20.0f), EGUIStyle::active_style);
		whole_battlepass_group->add_caption_by_localistation_key("window_header_battlepass");

		EntityButton*
			battlepass_button = new EntityButton();
		battlepass_button->make_as_default_button_with_full_icon
		(
			new ERegionGabarite(637.0f, 269.0f),
			workspace_battlepass_part,
			nullptr,
			NS_EGraphicCore::load_from_textures_folder("help/AwakenedDaDEditor_battle_pass")
		);
		workspace_battlepass_part->add_button_to_working_group(battlepass_button);

		button_group_list.push_back(whole_battlepass_group);
		whole_battlepass_group->need_refresh = true;
	}
}

void EWindowMain::register_styles_group()
{
	if (true)
	{
		EButtonGroup*
			whole_style_group = new EButtonGroup(new ERegionGabarite(800.0f, 600.0f));

		style_list_group = whole_style_group;
		whole_style_group->root_group = whole_style_group;
		whole_style_group->parent_window = this;
		whole_style_group->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DARKEN, bgroup_with_slider);
		whole_style_group->button_group_is_active = false;;

		EButtonGroup*
			style_workspace_part = whole_style_group->add_close_group_and_return_workspace_group(new ERegionGabarite(20.0f, 20.0f), EGUIStyle::active_style);
		//whole_style_group->close_section_left_part->add_default_clickable_region_with_text_area(ELocalisationText::get_localisation_by_key("window_header_select_GUI_style"));
		whole_style_group->add_caption_by_localistation_key("window_header_select_GUI_style");

		for (EGUIStyle* gui_style : EGUIStyle::style_list)
		{
			EButtonGroup*
				style_sample = style_workspace_part->add_group(new EButtonGroup(new ERegionGabarite(100.0f, 256.0f)));
			style_sample->init_button_group(gui_style, BrickStyleID::GROUP_DARKEN, bgroup_with_slider);
			style_sample->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_static_autosize);
			style_sample->can_change_style = false;
			style_sample->additional_y_distance = 32.0f;

			//BOTTOM
			EButtonGroup*
				group_for_preview = style_sample->add_group(new EButtonGroup(new ERegionGabarite(100.0f, 40.0f)));
			group_for_preview->init_button_group(gui_style, BrickStyleID::GROUP_DEFAULT, bgroup_with_slider);
			group_for_preview->set_parameters(ChildAlignMode::ALIGN_HORIZONTAL, NSW_dynamic_autosize, NSW_dynamic_autosize);
			group_for_preview->additional_y_distance = 0.0f;
			group_for_preview->can_change_style = false;
			group_for_preview->button_align_type = ButtonAlignType::BUTTON_ALIGN_MID;

			//UP
			EButtonGroup*
				style_select_group = style_sample->add_group(new EButtonGroup(new ERegionGabarite(100.0f, 40.0f)));
			style_select_group->init_button_group(gui_style, BrickStyleID::GROUP_DEFAULT, bgroup_with_slider);
			style_select_group->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_static_autosize);
			style_select_group->additional_y_distance = 0.0f;
			style_select_group->can_change_style = false;
			style_select_group->button_align_type = ButtonAlignType::BUTTON_ALIGN_MID;

			//LEFT
			EButtonGroup*
				group_for_texture_preview = group_for_preview->add_group(new EButtonGroup(new ERegionGabarite(111.0f, 111.0f)));
			group_for_texture_preview->init_button_group(gui_style, BrickStyleID::NONE, bgroup_with_slider);
			group_for_texture_preview->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_dynamic_autosize);
			group_for_texture_preview->additional_y_distance = 0.0f;
			group_for_texture_preview->can_change_style = false;
			group_for_texture_preview->button_align_type = ButtonAlignType::BUTTON_ALIGN_MID;


			//RIGHT
			EButtonGroup*
				group_for_imitation_buttons = group_for_preview->add_group(new EButtonGroup(new ERegionGabarite(111.0f, 111.0f)));
			group_for_imitation_buttons->init_button_group(gui_style, BrickStyleID::NONE, bgroup_with_slider);
			group_for_imitation_buttons->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_dynamic_autosize);
			group_for_imitation_buttons->additional_y_distance = 0.0f;
			group_for_imitation_buttons->can_change_style = false;
			group_for_imitation_buttons->button_align_type = ButtonAlignType::BUTTON_ALIGN_MID;
			//EButtonGroup*
			//style_button_imitator_up = style_sample->add_group(new EButtonGroup(new ERegionGabarite(100.0f, 30.0f)));
			//style_button_imitator_up->init_button_group(gui_style, bgroup_with_bg, bgroup_with_slider, bgroup_default_bg);
			//style_button_imitator_up->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_dynamic_autosize);
			//style_button_imitator_up->additional_y_distance = 0.0f;
			//style_button_imitator_up->can_change_style = false;

			// // // // // // //// // // // // // //// // // // // // //
			EntityButton* example_slider = EntityButton::create_horizontal_named_slider
			(

				new ERegionGabarite(350.0f, 38.0f),
				group_for_texture_preview,
				EFont::font_list[0],
				EGUIStyle::active_style,
				ELocalisationText::get_localisation_by_key("example_slider")
			);
			example_slider->can_be_stretched = true;
			static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(example_slider)->data_container)->pointer_to_value = new float(0.3333333f);
			static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(example_slider)->data_container)->mid_value = 1.0f;
			static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(example_slider)->data_container)->max_value = 10.0f;

			//static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(example_slider)->data_container)->current_value = 0.333f;
			group_for_texture_preview->add_button_to_working_group(example_slider);
			// // // // // // //// // // // // // //// // // // // // //

			for (int i = 0; i < 64; i++)
			{
				{
					EntityButton*
						button_simulator = new EntityButton();
					group_for_imitation_buttons->add_button_to_working_group(button_simulator);

					std::string
						path_to_icon = DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::icon_path, EDataEntity::data_entity_global_list[rand() % EDataEntity::data_entity_global_list.size()]);

					button_simulator->make_as_default_button_with_icon
					(
						new ERegionGabarite(44.0f, 44.0f),
						group_for_imitation_buttons,
						nullptr,
						(path_to_icon != "")
						?
						(NS_EGraphicCore::load_from_textures_folder("icons/" + path_to_icon))
						:
						(nullptr)
					);
					button_simulator->force_field_left = 3.0f;
					button_simulator->force_field_right = 3.0f;
					button_simulator->force_field_bottom = 3.0f;
					button_simulator->force_field_up = 3.0f;
				}

				//{
				//	EntityButton*
				//	button_select_style = new EntityButton();
				//	style_button_imitator_up->add_button_to_working_group(button_select_style);

				//	button_select_style->make_as_default_button_with_icon
				//	(
				//		new ERegionGabarite(40.0f, 40.0f),
				//		style_button_imitator_up,
				//		nullptr,
				//		NS_EGraphicCore::load_from_textures_folder("icons/" + DataEntityUtils::get_tag_value_by_name(0, "icon path", EDataEntity::data_entity_global_list[rand() % EDataEntity::data_entity_global_list.size()]))
				//	);
				//}

			}

			EntityButton*
				button_select_style = new EntityButton();
			style_select_group->add_button_to_working_group(button_select_style);

			ELocalisationText ltext;;
			ltext.localisations[NSW_localisation_EN] = "Select style [" + gui_style->localisation_text.localisations[NSW_localisation_EN] + "]";
			ltext.localisations[NSW_localisation_RU] = "Выбрать стиль [" + gui_style->localisation_text.localisations[NSW_localisation_RU] + "]";

			button_select_style->make_default_button_with_unedible_text
			(
				new ERegionGabarite(450.0f, 40.0f),
				style_select_group,
				&EDataActionCollection::action_select_this_style,
				ltext
			);
			button_select_style->main_text_area->localisation_text = ltext;
			button_select_style->can_be_stretched = true;
			//&EDataActionCollection::action_select_this_style

			//style_workspace_part->group_list.push_back(style_sample);
		}

		//whole_style_group->need_refresh = true;
		button_group_list.push_back(whole_style_group);
		whole_style_group->need_refresh = true;
	}
}

void EWindowMain::register_filter_tabs()
{
	if (true)
	{
		for (int i = 0; i < filter_tabs_count; i++)
		{
			EButtonGroupFilterBlockEditor* main_filter_editor =
				new EButtonGroupFilterBlockEditor(new ERegionGabarite(NS_EGraphicCore::SCREEN_WIDTH, NS_EGraphicCore::SCREEN_HEIGHT));

			main_filter_editor->init_button_group(EGUIStyle::active_style, BrickStyleID::NONE, bgroup_with_slider);

			main_filter_editor->parent_window = this;

			main_filter_editor->child_align_direction = ChildElementsAlignDirection::TOP_TO_BOTTOM;

			main_filter_editor->actions_on_resize_window.push_back(&EDataActionCollection::action_resize_to_full_window);

			main_filter_editor->root_group = main_filter_editor;
			main_filter_editor->can_be_moved = false;
			main_filter_editor->can_resize_to_workspace_size_x = false;
			main_filter_editor->can_resize_to_workspace_size_y = false;

			main_filter_editor->additional_fake_start_offset = 16.0f;
			main_filter_editor->additional_fake_y_point = 16.0f;

			main_filter_editor->child_align_mode = ChildAlignMode::ALIGN_VERTICAL;
			//*main_button_group->stretch_mode		= GroupStretchMode::CONSTANT;
			main_filter_editor->dynamic_autosize_for_window = true;

			filter_block_tabs[i] = main_filter_editor;
		}

		active_loot_filter_editor = filter_block_tabs[0];
		autosize_group_list.push_back(filter_block_tabs[0]);

		//for (int z = 0; z < 0; z++)
		//{
		//	create_filter_block(main_button_group);
		//}




		button_group_list.insert(button_group_list.begin(), filter_block_tabs[0]);
		//EButtonGroup::refresh_button_group(filter_block_tabs[0]);
		filter_block_tabs[0]->need_refresh = true;
	}
}

void EWindowMain::register_bottom_search_line()
{
	{
		EButtonGroupBottomFilterBlockControl* main_bottom_filter_block_control = new EButtonGroupBottomFilterBlockControl(new ERegionGabarite(0.0f, 0.0f, 1020.0f, 32.0f));
		//(
		//	EButtonGroup::create_root_button_group
		//);
		main_bottom_filter_block_control->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DARKEN, bgroup_without_slider);

		main_bottom_filter_block_control->parent_window = this;

		main_bottom_filter_block_control->root_group = main_bottom_filter_block_control;
		main_bottom_filter_block_control->can_be_moved = false;
		main_bottom_filter_block_control->can_resize_to_workspace_size_x = false;
		main_bottom_filter_block_control->can_resize_to_workspace_size_y = true;

		main_bottom_filter_block_control->child_align_mode = ChildAlignMode::ALIGN_VERTICAL;

		main_bottom_filter_block_control->actions_on_resize_window.push_back(&EDataActionCollection::action_resize_to_full_window_only_x);
		main_bottom_filter_block_control->dynamic_autosize_for_window = false;
		main_bottom_filter_block_control->shadow_size = 8.0f;

		EWindowMain::bottom_filter_block_control = main_bottom_filter_block_control;

		autosize_group_list.push_back(main_bottom_filter_block_control);

		//for (int z = 0; z < 0; z++)
		//{
		//	create_filter_block(main_button_group);
		//}



		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		EntityButton*
			search_button = new EntityButton();
		search_button->make_default_button_with_edible_text
		(
			new ERegionGabarite(300.0f, 30.0f),
			main_bottom_filter_block_control,
			nullptr,
			""
		);
		search_button->main_text_area->action_on_change_text.push_back(&EDataActionCollection::action_type_search_filter_block_text);

		search_button->main_text_area->gray_text = ELocalisationText();
		search_button->main_text_area->gray_text.localisations[NSW_localisation_EN] = "Search...";
		search_button->main_text_area->gray_text.localisations[NSW_localisation_RU] = "Поиск...";

		main_bottom_filter_block_control->search_button = search_button;
		//search_button->main_text_area->change_text("");

		search_button->add_default_description_by_key("description_filter_block_search");

		main_bottom_filter_block_control->add_button_to_working_group(search_button);
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


		//CLEAR TEXT BUTTON
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		EntityButtonForFilterBlock*
			button_clear_text = new EntityButtonForFilterBlock();
		button_clear_text->make_as_default_button_with_icon
		(
			new ERegionGabarite(30.0f, 30.0f),
			main_bottom_filter_block_control,
			&EDataActionCollection::action_clear_bottom_section_for_search_text,
			NS_EGraphicCore::load_from_textures_folder("button_close[30x30]")
		);
		button_clear_text->add_default_description_by_key("description_remove_text");

		main_bottom_filter_block_control->search_button_clear = button_clear_text;
		main_bottom_filter_block_control->add_button_to_working_group(button_clear_text);
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


		//EXPAND ALL SEPARATORS
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		EntityButton*
			button_expand_all_separator = new EntityButton();
		main_bottom_filter_block_control->add_button_to_working_group(button_expand_all_separator);
		button_expand_all_separator->make_as_default_button_with_icon
		(
			new ERegionGabarite(30.0f, 30.0f),
			main_bottom_filter_block_control,
			&EDataActionCollection::action_expand_all_separators,
			NS_EGraphicCore::load_from_textures_folder("buttons/button_expand_all_separators")
		);
		button_expand_all_separator->add_default_description_by_key("description_expand_all_separators");
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


		//SHRINK ALL SEPARATORS
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		{
			EntityButton*
				button_shrink_all_separator = new EntityButton();
			main_bottom_filter_block_control->add_button_to_working_group(button_shrink_all_separator);
			button_shrink_all_separator->make_as_default_button_with_icon
			(
				new ERegionGabarite(30.0f, 30.0f),
				main_bottom_filter_block_control,
				&EDataActionCollection::action_shrink_all_separators,
				NS_EGraphicCore::load_from_textures_folder("buttons/button_shrink_all_separators")
			);
			button_shrink_all_separator->add_default_description_by_key("description_shrink_all_separators");
		}
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

		button_group_list.push_back(main_bottom_filter_block_control);
		//EButtonGroup::refresh_button_group(main_bottom_filter_block_control);
		main_bottom_filter_block_control->need_refresh = true;

	}
}

void EWindowMain::register_color_editor()
{
	if (true)
	{
		EButtonGroupSimpleColorEditor*
			simple_color_editor = EButtonGroupSimpleColorEditor::create_color_editor_group(new ERegionGabarite(350.0f, 260.0f), EGUIStyle::active_style, this);

		EButtonGroupSimpleColorEditor::registered_color_editor_group = simple_color_editor;
		simple_color_editor->button_group_is_active = false;
		//main_button_group->can_be_moved = true;

		button_group_list.push_back(simple_color_editor);
		simple_color_editor->need_refresh = true;


	}
}

void EWindowMain::register_default_color_patterns()
{
	//NORMAL RARITY
	HSVRGBAColor HRA_color;
	HRA_color.set_color_RGBA(1.0f, 0.9f, 0.8f, 1.0f);
	Helper::hsv2rgb(&HRA_color);

	HRA_color_collection* HRA_collection = new HRA_color_collection();
	HRA_collection->localised_name.localisations[NSW_localisation_EN] = "Normal";
	HRA_collection->localised_name.localisations[NSW_localisation_RU] = "Обычный";
	HRA_collection->target_color = HRA_color;

	Helper::registered_color_list.push_back(HRA_collection);

	//MAGIC RARITY
	HRA_color.set_color_RGBA(0.25f, 0.5f, 1.0f, 1.0f);
	Helper::hsv2rgb(&HRA_color);

	HRA_collection = new HRA_color_collection();
	HRA_collection->localised_name.localisations[NSW_localisation_EN] = "Magic";
	HRA_collection->localised_name.localisations[NSW_localisation_RU] = "Волшебный";
	HRA_collection->target_color = HRA_color;

	Helper::registered_color_list.push_back(HRA_collection);

	//RARE RARITY
	HRA_color.set_color_RGBA(1.0f, 0.8f, 0.25f, 1.0f);
	Helper::hsv2rgb(&HRA_color);

	HRA_collection = new HRA_color_collection();
	HRA_collection->localised_name.localisations[NSW_localisation_EN] = "Rare";
	HRA_collection->localised_name.localisations[NSW_localisation_RU] = "Редкий";
	HRA_collection->target_color = HRA_color;

	Helper::registered_color_list.push_back(HRA_collection);

	//RARE RARITY
	HRA_color.set_color_RGBA(1.0f, 0.5f, 0.25f, 1.0f);
	Helper::hsv2rgb(&HRA_color);

	HRA_collection = new HRA_color_collection();
	HRA_collection->localised_name.localisations[NSW_localisation_EN] = "Unique";
	HRA_collection->localised_name.localisations[NSW_localisation_RU] = "Уникальный";
	HRA_collection->target_color = HRA_color;

	Helper::registered_color_list.push_back(HRA_collection);
}

void NSWRegisteredButtonGroups::register_poe_ninja_price_checker()
{
	EButtonGroupPoeNijaPriceChecker*
	poe_ninja_price_checker_group = new EButtonGroupPoeNijaPriceChecker(new ERegionGabarite(200.0f, 320.0f));
	poe_ninja_price_checker_group->button_group_is_active = false;
	poe_ninja_price_checker_group->auto_superfocused = true;

	poe_ninja_price_checker_group->init_as_root_group(EWindowMain::link_to_main_window);
	//poe_ninja_price_checker_group->child_align_direction = ChildElementsAlignDirection::TOP_TO_BOTTOM
	poe_ninja_price_checker_group->child_align_mode = ChildAlignMode::ALIGN_VERTICAL;

	//		WORSPACE PART		//////////////////////////////////////////////////////////////////////////////////////////
	EButtonGroup*
	workspace_part = poe_ninja_price_checker_group->add_close_group_and_return_workspace_group(new ERegionGabarite(1.0f, 20.0f), EGUIStyle::active_style);
	/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////



			//		STATUS_LIST		//////////////////////////////////////////////////////////////////////////////////////////
			EButtonGroup*
			status_list_part = new EButtonGroup(new ERegionGabarite(100.0f, 40.0f));
			status_list_part->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_dynamic_autosize);
			status_list_part->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DEFAULT, bgroup_with_slider);

			//status_list_part->add_default_clickable_region_with_text_area(ELocalisationText::get_localisation_by_key("status_list_group_text"));
			//status_list_part->main_clickable_area->text_area->offset_by_gabarite_size_y = 1.0f;
			//status_list_part->main_clickable_area->text_area->offset_by_text_size_y = -1.0f;
			workspace_part->add_group(status_list_part);

			poe_ninja_price_checker_group->pointer_to_status_group = status_list_part;
			/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

			//		CHECK BUTTON PART		//////////////////////////////////////////////////////////////////////////////////////////
			EButtonGroup*
			check_button_part = new EButtonGroup(new ERegionGabarite(100.0f, 20.0f));
			check_button_part->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_static_autosize);
			check_button_part->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DEFAULT, bgroup_without_slider);
			workspace_part->add_group(check_button_part);
			/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	
			//		LEAGUE NAME PART		//////////////////////////////////////////////////////////////////////////////////////////
			EButtonGroup*
			league_name_part = new EButtonGroup(new ERegionGabarite(100.0f, 40.0f));
			league_name_part->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_static_autosize);
			league_name_part->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DEFAULT, bgroup_without_slider);

			league_name_part->add_default_clickable_region_with_text_area(ELocalisationText::get_localisation_by_key("league_name_group_text"));
			league_name_part->main_clickable_area->text_area->offset_by_gabarite_size_y = 1.0f;
			league_name_part->main_clickable_area->text_area->offset_by_text_size_y = -1.0f;
			workspace_part->add_group(league_name_part);
			/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////





	{
		EntityButton*
		button_league_name = new EntityButton();
		button_league_name->make_default_button_with_edible_text
		(
			new ERegionGabarite(200.0f, 25.0f),
			league_name_part,
			nullptr,
			"Necropolis"
		);
		button_league_name->can_be_stretched = true;

		button_league_name->main_text_area->gray_text = ELocalisationText::get_localisation_by_key("league_name_gray_text");
		poe_ninja_price_checker_group->league_name_button = button_league_name;

		league_name_part->add_button_to_working_group(button_league_name);
	}




	{
		EntityButton*
		button_check_prices = new EntityButton();
		button_check_prices->make_default_button_with_unedible_text
		(
			new ERegionGabarite(200.0f, 20.0f),
			check_button_part,
			&EDataActionCollection::action_get_poe_ninja_prices,
			ELocalisationText::get_localisation_by_key("button_check_prices")
		);
		button_check_prices->can_be_stretched = true;

		//poe_ninja_price_checker_group->league_name_button = button_check_prices;

		check_button_part->add_button_to_working_group(button_check_prices);
	}



	poe_ninja_price_checker_group->need_refresh = true;
	EWindowMain::link_to_main_window->button_group_list.push_back(poe_ninja_price_checker_group);

	NSWRegisteredButtonGroups::poe_ninja_price_checker_group = poe_ninja_price_checker_group;
}

//CONSTRUCTOR
EWindowMain::EWindowMain()
{
	link_to_main_window = this;
	EInputCore::logger_param("size of EButtonGroup ", sizeof EButtonGroup);

	//REGISTER USERNAME
	TCHAR localised_name[UNLEN + 1];
	DWORD size = UNLEN + 1;

	if (GetUserName(localised_name, &size))
	{
		//std::string zalupa = *(new std::string(name));

		username = EStringUtils::UTF8_to_ANSI(localised_name);
		std::cout << "Hello, " << username << "!\n";
	}
	else
	{
		std::cout << "Hello, unnamed person!\n";
	}


















	//std::string
	//op = std::string("start ").append("https://poe.ninja/api/data/currencyoverview?league=Affliction&type=Currency");




	//DEFINE PATH TO FOLDER WITH LOOT-FILTERS
	CHAR my_documents[MAX_PATH];
	HRESULT result = SHGetFolderPath(NULL, CSIDL_PERSONAL, NULL, SHGFP_TYPE_CURRENT, my_documents);

	if (result != S_OK)
	{
		std::cout << "Error: " << result << "\n";
	}
	else
	{
		/*
		for (int i = 0; i < MAX_PATH; i++)
		{
			cout << "symbol at " << i << "is= " << my_documents[i] << endl;
		}
		*/

		path_of_exile_folder = (std::string)my_documents + "\\My Games\\Path of Exile\\";
		std::cout << "Path to loot-filters folder: " << path_of_exile_folder << "\n";

	}




	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/stackable_currency.txt");

	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/delve_stackable_socketable_currency.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/oils.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/catalysts.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/charms.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/currency_shards.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/delirium_orbs.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/fossils.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/map_splinters.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/breach_blessings.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/harbinger_scrolls.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/tainted_currency.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/tinctures.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/expedition_currency.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/scouting_reports.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/eldritch_currency.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/incubators.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/incursion_items.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/vials.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/nets.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/essences.txt");

	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/currency.txt");

	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/amulets.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/abyss_jewels.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/belts.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/rings.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/jewels.txt");

	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/divinations.txt");


	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/body_armours.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/gloves.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/helmets.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/boots.txt");







	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/contracts.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/corpses.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/blueprints.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/heist_brooch.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/heist_cloak.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/heist_gear.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/heist_targets.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/heist_tool.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/trinkets.txt");



	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/bows.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/quivers.txt");

	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/two_hand_axes.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/two_hand_maces.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/two_hand_swords.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/warstaves.txt");







	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/rune_daggers.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/sceptres.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/wands.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/staves.txt");

	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/sanctum_research.txt");




	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/shields.txt");



	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/claws.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/daggers.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/one_hand_axes.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/one_hand_maces.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/one_hand_swords.txt");


	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/support_skill_gems.txt");


	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/flasks.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/mana_flasks.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/hybrid_flasks.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/utility_flasks.txt");

	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/map_fragments.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/maps.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/memories.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/misc_map_items.txt");

	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/harvest_seeds.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/metamorph_samples.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/quest_items.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/relics.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/atlas_region_upgrade_item.txt");

	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/item_piece.txt");

	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/ambers_of_the_allflame.txt");

	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/uniques.txt");

	ETextParser::data_entity_parse_file("data/DataEntity/GameItems/_special_items.txt");















	//ETextParser::data_entity_parse_file("data/DataEntity/data_entity_list[game_item].txt");

	ETextParser::data_entity_parse_file("data/DataEntity/influence.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/base_class.txt");

	//ETextParser::data_entity_parse_file("data/data_entity_list[explicit].txt");
	ETextParser::data_entity_parse_file("data/DataEntity/Explicits/basic.txt");
	ETextParser::data_entity_parse_file("data/DataEntity/Explicits/special.txt");
	//ETextParser::data_entity_parse_file("data/DataEntityExplicitsLowUsable.txt");

	ETextParser::data_entity_parse_file("data/DataEntity/enchantment.txt");

	ETextParser::data_entity_parse_file("data/DataEntity/localisation.txt");


	parse_raw_explicit_table();





	ETextParser::split_data_entity_list_to_named_structs();




	add_game_item_data_entity_to_list();

	register_filter_rules();


	preload_textures();


	register_rarities();
	register_alternate_qualities();
	register_game_item_attributes();

	//register_loot_simulator_patterns();

	//export_loot_patterns_to_file();
	import_loot_patterns_from_file();

	std::cout << green << "IDstrings hash density" << std::endl;

	for (int i = 0; i < 256; i++)
	{
		for (int j = 0; j < ID_string_array_size_for_hash; j++)
		{
			if (ID_string::HASHED_registered_ID_strings[i][j].is_empty)
			{
				EInputCore::logger_param("ID string[" + std::to_string(i) + "]", j);
				break;
			}
		}
	}

	//get_poe_ninja_api_prices();


	Entity* jc_entity = new Entity();
	ESpriteLayer* jc_sprite_layer = new ESpriteLayer();
	ESpriteLayer* jc_sprite_layer_for_text = new ESpriteLayer();
	ESprite* jc_sprite = new ESprite();
	ECustomData* jc_custom_data = new ECustomData();
	ERegionGabarite* jc_region_gabarite = new ERegionGabarite(0.0f, 0.0f, 500.0f, 200.0f);
	EClickableArea* jc_clickable_area = new EClickableArea();
	ETextArea* jc_text_area = new ETextArea();
	EButtonGroup* jc_button_group;
	EButtonGroup* main_button_group;
	//EButtonGroupRow*	jc_button_group_row;
	EntityButton* jc_button;
	ESpriteFrame* jc_sprite_frame = new ESpriteFrame();

	std::string random_texture_list[5] =
	{
		"Chaos_Orb_inventory_icon",
		"Orb_of_Horizons_inventory_icon",
		"Orb_of_Regret_inventory_icon",
		"Orb_of_Scouring_inventory_icon",
		"Orb_of_Transmutation_inventory_icon"
	};

	std::string random_item_property[5] =
	{
		"Item level",
		"Map tier",
		"Links",
		"Sockets",
		"Require level"
	};



















	//test blocks
	if (false)
	{
		for (int i = 0; i < 500 * 1; i++)
		{
			EButtonGroup* test_group = main_button_group->add_group
			(EButtonGroup::create_default_button_group(new ERegionGabarite(100.0f, 200.0f), EGUIStyle::active_style));
			test_group->can_be_stretched_by_child = true;

			test_group->stretch_x_by_parent_size = true;
			test_group->dynamic_size_y = false;

			for (int k = 0; k < 20; k++)
			{
				EntityButton* test_button = new EntityButton();
				test_button->make_as_default_clickable_button(new ERegionGabarite(64.0f, 64.0f), test_group, nullptr);

				test_group->add_button_to_working_group(test_button);
			}
		}
		button_group_list.push_back(main_button_group);
		//EButtonGroup::refresh_button_group(main_button_group);
		main_button_group->need_refresh = true;
	}
	////////////////////////////////////////////////




	load_config_from_disc();

	load_config_from_disc_for_filter_version();
	if (have_no_loot_version_config)
	{register_loot_version_names();}


	load_config_from_disc_for_filter_version_patterns();
	if (have_no_loot_version_pattern_config)
	{register_loot_filter_version_patterns();}



	if (Helper::registered_color_list.empty())
	{register_default_color_patterns();}

	register_color_editor();
	register_bottom_search_line();
	register_filter_tabs();

	//skill gems
	if (false)
	{
		main_button_group = EButtonGroup::create_root_button_group
		(new ERegionGabarite(10.0f, 10.0f, 0.0f, 512.0f, 800.0f), EGUIStyle::active_style);
		main_button_group->parent_window = this;
		main_button_group->root_group = main_button_group;
		main_button_group->child_align_mode = ChildAlignMode::ALIGN_VERTICAL;

		jc_button_group = main_button_group->add_group(EButtonGroup::create_default_button_group(new ERegionGabarite(256.0f, 150.0f), EGUIStyle::active_style));
		jc_button_group->child_align_mode = ChildAlignMode::ALIGN_HORIZONTAL;
		jc_button_group->stretch_x_by_parent_size = true;
		jc_button_group->dynamic_size_y = true;

		std::vector <EDataEntity*> suitable_data_entity_list;
		for (EDataEntity* de : EDataEntity::data_entity_global_list)
		{
			if
				(
					EStringUtils::to_lower(DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::data_type, de))
					==
					"gem"
					)
			{
				suitable_data_entity_list.push_back(de);
			}
		}

		for (int i = 0; i < 6; i++)
		{
			EntityButtonWideItem* jc_wide_button = EntityButtonWideItem::create_wide_item_button
			(
				new ERegionGabarite(480.0f, 64.0f),
				jc_button_group,
				suitable_data_entity_list[rand() % suitable_data_entity_list.size()],
				EFont::font_list[1],
				true
			);
			jc_button_group->add_button_to_working_group(jc_wide_button);
			//Entity::get_last_clickable_area(jc_button)->actions_on_click_list.push_back(&EDataActionCollection::action_open_data_entity_filter_group);


			EDataContainer_Group_StoreFilterRuleForDataEntitySearcher* data_container_entity_filter = new EDataContainer_Group_StoreFilterRuleForDataEntitySearcher();
			data_container_entity_filter->target_group_receiver = EWindowMain::data_entity_filter;
			data_container_entity_filter->filter_rule = EFilterRule::registered_global_filter_rules[RegisteredFilterRules::FILTER_RULE_SKILL_GEMS];

			ECustomData* custom_data_for_gem_button = new ECustomData();
			custom_data_for_gem_button->data_container = data_container_entity_filter;

			EClickableArea* clickable_area_for_gem_button = EClickableArea::create_default_clickable_region(jc_wide_button->button_gabarite, jc_wide_button, custom_data_for_gem_button);
			clickable_area_for_gem_button->actions_on_click_list.push_back(&EDataActionCollection::action_open_data_entity_filter_group);
			custom_data_for_gem_button->clickable_area_list.push_back(clickable_area_for_gem_button);


			jc_wide_button->custom_data_list.push_back(custom_data_for_gem_button);
		}

		button_group_list.push_back(main_button_group);
		//EButtonGroup::refresh_button_group(main_button_group);
		main_button_group->need_refresh = true;



	}

	register_styles_group();

	if (NSW_APRIL_FOOL){register_2013_april_fool_group();}

	register_loot_filter_error_list_group();
	register_loot_version_configurator();
	register_create_new_loot_filter_group();
	register_add_data_entity_group();
	register_world_parameters_group();
	register_loot_simulator_group();
	register_add_content_to_filter_block_group();
	register_sound_group();	//loot-filter list
	register_loot_filter_list_group();
	register_about_group();


	NSWRegisteredButtonGroups::register_filter_block_colors_group_for_filter_block();
	NSWRegisteredButtonGroups::register_explicit_for_loot_simulator_group();
	NSWRegisteredButtonGroups::register_poe_ninja_price_checker();


	////////////////////////////////////////////////////////////////
	// 
	//		#LOCKED VECTOR ORDER
	// 
	//////////////////////////////////////////////////////////////// 



	//head button group
	if (true)
	{
		EButtonGroupFilterEditorTopHeader*
			main_button_group = new EButtonGroupFilterEditorTopHeader
			(new ERegionGabarite(NS_EGraphicCore::SCREEN_WIDTH, 70.0f));
		main_button_group->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DARKEN, bgroup_with_slider);

		header_line = main_button_group;
		main_button_group->region_gabarite->offset_y = NS_EGraphicCore::SCREEN_HEIGHT / NS_EGraphicCore::current_zoom - main_button_group->region_gabarite->size_y;

		main_button_group->parent_window = this;

		main_button_group->root_group = main_button_group;
		main_button_group->can_be_moved = false;
		main_button_group->can_change_position_in_vector = false;
		main_button_group->can_resize_to_workspace_size_x = false;
		main_button_group->can_resize_to_workspace_size_y = true;

		main_button_group->child_align_mode = ChildAlignMode::ALIGN_VERTICAL;

		main_button_group->actions_on_resize_window.push_back(&EDataActionCollection::action_resize_to_full_window_only_x);
		main_button_group->dynamic_autosize_for_window = false;
		main_button_group->shadow_size = 32.0f;

		autosize_group_list.push_back(main_button_group);





		//TAB SECTION
		//////////////////////////////////////////////////////////////////////////////////////////////
		EButtonGroup* bottom_tab_section = main_button_group->add_group
		(
			EButtonGroup::create_button_group_without_bg
			(
				new ERegionGabarite(1.0f, 1.0f),
				EGUIStyle::active_style
			)
		)->set_parameters(ChildAlignMode::ALIGN_HORIZONTAL, NSW_dynamic_autosize, NSW_dynamic_autosize);

		tab_list_group = bottom_tab_section;

		header_line->pointer_to_bottom_tabs_section = bottom_tab_section;
		//////////////////////////////////////////////////////////////////////////////////////////////

		if (NSW_APRIL_FOOL)
		{
			//APRIL FOOL PREMIUM SECTION
			//////////////////////////////////////////////////////////////////////////////////////////////
			EButtonGroup*
				april_fool_section = main_button_group->add_group
				(
					EButtonGroup::create_button_group_without_bg
					(
						new ERegionGabarite(10.0f, 80.0f),
						EGUIStyle::active_style
					)
				)->set_parameters(ChildAlignMode::ALIGN_HORIZONTAL, NSW_dynamic_autosize, NSW_static_autosize);

			header_line->pointer_to_bottom_tabs_section = april_fool_section;
			//////////////////////////////////////////////////////////////////////////////////////////////


			//////////////////////////////////////////////////////
			jc_button = new EntityButtonForFilterBlock();
			jc_button->make_as_default_button_with_icon_and_text
			(
				new ERegionGabarite(500.0f, 80.0f),
				april_fool_section,
				nullptr,
				NS_EGraphicCore::load_from_textures_folder("buttons/button_upgrade_to_premium"),
				"ОБНОВИТЬ ДО PREMIUM!"
			);
			jc_button->can_be_stretched = true;
			jc_button->main_text_area->font = EFont::font_list[1];
			jc_button->add_hotkey(GLFW_KEY_LEFT_CONTROL, GLFW_KEY_P);
			jc_button->max_stretch_factor = 2.0f;
			april_fool_section->add_button_to_working_group(jc_button);
			//////////////////////////////////////////////////////


			//////////////////////////////////////////////////////
			EntityButtonButtonGroupActivator* battle_pass_activator = new EntityButtonButtonGroupActivator();
			battle_pass_activator->make_as_default_button_with_icon_and_text
			(
				new ERegionGabarite(500.0f, 80.0f),
				april_fool_section,
				EDataActionCollection::action_set_button_group_as_active,
				NS_EGraphicCore::load_from_textures_folder("buttons/button_buy_battle_pass"),
				"ПРИОБРЕСТИ BATTLEPASS!"
			);
			battle_pass_activator->target_group = pointer_to_battlepass;

			battle_pass_activator->can_be_stretched = true;
			battle_pass_activator->main_text_area->font = EFont::font_list[1];
			battle_pass_activator->max_stretch_factor = 2.0f;
			battle_pass_activator->add_hotkey(GLFW_KEY_LEFT_CONTROL, GLFW_KEY_B);
			april_fool_section->add_button_to_working_group(battle_pass_activator);
			//////////////////////////////////////////////////////
		}


		EButtonGroup* top_section = main_button_group->add_group
		(
			EButtonGroup::create_button_group_without_bg
			(
				new ERegionGabarite(1.0f, 35.0f),
				EGUIStyle::active_style
			)
		)->set_parameters(ChildAlignMode::ALIGN_HORIZONTAL, NSW_dynamic_autosize, NSW_static_autosize);

		//////////////////////////////////////////////////////
		EButtonGroup* top_section_left_part = top_section->add_group
		(
			EButtonGroup::create_button_group_without_bg
			(
				new ERegionGabarite(530.0f, 35.0f),
				EGUIStyle::active_style
			)
		)->set_parameters(ChildAlignMode::ALIGN_HORIZONTAL, NSW_static_autosize, NSW_dynamic_autosize);
		top_section_left_part->ignore_vertical_buttons_force_field = true;
		//////////////////////////////////////////////////////



		//////////////////////////////////////////////////////
		EButtonGroup* top_section_mid_part = top_section->add_group
		(
			EButtonGroup::create_button_group_without_bg
			(
				new ERegionGabarite(320.0f, 35.0f),
				EGUIStyle::active_style
			)
		)->set_parameters(ChildAlignMode::ALIGN_HORIZONTAL, NSW_static_autosize, NSW_dynamic_autosize);
		top_section_mid_part->ignore_vertical_buttons_force_field = true;

		top_section_mid_part->button_align_type = ButtonAlignType::BUTTON_ALIGN_LEFT;
		//////////////////////////////////////////////////////



		//////////////////////////////////////////////////////
		EButtonGroup* top_section_right_part = top_section->add_group
		(
			EButtonGroup::create_button_group_without_bg
			(
				new ERegionGabarite(350.0f, 35.0f),
				EGUIStyle::active_style
			)
		)->set_parameters(ChildAlignMode::ALIGN_HORIZONTAL, NSW_dynamic_autosize, NSW_static_autosize);
		top_section_right_part->ignore_vertical_buttons_force_field = true;

		top_section_right_part->button_align_type = ButtonAlignType::BUTTON_ALIGN_RIGHT;
		//////////////////////////////////////////////////////



		/*		BUTTON FOR GROUPS		*/
				//////////////////////////////////////////////////////
		jc_button = new EntityButtonForFilterBlock();
		jc_button->make_as_default_button_with_icon_and_localisation_by_key
		(
			new ERegionGabarite(110.0f, 34.0f),
			top_section_left_part,
			&EDataActionCollection::action_open_new_lootfilter_group,
			NS_EGraphicCore::load_from_textures_folder("buttons/button_create_new_loot_filter"),
			"button_text_new_filter"
		);
		jc_button->add_hotkey(GLFW_KEY_LEFT_CONTROL, GLFW_KEY_N);
		jc_button->add_default_description_by_key("description_new_loot_filter");
		top_section_left_part->add_button_to_working_group(jc_button);
		jc_button->can_be_stretched = true;
		jc_button->force_field_right = 8.0f;
		//////////////////////////////////////////////////////





		//////////////////////////////////////////////////////
		jc_button = new EntityButtonForFilterBlock();
		jc_button->make_as_default_button_with_icon_and_localisation_by_key
		(
			new ERegionGabarite(110.0f, 34.0f),
			top_section_left_part,
			&EDataActionCollection::action_open_loot_filters_list_window,
			NS_EGraphicCore::load_from_textures_folder("buttons/button_open"),
			"button_text_open_filter"
		);
		jc_button->add_default_description_by_key("description_open_loot_filter");
		jc_button->add_hotkey(GLFW_KEY_LEFT_CONTROL, GLFW_KEY_O);
		top_section_left_part->add_button_to_working_group(jc_button);
		jc_button->can_be_stretched = true;
		//////////////////////////////////////////////////////





		//////////////////////////////////////////////////////
		jc_button = new EntityButtonForFilterBlock();

		jc_button->make_as_default_button_with_icon_and_localisation_by_key
		(
			new ERegionGabarite(110.0f, 34.0f),
			top_section_left_part,
			&EDataActionCollection::action_save_lootfilter,
			NS_EGraphicCore::load_from_textures_folder("buttons/button_save"),
			"button_text_save_filter"
		);

		//jc_button->force_field_right = 32.0f;
		jc_button->add_default_description_by_key("description_save_loot_filter");
		jc_button->add_hotkey(GLFW_KEY_LEFT_CONTROL, GLFW_KEY_S);
		jc_button->force_field_right = 8.0f;
		top_section_left_part->add_button_to_working_group(jc_button);
		jc_button->can_be_stretched = true;
		//////////////////////////////////////////////////////







		//////////////////////////////////////////////////////
		jc_button = new EntityButtonForFilterBlock();

		jc_button->make_as_default_button_with_icon_and_localisation_by_key
		(
			new ERegionGabarite(110.0f, 34.0f),
			top_section_left_part,
			&EDataActionCollection::action_multisave_lootfilter,
			NS_EGraphicCore::load_from_textures_folder("buttons/button_multisave"),
			"button_text_multisave_filter"
		);

		//jc_button->force_field_right = 32.0f;
		jc_button->add_default_description_by_key("description_multisave_loot_filter");
		jc_button->add_hotkey(GLFW_KEY_LEFT_CONTROL, GLFW_KEY_A);

		top_section_left_part->add_button_to_working_group(jc_button);
		jc_button->can_be_stretched = true;
		//////////////////////////////////////////////////////

		if (NSW_APRIL_FOOL)
		{
			//////////////////////////////////////////////////////
			EntityButtonButtonGroupActivator* activator_bulldozer = new EntityButtonButtonGroupActivator();

			activator_bulldozer->make_as_default_button_with_icon
			(
				new ERegionGabarite(45.0f, 45.0f),
				top_section_left_part,
				&EDataActionCollection::action_set_button_group_as_active,
				NS_EGraphicCore::load_from_textures_folder("buttons/button_bulldozer_ear")
			);

			activator_bulldozer->target_group = pointer_to_joke_AD;
			activator_bulldozer->add_hotkey(GLFW_KEY_LEFT_CONTROL, GLFW_KEY_J);
			activator_bulldozer->force_field_right = 4.0f;
			top_section_left_part->add_button_to_working_group(activator_bulldozer);
			//////////////////////////////////////////////////////
			// 
			// 
			//////////////////////////////////////////////////////

			//////////////////////////////////////////////////////
			jc_button = new EntityButtonForFilterBlock();

			jc_button->make_as_default_button_with_icon
			(
				new ERegionGabarite(45.0f, 45.0f),
				top_section_left_part,
				nullptr,
				NS_EGraphicCore::load_from_textures_folder("buttons/button_finger_watch_mode")
			);

			jc_button->force_field_right = 4.0f;
			top_section_left_part->add_button_to_working_group(jc_button);
			//////////////////////////////////////////////////////

			//////////////////////////////////////////////////////
			jc_button = new EntityButtonForFilterBlock();

			jc_button->make_as_default_button_with_icon
			(
				new ERegionGabarite(45.0f, 45.0f),
				top_section_left_part,
				nullptr,
				NS_EGraphicCore::load_from_textures_folder("buttons/button_snail_and_screwdriver")
			);

			jc_button->force_field_right = 4.0f;
			top_section_left_part->add_button_to_working_group(jc_button);
			//////////////////////////////////////////////////////
			//////////////////////////////////////////////////////

			//////////////////////////////////////////////////////
			jc_button = new EntityButtonForFilterBlock();

			jc_button->make_as_default_button_with_icon
			(
				new ERegionGabarite(45.0f, 45.0f),
				top_section_left_part,
				nullptr,
				NS_EGraphicCore::load_from_textures_folder("buttons/button_ghost_at_scope")
			);

			jc_button->force_field_right = 4.0f;
			top_section_left_part->add_button_to_working_group(jc_button);
			//////////////////////////////////////////////////////

			//////////////////////////////////////////////////////
			jc_button = new EntityButtonForFilterBlock();

			jc_button->make_as_default_button_with_icon
			(
				new ERegionGabarite(45.0f, 45.0f),
				top_section_left_part,
				nullptr,
				NS_EGraphicCore::load_from_textures_folder("buttons/button_currency_crane")
			);

			jc_button->force_field_right = 4.0f;
			top_section_left_part->add_button_to_working_group(jc_button);
			//////////////////////////////////////////////////////
			//////////////////////////////////////////////////////

			//////////////////////////////////////////////////////
			jc_button = new EntityButtonForFilterBlock();

			jc_button->make_as_default_button_with_icon
			(
				new ERegionGabarite(45.0f, 45.0f),
				top_section_left_part,
				nullptr,
				NS_EGraphicCore::load_from_textures_folder("buttons/button_time_push_to_paper_clip")
			);

			jc_button->force_field_right = 32.0f;
			top_section_left_part->add_button_to_working_group(jc_button);
			//////////////////////////////////////////////////////
		}







		//////////////////////////////////////////////////////
		//button_activator = new EntityButtonButtonGroupActivator();

		//button_activator->make_as_default_button_with_icon
		//(
		//	new ERegionGabarite(45.0f, 45.0f),
		//	top_section,
		//	&EDataActionCollection::action_open_custom_sound_list,
		//	NS_EGraphicCore::load_from_textures_folder("buttons/button_custom_sound")
		//);
		////button_activator->target_group = EWindowMain::world_parameters;
		//top_section->add_button_to_working_group(button_activator);
		//////////////////////////////////////////////////////



		//////////////////////////////////////////////////////
		EntityButtonButtonGroupActivator* button_activator = new EntityButtonButtonGroupActivator();

		button_activator->make_as_default_button_with_icon_and_localisation_by_key
		(
			new ERegionGabarite(140.0f, 34.0f),
			top_section_mid_part,
			&EDataActionCollection::action_open_and_refresh_loot_simulator,
			NS_EGraphicCore::load_from_textures_folder("buttons/button_open_loot_simulator"),
			"button_text_loot_simulator"
		);
		button_activator->force_field_left = 16.0f;
		button_activator->add_default_description_by_key("description_open_loot_simulator");
		button_activator->add_hotkey(GLFW_KEY_LEFT_CONTROL, GLFW_KEY_L);
		//button_activator->target_group = EWindowMain::loot_simulator_button_group;
		top_section_mid_part->add_button_to_working_group(button_activator);
		//////////////////////////////////////////////////////

		//////////////////////////////////////////////////////
		button_activator = new EntityButtonButtonGroupActivator();

		button_activator->make_as_default_button_with_icon_and_localisation_by_key
		(
			new ERegionGabarite(140.0f, 34.0f),
			top_section_mid_part,
			&EDataActionCollection::action_open_and_refresh_error_list,
			NS_EGraphicCore::load_from_textures_folder("buttons/button_error_list"),
			"button_text_error_list"
		);
		button_activator->force_field_left = 16.0f;
		button_activator->add_default_description_by_key("description_open_loot_simulator");
		button_activator->add_hotkey(GLFW_KEY_LEFT_CONTROL, GLFW_KEY_E);
		//button_activator->target_group = EWindowMain::loot_simulator_button_group;
		top_section_mid_part->add_button_to_working_group(button_activator);
		//////////////////////////////////////////////////////










		//////////////////////////////////////////////////////
		button_activator = new EntityButtonButtonGroupActivator();

		button_activator->make_as_default_button_with_icon_and_localisation_by_key
		(
			new ERegionGabarite(140.0f, 34.0f),
			top_section_mid_part,
			&EDataActionCollection::action_set_button_group_as_active,
			NS_EGraphicCore::load_from_textures_folder("buttons/button_world_parameters"),
			"button_text_world_parameters"
		);
		button_activator->add_default_description_by_key("description_open_world_parameters");
		button_activator->add_hotkey(GLFW_KEY_LEFT_CONTROL, GLFW_KEY_W);
		button_activator->target_group = EWindowMain::world_parameters;
		top_section_right_part->add_button_to_working_group(button_activator);
		//////////////////////////////////////////////////////



		//////////////////////////////////////////////////////
		{
			EntityButtonButtonGroupActivator* button_activator = new EntityButtonButtonGroupActivator();

			button_activator->make_as_default_button_with_icon_and_localisation_by_key
			(
				new ERegionGabarite(140.0f, 34.0f),
				top_section_right_part,
				&EDataActionCollection::action_set_button_group_as_active,
				NS_EGraphicCore::load_from_textures_folder("buttons/button_styles"),
				"button_text_styles"
			);
			button_activator->add_hotkey(GLFW_KEY_LEFT_CONTROL, GLFW_KEY_G);
			button_activator->target_group = EWindowMain::style_list_group;
			top_section_right_part->add_button_to_working_group(button_activator);

		}
		//////////////////////////////////////////////////////






		/////////////		OPEN INFO WINDOW		///////////////////////
		button_activator = new EntityButtonButtonGroupActivator();

		button_activator->make_as_default_button_with_icon_and_localisation_by_key
		(
			new ERegionGabarite(140.0f, 34.0f),
			top_section_right_part,
			&EDataActionCollection::action_set_button_group_as_active,
			NS_EGraphicCore::load_from_textures_folder("buttons/button_info"),
			"button_text_info"
		);
		button_activator->add_default_description_by_key("description_open_info_window");
		button_activator->target_group = EWindowMain::info_button_group;
		button_activator->add_hotkey(GLFW_KEY_LEFT_CONTROL, GLFW_KEY_I);
		button_activator->force_field_right = 16.0f;
		top_section_right_part->add_button_to_working_group(button_activator);
		//////////////////////////////////////////////////////

		/////////////		OPEN DEBUG WINDOW		///////////////////////
		button_activator = new EntityButtonButtonGroupActivator();

		button_activator->make_as_default_button_with_icon_and_localisation_by_key
		(
			new ERegionGabarite(140.0f, 34.0f),
			top_section_right_part,
			&EDataActionCollection::action_set_button_group_as_active,
			NS_EGraphicCore::load_from_textures_folder("buttons/button_debug"),
			"button_text_debug"
		);
		//button_activator->target_group = DebugNamespace::NSW_pointer_to_debug_window;
		header_line->pointer_to_debug_button = button_activator;
		button_activator->add_default_description_by_key("description_open_debug_window");
		button_activator->add_hotkey(GLFW_KEY_LEFT_CONTROL, GLFW_KEY_D);

		//button_activator->force_field_right = 16.0f;
		top_section_right_part->add_button_to_working_group(button_activator);
		//////////////////////////////////////////////////////



		//LOCALISATION RU
		//////////////////////////////////////////////////////
		EntityButtonLocalisationSelector*
			button_RU = new EntityButtonLocalisationSelector();

		button_RU->make_as_default_button_with_icon
		(
			new ERegionGabarite(34.0f, 34.0f),
			top_section_right_part,
			&EDataActionCollection::action_change_localisation,
			NS_EGraphicCore::load_from_textures_folder("buttons/button_localisation_RU")
		);
		button_RU->stored_localisation = NSW_localisation_RU;

		top_section_right_part->add_button_to_working_group(button_RU);
		//////////////////////////////////////////////////////


		//LOCALISATION EN
		//////////////////////////////////////////////////////
		EntityButtonLocalisationSelector*
			button_EN = new EntityButtonLocalisationSelector();

		button_EN->make_as_default_button_with_icon
		(
			new ERegionGabarite(34.0f, 34.0f),
			top_section_right_part,
			&EDataActionCollection::action_change_localisation,
			NS_EGraphicCore::load_from_textures_folder("buttons/button_localisation_EN")
		);
		button_EN->stored_localisation = NSW_localisation_EN;



		top_section_right_part->add_button_to_working_group(button_EN);
		//////////////////////////////////////////////////////

		//FILTER BLOCK TABS
		//////////////////////////////////////////////////////
		ELocalisationText l_text;
		for (int i = 0; i < 5; i++)
		{
			EntityButtonFilterBlockTab*
				tab_button = new EntityButtonFilterBlockTab();

			l_text.localisations[NSW_localisation_EN] = "Filter tab #" + std::to_string(i);
			l_text.localisations[NSW_localisation_RU] = "Закладка #" + std::to_string(i);

			tab_button->make_default_button_with_unedible_text
			(
				new ERegionGabarite(200.0f, 26.0f),
				bottom_tab_section,
				&EDataActionCollection::action_select_this_tab,
				l_text
			);

			tab_button->main_text_area->localisation_text = l_text;


			tab_button->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_select_this_button);

			tab_button->tab_id = i;
			tab_button->target_filter_editor = filter_block_tabs[i];

			//tab_button->add_close_circle(nullptr);

			bottom_tab_section->add_button_to_working_group(tab_button);



			if (i == 0) { bottom_tab_section->selected_button = tab_button; }
		}
		//////////////////////////////////////////////////////


		button_group_list.push_back(main_button_group);

		//EButtonGroup::refresh_button_group(main_button_group);

		main_button_group->need_refresh = true;
	}



	//confirm open autogenerated loot filter
	if (true)
	{
		confirm_deletion_group = new EButtonGroupConfirmActionDelete(new ERegionGabarite(400.0f, 150.0f));
		confirm_deletion_group->unique_id = "global confirm group";
		confirm_deletion_group->init_as_confirm_decline_group(EWindowMain::link_to_main_window);
		confirm_deletion_group->parent_window = this;

		confirm_deletion_group->pointer_to_description_text_area->localisation_text.localisations[NSW_localisation_EN] = "You really want delete this?";
		confirm_deletion_group->pointer_to_description_text_area->localisation_text.localisations[NSW_localisation_RU] = "Вы действителбно хотите это удалить?";
		confirm_deletion_group->pointer_to_description_text_area->update_localisation();


		confirm_deletion_group->pointer_to_confirm_button->main_text_area->localisation_text.localisations[NSW_localisation_EN] = "Yes";
		confirm_deletion_group->pointer_to_confirm_button->main_text_area->localisation_text.localisations[NSW_localisation_RU] = "Да";
		confirm_deletion_group->pointer_to_confirm_button->main_text_area->update_localisation();
		confirm_deletion_group->pointer_to_confirm_button->stored_action = &EDataActionCollection::action_confirm_open_autogenerated_loot_filter;

		confirm_deletion_group->pointer_to_decline_button->main_text_area->localisation_text.localisations[NSW_localisation_EN] = "Cancel";
		confirm_deletion_group->pointer_to_decline_button->main_text_area->localisation_text.localisations[NSW_localisation_RU] = "Отмена";
		confirm_deletion_group->pointer_to_decline_button->main_text_area->update_localisation();
		confirm_deletion_group->pointer_to_decline_button->stored_action = &EDataActionCollection::action_close_root_group;

		button_group_list.push_back(confirm_deletion_group);
		confirm_deletion_group->need_refresh = true;
		//EButtonGroup::refresh_button_group(main_button_group);
	}



	//confirm open autogenerated loot filter
	if (true)
	{
		confirm_load_autogenerated_block = new EButtonGroupConfirmActionOpenAutogeneratedLootFilter(new ERegionGabarite(500.0f, 200.0f));
		confirm_load_autogenerated_block->unique_id = "global confirm group";

		confirm_load_autogenerated_block->init_as_confirm_decline_group(EWindowMain::link_to_main_window);
		confirm_load_autogenerated_block->parent_window = this;

		confirm_load_autogenerated_block->pointer_to_description_text_area->localisation_text.localisations[NSW_localisation_EN] = "It's automatically generated loot-filter, and we dont recommend edit him 'manually'.";
		confirm_load_autogenerated_block->pointer_to_description_text_area->localisation_text.localisations[NSW_localisation_RU] = "Это автоматически сгенерированный лут-фильтр, и мы не рекомендуем редактировать его 'вручную'.";
		confirm_load_autogenerated_block->pointer_to_description_text_area->update_localisation();


		confirm_load_autogenerated_block->pointer_to_confirm_button->main_text_area->localisation_text.localisations[NSW_localisation_EN] = "Open";
		confirm_load_autogenerated_block->pointer_to_confirm_button->main_text_area->localisation_text.localisations[NSW_localisation_RU] = "Открыть";
		confirm_load_autogenerated_block->pointer_to_confirm_button->main_text_area->update_localisation();
		confirm_load_autogenerated_block->pointer_to_confirm_button->stored_action = &EDataActionCollection::action_confirm_open_autogenerated_loot_filter;

		confirm_load_autogenerated_block->pointer_to_decline_button->main_text_area->localisation_text.localisations[NSW_localisation_EN] = "Cancel";
		confirm_load_autogenerated_block->pointer_to_decline_button->main_text_area->localisation_text.localisations[NSW_localisation_RU] = "Отмена";
		confirm_load_autogenerated_block->pointer_to_decline_button->main_text_area->update_localisation();
		confirm_load_autogenerated_block->pointer_to_decline_button->stored_action = &EDataActionCollection::action_close_root_group;

		button_group_list.push_back(confirm_load_autogenerated_block);
		confirm_load_autogenerated_block->need_refresh = true;
		//EButtonGroup::refresh_button_group(main_button_group);
	}


	//FAST MEGGASE BACKGROUND LOADING
	if (true)
	{
		ELocalisationText ltext;;
		ltext.localisations[NSW_localisation_EN] = "Background loading process.\nPerfomance may be affected";
		ltext.localisations[NSW_localisation_RU] = "Фоновая загрузка ресурсов.\nНа время загрузки производительность может быть снижена";

		EButtonGroupFastMessage*
			fast_message_background_loading = new EButtonGroupFastMessage(new ERegionGabarite(500.0f, 40.0f));
		background_loading_info = fast_message_background_loading;

		fast_message_background_loading->exist_time = 10.0f;
		fast_message_background_loading->delete_when_expire = true;
		fast_message_background_loading->init_as_fast_message(this, ELocalisationText::get_localisation_by_key("fast_message_background_loading"));
		//fast_message_background_loading->can_change_position_in_vector = false;
		fast_message_background_loading->need_refresh = true;
		button_group_list.push_back(fast_message_background_loading);
		fast_message_background_loading->move_to_foreground_and_center();
	}


	NS_EGraphicCore::refresh_autosize_groups(this);



	if (first_time_open)
	{
		style_list_group->activate_move_to_foreground_and_center();
	}



}

void EWindowMain::register_loot_filter_list_group()
{
	{
		EButtonGroupLootFilterList*
			main_button_group = new EButtonGroupLootFilterList(new ERegionGabarite(512.0f, 256.0f, 1020.0f, 512.0f));
		main_button_group->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DARKEN, bgroup_with_slider);

		EWindowMain::existing_loot_filter_list = main_button_group;

		auto whole_loot_filter_group = static_cast<EButtonGroupLootFilterList*>(main_button_group);


		main_button_group->parent_window = this;

		main_button_group->root_group = main_button_group;
		main_button_group->can_be_moved = true;
		main_button_group->can_resize_to_workspace_size_x = true;
		main_button_group->can_resize_to_workspace_size_y = true;

		main_button_group->child_align_mode = ChildAlignMode::ALIGN_VERTICAL;

		EButtonGroup* loot_filters_list_workspace_part = main_button_group->add_close_group_and_return_workspace_group
		(
			new ERegionGabarite(1.0f, 20.0f),
			EGUIStyle::active_style
		)->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_dynamic_autosize);
		main_button_group->add_caption_by_localistation_key("window_header_loot_filters_list");
		///////////////		LOOT-FILTERS LIST PART		///////////////
		EButtonGroup* loot_filter_list_part = loot_filters_list_workspace_part->add_group
		(
			EButtonGroup::create_default_button_group
			(
				new ERegionGabarite(1.0f, 1.0f),
				EGUIStyle::active_style
			)->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_dynamic_autosize)
		);
		loot_filter_list_part->button_size_x_override = 300.0f;
		loot_filter_list_part->group_have_button_lines = true;

		///////////////		SEARCH INPUT PART		///////////////
		EButtonGroup*
			search_input_part = loot_filters_list_workspace_part->add_group
			(
				EButtonGroup::create_default_button_group
				(
					new ERegionGabarite(1.0f, 32.0f),
					EGUIStyle::active_style
				)->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_static_autosize)
			);
		search_input_part->button_align_type = ButtonAlignType::BUTTON_ALIGN_MID;



		EntityButtonMultiSearch*
			button_multisearch = new EntityButtonMultiSearch();
		button_multisearch->make_default_button_with_edible_text
		(
			new ERegionGabarite(300.0f, 28.0f),
			search_input_part,
			nullptr,
			""
		);

		button_multisearch->main_text_area->gray_text = ELocalisationText();
		button_multisearch->main_text_area->gray_text.localisations[NSW_localisation_EN] = "Search by name...";
		button_multisearch->main_text_area->gray_text.localisations[NSW_localisation_RU] = "Поиск по названию...";

		button_multisearch->target_group_list.push_back(loot_filter_list_part);
		button_multisearch->main_text_area->action_on_change_text.push_back(&EDataActionCollection::action_type_text_multiblock_searcher);
		button_multisearch->can_be_stretched = true;
		button_multisearch->max_stretch_factor = 2.0f;
		search_input_part->add_button_to_working_group(button_multisearch);


		/// set data parameters
		whole_loot_filter_group->part_with_list = loot_filter_list_part;





		//VARIANT ROUTER BUTTON
		EntityButtonVariantRouter*
			button_variant_router = new EntityButtonVariantRouter;
		search_input_part->add_button_to_working_group(button_variant_router);
		main_button_group->pointer_to_filtration_router = button_variant_router;

		button_variant_router->make_as_default_router_variant_button(new ERegionGabarite(256.0f, 28.0f));
		button_variant_router->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_show_hide_autogenerated_loot_filters);

		//RV
		{
			RouterVariant* router_variant = new RouterVariant();
			ELocalisationText local_text;

			local_text.localisations[NSW_localisation_EN] = "Only originals";
			local_text.localisations[NSW_localisation_RU] = "Только оригиналы";
			router_variant->router_localisation = local_text;

			router_variant->text_color = new HSVRGBAColor();
			router_variant->text_color->set_color_RGBA(0.6f, 0.5f, 0.4f, 1.0f);

			button_variant_router->router_variant_list.push_back(router_variant);
		}

		//RV
		{
			RouterVariant* router_variant = new RouterVariant();
			ELocalisationText local_text;

			local_text.localisations[NSW_localisation_EN] = "All loot-filters";
			local_text.localisations[NSW_localisation_RU] = "Все лут-фильтры";
			router_variant->router_localisation = local_text;

			router_variant->text_color = new HSVRGBAColor();
			router_variant->text_color->set_color_RGBA(1.0f, 0.8f, 0.6f, 1.0f);

			button_variant_router->router_variant_list.push_back(router_variant);
		}


		button_variant_router->select_variant(0);





		//





		load_loot_filter_list();

		/*for (int i = 0; i < 2; i++)
		{
		EntityButton* but = EntityButton::make_default_button_with_unedible_text
		(
		new ERegionGabarite(128.0f, 32.0f),
		loot_filter_list_part,
		nullptr,
		"ZZZ"
		);
		loot_filter_list_part->button_list.push_back(but);
		}*/

		button_group_list.push_back(main_button_group);

		//EButtonGroup::refresh_button_group(main_button_group);
		main_button_group->need_refresh = true;

		main_button_group->move_to_foreground_and_center();
	}
}

std::vector<RawExplicitDataEntity> raw_data_entity_list;

void EWindowMain::parse_raw_explicit_table()
{
	std::ifstream file;
	std::string str;

	file.open("data/RawExplicitsTable.txt");

	RawExplicitDataEntity
		new_raw_entity;

	EDataTag
		new_tag;

	std::string
		raw_mod_name_EN, raw_mod_name_RU, raw_class_name, raw_tier, raw_tag_and_description_EN, raw_tag_and_description_RU, raw_required_level;

	std::string
		splitted_description_EN, splitted_description_RU;

	std::string
		icon_name;

	int
		duplicate_id = -1;

	std::string
		text_buffer;

	while (std::getline(file, str))
	{
		EStringUtils::split_line_to_array(str, true);



		if (str[0] != '\t')
		{
			new_raw_entity = RawExplicitDataEntity();
			new_tag = EDataTag();


			//read raw data
			raw_class_name = EStringUtils::string_array[0];
			raw_tier = EStringUtils::string_array[1];

			raw_mod_name_EN = EStringUtils::string_array[2];
			raw_required_level = EStringUtils::string_array[3];//need split
			raw_tag_and_description_EN = EStringUtils::string_array[4];

			raw_mod_name_RU = EStringUtils::string_array[5];

			//6, duplicate req level
			raw_tag_and_description_RU = EStringUtils::string_array[7];

			icon_name = EStringUtils::string_array[8];

			splitted_description_EN = "";


			//SPLIT TAGS 


			bool
				number_mode = false;

			for (int k = 0; k < 2; k++)
			{
				number_mode = false;
				text_buffer = "";

				std::string
					target_text = (k == 0) ? (raw_tag_and_description_EN) : (raw_tag_and_description_RU);

				for (int i = 0; i < target_text.length(); i++)
				{
					char
						ch = target_text[i];

					if ((ch >= 48) && (ch <= 57))
					{
						//if (k == 0) { new_raw_entity.tag_type_list.push_back(text_buffer); }
						number_mode = true;
					}

					if
						(
							(ch != ',')
							&&
							(!number_mode)
							)
					{
						text_buffer += ch;
					}
					else
						if (text_buffer != "")
						{
							if (k == 0) { new_raw_entity.tag_type_list.push_back(text_buffer); }

							text_buffer = "";
						}

					ch = ch;

					if ((ch == ' ') && (number_mode))
					{

						if (k == 0)
						{
							splitted_description_EN = target_text.substr(i + 1, target_text.length() - i - 1);
						}
						else
						{
							splitted_description_RU = target_text.substr(i + 1, target_text.length() - i - 1);
						}

						break;
					}
				}
			}

			duplicate_id = -1;
			for (int i = 0; i < raw_data_entity_list.size(); i++)
			{
				RawExplicitDataEntity*
					raw_data_entity_pointer = &(raw_data_entity_list[i]);

				if
					(
						(raw_data_entity_pointer->mod_description.localisations[NSW_localisation_EN] == splitted_description_EN)
						&&
						(raw_data_entity_pointer->tier == raw_tier)
						&&
						(raw_data_entity_pointer->mod_name.localisations[NSW_localisation_EN] == raw_mod_name_EN)
						)
				{
					duplicate_id = i;

					break;
				}
			}

			//no duplicates, unique data_entity
			if (duplicate_id == -1)
			{
				new_tag.tag_name.set_ID_by_string(EStringUtils::string_array[0]);

				new_raw_entity.mod_name.localisations[NSW_localisation_EN] = raw_mod_name_EN;
				new_raw_entity.mod_name.localisations[NSW_localisation_RU] = raw_mod_name_RU;

				new_raw_entity.mod_description.localisations[NSW_localisation_EN] = splitted_description_EN;
				new_raw_entity.mod_description.localisations[NSW_localisation_RU] = splitted_description_RU;

				new_raw_entity.tier = raw_tier;
				new_raw_entity.required_level = raw_required_level;
				new_raw_entity.class_list.push_back(raw_class_name);

				new_raw_entity.icon_text = icon_name;


				raw_data_entity_list.push_back(new_raw_entity);
			}
			else
			{
				raw_data_entity_list[duplicate_id].class_list.push_back(raw_class_name);
			}


		}


	}

	file.close();






	std::ofstream writabro;
	std::string buffer = "";

	writabro.open("data/ParsedDataEntity.txt");
	for (int i = 0; i < raw_data_entity_list.size(); i++)
	{
		RawExplicitDataEntity*
			raw_data_entity_pointer = &(raw_data_entity_list[i]);


		writabro << "ADD_NEW_DATA_ENTITY" << std::endl;
		writabro << '\t' << "[tag]\"data type\"\t[value]\"Explicit\"" << std::endl;
		writabro << std::endl;

		writabro << '\t' << "[tag]\"icon path\"\t[value]\"" << raw_data_entity_pointer->icon_text << "\"" << std::endl;
		writabro << std::endl;

		writabro << '\t' << "[tag]\"base name\"\t[value]\"" << raw_data_entity_pointer->mod_name.localisations[NSW_localisation_EN] << "\"" << std::endl;

		writabro << '\t' << "[tag]\"name EN\"\t[value]\"[T" << std::to_string(raw_data_entity_pointer->tier) << "]" << raw_data_entity_pointer->mod_description.localisations[NSW_localisation_EN] << "\"" << std::endl;
		writabro << '\t' << "[tag]\"name RU\"\t[value]\"[T" << std::to_string(raw_data_entity_pointer->tier) << "]" << raw_data_entity_pointer->mod_description.localisations[NSW_localisation_RU] << "\"" << std::endl;
		writabro << std::endl;

		writabro << '\t' << "[tag]\"tier\"\t[value]\"" << raw_data_entity_pointer->tier << "\"" << std::endl;
		writabro << '\t' << "[tag]\"required level\"\t[value]\"" << raw_data_entity_pointer->required_level << "\"" << std::endl;
		writabro << std::endl;

		for (int j = 0; j < raw_data_entity_pointer->class_list.size(); j++)
		{
			writabro << '\t' << "[tag]\"suitable class\"\t[value]\"" << raw_data_entity_pointer->class_list[j] << "\"" << std::endl;
		}
		writabro << std::endl;

		for (int j = 0; j < raw_data_entity_pointer->tag_type_list.size(); j++)
		{
			writabro << '\t' << "[tag]\"attribute tag\"\t[value]\"" << raw_data_entity_pointer->tag_type_list[j] << "\"" << std::endl;
		}
		writabro << std::endl;




	}
	writabro.close();
}

void EWindowMain::load_config_from_disc()
{
	if (std::filesystem::exists(path_of_exile_folder + "DaDEditorConfig.config"))
	{

		first_time_open = false;

		std::ifstream file;
		std::string str;

		file.open(path_of_exile_folder + "DaDEditorConfig.config");

		int version_id = 0;

		while (std::getline(file, str))
		{
			EStringUtils::split_line_to_array(str);


			if (EStringUtils::string_array[0] == "active_localisation")
			{
				ELocalisationText::active_localisation = EStringUtils::safe_convert_string_to_number(EStringUtils::string_array[1], 0, NSW_languages_count);
			}

			if (EStringUtils::string_array[0] == "selected_style")
			{
				for (int i = 0; i < EGUIStyle::style_list.size(); i++)
				{
					if (EGUIStyle::style_list[i]->localisation_text.base_name == EStringUtils::string_array[1])
					{
						EGUIStyle::active_style = EGUIStyle::style_list[i];

						break;
					}
				}

			}

			if (EStringUtils::string_array[0] == "color_collection")
			{
				//for (HRA_color_collection* color_collection : Helper::registered_color_list)
				HRA_color_collection*
					color_collection = new HRA_color_collection();
				Helper::registered_color_list.push_back(color_collection);

				color_collection->target_color.r = EStringUtils::safe_convert_string_to_number(EStringUtils::string_array[1], 0, 255) / 255.0f;
				color_collection->target_color.g = EStringUtils::safe_convert_string_to_number(EStringUtils::string_array[2], 0, 255) / 255.0f;
				color_collection->target_color.b = EStringUtils::safe_convert_string_to_number(EStringUtils::string_array[3], 0, 255) / 255.0f;
				color_collection->target_color.a = EStringUtils::safe_convert_string_to_number(EStringUtils::string_array[4], 0, 255) / 255.0f;

				Helper::rgb2hsv(&color_collection->target_color);
				for (int i = 0; i < NSW_languages_count; i++)
				{
					color_collection->localised_name.localisations[i] = EStringUtils::string_array[5 + i];
				}

			}

			if ((EStringUtils::string_array[0] == "version_name_active") || (EStringUtils::string_array[0] == "version_name_inactive"))
			{
				LootFilterVersionPattern::NSW_LOOT_FILTER_VERSION_ACTIVE[version_id] = (EStringUtils::string_array[0] == "version_name_active");


				LootFilterVersionPattern::NSW_LOOT_VERSION_NAME[version_id] = (EStringUtils::string_array[1] != "*EMPTY*") ? (EStringUtils::string_array[1]) : ("");

				version_id++;
			}
		}

		file.close();
	}
	else
	{
		first_time_open = true;

	}
}

void EWindowMain::load_config_from_disc_for_filter_version()
{
	if (std::filesystem::exists(path_of_exile_folder + "DaDEditorConfig[loot_versions].config"))
	{

		have_no_loot_version_config = false;

		std::ifstream file;
		std::string str;

		file.open(path_of_exile_folder + "DaDEditorConfig[loot_versions].config");

		int version_id = 0;

		while (std::getline(file, str))
		{
			EStringUtils::split_line_to_array(str);

			if ((EStringUtils::string_array[0] == "version_name_active") || (EStringUtils::string_array[0] == "version_name_inactive"))
			{
				LootFilterVersionPattern::NSW_LOOT_FILTER_VERSION_ACTIVE[version_id] = (EStringUtils::string_array[0] == "version_name_active");


				LootFilterVersionPattern::NSW_LOOT_VERSION_NAME[version_id] = (EStringUtils::string_array[1] != "*EMPTY*") ? (EStringUtils::string_array[1]) : ("");

				version_id++;
			}
		}
	}
	else
	{
		have_no_loot_version_config = true;
	}
}

void EWindowMain::load_config_from_disc_for_filter_version_patterns()
{
	if (std::filesystem::exists(path_of_exile_folder + "DaDEditorConfig[loot_version_patterns].config"))
	{

		have_no_loot_version_pattern_config = false;

		std::ifstream file;
		std::string str;

		file.open(path_of_exile_folder + "DaDEditorConfig[loot_version_patterns].config");

		int version_id = 0;

		LootFilterVersionPattern::PatternStruct*
			last_pattern = nullptr;


		while (std::getline(file, str))
		{
			EStringUtils::split_line_to_array(str);

			std::string
				otebis = EStringUtils::string_array[0];


			if (otebis == "CREATE_NEW_LOOT_VERSION_PATTERN")
			{
				last_pattern = new LootFilterVersionPattern::PatternStruct();
				LootFilterVersionPattern::registered_loot_filter_version_patterns.push_back(last_pattern);
				EInputCore::logger_param("!", LootFilterVersionPattern::registered_loot_filter_version_patterns.size());
			}
			else
				if (otebis == "localised_name")
				{
					last_pattern->key_for_localisation = EStringUtils::string_array[1];
					last_pattern->localised_name = ELocalisationText::get_localisation_by_key(EStringUtils::string_array[1]);
				}
				else
					if (otebis == "custom_name")
					{
						last_pattern->key_for_localisation = EStringUtils::string_array[1];
						last_pattern->localised_name = ELocalisationText::generate_localization_with_base_name(EStringUtils::string_array[1]);
					}
					else
						if (otebis == "selected_continue_mode")
						{
							last_pattern->continue_mode = EStringUtils::safe_convert_string_to_number(EStringUtils::string_array[1], 0, 2);
						}
						else
							if (otebis == "selected_show_hide_mode")
							{
								last_pattern->show_hide_mode = EStringUtils::safe_convert_string_to_number(EStringUtils::string_array[1], 0, 2);
							}
							else
								if (otebis == "focus_multiplier")
								{
									last_pattern->focus_multiplier = std::stof(EStringUtils::string_array[1]);
								}
								else
									if (otebis == "is_default")
									{
										last_pattern->is_default = true;
									}
									else
										if (otebis == "disable_minimap_element")
										{
											last_pattern->disable_minimap_elements = true;
										}
										else
											if (otebis == "disable_sound")
											{
												last_pattern->disable_sound = true;
											}
											else
												if (otebis == "full_ignore_mode")
												{
													last_pattern->full_ignore_mode = true;
												}
												else
													if (otebis == "text_color")
													{
														last_pattern->default_text_color.r = ((float)EStringUtils::safe_convert_string_to_number(EStringUtils::string_array[1], 0, 255)) / 255.0f;
														last_pattern->default_text_color.g = ((float)EStringUtils::safe_convert_string_to_number(EStringUtils::string_array[2], 0, 255)) / 255.0f;
														last_pattern->default_text_color.b = ((float)EStringUtils::safe_convert_string_to_number(EStringUtils::string_array[3], 0, 255)) / 255.0f;
														last_pattern->default_text_color.a = ((float)EStringUtils::safe_convert_string_to_number(EStringUtils::string_array[4], 0, 255)) / 255.0f;
													}
													else
														if (otebis == "icon_texture")
														{
															last_pattern->icon = NS_EGraphicCore::load_from_textures_folder("loot_versions/" + EStringUtils::string_array[1]);
														}







		}
	}
	else
	{
		have_no_loot_version_pattern_config = true;
	}
}

void EWindowMain::preload_textures()
{
	NS_DefaultGabarites::texture_example_text_bg_for_preview_box = NS_EGraphicCore::put_texture_to_atlas("data/textures/example_text_bg.png", NS_EGraphicCore::default_texture_atlas);
	NS_DefaultGabarites::texture_example_text_for_preview_box = NS_EGraphicCore::put_texture_to_atlas("data/textures/example_text.png", NS_EGraphicCore::default_texture_atlas);
	NS_DefaultGabarites::texture_example_text_for_preview_box_half = NS_EGraphicCore::put_texture_to_atlas("data/textures/example_text_half.png", NS_EGraphicCore::default_texture_atlas);


	NS_DefaultGabarites::texture_loot_version_full_ignore = NS_EGraphicCore::load_from_textures_folder("loot_versions/loot_version_full_ignore");
	NS_DefaultGabarites::texture_loot_version_hide = NS_EGraphicCore::load_from_textures_folder("loot_versions/loot_version_hide");
	NS_DefaultGabarites::texture_loot_version_ignore = NS_EGraphicCore::load_from_textures_folder("loot_versions/loot_version_strong_ignore");
	NS_DefaultGabarites::texture_loot_version_default = NS_EGraphicCore::load_from_textures_folder("loot_versions/loot_version_default");
	NS_DefaultGabarites::texture_loot_version_focus = NS_EGraphicCore::load_from_textures_folder("loot_versions/loot_version_strong_focus");


	NS_DefaultGabarites::texture_show_hide_visual_editor = NS_EGraphicCore::load_from_textures_folder("buttons/button_show_hide_visual_editor");
	NS_DefaultGabarites::texture_show_hide_visual_editor_deactivate = NS_EGraphicCore::load_from_textures_folder("buttons/button_show_hide_visual_editor_deactivate");

	NS_DefaultGabarites::texture_button_plus = NS_EGraphicCore::load_from_textures_folder("buttons/button_plus");

	NS_DefaultGabarites::texture_button_move_up = NS_EGraphicCore::load_from_textures_folder("buttons/button_move_up");
	NS_DefaultGabarites::texture_button_move_down = NS_EGraphicCore::load_from_textures_folder("buttons/button_move_down");
	NS_DefaultGabarites::texture_button_move = NS_EGraphicCore::load_from_textures_folder("buttons/button_move");
	NS_DefaultGabarites::texture_button_move_small = NS_EGraphicCore::load_from_textures_folder("buttons/button_move_small");

	NS_DefaultGabarites::texture_button_cut = NS_EGraphicCore::load_from_textures_folder("buttons/button_cut");

	NS_DefaultGabarites::texture_button_remove_filter_block = NS_EGraphicCore::load_from_textures_folder("buttons/button_remove_filter_block");

	NS_DefaultGabarites::texture_ray = NS_EGraphicCore::load_from_textures_folder("ray");

	NS_DefaultGabarites::texture_minimap_shape_circle = NS_EGraphicCore::load_from_textures_folder("minimap_shapes/minimap_icon_shape[circle]");
	NS_DefaultGabarites::texture_minimap_shape_diamond = NS_EGraphicCore::load_from_textures_folder("minimap_shapes/minimap_icon_shape[diamond]");
	NS_DefaultGabarites::texture_minimap_shape_hexagon = NS_EGraphicCore::load_from_textures_folder("minimap_shapes/minimap_icon_shape[hexagon]");
	NS_DefaultGabarites::texture_minimap_shape_square = NS_EGraphicCore::load_from_textures_folder("minimap_shapes/minimap_icon_shape[square]");
	NS_DefaultGabarites::texture_minimap_shape_star = NS_EGraphicCore::load_from_textures_folder("minimap_shapes/minimap_icon_shape[star]");
	NS_DefaultGabarites::texture_minimap_shape_triangle = NS_EGraphicCore::load_from_textures_folder("minimap_shapes/minimap_icon_shape[triangle]");
	NS_DefaultGabarites::texture_minimap_shape_cross = NS_EGraphicCore::load_from_textures_folder("minimap_shapes/minimap_icon_shape[cross]");
	NS_DefaultGabarites::texture_minimap_shape_moon = NS_EGraphicCore::load_from_textures_folder("minimap_shapes/minimap_icon_shape[moon]");
	NS_DefaultGabarites::texture_minimap_shape_raindrop = NS_EGraphicCore::load_from_textures_folder("minimap_shapes/minimap_icon_shape[raindrop]");
	NS_DefaultGabarites::texture_minimap_shape_kite = NS_EGraphicCore::load_from_textures_folder("minimap_shapes/minimap_icon_shape[kite]");
	NS_DefaultGabarites::texture_minimap_shape_pentagon = NS_EGraphicCore::load_from_textures_folder("minimap_shapes/minimap_icon_shape[pentagon]");
	NS_DefaultGabarites::texture_minimap_shape_upside_down_house = NS_EGraphicCore::load_from_textures_folder("minimap_shapes/minimap_icon_shape[upside_down_house]");

	NS_DefaultGabarites::texture_help_description_exact_match[NSW_localisation_EN] = NS_EGraphicCore::load_from_textures_folder("help/ExactMatchDescription[EN]");
	NS_DefaultGabarites::texture_help_description_exact_match[NSW_localisation_RU] = NS_EGraphicCore::load_from_textures_folder("help/ExactMatchDescription[RU]");

	NS_DefaultGabarites::texture_WARNING = NS_EGraphicCore::load_from_textures_folder("icons/WARNING");
	NS_DefaultGabarites::texture_config_gear = NS_EGraphicCore::load_from_textures_folder("buttons/config_gear");




}

void EWindowMain::register_rarities()
{
	ELocalisationText localisation_text;

	localisation_text.base_name = "Normal";
	localisation_text.localisations[NSW_localisation_EN] = "Normal";
	localisation_text.localisations[NSW_localisation_RU] = "Обычная";

	registered_rarity_router_variants[0] = new RouterVariant();
	registered_rarity_router_variants[0]->router_localisation = localisation_text;
	registered_rarity_router_variants[0]->text_color = new HSVRGBAColor();
	registered_rarity_router_variants[0]->text_color->set_color_RGBA(0.9f, 0.95f, 1.0f, 1.0f);

	//Magic
	localisation_text.base_name = "Magic";
	localisation_text.localisations[NSW_localisation_EN] = "Magic";
	localisation_text.localisations[NSW_localisation_RU] = "Магическая";

	registered_rarity_router_variants[1] = new RouterVariant();
	registered_rarity_router_variants[1]->router_localisation = localisation_text;
	registered_rarity_router_variants[1]->text_color = new HSVRGBAColor();
	registered_rarity_router_variants[1]->text_color->set_color_RGBA(0.5f, 0.7f, 1.0f, 1.0f);


	//Rare
	localisation_text.base_name = "Rare";
	localisation_text.localisations[NSW_localisation_EN] = "Rare";
	localisation_text.localisations[NSW_localisation_RU] = "Редкая";

	registered_rarity_router_variants[2] = new RouterVariant();
	registered_rarity_router_variants[2]->router_localisation = localisation_text;
	registered_rarity_router_variants[2]->text_color = new HSVRGBAColor();
	registered_rarity_router_variants[2]->text_color->set_color_RGBA(1.0f, 0.9f, 0.35f, 1.0f);


	//Unique
	localisation_text.base_name = "Unique";
	localisation_text.localisations[NSW_localisation_EN] = "Unique";
	localisation_text.localisations[NSW_localisation_RU] = "Уникальная";

	registered_rarity_router_variants[3] = new RouterVariant();
	registered_rarity_router_variants[3]->router_localisation = localisation_text;
	registered_rarity_router_variants[3]->text_color = new HSVRGBAColor();
	registered_rarity_router_variants[3]->text_color->set_color_RGBA(1.0f, 0.5f, 0.25f, 1.0f);
}

void EWindowMain::register_alternate_qualities()
{
	ELocalisationText localisation_text;
	/*		REGISTER ALTERNATE QUALITIES		*/
	//Superior

	localisation_text.base_name = "Superior";
	localisation_text.localisations[NSW_localisation_EN] = "Superior";
	localisation_text.localisations[NSW_localisation_RU] = "Обычное";

	registered_alternate_gem_quality_router_variants[0] = new RouterVariant();
	registered_alternate_gem_quality_router_variants[0]->router_localisation = localisation_text;
	registered_alternate_gem_quality_router_variants[0]->text_color = new HSVRGBAColor();
	registered_alternate_gem_quality_router_variants[0]->text_color->set_color_RGBA(1.0f, 0.8f, 0.6f, 1.0f);

	//Anomalous

	localisation_text.base_name = "Anomalous";
	localisation_text.localisations[NSW_localisation_EN] = "Anomalous";
	localisation_text.localisations[NSW_localisation_RU] = "Аномальный";

	registered_alternate_gem_quality_router_variants[1] = new RouterVariant();
	registered_alternate_gem_quality_router_variants[1]->router_localisation = localisation_text;
	registered_alternate_gem_quality_router_variants[1]->text_color = new HSVRGBAColor();
	registered_alternate_gem_quality_router_variants[1]->text_color->set_color_RGBA(1.0f, 0.4f, 0.4f, 1.0f);


	//Divergent
	localisation_text.base_name = "Divergent";
	localisation_text.localisations[NSW_localisation_EN] = "Divergent";
	localisation_text.localisations[NSW_localisation_RU] = "Искривлённый";

	registered_alternate_gem_quality_router_variants[2] = new RouterVariant();
	registered_alternate_gem_quality_router_variants[2]->router_localisation = localisation_text;
	registered_alternate_gem_quality_router_variants[2]->text_color = new HSVRGBAColor();
	registered_alternate_gem_quality_router_variants[2]->text_color->set_color_RGBA(0.4f, 1.0f, 0.4f, 1.0f);


	//Phantasmal

	localisation_text.base_name = "Phantasmal";
	localisation_text.localisations[NSW_localisation_EN] = "Phantasmal";
	localisation_text.localisations[NSW_localisation_RU] = "Фантомный";

	registered_alternate_gem_quality_router_variants[3] = new RouterVariant();
	registered_alternate_gem_quality_router_variants[3]->router_localisation = localisation_text;
	registered_alternate_gem_quality_router_variants[3]->text_color = new HSVRGBAColor();
	registered_alternate_gem_quality_router_variants[3]->text_color->set_color_RGBA(0.4f, 0.4f, 1.0f, 1.0f);
}

void EWindowMain::register_game_item_attributes()
{
	/*		REGISTER FILTER BLOCK ATTRIBUTES		*/
	GameItemAttribute* jc_filter_block_attribute;
	ELocalisationText		jc_localisation;

	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "ItemLevel";
	jc_localisation.localisations[NSW_localisation_EN] = "Item level";
	jc_localisation.localisations[NSW_localisation_RU] = "Уровень предмета";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_NUMBER;
	jc_filter_block_attribute->have_operator = true;
	jc_filter_block_attribute->show_in_loot_item_description = false;
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("buttons/attribute_icon_level");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_item_level";

	registered_game_item_attributes.push_back(jc_filter_block_attribute);

	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "DropLevel";
	jc_localisation.localisations[NSW_localisation_EN] = "Required level";
	jc_localisation.localisations[NSW_localisation_RU] = "Требуемый уровень";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_NUMBER;
	jc_filter_block_attribute->have_operator = true;
	jc_filter_block_attribute->show_in_loot_item_description = true;
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("buttons/attribute_icon_level");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_required_level";

	registered_game_item_attributes.push_back(jc_filter_block_attribute);

	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "Quality";
	jc_localisation.localisations[NSW_localisation_EN] = "Quality";
	jc_localisation.localisations[NSW_localisation_RU] = "Качество";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_NUMBER;
	jc_filter_block_attribute->have_operator = true;
	jc_filter_block_attribute->show_in_loot_item_description = true;
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("buttons/attribute_icon_quality");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_quality";

	registered_game_item_attributes.push_back(jc_filter_block_attribute);


	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "Rarity";
	jc_localisation.localisations[NSW_localisation_EN] = "Item rarity";
	jc_localisation.localisations[NSW_localisation_RU] = "Редкость предмета";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_RARITY_LIST;
	jc_filter_block_attribute->have_operator = true;
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("buttons/attribute_icon_rarity");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_item_rarity";

	registered_game_item_attributes.push_back(jc_filter_block_attribute);


	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "StackSize";
	jc_localisation.localisations[NSW_localisation_EN] = "Stack size";
	jc_localisation.localisations[NSW_localisation_RU] = "Размер стопки";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_NUMBER;
	jc_filter_block_attribute->have_operator = true;
	jc_filter_block_attribute->show_in_loot_item_description = false;
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("buttons/attribute_icon_stack_size");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_stack_size";

	registered_game_item_attributes.push_back(jc_filter_block_attribute);



	////////		ATTRIBUTE HEADER SEPARATOR		////////
	jc_filter_block_attribute->header_localistaion_key = "attribute_header_main_attributes";
	////////////////////////////////////////////////////////
























	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "GemLevel";
	jc_localisation.localisations[NSW_localisation_EN] = "Gem level";
	jc_localisation.localisations[NSW_localisation_RU] = "Уровень камня";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_NUMBER;
	jc_filter_block_attribute->have_operator = true;
	jc_filter_block_attribute->show_in_loot_item_description = true;

	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("buttons/attribute_icon_gem_level");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_gem_level";

	registered_game_item_attributes.push_back(jc_filter_block_attribute);

	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	//jc_localisation.base_name = "GemQualityType";
	//jc_localisation.localisations[NSW_localisation_EN] = "Quality type";
	//jc_localisation.localisations[NSW_localisation_RU] = "Вид качества";

	//jc_filter_block_attribute = new GameItemAttribute();
	//jc_filter_block_attribute->localisation = jc_localisation;
	//jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	//jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_QUALITY_LIST;
	//jc_filter_block_attribute->have_operator = false;
	//jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("buttons/attribute_icon_alternate_gem_quality");
	//jc_filter_block_attribute->description_localisation_key = "attribute_description_gem_quality_type";

	//registered_game_item_attributes.push_back(jc_filter_block_attribute);
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "TransfiguredGem";
	jc_localisation.localisations[NSW_localisation_EN] = "Transfigured gem";
	jc_localisation.localisations[NSW_localisation_RU] = "Преображённый камень";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_BOOL_SWITCHER;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("buttons/box_switcher_on");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_gem_have_transfigured_quality";

	registered_game_item_attributes.push_back(jc_filter_block_attribute);

	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "AlternateQuality";
	jc_localisation.localisations[NSW_localisation_EN] = "Alternate quality";
	jc_localisation.localisations[NSW_localisation_RU] = "Альтернативное качество";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_BOOL_SWITCHER;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("buttons/box_switcher_on");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_gem_have_alternate_qualitry";

	registered_game_item_attributes.push_back(jc_filter_block_attribute);



	////////		ATTRIBUTE HEADER SEPARATOR		////////
	jc_filter_block_attribute->header_localistaion_key = "attribute_header_gem_attributes";
	////////////////////////////////////////////////////////





















	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "MapTier";
	jc_localisation.localisations[NSW_localisation_EN] = "Map tier";
	jc_localisation.localisations[NSW_localisation_RU] = "Тир карты";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_NUMBER;
	jc_filter_block_attribute->have_operator = true;
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("buttons/attribute_icon_map_tier");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_map_tier";

	registered_game_item_attributes.push_back(jc_filter_block_attribute);


	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "ElderMap";
	jc_localisation.localisations[NSW_localisation_EN] = "Elder map";
	jc_localisation.localisations[NSW_localisation_RU] = "Карта Древнего";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_BOOL_SWITCHER;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("icons/ElderInfluence");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_is_elder_map";

	registered_game_item_attributes.push_back(jc_filter_block_attribute);


	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "ShapedMap";
	jc_localisation.localisations[NSW_localisation_EN] = "Shaped map";
	jc_localisation.localisations[NSW_localisation_RU] = "Карта Создателя";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_BOOL_SWITCHER;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("icons/ShaperInfluence");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_is_shaper_map";

	registered_game_item_attributes.push_back(jc_filter_block_attribute);


	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "BlightedMap";
	jc_localisation.localisations[NSW_localisation_EN] = "Blighted map";
	jc_localisation.localisations[NSW_localisation_RU] = "Карта скверны";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_BOOL_SWITCHER;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("buttons/attribute_icon_blighted");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_is_blighted_map";

	registered_game_item_attributes.push_back(jc_filter_block_attribute);


	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "UberBlightedMap";
	jc_localisation.localisations[NSW_localisation_EN] = "Uber Blighted map";
	jc_localisation.localisations[NSW_localisation_RU] = "Карта Уберскверны";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_BOOL_SWITCHER;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("buttons/attribute_icon_uberblighted");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_is_uberblighted_map";

	registered_game_item_attributes.push_back(jc_filter_block_attribute);


	////////		ATTRIBUTE HEADER SEPARATOR		////////
	jc_filter_block_attribute->header_localistaion_key = "attribute_header_map_attributes";
	////////////////////////////////////////////////////////















	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "SocketGroup";
	jc_localisation.localisations[NSW_localisation_EN] = "Links colours";
	jc_localisation.localisations[NSW_localisation_RU] = "Цвета связей";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_COLOURS_TEXT;
	jc_filter_block_attribute->have_operator = true;
	jc_filter_block_attribute->show_in_loot_item_description = false;
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("buttons/attribute_icon_linked_colours");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_socket_group";

	registered_game_item_attributes.push_back(jc_filter_block_attribute);

	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "Sockets";
	jc_localisation.localisations[NSW_localisation_EN] = "Sockets colours";
	jc_localisation.localisations[NSW_localisation_RU] = "Цвета гнёзд";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_COLOURS_TEXT;
	jc_filter_block_attribute->have_operator = true;
	jc_filter_block_attribute->show_in_loot_item_description = false;
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("buttons/attribute_icon_socket_colours");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_sockets";

	registered_game_item_attributes.push_back(jc_filter_block_attribute);

	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "LinkedSockets";
	jc_localisation.localisations[NSW_localisation_EN] = "Linked sockets";
	jc_localisation.localisations[NSW_localisation_RU] = "Связанные гнёзда";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_NUMBER;
	jc_filter_block_attribute->have_operator = true;
	jc_filter_block_attribute->show_in_loot_item_description = false;
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("buttons/attribute_icon_links");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_lined_sockets";
	registered_game_item_attributes.push_back(jc_filter_block_attribute);



	////////		ATTRIBUTE HEADER SEPARATOR		////////
	jc_filter_block_attribute->header_localistaion_key = "attribute_header_sockets_attribute";
	////////////////////////////////////////////////////////








































	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "BaseDefencePercentile";
	jc_localisation.localisations[NSW_localisation_EN] = "Defence procentile";
	jc_localisation.localisations[NSW_localisation_RU] = "Проценталь защиты";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_NUMBER;
	jc_filter_block_attribute->have_operator = true;
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("icons/Sacred_orb");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_defence_procentile";

	registered_game_item_attributes.push_back(jc_filter_block_attribute);

	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "BaseWard";
	jc_localisation.localisations[NSW_localisation_EN] = "Base Ward";
	jc_localisation.localisations[NSW_localisation_RU] = "Барьер";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_NUMBER;
	jc_filter_block_attribute->have_operator = true;
	registered_game_item_attributes.push_back(jc_filter_block_attribute);
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("buttons/attribute_icon_ward");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_base_ward";

	GameItemAttribute::default_game_attribute[DefaultGameAttributeEnum::GAME_ATTRIBUTE_BASE_WARD] = jc_filter_block_attribute;

	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "BaseArmour";
	jc_localisation.localisations[NSW_localisation_EN] = "Base Armour";
	jc_localisation.localisations[NSW_localisation_RU] = "Броня";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_NUMBER;
	jc_filter_block_attribute->have_operator = true;
	registered_game_item_attributes.push_back(jc_filter_block_attribute);
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("icons/Determination");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_base_armour";

	GameItemAttribute::default_game_attribute[DefaultGameAttributeEnum::GAME_ATTRIBUTE_BASE_ARMOUR] = jc_filter_block_attribute;

	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "BaseEnergyShield";
	jc_localisation.localisations[NSW_localisation_EN] = "Base Energy Shield";
	jc_localisation.localisations[NSW_localisation_RU] = "Энергощит";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_NUMBER;
	jc_filter_block_attribute->have_operator = true;
	registered_game_item_attributes.push_back(jc_filter_block_attribute);
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("icons/Discipline");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_base_energy_shield";

	GameItemAttribute::default_game_attribute[DefaultGameAttributeEnum::GAME_ATTRIBUTE_BASE_ENERGY_SHIELD] = jc_filter_block_attribute;


	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "BaseEvasion";
	jc_localisation.localisations[NSW_localisation_EN] = "Base Evasion";
	jc_localisation.localisations[NSW_localisation_RU] = "Уклонение";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_NUMBER;
	jc_filter_block_attribute->have_operator = true;
	registered_game_item_attributes.push_back(jc_filter_block_attribute);
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("icons/Grace");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_base_evasion";

	GameItemAttribute::default_game_attribute[DefaultGameAttributeEnum::GAME_ATTRIBUTE_BASE_EVASION] = jc_filter_block_attribute;



	////////		ATTRIBUTE HEADER SEPARATOR		////////
	jc_filter_block_attribute->header_localistaion_key = "attribute_header_defence_attribute";
	////////////////////////////////////////////////////////




















	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "HasSearingExarchImplicit";
	jc_localisation.localisations[NSW_localisation_EN] = "Searing Exarch implicits";
	jc_localisation.localisations[NSW_localisation_RU] = "Свойство Пламенного Экзарха";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_NUMBER;
	jc_filter_block_attribute->have_operator = true;
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("icons/GreaterEldritchEmber");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_exarch_implicit_level";

	registered_game_item_attributes.push_back(jc_filter_block_attribute);

	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "HasEaterOfWorldsImplicit";
	jc_localisation.localisations[NSW_localisation_EN] = "Eater of Worlds implicits";
	jc_localisation.localisations[NSW_localisation_RU] = "Свойства Пожирателя Миров";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_NUMBER;
	jc_filter_block_attribute->have_operator = true;
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("icons/GreaterEldritchIchor");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_eater_implicit_level";

	registered_game_item_attributes.push_back(jc_filter_block_attribute);






	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "Corrupted";
	jc_localisation.localisations[NSW_localisation_EN] = "Corrupted";
	jc_localisation.localisations[NSW_localisation_RU] = "Осквернён";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_BOOL_SWITCHER;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("icons/Vaal_Orb_inventory_icon");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_corrupted_item";

	registered_game_item_attributes.push_back(jc_filter_block_attribute);

	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "CorruptedMods";
	jc_localisation.localisations[NSW_localisation_EN] = "Corrupted mods";
	jc_localisation.localisations[NSW_localisation_RU] = "Осквернённые свойства";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_NUMBER;
	jc_filter_block_attribute->have_operator = true;
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("buttons/attribute_icon_corrupted");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_corrupted_mods";

	registered_game_item_attributes.push_back(jc_filter_block_attribute);






	////////		ATTRIBUTE HEADER SEPARATOR		////////
	jc_filter_block_attribute->header_localistaion_key = "attribute_header_corruption";
	////////////////////////////////////////////////////////
















	/*____________________________________BOOLEAN SECTION___________________________________________________*/
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "AnyEnchantment";
	jc_localisation.localisations[NSW_localisation_EN] = "Any enchantment";
	jc_localisation.localisations[NSW_localisation_RU] = "Есть зачарование";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_BOOL_SWITCHER;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("icons/enchantment");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_any_enchantment";

	//jc_filter_block_attribute->filter_rule = EFilterRule::registered_filter_rules[RegisteredFilterRules::FILTER_RULE_EXPLICITS];

	registered_game_item_attributes.push_back(jc_filter_block_attribute);
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "Replica";
	jc_localisation.localisations[NSW_localisation_EN] = "Replica";
	jc_localisation.localisations[NSW_localisation_RU] = "Реплика";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_BOOL_SWITCHER;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("buttons/attribute_icon_replica");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_replica";

	registered_game_item_attributes.push_back(jc_filter_block_attribute);
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "Identified";
	jc_localisation.localisations[NSW_localisation_EN] = "Identified";
	jc_localisation.localisations[NSW_localisation_RU] = "Опознан";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_BOOL_SWITCHER;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("icons/Scroll_of_Wisdom_inventory_icon");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_identified";

	registered_game_item_attributes.push_back(jc_filter_block_attribute);
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "Scourged";
	jc_localisation.localisations[NSW_localisation_EN] = "Scourged";
	jc_localisation.localisations[NSW_localisation_RU] = "Преображённый";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_BOOL_SWITCHER;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("buttons/attribute_icon_scourged");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_scourged";

	registered_game_item_attributes.push_back(jc_filter_block_attribute);
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "Mirrored";
	jc_localisation.localisations[NSW_localisation_EN] = "Mirrored";
	jc_localisation.localisations[NSW_localisation_RU] = "Отражён";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_BOOL_SWITCHER;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("icons/Mirror_of_Kalandra_inventory_icon");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_mirrored";

	registered_game_item_attributes.push_back(jc_filter_block_attribute);
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "ElderItem";
	jc_localisation.localisations[NSW_localisation_EN] = "Elder item";
	jc_localisation.localisations[NSW_localisation_RU] = "Предмет Древнего";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_BOOL_SWITCHER;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("icons/ElderInfluence");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_elder_item";

	registered_game_item_attributes.push_back(jc_filter_block_attribute);
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "ShaperItem";
	jc_localisation.localisations[NSW_localisation_EN] = "Shaper item";
	jc_localisation.localisations[NSW_localisation_RU] = "Предмет Создателя";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_BOOL_SWITCHER;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("icons/ShaperInfluence");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_shaper_item";

	registered_game_item_attributes.push_back(jc_filter_block_attribute);
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "FracturedItem";
	jc_localisation.localisations[NSW_localisation_EN] = "Fractured item";
	jc_localisation.localisations[NSW_localisation_RU] = "Расколотый предмет";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_BOOL_SWITCHER;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("buttons/attribute_icon_fractured");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_fractured_item";

	registered_game_item_attributes.push_back(jc_filter_block_attribute);
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "SynthesisedItem";
	jc_localisation.localisations[NSW_localisation_EN] = "Synthesised item";
	jc_localisation.localisations[NSW_localisation_RU] = "Синтезированный предмет";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_BOOL_SWITCHER;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("buttons/attribute_icon_synthesised");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_synthesised_item";

	registered_game_item_attributes.push_back(jc_filter_block_attribute);

	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////



	jc_localisation.base_name = "HasImplicitMod";
	jc_localisation.localisations[NSW_localisation_EN] = "Has implicit mod";
	jc_localisation.localisations[NSW_localisation_RU] = "Есть собственное свойство";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_BOOL_SWITCHER;
	jc_filter_block_attribute->have_operator = false;
	registered_game_item_attributes.push_back(jc_filter_block_attribute);
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("buttons/attribute_icon_has_implicit");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_has_implicit";

	GameItemAttribute::default_game_attribute[DefaultGameAttributeEnum::GAME_ATTRIBUTE_HAVE_IMPLICIT] = jc_filter_block_attribute;
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////



	jc_localisation.base_name = "HasCruciblePassiveTree";
	jc_localisation.localisations[NSW_localisation_EN] = "Crucible passive tree";
	jc_localisation.localisations[NSW_localisation_RU] = "Пассивное дерево Горнила";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_BOOL_SWITCHER;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("buttons/button_crucible_passive");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_crucible_passive";

	registered_game_item_attributes.push_back(jc_filter_block_attribute);
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


	////////		ATTRIBUTE HEADER SEPARATOR		////////
	jc_filter_block_attribute->header_localistaion_key = "attribute_header_additional_modifiers";
	////////////////////////////////////////////////////////


















	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "EnchantmentPassiveNum";
	jc_localisation.localisations[NSW_localisation_EN] = "Passives count";
	jc_localisation.localisations[NSW_localisation_RU] = "Пассивки самоцвета";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_NUMBER;
	jc_filter_block_attribute->have_operator = true;
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("icons/NotableLargeClusterJewel");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_cluster_passive_num";

	registered_game_item_attributes.push_back(jc_filter_block_attribute);

	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "AreaLevel";
	jc_localisation.localisations[NSW_localisation_EN] = "Area level";
	jc_localisation.localisations[NSW_localisation_RU] = "Уровень области";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_NUMBER;
	jc_filter_block_attribute->have_operator = true;
	jc_filter_block_attribute->global_attribute_value = true;
	jc_filter_block_attribute->show_in_loot_item_description = false;
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("buttons/attribute_icon_atlas");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_area_level";


	registered_game_item_attributes.push_back(jc_filter_block_attribute);

	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "Width";
	jc_localisation.localisations[NSW_localisation_EN] = "Width";
	jc_localisation.localisations[NSW_localisation_RU] = "Ширина";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_NUMBER;
	jc_filter_block_attribute->have_operator = true;
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("buttons/attribute_icon_width");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_width";

	registered_game_item_attributes.push_back(jc_filter_block_attribute);

	GameItemAttribute::default_game_attribute[DefaultGameAttributeEnum::GAME_ATTRIBUTE_WIDTH] = jc_filter_block_attribute;

	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "Height";
	jc_localisation.localisations[NSW_localisation_EN] = "Height";
	jc_localisation.localisations[NSW_localisation_RU] = "Высота";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_NUMBER;
	jc_filter_block_attribute->have_operator = true;
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("buttons/attribute_icon_height");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_height";

	registered_game_item_attributes.push_back(jc_filter_block_attribute);

	GameItemAttribute::default_game_attribute[DefaultGameAttributeEnum::GAME_ATTRIBUTE_HEIGHT] = jc_filter_block_attribute;



	////////		ATTRIBUTE HEADER SEPARATOR		////////
	jc_filter_block_attribute->header_localistaion_key = "attribute_header_other";
	////////////////////////////////////////////////////////




	//UNDEFINED ATTRIBUTE
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "UndefinedAttribute";
	jc_localisation.localisations[NSW_localisation_EN] = "Undefined attribute";
	jc_localisation.localisations[NSW_localisation_RU] = "Неизвестный атрибут";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_UNDEFINED_ATTRIBUTE;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->commentary_config = false;
	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("undefined_item");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_undefined_attribute";

	registered_game_item_attributes.push_back(jc_filter_block_attribute);
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////



	/*____________________________________LISTED SECTION___________________________________________________*/
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "BaseType";
	jc_localisation.localisations[NSW_localisation_EN] = "Game item";
	jc_localisation.localisations[NSW_localisation_RU] = "Предмет";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->button_x_size_override = 200.0f;
	jc_filter_block_attribute->attribute_tab_priority = 3;

	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_DATA_ENTITY;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->have_exact_match = true;
	jc_filter_block_attribute->have_input_field_for_listed = false;
	jc_filter_block_attribute->show_in_loot_item_description = false;

	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("icons/Chaos_Orb_inventory_icon");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_base_type";

	jc_filter_block_attribute->filter_rule = EFilterRule::registered_global_filter_rules[RegisteredFilterRules::FILTER_RULE_OBTAINABLE_GAME_ITEM];
	GameItemAttribute::default_game_attribute[DefaultGameAttributeEnum::GAME_ATTRIBUTE_BASE_TYPE] = jc_filter_block_attribute;

	registered_game_item_attributes.push_back(jc_filter_block_attribute);
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "Class";
	jc_localisation.localisations[NSW_localisation_EN] = "Item class";
	jc_localisation.localisations[NSW_localisation_RU] = "Класс предмета";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->button_x_size_override = 150.0f;
	jc_filter_block_attribute->attribute_tab_priority = 1;

	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_DATA_ENTITY;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->have_exact_match = true;
	jc_filter_block_attribute->show_in_loot_item_description = false;

	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("icons/SuperGloves");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_class";

	jc_filter_block_attribute->filter_rule = EFilterRule::registered_global_filter_rules[RegisteredFilterRules::FILTER_RULE_BASE_CLASS];

	GameItemAttribute::default_game_attribute[DefaultGameAttributeEnum::GAME_ATTRIBUTE_BASE_CLASS] = jc_filter_block_attribute;

	registered_game_item_attributes.push_back(jc_filter_block_attribute);
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "HasExplicitMod";

	jc_localisation.localisations[NSW_localisation_EN] = "Explicit mods";
	jc_localisation.localisations[NSW_localisation_RU] = "Префикс/суффикс";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->button_x_size_override = 350.0f;
	jc_filter_block_attribute->attribute_tab_priority = 2;

	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_DATA_ENTITY;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->have_input_field_for_listed = true;
	jc_filter_block_attribute->have_exact_match = false;

	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("buttons/attribute_icon_has_implicit");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_explicit_mods";

	jc_filter_block_attribute->filter_rule = EFilterRule::registered_global_filter_rules[RegisteredFilterRules::FILTER_RULE_EXPLICITS];

	registered_game_item_attributes.push_back(jc_filter_block_attribute);
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "EnchantmentPassiveNode";

	jc_localisation.localisations[NSW_localisation_EN] = "Cluster jewel type";
	jc_localisation.localisations[NSW_localisation_RU] = "Тип кластера";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->button_x_size_override = 200.0f;

	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_DATA_ENTITY;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->have_exact_match = true;

	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("icons/NotableLargeClusterJewel");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_cluster_node";

	jc_filter_block_attribute->filter_rule = EFilterRule::registered_global_filter_rules[RegisteredFilterRules::FILTER_RULE_CLUSTER_PASSIVE];

	registered_game_item_attributes.push_back(jc_filter_block_attribute);


	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "HasInfluence";
	jc_localisation.localisations[NSW_localisation_EN] = "Influence";
	jc_localisation.localisations[NSW_localisation_RU] = "Влияние";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->button_x_size_override = 150.0f;
	jc_filter_block_attribute->attribute_tab_priority = 1;

	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_DATA_ENTITY;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->have_exact_match = true;

	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("icons/RedeemerInfluence");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_influence";

	jc_filter_block_attribute->filter_rule = EFilterRule::registered_global_filter_rules[RegisteredFilterRules::FILTER_RULE_INFLUENCE];

	registered_game_item_attributes.push_back(jc_filter_block_attribute);


	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "HasEnchantment";
	jc_localisation.localisations[NSW_localisation_EN] = "Enchantment";
	jc_localisation.localisations[NSW_localisation_RU] = "Зачарование";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->button_x_size_override = 200.0f;

	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_LISTED;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_DATA_ENTITY;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->have_input_field_for_listed = true;
	jc_filter_block_attribute->have_exact_match = false;

	jc_filter_block_attribute->icon = NS_EGraphicCore::load_from_textures_folder("icons/enchantment");
	jc_filter_block_attribute->description_localisation_key = "attribute_description_enchantment";

	jc_filter_block_attribute->filter_rule = EFilterRule::registered_global_filter_rules[RegisteredFilterRules::FILTER_RULE_ENCHANTMENT];

	registered_game_item_attributes.push_back(jc_filter_block_attribute);
	/*_____________________________________________________________________________________________________*/









	/*____________________________________COSMETIC SECTION___________________________________________________*/
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "SetBackgroundColor";
	jc_localisation.localisations[NSW_localisation_EN] = "Background color";
	jc_localisation.localisations[NSW_localisation_RU] = "Цвет фона";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_COSMETIC;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_COLOR;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->always_present = true;

	registered_game_item_attributes.push_back(jc_filter_block_attribute);
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "SetBorderColor";
	jc_localisation.localisations[NSW_localisation_EN] = "Border color";
	jc_localisation.localisations[NSW_localisation_RU] = "Цвет рамки";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_COSMETIC;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_COLOR;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->always_present = true;

	registered_game_item_attributes.push_back(jc_filter_block_attribute);
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "SetTextColor";
	jc_localisation.localisations[NSW_localisation_EN] = "Text color";
	jc_localisation.localisations[NSW_localisation_RU] = "Цвет текста";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_COSMETIC;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_COLOR;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->always_present = true;

	registered_game_item_attributes.push_back(jc_filter_block_attribute);
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "SetFontSize";
	jc_localisation.localisations[NSW_localisation_EN] = "Text size";
	jc_localisation.localisations[NSW_localisation_RU] = "Размер текста";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_COSMETIC;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_VALUE_SLIDER;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->always_present = true;

	registered_game_item_attributes.push_back(jc_filter_block_attribute);
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "MinimapIcon";
	jc_localisation.localisations[NSW_localisation_EN] = "Minimap icon";
	jc_localisation.localisations[NSW_localisation_RU] = "Иконка";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_COSMETIC;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_MINIMAP_ICON;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->always_present = true;

	registered_game_item_attributes.push_back(jc_filter_block_attribute);
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "CustomAlertSound";
	jc_localisation.localisations[NSW_localisation_EN] = "User sound";
	jc_localisation.localisations[NSW_localisation_RU] = "Свой звук";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_COSMETIC;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_VALUE_USER_SOUND;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->always_present = true;

	registered_game_item_attributes.push_back(jc_filter_block_attribute);
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "CustomAlertSoundOptional";
	jc_localisation.localisations[NSW_localisation_EN] = "User sound";
	jc_localisation.localisations[NSW_localisation_RU] = "Свой звук";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_COSMETIC;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_VALUE_USER_SOUND;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->always_present = true;

	registered_game_item_attributes.push_back(jc_filter_block_attribute);
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "PlayAlertSound";
	jc_localisation.localisations[NSW_localisation_EN] = "Game sound";
	jc_localisation.localisations[NSW_localisation_RU] = "Стандартный звук";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_COSMETIC;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_VALUE_INGAME_SOUND;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->always_present = true;

	registered_game_item_attributes.push_back(jc_filter_block_attribute);
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "PlayAlertSoundPositional";
	jc_localisation.localisations[NSW_localisation_EN] = "Game sound (positional)";
	jc_localisation.localisations[NSW_localisation_RU] = "Стандартный звук (позиционно)";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_COSMETIC;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_VALUE_INGAME_SOUND;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->always_present = true;

	registered_game_item_attributes.push_back(jc_filter_block_attribute);
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "DisableDropSound";
	jc_localisation.localisations[NSW_localisation_EN] = "Disable drop sound";
	jc_localisation.localisations[NSW_localisation_RU] = "Выключить звук дропа";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_COSMETIC;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_DISABLE_DROP_SOUND;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->always_present = true;

	registered_game_item_attributes.push_back(jc_filter_block_attribute);
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "EnableDropSound";
	jc_localisation.localisations[NSW_localisation_EN] = "Enable drop sound";
	jc_localisation.localisations[NSW_localisation_RU] = "Включить звук дропа";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_COSMETIC;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_ENABLE_DROP_SOUND;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->always_present = true;

	registered_game_item_attributes.push_back(jc_filter_block_attribute);
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "DisableDropSoundIfAlertSound";
	jc_localisation.localisations[NSW_localisation_EN] = "Disable drop sound if alert sound";
	jc_localisation.localisations[NSW_localisation_RU] = "Выключить звук дропа, если есть звук";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_COSMETIC;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_DISABLE_DROP_SOUND_IF_ALERT;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->always_present = true;

	registered_game_item_attributes.push_back(jc_filter_block_attribute);
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "EnableDropSoundIfAlertSound";
	jc_localisation.localisations[NSW_localisation_EN] = "Enable drop sound if alert sound";
	jc_localisation.localisations[NSW_localisation_RU] = "Включить звук дропа, если есть звук";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_COSMETIC;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_ENABLE_DROP_SOUND_IF_ALERT;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->always_present = true;

	registered_game_item_attributes.push_back(jc_filter_block_attribute);
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "PlayEffect";
	jc_localisation.localisations[NSW_localisation_EN] = "Loot ray";
	jc_localisation.localisations[NSW_localisation_RU] = "Луч дропа";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_COSMETIC;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_RAY;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->always_present = true;

	registered_game_item_attributes.push_back(jc_filter_block_attribute);
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "Continue";
	jc_localisation.localisations[NSW_localisation_EN] = "Continue";
	jc_localisation.localisations[NSW_localisation_RU] = "Продолжить";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_COSMETIC;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_CONTINUE;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->always_present = true;

	registered_game_item_attributes.push_back(jc_filter_block_attribute);
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////



	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "config_VersionControl";
	jc_localisation.localisations[NSW_localisation_EN] = "Configue versions";
	jc_localisation.localisations[NSW_localisation_RU] = "Настройка версий";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_CONFIG;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_CONFIG_VERSIONS;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->commentary_config = true;
	registered_game_item_attributes.push_back(jc_filter_block_attribute);
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////




	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	//jc_localisation.base_name = "COLOR_PALETTE";
	//jc_localisation.localisations[NSW_localisation_EN] = "Palette color";
	//jc_localisation.localisations[NSW_localisation_RU] = "Коллекция цветов";

	//jc_filter_block_attribute = new GameItemAttribute();
	//jc_filter_block_attribute->localisation = jc_localisation;
	//jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_CONFIG;
	//jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_CONFIG_COLOR_COLLECTION;
	//jc_filter_block_attribute->have_operator = false;
	//jc_filter_block_attribute->commentary_config = true;
	//registered_game_item_attributes.push_back(jc_filter_block_attribute);
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////



	//	OLD DADEditor Parameters
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "autogen";
	jc_localisation.localisations[NSW_localisation_EN] = "Autogeneration (old version support)";
	jc_localisation.localisations[NSW_localisation_RU] = "Автогенерация (поддержка старых версий)";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_CONFIG;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_OLD_VERSION_AUTOGEN;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->commentary_config = true;
	registered_game_item_attributes.push_back(jc_filter_block_attribute);

	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	jc_localisation.base_name = "BlockSeparator";
	jc_localisation.localisations[NSW_localisation_EN] = "Block separator";
	jc_localisation.localisations[NSW_localisation_RU] = "Разделитель";

	jc_filter_block_attribute = new GameItemAttribute();
	jc_filter_block_attribute->localisation = jc_localisation;
	jc_filter_block_attribute->filter_attribute_type = FilterAttributeType::FILTER_ATTRIBUTE_TYPE_CONFIG;
	jc_filter_block_attribute->filter_attribute_value_type = FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_CONFIG_SEPARATOR;
	jc_filter_block_attribute->have_operator = false;
	jc_filter_block_attribute->commentary_config = true;
	registered_game_item_attributes.push_back(jc_filter_block_attribute);
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


}

void EWindowMain::register_filter_rules()
{
	EFilterRule*
		jc_filter_rule = nullptr;

	DataEntityTagFilter
		jc_filter;

	// // // GLOBAL // // //
	////////////////////////////////////////////////////////////////////////////////////////////
	//game items
	jc_filter_rule = new EFilterRule();
	jc_filter_rule->min_y_size = 40.0f;
	jc_filter_rule->focused_by_data_type = "Game item";
	jc_filter_rule->stored_action_for_data_entity_group = &EDataActionCollection::action_add_wide_item_to_group_receiver;

	jc_filter = DataEntityTagFilter();
	jc_filter.target_tag.set_ID_by_string("data type");
	jc_filter.add_new_suitable_value("Game item");
	jc_filter_rule->required_tag_list.push_back(jc_filter);

	////DELETED
	//
	//jc_filter.target_tag = "item tag";
	//jc_filter.add_new_suitable_value("Deleted");
	//jc_filter_rule->banned_tag_list.push_back(jc_filter);
	////

	EFilterRule::registered_global_filter_rules[RegisteredFilterRules::FILTER_RULE_OBTAINABLE_GAME_ITEM] = jc_filter_rule;

	////////////////////////////////////////////////////////////////////////////////////////////
	//base class
	{
		jc_filter_rule = new EFilterRule();
		jc_filter_rule->min_y_size = 40.0f;
		jc_filter_rule->focused_by_data_type = "Base Class";
		jc_filter_rule->stored_action_for_data_entity_group = &EDataActionCollection::action_add_wide_item_to_group_receiver;


		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("data type");
		jc_filter.add_new_suitable_value("Base Class");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		EFilterRule::registered_global_filter_rules[RegisteredFilterRules::FILTER_RULE_BASE_CLASS] = jc_filter_rule;
	}


	////////////////////////////////////////////////////////////////////////////////////////////
	//influence
	{
		jc_filter_rule = new EFilterRule();
		jc_filter_rule->min_y_size = 45.0f;
		jc_filter_rule->focused_by_data_type = "Influence";
		jc_filter_rule->stored_action_for_data_entity_group = &EDataActionCollection::action_add_wide_item_to_group_receiver;



		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("data type");
		jc_filter.add_new_suitable_value("Influence");

		jc_filter_rule->required_tag_list.push_back(jc_filter);
		EFilterRule::registered_global_filter_rules[RegisteredFilterRules::FILTER_RULE_INFLUENCE] = jc_filter_rule;
	}

	////////////////////////////////////////////////////////////////////////////////////////////
	//gem
	{
		jc_filter_rule = new EFilterRule();
		jc_filter_rule->focused_by_data_type = "Gem";
		jc_filter_rule->stored_action_for_data_entity_group = &EDataActionCollection::action_add_wide_item_to_group_receiver;


		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("data type");
		jc_filter.add_new_suitable_value("Gem");

		jc_filter_rule->required_tag_list.push_back(jc_filter);
		EFilterRule::registered_global_filter_rules[RegisteredFilterRules::FILTER_RULE_SKILL_GEMS] = jc_filter_rule;
	}

	////////////////////////////////////////////////////////////////////////////////////////////
	//explicit
	{
		jc_filter_rule = new EFilterRule();
		jc_filter_rule->min_y_size = 45.0f;
		jc_filter_rule->focused_by_data_type = "Explicit";
		jc_filter_rule->stored_action_for_data_entity_group = &EDataActionCollection::action_add_wide_item_to_group_receiver;


		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("data type");
		jc_filter.add_new_suitable_value("Explicit");

		jc_filter_rule->required_tag_list.push_back(jc_filter);
		EFilterRule::registered_global_filter_rules[RegisteredFilterRules::FILTER_RULE_EXPLICITS] = jc_filter_rule;
	}

	////////////////////////////////////////////////////////////////////////////////////////////
	//cluster passives
	{
		jc_filter_rule = new EFilterRule();
		jc_filter_rule->min_y_size = 45.0f;
		jc_filter_rule->focused_by_data_type = "Cluster passive";
		jc_filter_rule->stored_action_for_data_entity_group = &EDataActionCollection::action_add_wide_item_to_group_receiver;


		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("data type");
		jc_filter.add_new_suitable_value("Cluster passive");

		jc_filter_rule->required_tag_list.push_back(jc_filter);
		EFilterRule::registered_global_filter_rules[RegisteredFilterRules::FILTER_RULE_CLUSTER_PASSIVE] = jc_filter_rule;
	}

	////////////////////////////////////////////////////////////////////////////////////////////
	//enchantments from lab
	{
		jc_filter_rule = new EFilterRule();
		jc_filter_rule->min_y_size = 45.0f;
		jc_filter_rule->focused_by_data_type = "Enchantment";
		jc_filter_rule->stored_action_for_data_entity_group = &EDataActionCollection::action_add_wide_item_to_group_receiver;


		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("data type");
		jc_filter.add_new_suitable_value("Enchantment");

		jc_filter_rule->required_tag_list.push_back(jc_filter);
		EFilterRule::registered_global_filter_rules[RegisteredFilterRules::FILTER_RULE_ENCHANTMENT] = jc_filter_rule;
	}






	////////////////////////////////////////////////////////////////////////////////////////////
	//			CLASS SECTION
	////////////////////////////////////////////////////////////////////////////////////////////

	//ALL CLASSES
	{
		jc_filter_rule = new EFilterRule();
		jc_filter_rule->icon_texture = NS_EGraphicCore::load_from_textures_folder("icons/all_items");
		jc_filter_rule->category_id = 0;

		jc_filter_rule->localisation_text = new ELocalisationText();
		jc_filter_rule->localisation_text->localisations[NSW_localisation_EN] = "All classes";
		jc_filter_rule->localisation_text->localisations[NSW_localisation_RU] = "Все классы";
		jc_filter_rule->tag = "Base Class";

		//filter by game item
		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("data type");
		jc_filter.add_new_suitable_value("Base Class");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//DELETED
		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("item tag");
		jc_filter.add_new_banned_value("Deleted");
		jc_filter.add_new_banned_value("Hidden item");
		jc_filter_rule->banned_tag_list.push_back(jc_filter);
		//
		EFilterRule::registered_filter_rules_for_list.push_back(jc_filter_rule);
	}


	//EQUIP
	{
		jc_filter_rule = new EFilterRule();
		jc_filter_rule->icon_texture = NS_EGraphicCore::load_from_textures_folder("icons/Wyrmscale_Boots_inventory_icon");
		jc_filter_rule->category_id = 0;

		jc_filter_rule->localisation_text = new ELocalisationText();
		jc_filter_rule->localisation_text->localisations[NSW_localisation_EN] = "Equipable";
		jc_filter_rule->localisation_text->localisations[NSW_localisation_RU] = "Экипировка";
		jc_filter_rule->tag = "Base Class";

		//filter by game item
		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("data type");
		jc_filter.add_new_suitable_value("Base Class");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//filter by game item
		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("name EN");
		jc_filter.add_new_suitable_value("Helmets");
		jc_filter.add_new_suitable_value("Gloves");
		jc_filter.add_new_suitable_value("Boots");

		jc_filter.add_new_suitable_value("Body Armour");

		jc_filter.add_new_suitable_value("Two Hand Axes");
		jc_filter.add_new_suitable_value("Two Hand Swords");
		jc_filter.add_new_suitable_value("Two Hand Maces");

		jc_filter.add_new_suitable_value("Staves");
		jc_filter.add_new_suitable_value("Warstaves");

		jc_filter.add_new_suitable_value("Daggers");
		jc_filter.add_new_suitable_value("Rune Daggers");

		jc_filter.add_new_suitable_value("One Hand Maces");
		jc_filter.add_new_suitable_value("One Hand Axes");
		jc_filter.add_new_suitable_value("One Hand Swords");
		jc_filter.add_new_suitable_value("Claws");
		jc_filter.add_new_suitable_value("Wands");

		jc_filter.add_new_suitable_value("Bows");
		jc_filter.add_new_suitable_value("Quivers");

		jc_filter.add_new_suitable_value("Shields");

		jc_filter.add_new_suitable_value("Rings");
		jc_filter.add_new_suitable_value("Amulets");
		jc_filter.add_new_suitable_value("Belts");

		jc_filter.add_new_suitable_value("Fishing Rods");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//DELETED
		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("item tag");
		jc_filter.add_new_banned_value("Deleted");
		jc_filter.add_new_banned_value("Hidden item");
		jc_filter_rule->banned_tag_list.push_back(jc_filter);
		//
		EFilterRule::registered_filter_rules_for_list.push_back(jc_filter_rule);
	}
	////////////////////////////////////////////////////////////////////////////////////////////

	// <cost list>
	// trash
	// common
	// moderate
	// rare
	// expensive
	// very expensive

	// // // BUTTON LIST // // //



	////////////////////////////////////////////////////////////////////////////////////////////
	//			INFLUENCES SECTION
	////////////////////////////////////////////////////////////////////////////////////////////

	//ALL INFLUENCE
	{
		jc_filter_rule = new EFilterRule();
		jc_filter_rule->icon_texture = NS_EGraphicCore::load_from_textures_folder("icons/all_items");
		jc_filter_rule->category_id = 0;

		jc_filter_rule->localisation_text = new ELocalisationText();
		jc_filter_rule->localisation_text->localisations[NSW_localisation_EN] = "All influences";
		jc_filter_rule->localisation_text->localisations[NSW_localisation_RU] = "Все влияния";
		jc_filter_rule->tag = "Influence";

		//filter by game item
		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("data type");
		jc_filter.add_new_suitable_value("Influence");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//DELETED
		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("item tag");
		jc_filter.add_new_banned_value("Deleted");
		jc_filter.add_new_banned_value("Hidden item");
		jc_filter_rule->banned_tag_list.push_back(jc_filter);
		//
		EFilterRule::registered_filter_rules_for_list.push_back(jc_filter_rule);
	}


	////////////////////////////////////////////////////////////////////////////////////////////
	//			ENCHANTMENTS SECTION
	////////////////////////////////////////////////////////////////////////////////////////////

	//ALL ENCHANTMENTS

	jc_filter_rule = new EFilterRule();
	jc_filter_rule->icon_texture = NS_EGraphicCore::load_from_textures_folder("icons/all_items");
	jc_filter_rule->category_id = 0;

	jc_filter_rule->localisation_text = new ELocalisationText();
	jc_filter_rule->localisation_text->localisations[NSW_localisation_EN] = "All enchantments";
	jc_filter_rule->localisation_text->localisations[NSW_localisation_RU] = "Все зачарования";
	jc_filter_rule->tag = "Enchantment";

	//filter by game item
	jc_filter = DataEntityTagFilter();
	jc_filter.target_tag.set_ID_by_string("data type");
	jc_filter.add_new_suitable_value("Enchantment");
	jc_filter_rule->required_tag_list.push_back(jc_filter);
	//

	//DELETED
	jc_filter = DataEntityTagFilter();
	jc_filter.target_tag.set_ID_by_string("item tag");
	jc_filter.add_new_banned_value("Deleted");
	jc_filter.add_new_banned_value("Hidden item");
	jc_filter_rule->banned_tag_list.push_back(jc_filter);
	//
	EFilterRule::registered_filter_rules_for_list.push_back(jc_filter_rule);


	////////////////////////////////////////////////////////////////////////////////////////////
	//			CLUSTER PASSIVES SECTION
	////////////////////////////////////////////////////////////////////////////////////////////

	//ALL ENCHANTMENTS
	{
		jc_filter_rule = new EFilterRule();
		jc_filter_rule->icon_texture = NS_EGraphicCore::load_from_textures_folder("icons/all_items");
		jc_filter_rule->category_id = 0;

		jc_filter_rule->localisation_text = new ELocalisationText();
		jc_filter_rule->localisation_text->localisations[NSW_localisation_EN] = "All cluster passives";
		jc_filter_rule->localisation_text->localisations[NSW_localisation_RU] = "Все пассивки кластера";
		jc_filter_rule->tag = "Cluster passive";

		//filter by game item
		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("data type");
		jc_filter.add_new_suitable_value("Cluster passive");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//DELETED
		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("item tag");
		jc_filter.add_new_banned_value("Deleted");
		jc_filter.add_new_banned_value("Hidden item");
		jc_filter_rule->banned_tag_list.push_back(jc_filter);
		//
		EFilterRule::registered_filter_rules_for_list.push_back(jc_filter_rule);
	}






	////////////////////////////////////////////////////////////////////////////////////////////
	//			ITEMS SECTION
	////////////////////////////////////////////////////////////////////////////////////////////

	////////////////////////////////////////////////////////////////////////////////////////////
	//ALL ITEMS
	{
		jc_filter_rule = new EFilterRule();
		jc_filter_rule->icon_texture = NS_EGraphicCore::load_from_textures_folder("icons/all_items");
		jc_filter_rule->category_id = 0;

		jc_filter_rule->localisation_text = new ELocalisationText();
		jc_filter_rule->localisation_text->localisations[NSW_localisation_EN] = "All items";
		jc_filter_rule->localisation_text->localisations[NSW_localisation_RU] = "Все предметы";
		jc_filter_rule->tag = "Game item";

		//filter by game item
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("data type");
		jc_filter.add_new_suitable_value("Game item");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//DELETED
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("item tag");
		jc_filter.add_new_banned_value("Deleted");
		jc_filter.add_new_banned_value("Hidden item");
		jc_filter_rule->banned_tag_list.push_back(jc_filter);
		//
		EFilterRule::registered_filter_rules_for_list.push_back(jc_filter_rule);
	}

	////////////////////////////////////////////////////////////////////////////////////////////
	//DELETED
	{
		jc_filter_rule = new EFilterRule();
		jc_filter_rule->icon_texture = NS_EGraphicCore::load_from_textures_folder("buttons/button_remove_filter_block");
		jc_filter_rule->category_id = 0;

		jc_filter_rule->localisation_text = new ELocalisationText();
		jc_filter_rule->localisation_text->localisations[NSW_localisation_EN] = "Deleted items";
		jc_filter_rule->localisation_text->localisations[NSW_localisation_RU] = "Удалённые предметы";
		jc_filter_rule->tag = "Game item";

		//filter by game item
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("data type");
		jc_filter.add_new_suitable_value("Game item");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//filter "item tag" by 
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("item tag");
		jc_filter.add_new_suitable_value("Deleted");
		jc_filter_rule->required_tag_list.push_back(jc_filter);

		//HIDDEN
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("item tag");
		jc_filter.add_new_banned_value("Hidden item");
		jc_filter_rule->banned_tag_list.push_back(jc_filter);
		//
	}



	//NECROPOLIS TATTOO
	{
		////////////////////////////////////////////////////////////////////////////////////////////
		jc_filter_rule = new EFilterRule();
		jc_filter_rule->icon_texture = NS_EGraphicCore::load_from_textures_folder("icons/Honoured_tattoo");
		jc_filter_rule->category_id = 0;

		jc_filter_rule->localisation_text = new ELocalisationText();
		jc_filter_rule->localisation_text->localisations[NSW_localisation_EN] = "Necropolis:\\nTattoo";
		jc_filter_rule->localisation_text->localisations[NSW_localisation_RU] = "Некрополис:\\nТатуировки";
		jc_filter_rule->tag = "Game item";
		jc_filter_rule->named_id = "necropolis folder";

		//filter by game item
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("data type");
		jc_filter.add_new_suitable_value("Game item");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//filter by class "divination"
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("base class");
		jc_filter.add_new_suitable_value("Stackable currency");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//filter by class "divination"
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("item tag");
		jc_filter.add_new_suitable_value("Tattoo");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//


		//filter "item tag" by 
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("item tag");
		jc_filter.add_new_banned_value("Deleted");
		jc_filter.add_new_banned_value("Hidden item");
		jc_filter_rule->banned_tag_list.push_back(jc_filter);

		//EFilterRule::registered_global_filter_rules.push_back(jc_filter_rule);
		EFilterRule::registered_filter_rules_for_list.push_back(jc_filter_rule);
	}
	
	//NECROPOLIS SCARABS
	{
		////////////////////////////////////////////////////////////////////////////////////////////
		jc_filter_rule = new EFilterRule();
		jc_filter_rule->icon_texture = NS_EGraphicCore::load_from_textures_folder("icons/Scarab_bonus");
		jc_filter_rule->category_id = 0;

		jc_filter_rule->localisation_text = new ELocalisationText();
		jc_filter_rule->localisation_text->localisations[NSW_localisation_EN] = "Necropolis:\\nScarabs";
		jc_filter_rule->localisation_text->localisations[NSW_localisation_RU] = "Некрополис:\\nСкарабеи";
		jc_filter_rule->tag = "Game item";
		jc_filter_rule->named_id = "necropolis folder";

		//filter by game item
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("data type");
		jc_filter.add_new_suitable_value("Game item");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//filter by class "divination"
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("item tag");
		jc_filter.add_new_suitable_value("Scarab item");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//
		// 
		// 
		//filter by class "divination"
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = true;
		jc_filter.target_tag.set_ID_by_string("scarab tier");
		jc_filter.add_new_suitable_value("Basic",		ELocalisationText::get_localisation_by_key("scarab_tier_basic"));
		jc_filter.add_new_suitable_value("Bonus",		ELocalisationText::get_localisation_by_key("scarab_tier_bonus"));
		jc_filter.add_new_suitable_value("Influencing",	ELocalisationText::get_localisation_by_key("scarab_tier_influenced"));
		jc_filter.add_new_suitable_value("Horned",		ELocalisationText::get_localisation_by_key("scarab_tier_horned"));
		jc_filter.add_new_suitable_value("Special",		ELocalisationText::get_localisation_by_key("scarab_tier_Special"));
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//


		//filter "item tag" by 
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("item tag");
		jc_filter.add_new_banned_value("Deleted");
		jc_filter.add_new_banned_value("Hidden item");
		jc_filter_rule->banned_tag_list.push_back(jc_filter);

		//EFilterRule::registered_global_filter_rules.push_back(jc_filter_rule);
		EFilterRule::registered_filter_rules_for_list.push_back(jc_filter_rule);
	}
	
	//NECROPOLIS BASES
	{
		////////////////////////////////////////////////////////////////////////////////////////////
		jc_filter_rule = new EFilterRule();
		jc_filter_rule->icon_texture = NS_EGraphicCore::load_from_textures_folder("icons/SuperBelt");
		jc_filter_rule->category_id = 0;

		jc_filter_rule->localisation_text = new ELocalisationText();
		jc_filter_rule->localisation_text->localisations[NSW_localisation_EN] = "Necropolis:\\New item bases";
		jc_filter_rule->localisation_text->localisations[NSW_localisation_RU] = "Некрополис:\\nНовые базы предметов";
		jc_filter_rule->tag = "Game item";
		jc_filter_rule->named_id = "necropolis folder";

		//filter by game item
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("data type");
		jc_filter.add_new_suitable_value("Game item");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//filter by class "штекщвгсув"
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("item tag");
		jc_filter.add_new_suitable_value("Introduced: Necropolis league");
		jc_filter_rule->required_tag_list.push_back(jc_filter);

		//filter by class "divination"
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("item tag");
		jc_filter.add_new_suitable_value("Item slot");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//filter "item tag" by 
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("item tag");
		jc_filter.add_new_banned_value("Deleted");
		jc_filter.add_new_banned_value("Hidden item");
		jc_filter_rule->banned_tag_list.push_back(jc_filter);

		//EFilterRule::registered_global_filter_rules.push_back(jc_filter_rule);
		EFilterRule::registered_filter_rules_for_list.push_back(jc_filter_rule);
	}


	register_filter_rule_folder("necropolis folder", "Game item", "rule_folder_necropolis", "buttons/pattern_folder_necropolis");
	
	//DIVINATIONS
	{
		////////////////////////////////////////////////////////////////////////////////////////////
		jc_filter_rule = new EFilterRule();
		jc_filter_rule->icon_texture = NS_EGraphicCore::load_from_textures_folder("icons/card");
		jc_filter_rule->category_id = 1;
		jc_filter_rule->named_id = "";

		jc_filter_rule->localisation_text = new ELocalisationText();
		jc_filter_rule->localisation_text->localisations[NSW_localisation_EN] = "Divinations";
		jc_filter_rule->localisation_text->localisations[NSW_localisation_RU] = "Гадальные карты";
		jc_filter_rule->tag = "Game item";

		//filter by game item
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("data type");
		jc_filter.add_new_suitable_value("Game item");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//filter by class "divination"
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("base class");
		jc_filter.add_new_suitable_value("Divination cards");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//filter by class "divination"
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = true;
		jc_filter.target_tag.set_ID_by_string("worth");
		jc_filter.add_new_suitable_value("Trash", ELocalisationText::get_localisation_by_key("tag_trash"));
		jc_filter.add_new_suitable_value("Common", ELocalisationText::get_localisation_by_key("tag_common"));
		jc_filter.add_new_suitable_value("Moderate", ELocalisationText::get_localisation_by_key("tag_moderate"));
		jc_filter.add_new_suitable_value("Rare", ELocalisationText::get_localisation_by_key("tag_rare"));
		jc_filter.add_new_suitable_value("Expensive", ELocalisationText::get_localisation_by_key("tag_expensive"));
		jc_filter.add_new_suitable_value("Very expensive", ELocalisationText::get_localisation_by_key("tag_very_expensive"));
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//filter "item tag" by 
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("item tag");
		jc_filter.add_new_banned_value("Deleted");
		jc_filter.add_new_banned_value("Hidden item");
		jc_filter_rule->banned_tag_list.push_back(jc_filter);
		//
		
		//EFilterRule::registered_global_filter_rules.push_back(jc_filter_rule);
		EFilterRule::registered_filter_rules_for_list.push_back(jc_filter_rule);
	}

	////////////////////////////////////////////////////////////////////////////////////////////

	//register_filter_rule_folder("divinations folder", "Game item", "rule_folder_divinations", "buttons/pattern_folder_divinations");

	////////////////////////////////////////////////////////////////////////////////////////////
	//CURRENCY
	{
		jc_filter_rule = new EFilterRule();
		jc_filter_rule->icon_texture = NS_EGraphicCore::load_from_textures_folder("icons/Chaos_Orb_inventory_icon");
		jc_filter_rule->category_id = 2;
		jc_filter_rule->named_id = "currency folder";

		jc_filter_rule->localisation_text = new ELocalisationText();
		jc_filter_rule->localisation_text->localisations[NSW_localisation_EN] = "Currency";
		jc_filter_rule->localisation_text->localisations[NSW_localisation_RU] = "Валюта";
		jc_filter_rule->tag = "Game item";


		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("data type");
		jc_filter.add_new_suitable_value("Game item");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//


		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("base class");
		jc_filter.add_new_suitable_value("Stackable currency");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("item tag");
		jc_filter.add_new_suitable_value("Basic currency");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = true;
		jc_filter.target_tag.set_ID_by_string("worth");
		jc_filter.add_new_suitable_value("Trash", ELocalisationText::get_localisation_by_key("tag_trash"));
		jc_filter.add_new_suitable_value("Common", ELocalisationText::get_localisation_by_key("tag_common"));
		jc_filter.add_new_suitable_value("Moderate", ELocalisationText::get_localisation_by_key("tag_moderate"));
		jc_filter.add_new_suitable_value("Rare", ELocalisationText::get_localisation_by_key("tag_rare"));
		jc_filter.add_new_suitable_value("Expensive", ELocalisationText::get_localisation_by_key("tag_expensive"));
		jc_filter.add_new_suitable_value("Very expensive", ELocalisationText::get_localisation_by_key("tag_very_expensive"));
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//EFilterRule::registered_global_filter_rules.push_back(jc_filter_rule);
		EFilterRule::registered_filter_rules_for_list.push_back(jc_filter_rule);
	}

	////////////////////////////////////////////////////////////////////////////////////////////
	//INCUBATORS
	{
		jc_filter_rule = new EFilterRule();
		jc_filter_rule->icon_texture = NS_EGraphicCore::load_from_textures_folder("icons/Incubator");
		jc_filter_rule->category_id = 7;
		jc_filter_rule->named_id = "currency folder";

		jc_filter_rule->localisation_text = new ELocalisationText();
		jc_filter_rule->localisation_text->localisations[NSW_localisation_EN] = "Incubators";
		jc_filter_rule->localisation_text->localisations[NSW_localisation_RU] = "Инкубаторы";
		jc_filter_rule->tag = "Game item";

		//filter by game item
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("data type");
		jc_filter.add_new_suitable_value("Game item");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//filter "item tag" by 
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("base class");
		jc_filter.add_new_suitable_value("Incubators");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//filter "item tag" by 
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = true;
		jc_filter.target_tag.set_ID_by_string("worth");
		jc_filter.add_new_suitable_value("Trash", ELocalisationText::get_localisation_by_key("tag_trash"));
		jc_filter.add_new_suitable_value("Common", ELocalisationText::get_localisation_by_key("tag_common"));
		jc_filter.add_new_suitable_value("Moderate", ELocalisationText::get_localisation_by_key("tag_moderate"));
		jc_filter.add_new_suitable_value("Rare", ELocalisationText::get_localisation_by_key("tag_rare"));
		jc_filter.add_new_suitable_value("Expensive", ELocalisationText::get_localisation_by_key("tag_expensive"));
		jc_filter.add_new_suitable_value("Very expensive", ELocalisationText::get_localisation_by_key("tag_very_expensive"));

		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//
		//EFilterRule::registered_global_filter_rules.push_back(jc_filter_rule);
		EFilterRule::registered_filter_rules_for_list.push_back(jc_filter_rule);
	}

	////////////////////////////////////////////////////////////////////////////////////////////
	//OILS
	{
		jc_filter_rule = new EFilterRule();
		jc_filter_rule->icon_texture = NS_EGraphicCore::load_from_textures_folder("icons/Opalescent_Oil");
		jc_filter_rule->category_id = 7;
		jc_filter_rule->named_id = "currency folder";

		jc_filter_rule->localisation_text = new ELocalisationText();
		jc_filter_rule->localisation_text->localisations[NSW_localisation_EN] = "Oils";
		jc_filter_rule->localisation_text->localisations[NSW_localisation_RU] = "Масла";
		jc_filter_rule->tag = "Game item";

		//filter by game item
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("data type");
		jc_filter.add_new_suitable_value("Game item");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//filter "item tag" by 
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("item tag");
		jc_filter.add_new_suitable_value("Oil item");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//filter "item tag" by 
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = true;
		jc_filter.add_new_suitable_value("Expensive", ELocalisationText::get_localisation_by_key("tag_expensive"));
		jc_filter.add_new_suitable_value("Very expensive", ELocalisationText::get_localisation_by_key("tag_very_expensive"));
		jc_filter.target_tag.set_ID_by_string("worth");
		jc_filter.add_new_suitable_value("Trash", ELocalisationText::get_localisation_by_key("tag_trash"));
		jc_filter.add_new_suitable_value("Common", ELocalisationText::get_localisation_by_key("tag_common"));
		jc_filter.add_new_suitable_value("Moderate", ELocalisationText::get_localisation_by_key("tag_moderate"));
		jc_filter.add_new_suitable_value("Rare", ELocalisationText::get_localisation_by_key("tag_rare"));
		jc_filter.add_new_suitable_value("Expensive", ELocalisationText::get_localisation_by_key("tag_expensive"));
		jc_filter.add_new_suitable_value("Very expensive", ELocalisationText::get_localisation_by_key("tag_very_expensive"));
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//
		//EFilterRule::registered_global_filter_rules.push_back(jc_filter_rule);
		EFilterRule::registered_filter_rules_for_list.push_back(jc_filter_rule);
	}



	//register_filter_rule_folder("oils folder", "Game item", "rule_folder_oils", "buttons/pattern_folder_oils");

	////////////////////////////////////////////////////////////////////////////////////////////
	//CATALYSTS
	{
		jc_filter_rule = new EFilterRule();
		jc_filter_rule->icon_texture = NS_EGraphicCore::load_from_textures_folder("icons/Abrasive_Catalyst");
		jc_filter_rule->category_id = 7;
		jc_filter_rule->named_id = "currency folder";

		jc_filter_rule->localisation_text = new ELocalisationText();
		jc_filter_rule->localisation_text->localisations[NSW_localisation_EN] = "Catalysts";
		jc_filter_rule->localisation_text->localisations[NSW_localisation_RU] = "Катализаторы";
		jc_filter_rule->tag = "Game item";

		//filter by game item
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("data type");
		jc_filter.add_new_suitable_value("Game item");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//filter "item tag" by 
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("item tag");
		jc_filter.add_new_suitable_value("Catalyst item");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//filter "item tag" by 
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = true;
		jc_filter.target_tag.set_ID_by_string("worth");
		jc_filter.add_new_suitable_value("Trash", ELocalisationText::get_localisation_by_key("tag_trash"));
		jc_filter.add_new_suitable_value("Common", ELocalisationText::get_localisation_by_key("tag_common"));
		jc_filter.add_new_suitable_value("Moderate", ELocalisationText::get_localisation_by_key("tag_moderate"));
		jc_filter.add_new_suitable_value("Rare", ELocalisationText::get_localisation_by_key("tag_rare"));
		jc_filter.add_new_suitable_value("Expensive", ELocalisationText::get_localisation_by_key("tag_expensive"));
		jc_filter.add_new_suitable_value("Very expensive", ELocalisationText::get_localisation_by_key("tag_very_expensive"));
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//
		//EFilterRule::registered_global_filter_rules.push_back(jc_filter_rule);
		EFilterRule::registered_filter_rules_for_list.push_back(jc_filter_rule);
	}
	
	////////////////////////////////////////////////////////////////////////////////////////////
	//FOSSILS
	{
		jc_filter_rule = new EFilterRule();
		jc_filter_rule->icon_texture = NS_EGraphicCore::load_from_textures_folder("icons/Faceted_Fossil_inventory_icon");
		jc_filter_rule->category_id = 7;
		jc_filter_rule->named_id = "currency folder";

		jc_filter_rule->localisation_text = new ELocalisationText();
		jc_filter_rule->localisation_text->localisations[NSW_localisation_EN] = "Fossils";
		jc_filter_rule->localisation_text->localisations[NSW_localisation_RU] = "Ископаемые";
		jc_filter_rule->tag = "Game item";

		//filter by game item
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("data type");
		jc_filter.add_new_suitable_value("Game item");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//filter "item tag" by 
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("item tag");
		jc_filter.add_new_suitable_value("Delve fossil");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//filter "item tag" by 
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = true;
		jc_filter.target_tag.set_ID_by_string("worth");
		jc_filter.add_new_suitable_value("Trash", ELocalisationText::get_localisation_by_key("tag_trash"));
		jc_filter.add_new_suitable_value("Common", ELocalisationText::get_localisation_by_key("tag_common"));
		jc_filter.add_new_suitable_value("Moderate", ELocalisationText::get_localisation_by_key("tag_moderate"));
		jc_filter.add_new_suitable_value("Rare", ELocalisationText::get_localisation_by_key("tag_rare"));
		jc_filter.add_new_suitable_value("Expensive", ELocalisationText::get_localisation_by_key("tag_expensive"));
		jc_filter.add_new_suitable_value("Very expensive", ELocalisationText::get_localisation_by_key("tag_very_expensive"));
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//
		//EFilterRule::registered_global_filter_rules.push_back(jc_filter_rule);
		EFilterRule::registered_filter_rules_for_list.push_back(jc_filter_rule);
	}



	register_filter_rule_folder("currency folder", "Game item", "rule_folder_currency", "buttons/pattern_folder_basic_currencies");

	//HEIST TOOL
	////////////////////////////////////////////////////////////////////////////////////////////
	{

		jc_filter_rule = new EFilterRule();
		jc_filter_rule->icon_texture = NS_EGraphicCore::load_from_textures_folder("icons/Mask");
		jc_filter_rule->category_id = 3;
		jc_filter_rule->named_id = "heist tool folder";

		jc_filter_rule->localisation_text = new ELocalisationText();
		jc_filter_rule->localisation_text->localisations[NSW_localisation_EN] = "Heist tools";
		jc_filter_rule->localisation_text->localisations[NSW_localisation_RU] = "Инструменты кражи";
		jc_filter_rule->tag = "Game item";

		//filter by game item
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("data type");
		jc_filter.add_new_suitable_value("Game item");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//filter "item tag" by 
		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("base class");
		jc_filter.can_be_configured = true;
		jc_filter.add_new_suitable_value("Heist Cloaks", ELocalisationText::get_localisation_by_key("tag_heist_cloaks"));
		jc_filter.add_new_suitable_value("Heist Gear", ELocalisationText::get_localisation_by_key("tag_heist_gear"));
		jc_filter.add_new_suitable_value("Heist Brooches", ELocalisationText::get_localisation_by_key("tag_heist_brooches"));
		jc_filter.add_new_suitable_value("Heist Tools", ELocalisationText::get_localisation_by_key("tag_heist_tool"));
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		// //filter "item tag" by 
		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("heist level");
		jc_filter.can_be_configured = true;
		jc_filter.add_new_suitable_value("2", ELocalisationText::get_localisation_by_key("tag_heist_level_2"));
		jc_filter.add_new_suitable_value("3", ELocalisationText::get_localisation_by_key("tag_heist_level_3"));
		jc_filter.add_new_suitable_value("4", ELocalisationText::get_localisation_by_key("tag_heist_level_4"));
		jc_filter.add_new_suitable_value("5", ELocalisationText::get_localisation_by_key("tag_heist_level_5"));
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//DELETED
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("item tag");
		jc_filter.add_new_banned_value("Deleted");
		jc_filter.add_new_banned_value("Hidden item");
		jc_filter_rule->banned_tag_list.push_back(jc_filter);
		//





		//
		//EFilterRule::registered_global_filter_rules.push_back(jc_filter_rule);
		EFilterRule::registered_filter_rules_for_list.push_back(jc_filter_rule);
	}

	//HEIST TARGET
	////////////////////////////////////////////////////////////////////////////////////////////
	{

		jc_filter_rule = new EFilterRule();
		jc_filter_rule->icon_texture = NS_EGraphicCore::load_from_textures_folder("icons/RoguesMarker");
		jc_filter_rule->category_id = 3;
		jc_filter_rule->named_id = "heist tool folder";

		jc_filter_rule->localisation_text = new ELocalisationText();
		jc_filter_rule->localisation_text->localisations[NSW_localisation_EN] = "Heist target";
		jc_filter_rule->localisation_text->localisations[NSW_localisation_RU] = "Цель кражи";
		jc_filter_rule->tag = "Game item";

		//filter by game item
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("data type");
		jc_filter.add_new_suitable_value("Game item");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//filter "item tag" by 
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = true;
		jc_filter.target_tag.set_ID_by_string("heist price");
		jc_filter.add_new_suitable_value("Low", ELocalisationText::get_localisation_by_key("tag_price_low"));			jc_filter.set_text_color(0.6f, 0.55f, 0.5f, 1.0f);
		jc_filter.add_new_suitable_value("Moderate", ELocalisationText::get_localisation_by_key("tag_price_moderate"));		jc_filter.set_text_color(0.5f, 1.0f, 0.7f, 1.0f);
		jc_filter.add_new_suitable_value("High", ELocalisationText::get_localisation_by_key("tag_price_high"));			jc_filter.set_text_color(0.5f, 0.7f, 1.0f, 1.0f);
		jc_filter.add_new_suitable_value("Precious", ELocalisationText::get_localisation_by_key("tag_price_precious"));		jc_filter.set_text_color(0.7f, 0.5f, 1.0f, 1.0f);
		jc_filter.add_new_suitable_value("Priceless", ELocalisationText::get_localisation_by_key("tag_price_priceless"));		jc_filter.set_text_color(1.0f, 0.8f, 0.5f, 1.0f);

		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//DELETED
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("item tag");
		jc_filter.add_new_banned_value("Deleted");
		jc_filter.add_new_banned_value("Hidden item");
		jc_filter_rule->banned_tag_list.push_back(jc_filter);
		//





		//
		//EFilterRule::registered_global_filter_rules.push_back(jc_filter_rule);
		EFilterRule::registered_filter_rules_for_list.push_back(jc_filter_rule);
	}

	register_filter_rule_folder("heist tool folder", "Game item", "rule_folder_heist_items", "icons/RoguesMarker");



	////////////////////////////////////////////////////////////////////////////////////////////
	//Items bases
	{
		jc_filter_rule = new EFilterRule();
		jc_filter_rule->icon_texture = NS_EGraphicCore::load_from_textures_folder("icons/Steel_Ring_inventory_icon");
		jc_filter_rule->category_id = 5;
		jc_filter_rule->named_id = "item bases folder";

		jc_filter_rule->localisation_text = new ELocalisationText();
		jc_filter_rule->localisation_text->localisations[NSW_localisation_EN] = "Item bases";
		jc_filter_rule->localisation_text->localisations[NSW_localisation_RU] = "Базы предметов";
		jc_filter_rule->tag = "Game item";

		//filter by game item
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("data type");
		jc_filter.add_new_suitable_value("Game item");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//filter "item tag" by 
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = true;
		jc_filter.target_tag.set_ID_by_string("Base tier");
		jc_filter.add_new_suitable_value("Acceptable", ELocalisationText::get_localisation_by_key("tag_tier_acceptable"));		jc_filter.set_text_color(0.60f, 0.65f, 0.70f, 1.0f);
		jc_filter.add_new_suitable_value("Good", ELocalisationText::get_localisation_by_key("tag_tier_good"));					jc_filter.set_text_color(0.60f, 1.00f, 0.70f, 1.0f);
		jc_filter.add_new_suitable_value("Best", ELocalisationText::get_localisation_by_key("tag_tier_best"));					jc_filter.set_text_color(1.00f, 0.80f, 0.60f, 1.0f);

		jc_filter.add_new_suitable_value("", ELocalisationText::get_localisation_by_key("tag_any"));							jc_filter.set_text_color(1.00f, 1.00f, 1.00f, 1.0f);

		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//filter "item tag" by 
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = true;
		jc_filter.target_tag.set_ID_by_string("base family");
		jc_filter.add_new_suitable_value("Basic", ELocalisationText::get_localisation_by_key("tag_tier_basic"));
		jc_filter.add_new_suitable_value("Ritual", ELocalisationText::get_localisation_by_key("tag_tier_ritual"));
		jc_filter.add_new_suitable_value("Heist", ELocalisationText::get_localisation_by_key("tag_tier_heist"));
		jc_filter.add_new_suitable_value("Breach", ELocalisationText::get_localisation_by_key("tag_tier_breach"));
		jc_filter.add_new_suitable_value("Runic", ELocalisationText::get_localisation_by_key("tag_tier_runic"));
		jc_filter.add_new_suitable_value("Boss", ELocalisationText::get_localisation_by_key("tag_tier_boss"));

		jc_filter.add_new_suitable_value("", ELocalisationText::get_localisation_by_key("tag_any"));										jc_filter.set_text_color(1.00f, 1.00f, 1.00f, 1.0f);

		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//



		//DELETED
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("item tag");
		jc_filter.add_new_banned_value("Deleted");
		jc_filter.add_new_banned_value("Hidden item");
		jc_filter_rule->banned_tag_list.push_back(jc_filter);
		//

		//
		//EFilterRule::registered_global_filter_rules.push_back(jc_filter_rule);
		EFilterRule::registered_filter_rules_for_list.push_back(jc_filter_rule);
	}

	//UNIQUES valuable
	{
		jc_filter_rule = new EFilterRule();
		jc_filter_rule->icon_texture = NS_EGraphicCore::load_from_textures_folder("buttons/button_icon_uniques");
		jc_filter_rule->category_id = 5;
		jc_filter_rule->named_id = "item bases folder";

		jc_filter_rule->localisation_text = new ELocalisationText();
		jc_filter_rule->localisation_text->localisations[NSW_localisation_EN] = "Useful uniques";
		jc_filter_rule->localisation_text->localisations[NSW_localisation_RU] = "Ценные уники";
		jc_filter_rule->tag = "Game item";



		//filter "item tag" by 
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("item tag");
		jc_filter.add_new_suitable_value("Good base for unique");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//
		//EFilterRule::registered_global_filter_rules.push_back(jc_filter_rule);
		EFilterRule::registered_filter_rules_for_list.push_back(jc_filter_rule);
	}

	//UNIQUES valuable
	{
		jc_filter_rule = new EFilterRule();
		jc_filter_rule->icon_texture = NS_EGraphicCore::load_from_textures_folder("buttons/button_icon_uniques");
		jc_filter_rule->category_id = 5;
		jc_filter_rule->named_id = "item bases folder";

		jc_filter_rule->localisation_text = new ELocalisationText();
		jc_filter_rule->localisation_text->localisations[NSW_localisation_EN] = "Expensive uniques";
		jc_filter_rule->localisation_text->localisations[NSW_localisation_RU] = "Дорогие уники";
		jc_filter_rule->tag = "Game item";



		//filter "item tag" by 
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("item tag");
		jc_filter.add_new_suitable_value("Expensive base for unique");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//
		//EFilterRule::registered_global_filter_rules.push_back(jc_filter_rule);
		EFilterRule::registered_filter_rules_for_list.push_back(jc_filter_rule);
	}


	register_filter_rule_folder("item bases folder", "Game item", "rule_folder_bases_folder", "buttons/pattern_folder_equip");




	////////////////////////////////////////////////////////////////////////////////////////////
	//Heist league
	{
		jc_filter_rule = new EFilterRule();
		jc_filter_rule->icon_texture = NS_EGraphicCore::load_from_textures_folder("icons/RoguesMarker");
		jc_filter_rule->category_id = 6;
		jc_filter_rule->named_id = "leagues folder";

		jc_filter_rule->localisation_text = new ELocalisationText();
		jc_filter_rule->localisation_text->localisations[NSW_localisation_EN] = "Heist league";
		jc_filter_rule->localisation_text->localisations[NSW_localisation_RU] = "Лига 'Кража'";
		jc_filter_rule->tag = "Game item";

		//filter by game item
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("data type");
		jc_filter.add_new_suitable_value("Game item");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//filter "item tag" by 
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = false;
		jc_filter.target_tag.set_ID_by_string("item tag");
		jc_filter.add_new_suitable_value("League: Heist");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//
		//EFilterRule::registered_global_filter_rules.push_back(jc_filter_rule);
		EFilterRule::registered_filter_rules_for_list.push_back(jc_filter_rule);
	}

	////////////////////////////////////////////////////////////////////////////////////////////
	//Ritual league
	{
		jc_filter_rule = new EFilterRule();
		jc_filter_rule->icon_texture = NS_EGraphicCore::load_from_textures_folder("icons/RitualRune");
		jc_filter_rule->category_id = 6;
		jc_filter_rule->named_id = "leagues folder";

		jc_filter_rule->localisation_text = new ELocalisationText();
		jc_filter_rule->localisation_text->localisations[NSW_localisation_EN] = "League: Ritual";
		jc_filter_rule->localisation_text->localisations[NSW_localisation_RU] = "Лига: Ритуал";
		jc_filter_rule->tag = "Game item";

		//filter by game item
		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("data type");
		jc_filter.add_new_suitable_value("Game item");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//filter "item tag" by 
		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("item tag");
		jc_filter.add_new_suitable_value("League: Ritual");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//
		//EFilterRule::registered_global_filter_rules.push_back(jc_filter_rule);
		EFilterRule::registered_filter_rules_for_list.push_back(jc_filter_rule);
	}

	////////////////////////////////////////////////////////////////////////////////////////////
	//Scourge league
	{
		jc_filter_rule = new EFilterRule();
		jc_filter_rule->icon_texture = NS_EGraphicCore::load_from_textures_folder("icons/HellscapePaleBoss");
		jc_filter_rule->category_id = 6;
		jc_filter_rule->named_id = "leagues folder";

		jc_filter_rule->localisation_text = new ELocalisationText();
		jc_filter_rule->localisation_text->localisations[NSW_localisation_EN] = "Scourge league";
		jc_filter_rule->localisation_text->localisations[NSW_localisation_RU] = "Лига 'Нашествие'";
		jc_filter_rule->tag = "Game item";

		//filter by game item
		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("data type");
		jc_filter.add_new_suitable_value("Game item");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//filter "item tag" by 
		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("item tag");
		jc_filter.add_new_suitable_value("Introduced: Scourge league");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//
		//EFilterRule::registered_global_filter_rules.push_back(jc_filter_rule);
		EFilterRule::registered_filter_rules_for_list.push_back(jc_filter_rule);
	}

	////////////////////////////////////////////////////////////////////////////////////////////
	//Archnemesis league
	{
		jc_filter_rule = new EFilterRule();
		jc_filter_rule->icon_texture = NS_EGraphicCore::load_from_textures_folder("icons/Archnemesis_league");
		jc_filter_rule->category_id = 6;
		jc_filter_rule->named_id = "leagues folder";

		jc_filter_rule->localisation_text = new ELocalisationText();
		jc_filter_rule->localisation_text->localisations[NSW_localisation_EN] = "Archnemesis league";
		jc_filter_rule->localisation_text->localisations[NSW_localisation_RU] = "Лига 'Возмездие'";
		jc_filter_rule->tag = "Game item";

		//filter by game item
		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("data type");
		jc_filter.add_new_suitable_value("Game item");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//filter "item tag" by 
		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("item tag");
		jc_filter.add_new_suitable_value("Introduced: Archnemesis league");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//
		//EFilterRule::registered_global_filter_rules.push_back(jc_filter_rule);
		EFilterRule::registered_filter_rules_for_list.push_back(jc_filter_rule);
	}

	////////////////////////////////////////////////////////////////////////////////////////////
	//Kalandra league
	{
		jc_filter_rule = new EFilterRule();
		jc_filter_rule->icon_texture = NS_EGraphicCore::load_from_textures_folder("icons/LakeStampingDevice");
		jc_filter_rule->category_id = 6;
		jc_filter_rule->named_id = "leagues folder";

		jc_filter_rule->localisation_text = new ELocalisationText();
		jc_filter_rule->localisation_text->localisations[NSW_localisation_EN] = "Kalandra league";
		jc_filter_rule->localisation_text->localisations[NSW_localisation_RU] = "Лига 'Каландра'";
		jc_filter_rule->tag = "Game item";

		//filter by game item
		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("data type");
		jc_filter.add_new_suitable_value("Game item");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//filter "item tag" by 
		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("item tag");
		jc_filter.add_new_suitable_value("Introduced: Kalandra league");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//
		//EFilterRule::registered_global_filter_rules.push_back(jc_filter_rule);
		EFilterRule::registered_filter_rules_for_list.push_back(jc_filter_rule);
	}

	////////////////////////////////////////////////////////////////////////////////////////////
	//Forbidden sanctum league
	{
		jc_filter_rule = new EFilterRule();
		jc_filter_rule->icon_texture = NS_EGraphicCore::load_from_textures_folder("icons/Sanctum_league");
		jc_filter_rule->category_id = 7;
		jc_filter_rule->named_id = "leagues folder";

		jc_filter_rule->localisation_text = new ELocalisationText();
		jc_filter_rule->localisation_text->localisations[NSW_localisation_EN] = "Forbidden Sanctum league";
		jc_filter_rule->localisation_text->localisations[NSW_localisation_RU] = "Лига 'Запретное святилище'";
		jc_filter_rule->tag = "Game item";

		//filter by game item
		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("data type");
		jc_filter.add_new_suitable_value("Game item");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//filter "item tag" by 
		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("item tag");
		jc_filter.add_new_suitable_value("Introduced: Forbidden Sanctum league");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//
		//EFilterRule::registered_global_filter_rules.push_back(jc_filter_rule);
		EFilterRule::registered_filter_rules_for_list.push_back(jc_filter_rule);
	}

	register_filter_rule_folder("leagues folder", "Game item", "rule_folder_leagues", "buttons/pattern_folder_leagues");


	////////////////////////////////////////////////////////////////////////////////////////////
	//Awakened gems
	{
		jc_filter_rule = new EFilterRule();
		jc_filter_rule->icon_texture = NS_EGraphicCore::load_from_textures_folder("icons/Awakened");
		jc_filter_rule->category_id = 7;
		jc_filter_rule->named_id = "awakened gems folder";

		jc_filter_rule->localisation_text = new ELocalisationText();
		jc_filter_rule->localisation_text->localisations[NSW_localisation_EN] = "Awakened gems";
		jc_filter_rule->localisation_text->localisations[NSW_localisation_RU] = "Пробуждённые камни";
		jc_filter_rule->tag = "Game item";

		//filter by game item
		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("data type");
		jc_filter.add_new_suitable_value("Game item");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//filter "item tag" by 
		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("item tag");
		jc_filter.add_new_suitable_value("Awakened gem");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//filter "item tag" by 
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = true;
		jc_filter.target_tag.set_ID_by_string("worth");
		jc_filter.can_be_configured = true;
		jc_filter.add_new_suitable_value("Common", ELocalisationText::get_localisation_by_key("tag_common"));
		jc_filter.add_new_suitable_value("Moderate", ELocalisationText::get_localisation_by_key("tag_moderate"));
		jc_filter.add_new_suitable_value("Rare", ELocalisationText::get_localisation_by_key("tag_rare"));
		jc_filter.add_new_suitable_value("Expensive", ELocalisationText::get_localisation_by_key("tag_expensive"));
		jc_filter.add_new_suitable_value("Very expensive", ELocalisationText::get_localisation_by_key("tag_very_expensive"));

		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//
		//EFilterRule::registered_global_filter_rules.push_back(jc_filter_rule);
		EFilterRule::registered_filter_rules_for_list.push_back(jc_filter_rule);
	}



	//register_filter_rule_folder("awakened gems folder", "Game item", "rule_folder_awakened_gems", "buttons/pattern_folder_gems");








	////////////////////////////////////////////////////////////////////////////////////////////
	//			EXPLICIT SECTION
	////////////////////////////////////////////////////////////////////////////////////////////

	//ALL EXPLICITS
	{
		jc_filter_rule = new EFilterRule();
		jc_filter_rule->icon_texture = NS_EGraphicCore::load_from_textures_folder("icons/all_items");
		jc_filter_rule->category_id = 0;

		jc_filter_rule->localisation_text = new ELocalisationText();
		jc_filter_rule->localisation_text->localisations[NSW_localisation_EN] = "All explicits";
		jc_filter_rule->localisation_text->localisations[NSW_localisation_RU] = "Все атрибуты";
		jc_filter_rule->tag = "Explicit";

		//filter by game item
		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("data type");
		jc_filter.add_new_suitable_value("Explicit");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//


		//EFilterRule::registered_global_filter_rules.push_back(jc_filter_rule);
		EFilterRule::registered_filter_rules_for_list.push_back(jc_filter_rule);
	}

	//VEILS
	////////////////////////////////////////////////////////////////////////////////////////////
	{
		jc_filter_rule = new EFilterRule();
		jc_filter_rule->icon_texture = NS_EGraphicCore::load_from_textures_folder("icons/veiled");
		jc_filter_rule->category_id = 1;

		jc_filter_rule->localisation_text = new ELocalisationText();
		jc_filter_rule->localisation_text->localisations[NSW_localisation_EN] = "Veiled attributes";
		jc_filter_rule->localisation_text->localisations[NSW_localisation_RU] = "Завуалированные свойства";
		jc_filter_rule->tag = "Explicit";

		//filter by game item
		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("data type");
		jc_filter.add_new_suitable_value("Explicit");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//filter by game item
		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("explicit tag");
		jc_filter.add_new_suitable_value("Undefined veil");
		jc_filter_rule->required_tag_list.push_back(jc_filter);

		EFilterRule::registered_filter_rules_for_list.push_back(jc_filter_rule);
	}

	//INCURSION
	////////////////////////////////////////////////////////////////////////////////////////////
	{
		jc_filter_rule = new EFilterRule();
		jc_filter_rule->icon_texture = NS_EGraphicCore::load_from_textures_folder("icons/incursion");
		jc_filter_rule->category_id = 1;

		jc_filter_rule->localisation_text = new ELocalisationText();
		jc_filter_rule->localisation_text->localisations[NSW_localisation_EN] = "Incursion";
		jc_filter_rule->localisation_text->localisations[NSW_localisation_RU] = "Вмешательство";
		jc_filter_rule->tag = "Explicit";

		//filter by game item

		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("data type");
		jc_filter.add_new_suitable_value("Explicit");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//filter by game item
		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("explicit tag");
		jc_filter.add_new_suitable_value("Incursion");
		jc_filter_rule->required_tag_list.push_back(jc_filter);

		EFilterRule::registered_filter_rules_for_list.push_back(jc_filter_rule);
	}
	//
	//INCURSION
	////////////////////////////////////////////////////////////////////////////////////////////
	{
		jc_filter_rule = new EFilterRule();
		jc_filter_rule->icon_texture = NS_EGraphicCore::load_from_textures_folder("icons/essence_explicit");
		jc_filter_rule->category_id = 1;

		jc_filter_rule->localisation_text = new ELocalisationText();
		jc_filter_rule->localisation_text->localisations[NSW_localisation_EN] = "Special";
		jc_filter_rule->localisation_text->localisations[NSW_localisation_RU] = "Особые";
		jc_filter_rule->tag = "Explicit";

		//filter by game item

		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("data type");
		jc_filter.add_new_suitable_value("Explicit");
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//filter by game item
		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("explicit tag");
		jc_filter.add_new_suitable_value("Other");
		jc_filter_rule->required_tag_list.push_back(jc_filter);

		EFilterRule::registered_filter_rules_for_list.push_back(jc_filter_rule);
	}
	//

	//T1 BOW
	////////////////////////////////////////////////////////////////////////////////////////////
	{
		jc_filter_rule = new EFilterRule();
		jc_filter_rule->icon_texture = NS_EGraphicCore::load_from_textures_folder("icons/Harbinger_Bow_inventory_icon");
		jc_filter_rule->category_id = 2;

		jc_filter_rule->localisation_text = new ELocalisationText();
		jc_filter_rule->localisation_text->localisations[NSW_localisation_EN] = "Useful attributes";
		jc_filter_rule->localisation_text->localisations[NSW_localisation_RU] = "Полезные атрибуты";
		jc_filter_rule->tag = "Explicit";

		//filter by game item
		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("data type");
		jc_filter.add_new_suitable_value("Explicit");
		jc_filter.can_be_configured = false;
		jc_filter_rule->required_tag_list.push_back(jc_filter);
		//

		//filter by game item
		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("tier");
		jc_filter.can_be_configured = true;
		jc_filter.add_new_suitable_value("1");
		jc_filter.add_new_suitable_value("2");
		jc_filter.add_new_suitable_value("3");
		jc_filter.add_new_suitable_value("4");
		jc_filter.add_new_suitable_value("5");
		jc_filter.add_new_suitable_value("", ELocalisationText::get_localisation_by_key("tag_any_tier"));
		jc_filter_rule->required_tag_list.push_back(jc_filter);


		//filter by game item
		jc_filter = DataEntityTagFilter();
		jc_filter.can_be_configured = true;
		jc_filter.target_tag.set_ID_by_string("attribute tag");
		//jc_filter.add_new_suitable_value("damage", ELocalisationText::get_localisation_by_key("tag_damage"));
		//jc_filter.add_new_suitable_value("resource", ELocalisationText::get_localisation_by_key("tag_resource"));
		//jc_filter.add_new_suitable_value("mana",				ELocalisationText::get_localisation_by_key("tag_mana"));

		jc_filter.add_new_suitable_value("attack", ELocalisationText::get_localisation_by_key("tag_attack"));				jc_filter.set_text_color(1.00f, 0.50f, 0.25f, 1.0f);
		jc_filter.add_new_suitable_value("caster", ELocalisationText::get_localisation_by_key("tag_caster"));				jc_filter.set_text_color(0.25f, 1.00f, 1.00f, 1.0f);
		jc_filter.add_force_field();


		jc_filter.add_new_suitable_value("elemental", ELocalisationText::get_localisation_by_key("tag_elemental"));			jc_filter.set_text_color(1.00f, 0.90f, 0.80f, 1.0f);
		jc_filter.add_new_suitable_value("physical", ELocalisationText::get_localisation_by_key("tag_physical"));			jc_filter.set_text_color(1.00f, 0.50f, 0.25f, 1.0f);
		jc_filter.add_new_suitable_value("fire", ELocalisationText::get_localisation_by_key("tag_fire"));					jc_filter.set_text_color(1.00f, 0.75f, 0.50f, 1.0f);
		jc_filter.add_new_suitable_value("cold", ELocalisationText::get_localisation_by_key("tag_cold"));					jc_filter.set_text_color(0.25f, 0.75f, 1.00f, 1.0f);
		jc_filter.add_new_suitable_value("lightning", ELocalisationText::get_localisation_by_key("tag_lightning"));			jc_filter.set_text_color(0.25f, 1.00f, 1.00f, 1.0f);
		jc_filter.add_new_suitable_value("chaos", ELocalisationText::get_localisation_by_key("tag_chaos"));					jc_filter.set_text_color(1.00f, 1.00f, 0.00f, 1.0f);

		jc_filter.add_force_field();

		jc_filter.add_new_suitable_value("attribute", ELocalisationText::get_localisation_by_key("tag_attribute"));
		jc_filter.add_new_suitable_value("speed", ELocalisationText::get_localisation_by_key("tag_speed"));					jc_filter.set_text_color(0.25f, 1.00f, 0.50f, 1.0f);
		jc_filter.add_new_suitable_value("critical", ELocalisationText::get_localisation_by_key("tag_critical"));			jc_filter.set_text_color(0.25f, 0.50f, 1.00f, 1.0f);
		jc_filter.add_new_suitable_value("resistance", ELocalisationText::get_localisation_by_key("tag_resistance"));
		jc_filter.add_new_suitable_value("minion", ELocalisationText::get_localisation_by_key("tag_minions"));				jc_filter.set_text_color(0.00f, 0.75f, 0.25f, 1.0f);
		jc_filter.add_new_suitable_value("gem", ELocalisationText::get_localisation_by_key("tag_gem"));
		jc_filter_rule->required_tag_list.push_back(jc_filter);


		jc_filter = DataEntityTagFilter();
		jc_filter.target_tag.set_ID_by_string("suitable class");
		jc_filter.add_new_suitable_value("Gloves", ELocalisationText::get_localisation_by_key("tag_gloves"));				jc_filter.set_text_color(1.0f, 0.9f, 0.8f, 1.0f);
		jc_filter.add_new_suitable_value("Helmets", ELocalisationText::get_localisation_by_key("tag_helmets"));				jc_filter.set_text_color(1.0f, 0.9f, 0.8f, 1.0f);
		jc_filter.add_new_suitable_value("Boots", ELocalisationText::get_localisation_by_key("tag_boots"));					jc_filter.set_text_color(1.0f, 0.9f, 0.8f, 1.0f);
		jc_filter.add_force_field();

		jc_filter.add_new_suitable_value("Body armours", ELocalisationText::get_localisation_by_key("tag_body_armours"));		jc_filter.set_text_color(1.0f, 0.9f, 0.8f, 1.0f);
		jc_filter.add_force_field();



		jc_filter.add_new_suitable_value("Two Hand Axes", ELocalisationText::get_localisation_by_key("tag_two_hand_axes"));		jc_filter.set_text_color(1.0f, 0.7f, 0.7f, 1.0f);
		jc_filter.add_new_suitable_value("Tho hand Swords", ELocalisationText::get_localisation_by_key("tag_two_hand_swords"));		jc_filter.set_text_color(1.0f, 0.7f, 0.7f, 1.0f);
		jc_filter.add_new_suitable_value("Two hand Maces", ELocalisationText::get_localisation_by_key("tag_two_hand_maces"));		jc_filter.set_text_color(1.0f, 0.7f, 0.7f, 1.0f);
		jc_filter.add_new_suitable_value("Warstaves", ELocalisationText::get_localisation_by_key("tag_warstaves"));			jc_filter.set_text_color(1.0f, 0.7f, 0.7f, 1.0f);
		jc_filter.add_new_suitable_value("Bows", ELocalisationText::get_localisation_by_key("tag_bows"));				jc_filter.set_text_color(1.0f, 0.7f, 0.7f, 1.0f);
		jc_filter.add_force_field();

		jc_filter.add_new_suitable_value("Rings", ELocalisationText::get_localisation_by_key("tag_rings"));				jc_filter.set_text_color(1.0f, 0.9f, 0.5f, 1.0f);
		jc_filter.add_new_suitable_value("Amulets", ELocalisationText::get_localisation_by_key("tag_amulets"));				jc_filter.set_text_color(1.0f, 0.9f, 0.5f, 1.0f);
		jc_filter.add_new_suitable_value("Belts", ELocalisationText::get_localisation_by_key("tag_belts"));				jc_filter.set_text_color(1.0f, 0.9f, 0.5f, 1.0f);
		jc_filter.add_force_field();

		jc_filter.add_new_suitable_value("One Hand Axes", ELocalisationText::get_localisation_by_key("tag_one_hand_axes"));		jc_filter.set_text_color(1.0f, 0.7f, 0.7f, 1.0f);
		jc_filter.add_new_suitable_value("One Hand Swors", ELocalisationText::get_localisation_by_key("tag_one_hand_swords"));		jc_filter.set_text_color(1.0f, 0.7f, 0.7f, 1.0f);
		jc_filter.add_new_suitable_value("One Hand Maces", ELocalisationText::get_localisation_by_key("tag_one_hand_maces"));		jc_filter.set_text_color(1.0f, 0.7f, 0.7f, 1.0f);
		jc_filter.add_new_suitable_value("One Hand Daggers", ELocalisationText::get_localisation_by_key("tag_daggers"));				jc_filter.set_text_color(1.0f, 0.7f, 0.7f, 1.0f);
		jc_filter.add_new_suitable_value("One Hand Claws", ELocalisationText::get_localisation_by_key("tag_claws"));				jc_filter.set_text_color(1.0f, 0.7f, 0.7f, 1.0f);
		jc_filter.add_force_field();

		jc_filter.add_new_suitable_value("Sceptres", ELocalisationText::get_localisation_by_key("tag_sceptres"));			jc_filter.set_text_color(0.7f, 0.9f, 1.0f, 1.0f);
		jc_filter.add_new_suitable_value("Wands", ELocalisationText::get_localisation_by_key("tag_wands"));				jc_filter.set_text_color(0.7f, 0.9f, 1.0f, 1.0f);
		jc_filter.add_new_suitable_value("Daggers", ELocalisationText::get_localisation_by_key("tag_rune_daggers"));		jc_filter.set_text_color(0.7f, 0.9f, 1.0f, 1.0f);
		jc_filter.add_new_suitable_value("Staves", ELocalisationText::get_localisation_by_key("tag_staves"));				jc_filter.set_text_color(0.7f, 0.9f, 1.0f, 1.0f);
		jc_filter.add_force_field();

		jc_filter.add_new_suitable_value("Quivers", ELocalisationText::get_localisation_by_key("tag_quivers"));				jc_filter.set_text_color(0.7f, 1.0f, 0.7f, 1.0f);
		jc_filter.add_new_suitable_value("Shields", ELocalisationText::get_localisation_by_key("tag_shields"));				jc_filter.set_text_color(0.7f, 1.0f, 0.7f, 1.0f);
		jc_filter.add_force_field();



		jc_filter_rule->required_tag_list.push_back(jc_filter);

		EFilterRule::registered_filter_rules_for_list.push_back(jc_filter_rule);
	}






}

EWindowMain::~EWindowMain()
{

}

void EWindowMain::load_loot_filter_list()
{
	//EString::loot_filter_path_list.clear();
	//EString::loot_filter_name_list.clear();

	EButtonGroupLootFilterList* loot_filter_group = EWindowMain::existing_loot_filter_list;
	EButtonGroup* part_with_list = loot_filter_group->part_with_list;

	//std::vector<EntityButton*> deleted_buttons;

	//EInputCore::logger_param("size of elements - part_with_list->button_list", part_with_list->button_list.size());

	part_with_list->remove_all_workspace_buttons();



	//part_with_list->button_list.clear();

	//part_with_list->button_list.shrink_to_fit();


	for (auto& p : std::experimental::filesystem::directory_iterator(path_of_exile_folder))
	{

		bool autogenerated_loot_filter = false;
		//read first line
		std::ifstream file;
		std::string full_line;



		//


		std::string filter_path = EStringUtils::UTF8_to_ANSI(p.path().u8string());

		if (true)
		{
			std::string loot_filter_full_name = EStringUtils::UTF8_to_ANSI(p.path().filename().u8string());
			std::string loot_filter_name = loot_filter_full_name.substr(0, loot_filter_full_name.length() - 7);

			//EInputCore::logger_param("detect file:", filter_path);
			//writer << custom_sound << endl;;




			if
				(
					(loot_filter_full_name.length() >= 8)
					&&
					(EStringUtils::to_lower(loot_filter_full_name.substr(loot_filter_full_name.length() - 7, 7)) == ".filter")
					)
			{

				file.open(filter_path);
				filter_text_lines.clear();
				std::getline(file, full_line);
				if (EStringUtils::A_contains_B_ignore_case(full_line, "#AUTOGENERATED")) { autogenerated_loot_filter = true; }
				file.close();

				//cout <<"It sound!" << '\n'<<'\n';

				//if (EInputCore::key_pressed(GLFW_KEY_LEFT_SHIFT))
				//for (int i = 0; i < 200; i ++)
				{
					ELocalisationText ltext;;
					ltext.localisations[NSW_localisation_EN] = loot_filter_name;
					ltext.localisations[NSW_localisation_RU] = loot_filter_name;
					{
						EntityButtonForLootFilterSelector* loot_filter_button = new EntityButtonForLootFilterSelector();
						loot_filter_button->make_default_button_with_unedible_text
						(
							new ERegionGabarite(325.0f, 32.0f),
							part_with_list,
							(autogenerated_loot_filter)
							?
							(&EDataActionCollection::action_open_confirm_decline_window_for_autogenerated_loot_filter)
							:
							(&EDataActionCollection::action_select_this_loot_filter_from_list),
							ltext
						);
						loot_filter_button->can_be_stretched = true;

						loot_filter_button->entity_disabled = autogenerated_loot_filter;


						//std::max(1, 2);
						loot_filter_button->is_autogenerated_loot_filter = autogenerated_loot_filter;

						if (autogenerated_loot_filter)
						{
							loot_filter_button->main_text_area->set_color(1.0f, 0.3f, 0.15f, 1.0f);
						}

						loot_filter_button->loot_filter_full_path = filter_path;
						loot_filter_button->filter_name = loot_filter_name;


						part_with_list->add_button_to_working_group(loot_filter_button);
					}
				}
			}
			//EInputCore::logger_simple_success("push back");

			//EInputCore::logger_simple_success("It filter!");
			//EStringUtils::loot_filter_path_list.push_back(UTF8_to_ANSI(loot_filter_name));
			//EStringUtils::loot_filter_name_list.push_back(UTF8_to_ANSI(p.path().filename().u8string().substr(0, p.path().filename().u8string().length() - 7)));

			//std::cout << "It filter! " << p.path().filename().u8string() << '\n' << '\n';

			//ESound::custom_drop_sound.push_back(ESound::engine->addSoundSourceFromFile(custom_sound.c_str()));
		}
	}
}

void EWindowMain::load_custom_sound_list()
{
	for (int i = 0; i < EWindowMain::custom_sound_list.size(); i++)
	{
		if (!disable_deleting) { delete EWindowMain::custom_sound_list[i]; }
	}

	EWindowMain::custom_sound_list.clear();
	EWindowMain::custom_sound_list.shrink_to_fit();

	for (auto& p : std::experimental::filesystem::directory_iterator(path_of_exile_folder))
	{
		std::string sound_path = EStringUtils::UTF8_to_ANSI(p.path().u8string());

		std::string sound_name = EStringUtils::UTF8_to_ANSI(p.path().filename().u8string());

		if
			(
				(sound_name.length() >= 4)
				&&
				(
					(EStringUtils::to_lower(sound_name.substr(sound_name.length() - 4, 4)) == ".mp3")
					||
					(EStringUtils::to_lower(sound_name.substr(sound_name.length() - 4, 4)) == ".wav")
					)
				)
		{
			ENamedSound* named_sound = new ENamedSound(path_of_exile_folder + p.path().filename().u8string());
			ELocalisationText l_text;
			l_text.base_name = sound_name;
			l_text.localisations[NSW_localisation_EN] = sound_name;
			l_text.localisations[NSW_localisation_RU] = sound_name;
			named_sound->localisation_text = l_text;

			EWindowMain::custom_sound_list.push_back(named_sound);
		}
	}
}

void EWindowMain::load_ingame_sound_list()
{






	ENamedSound* named_sound = nullptr;
	ELocalisationText l_text;

	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	named_sound = new ENamedSound("data/sounds/default_drop_sound/ItemFilterAlert06.wav");
	l_text.base_name = "6";
	l_text.localisations[NSW_localisation_EN] = "Something worth!";
	l_text.localisations[NSW_localisation_RU] = "Что-то ценное!";
	named_sound->localisation_text = l_text;
	EWindowMain::default_sound_list.push_back(named_sound);

	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


	named_sound = new ENamedSound("data/sounds/default_drop_sound/ItemFilterAlert01.wav");
	l_text.base_name = "1";
	l_text.localisations[NSW_localisation_EN] = "Iron drum 1";
	l_text.localisations[NSW_localisation_RU] = "Железный барабан 1";
	named_sound->localisation_text = l_text;
	EWindowMain::default_sound_list.push_back(named_sound);



	named_sound = new ENamedSound("data/sounds/default_drop_sound/ItemFilterAlert10.wav");
	l_text.base_name = "10";
	l_text.localisations[NSW_localisation_EN] = "Iron drum 2";
	l_text.localisations[NSW_localisation_RU] = "Железный барабан 2";
	named_sound->localisation_text = l_text;
	EWindowMain::default_sound_list.push_back(named_sound);






	named_sound = new ENamedSound("data/sounds/default_drop_sound/ItemFilterAlert13.wav");
	l_text.base_name = "13";
	l_text.localisations[NSW_localisation_EN] = "Iron drum 3";
	l_text.localisations[NSW_localisation_RU] = "Железный барабан 3";
	named_sound->localisation_text = l_text;
	EWindowMain::default_sound_list.push_back(named_sound);


	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


	named_sound = new ENamedSound("data/sounds/default_drop_sound/ItemFilterAlert03.wav");
	l_text.base_name = "3";
	l_text.localisations[NSW_localisation_EN] = "Drum 1";
	l_text.localisations[NSW_localisation_RU] = "Барабан 1";
	named_sound->localisation_text = l_text;
	EWindowMain::default_sound_list.push_back(named_sound);



	named_sound = new ENamedSound("data/sounds/default_drop_sound/ItemFilterAlert11.wav");
	l_text.base_name = "11";
	l_text.localisations[NSW_localisation_EN] = "Drum 2";
	l_text.localisations[NSW_localisation_RU] = "Барабан 2";
	named_sound->localisation_text = l_text;
	EWindowMain::default_sound_list.push_back(named_sound);



	named_sound = new ENamedSound("data/sounds/default_drop_sound/ItemFilterAlert16.wav");
	l_text.base_name = "16";
	l_text.localisations[NSW_localisation_EN] = "Drum 3";
	l_text.localisations[NSW_localisation_RU] = "Барабан 3";
	named_sound->localisation_text = l_text;
	EWindowMain::default_sound_list.push_back(named_sound);




	named_sound = new ENamedSound("data/sounds/default_drop_sound/ItemFilterAlert02.wav");
	l_text.base_name = "2";
	l_text.localisations[NSW_localisation_EN] = "Drum 4";
	l_text.localisations[NSW_localisation_RU] = "Барабан 4";
	named_sound->localisation_text = l_text;
	EWindowMain::default_sound_list.push_back(named_sound);
	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


	named_sound = new ENamedSound("data/sounds/default_drop_sound/ItemFilterAlert04.wav");
	l_text.base_name = "4";
	l_text.localisations[NSW_localisation_EN] = "Echo 1";
	l_text.localisations[NSW_localisation_RU] = "Эхо 1";
	named_sound->localisation_text = l_text;
	EWindowMain::default_sound_list.push_back(named_sound);





	named_sound = new ENamedSound("data/sounds/default_drop_sound/ItemFilterAlert05.wav");
	l_text.base_name = "5";
	l_text.localisations[NSW_localisation_EN] = "Echo 2";
	l_text.localisations[NSW_localisation_RU] = "Эхо 2";
	named_sound->localisation_text = l_text;
	EWindowMain::default_sound_list.push_back(named_sound);





	named_sound = new ENamedSound("data/sounds/default_drop_sound/ItemFilterAlert07.wav");
	l_text.base_name = "7";
	l_text.localisations[NSW_localisation_EN] = "Echo 3";
	l_text.localisations[NSW_localisation_RU] = "Эхо 3";
	named_sound->localisation_text = l_text;
	EWindowMain::default_sound_list.push_back(named_sound);








	named_sound = new ENamedSound("data/sounds/default_drop_sound/ItemFilterAlert08.wav");
	l_text.base_name = "8";
	l_text.localisations[NSW_localisation_EN] = "Echo 4";
	l_text.localisations[NSW_localisation_RU] = "Эхо 4";
	named_sound->localisation_text = l_text;
	EWindowMain::default_sound_list.push_back(named_sound);








	named_sound = new ENamedSound("data/sounds/default_drop_sound/ItemFilterAlert09.wav");
	l_text.base_name = "9";
	l_text.localisations[NSW_localisation_EN] = "Echo 5";
	l_text.localisations[NSW_localisation_RU] = "Эхо 5";
	named_sound->localisation_text = l_text;
	EWindowMain::default_sound_list.push_back(named_sound);





	named_sound = new ENamedSound("data/sounds/default_drop_sound/ItemFilterAlert14.wav");
	l_text.base_name = "14";
	l_text.localisations[NSW_localisation_EN] = "Echo 6";
	l_text.localisations[NSW_localisation_RU] = "Эхо 6";
	named_sound->localisation_text = l_text;
	EWindowMain::default_sound_list.push_back(named_sound);






	named_sound = new ENamedSound("data/sounds/default_drop_sound/ItemFilterAlert15.wav");
	l_text.base_name = "15";
	l_text.localisations[NSW_localisation_EN] = "Echo 7";
	l_text.localisations[NSW_localisation_RU] = "Эхо 7";
	named_sound->localisation_text = l_text;
	EWindowMain::default_sound_list.push_back(named_sound);

	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	named_sound = new ENamedSound("data/sounds/default_drop_sound/ItemFilterAlert12.wav");
	l_text.base_name = "12";
	l_text.localisations[NSW_localisation_EN] = "Glass";
	l_text.localisations[NSW_localisation_RU] = "Стекло";
	named_sound->localisation_text = l_text;
	EWindowMain::default_sound_list.push_back(named_sound);

	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	named_sound = new ENamedSound("data/sounds/default_drop_sound/SHAlchemy.wav");
	l_text.base_name = "SHAlchemy";
	l_text.localisations[NSW_localisation_EN] = "Shaper: Alchemy orb";
	l_text.localisations[NSW_localisation_RU] = "Шейпер: Сфера алхимии";
	named_sound->localisation_text = l_text;
	EWindowMain::default_sound_list.push_back(named_sound);

	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	named_sound = new ENamedSound("data/sounds/default_drop_sound/SHBlessed.wav");
	l_text.base_name = "SHBlessed";
	l_text.localisations[NSW_localisation_EN] = "Shaper: Blessed orb";
	l_text.localisations[NSW_localisation_RU] = "Шейпер: Благодатная сфера";
	named_sound->localisation_text = l_text;
	EWindowMain::default_sound_list.push_back(named_sound);

	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	named_sound = new ENamedSound("data/sounds/default_drop_sound/SHChaos.wav");
	l_text.base_name = "SHChaos";
	l_text.localisations[NSW_localisation_EN] = "Shaper: Chaos orb";
	l_text.localisations[NSW_localisation_RU] = "Шейпер: Сфера хаоса";
	named_sound->localisation_text = l_text;
	EWindowMain::default_sound_list.push_back(named_sound);

	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	named_sound = new ENamedSound("data/sounds/default_drop_sound/SHDivine.wav");
	l_text.base_name = "SHDivine";
	l_text.localisations[NSW_localisation_EN] = "Shaper: Divine orb";
	l_text.localisations[NSW_localisation_RU] = "Шейпер: Божественная сфера";
	named_sound->localisation_text = l_text;
	EWindowMain::default_sound_list.push_back(named_sound);

	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	named_sound = new ENamedSound("data/sounds/default_drop_sound/SHExalted.wav");
	l_text.base_name = "SHExalted";
	l_text.localisations[NSW_localisation_EN] = "Shaper: Exalted orb";
	l_text.localisations[NSW_localisation_RU] = "Шейпер: Сфера возвышения";
	named_sound->localisation_text = l_text;
	EWindowMain::default_sound_list.push_back(named_sound);

	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	named_sound = new ENamedSound("data/sounds/default_drop_sound/SHFusing.wav");
	l_text.base_name = "SHFusing";
	l_text.localisations[NSW_localisation_EN] = "Shaper: Fusing orb";
	l_text.localisations[NSW_localisation_RU] = "Шейпер: Сфера соединения";
	named_sound->localisation_text = l_text;
	EWindowMain::default_sound_list.push_back(named_sound);

	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	named_sound = new ENamedSound("data/sounds/default_drop_sound/SHGeneral.wav");
	l_text.base_name = "SHGeneral";
	l_text.localisations[NSW_localisation_EN] = "Shaper: General";
	l_text.localisations[NSW_localisation_RU] = "Шейпер: Общее";
	named_sound->localisation_text = l_text;
	EWindowMain::default_sound_list.push_back(named_sound);

	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	named_sound = new ENamedSound("data/sounds/default_drop_sound/SHMirror.wav");
	l_text.base_name = "SHMirror";
	l_text.localisations[NSW_localisation_EN] = "Shaper: Mirror of kalandra";
	l_text.localisations[NSW_localisation_RU] = "Шейпер: Зеркало Каландры";
	named_sound->localisation_text = l_text;
	EWindowMain::default_sound_list.push_back(named_sound);

	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	named_sound = new ENamedSound("data/sounds/default_drop_sound/SHRegal.wav");
	l_text.base_name = "SHRegal";
	l_text.localisations[NSW_localisation_EN] = "Shaper: Orb of regal";
	l_text.localisations[NSW_localisation_RU] = "Шейпер: Сфера Царей";
	named_sound->localisation_text = l_text;
	EWindowMain::default_sound_list.push_back(named_sound);

	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	named_sound = new ENamedSound("data/sounds/default_drop_sound/SHVaal.wav");
	l_text.base_name = "SHVaal";
	l_text.localisations[NSW_localisation_EN] = "Shaper: Vaal orb";
	l_text.localisations[NSW_localisation_RU] = "Шейпер: Свера Ваал";
	named_sound->localisation_text = l_text;
	EWindowMain::default_sound_list.push_back(named_sound);

	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

}

//enum class ReadLootFilterState
//{
//	BEGIN,
//	ATTRIBUTE_NAME,
//	WTF
//};

bool EWindowMain::text_is_condition(std::string& buffer_text)
{
	return
		(buffer_text == "<=")
		||
		(buffer_text == "<")
		||
		(buffer_text == "=")
		||
		(buffer_text == "==")
		||
		(buffer_text == ">")
		||
		(buffer_text == ">=")
		//||
		//(buffer_text == "<>")
		||
		(buffer_text == "!")
		||
		(buffer_text == "!=");
}

void EWindowMain::open_loot_filter(std::string _full_path, LootFilterOpenMode _loot_filter_mode)
{
	//_full_path = EStringUtils::UTF8_to_ANSI(_full_path);
	EInputCore::logger_param("open loot filter", _full_path);

	//loot_filter_editor->scroll_y = 1.0f;




	std::ifstream file;
	std::string full_line;

	file.open(_full_path);

	filter_text_lines.clear();

	while (std::getline(file, full_line))
	{
		filter_text_lines.push_back(full_line);
	}


	parse_filter_text_lines(nullptr, _loot_filter_mode);

	//for (EButtonGroup* group : EWindowMain::loot_filter_editor->group_list)
	//{
	//	if (EButtonGroupFilterBlock* block = dynamic_cast<EButtonGroupFilterBlock*>(group))
	//	{
	//		EInputCore::logger_simple_info("It FilterBlock!");
	//	}
	//	else
	//	{
	//		EInputCore::logger_simple_info("It NOT FilterBlock!");
	//	}
	//}

	file.close();


}

EntityButtonVariantRouterForFilterBlock* EWindowMain::create_show_hide_button()
{



	return nullptr;


}

EButtonGroupFilterBlock* EWindowMain::create_filter_block(EButtonGroup* _target_editor, int _specific_position = -1)
{

	float left_control_segment_size = 40.0f;
	float non_listed_segment_size = 370.0f;

	float ray_preview_segment_size = 32.0f;
	float preview_box_segment_size = 150.0f;


	//NEW GROUP
	//WHOLE FILTER BLOCK
	/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	EButtonGroupFilterBlock*
		whole_filter_block_group = new EButtonGroupFilterBlock(new ERegionGabarite(1200.0f, 280.0f));
	whole_filter_block_group->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DARKEN, bgroup_with_slider);
	whole_filter_block_group->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_static_autosize);
	whole_filter_block_group->debug_name = "Whole filter block";
	whole_filter_block_group->focusable_for_select = true;
	whole_filter_block_group->additional_y_distance = 24.0f;
	//whole_filter_block_group->group_have_background = false;

	if (_target_editor != nullptr)
	{
		if (_specific_position < 0)
		{
			_target_editor->add_group(whole_filter_block_group);
		}
		else
		{
			_target_editor->add_group_scecific_position(whole_filter_block_group, _specific_position);
		}
	}

	/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

		//NEW GROUP
		//workspace bottom part
		/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	EButtonGroup*
		workspace_filter_block_part = EButtonGroup::create_button_group_without_bg(new ERegionGabarite(1200.0f, 150.0f), EGUIStyle::active_style)
		->set_parameters(ChildAlignMode::ALIGN_HORIZONTAL, NSW_dynamic_autosize, NSW_dynamic_autosize);

	whole_filter_block_group->add_group(workspace_filter_block_part);
	workspace_filter_block_part->debug_name = "Filter block workspace part";
	/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


	/*			TOP CONTROL PART			*/
	//NEW GROUP
	// whole line
	/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	EButtonGroupTopControlSection*
		control_part = new EButtonGroupTopControlSection(new ERegionGabarite(1200.0f, 30.0f));
	control_part->init_button_group(EGUIStyle::active_style, BrickStyleID::NONE, bgroup_without_slider);
	control_part->set_parameters(ChildAlignMode::ALIGN_HORIZONTAL, NSW_dynamic_autosize, NSW_static_autosize);

	control_part->fake_borders_id = BrickStyleID::GROUP_DEFAULT;
	//control_part->pointer_to_filter_block_group = whole_filter_block_group;
	control_part->debug_name = "Control part";
	control_part->can_resize_to_workspace_size_y = true;

	whole_filter_block_group->pointer_to_top_control_block = control_part;
	whole_filter_block_group->add_group(control_part);
	/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	//NEW GROUP
	//left section for ID
	/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	EButtonGroup*
		block_for_ID = new EButtonGroup(new ERegionGabarite(left_control_segment_size, 30.0f));
	block_for_ID->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DEFAULT, bgroup_with_slider);
	block_for_ID->set_parameters(ChildAlignMode::ALIGN_HORIZONTAL, NSW_static_autosize, NSW_dynamic_autosize);
	block_for_ID->debug_name = "Left show/hide";

	whole_filter_block_group->pointer_to_ID_block = block_for_ID;
	control_part->add_group(block_for_ID);
	/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////



	{
		EntityButton*
			id_button = new EntityButton();

		block_for_ID->add_button_to_working_group(id_button);
		id_button->make_default_button_with_unedible_text
		(
			new ERegionGabarite(left_control_segment_size, 30.0f),
			block_for_ID,
			nullptr,
			ELocalisationText::empty_localisation
		);
		id_button->main_text_area->font = EFont::font_list[1];
		id_button->main_text_area->font_scale = 0.75f;
		id_button->can_be_stretched;
		whole_filter_block_group->id_button = id_button;
	}






	//mid section for button import
	/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	//EButtonGroup*
	//	control_part_mid_import = new EButtonGroup(new ERegionGabarite(215.0f, 30.0f));
	//control_part_mid_import->init_button_group(EGUIStyle::active_style, false, false, true);
	//control_part_mid_import->set_parameters(ChildAlignMode::ALIGN_HORIZONTAL, NSW_static_autosize, NSW_dynamic_autosize);
	//control_part_mid_import->debug_name = "Mid part import";

	//whole_filter_block_group->pointer_to_control_group_mid_import = control_part_mid_import;
	//control_part->add_group(control_part_mid_import);
	/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////



	//NEW GROUP
	//mid section for version control
	/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	EButtonGroup*
		block_for_loot_versions = new EButtonGroup(new ERegionGabarite(111.0f, 30.0f));
	block_for_loot_versions->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DEFAULT, bgroup_without_slider);
	block_for_loot_versions->set_parameters(ChildAlignMode::ALIGN_HORIZONTAL, NSW_dynamic_autosize, NSW_dynamic_autosize);
	block_for_loot_versions->debug_name = "Versions";
	//block_for_loot_versions->auto_superfocused = true;

	whole_filter_block_group->pointer_to_control_group_mid_versions = block_for_loot_versions;
	control_part->add_group(block_for_loot_versions);
	/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////










	//left additional section
	/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	EButtonGroup*
		left_control_section = EButtonGroup::create_default_button_group(new ERegionGabarite(left_control_segment_size, 20.0f), EGUIStyle::active_style)
		->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_static_autosize, NSW_dynamic_autosize);

	workspace_filter_block_part->add_group(left_control_section);
	/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////







	//////////////////////////////////////////
	//			NON LISTED SECTION			//
	//////////////////////////////////////////





	//left side for nonlisted parameters
	/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	EButtonGroup*
		non_list_whole_group = EButtonGroup::create_default_button_group
		(
			new ERegionGabarite(non_listed_segment_size, 160.0f),
			EGUIStyle::active_style
		)->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_static_autosize, NSW_dynamic_autosize);

	non_list_whole_group->have_rama = true;

	whole_filter_block_group->pointer_to_whole_non_listed_segment = non_list_whole_group;

	workspace_filter_block_part->add_group(non_list_whole_group);


	/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

			//BOTTOM WORKSPACE FOR NONLISTED
			/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	EButtonGroup*
		non_listed_workspace_group = EButtonGroup::create_button_group_without_bg
		(
			new ERegionGabarite(non_listed_segment_size, 160.0f),
			EGUIStyle::active_style
		)->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_dynamic_autosize);

	whole_filter_block_group->pointer_to_workspace_non_listed_segment = non_listed_workspace_group;

	non_listed_workspace_group->add_default_clickable_region_with_text_area(ELocalisationText::get_localisation_by_key("text_region_press_plus_button_to_add_new_condition"));

	non_list_whole_group->add_group(non_listed_workspace_group);
	/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	//TOP SHOW HIDE CONTINUE
	/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	EButtonGroup*
		show_hide_continue_group = EButtonGroup::create_button_group_without_bg
		(
			new ERegionGabarite(non_listed_segment_size, 30.0f),
			EGUIStyle::active_style
		)->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_static_autosize);

	whole_filter_block_group->pointer_to_block_show_hide_continue = show_hide_continue_group;
	non_list_whole_group->add_group(show_hide_continue_group);
	/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////









//		SHOW/HIDE LOOT BUTTON ROUTER
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	EntityButtonVariantRouterForFilterBlock*
		show_hide_router = new EntityButtonVariantRouterForFilterBlock();
	show_hide_continue_group->add_button_to_working_group(show_hide_router);

	show_hide_router->make_as_default_router_variant_button(new ERegionGabarite(140.0f, 29.0f));
	show_hide_router->can_be_stretched = true;
	show_hide_router->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_make_unsave_filter_block_changes_and_refresh_loot_simulator);
	show_hide_router->add_default_description_by_key("description_show_hide_loot");

	show_hide_router->add_router_variant_with_localization_key_and_color("variant_hide_loot", 1.00f, 0.50f, 0.45f, 1.00f);
	show_hide_router->add_router_variant_with_localization_key_and_color("variant_show_loot", 0.80f, 1.00f, 0.80f, 1.00f);

	show_hide_router->select_variant(1);

	whole_filter_block_group->button_show_hide = show_hide_router;
	////////////////////////////////////////////////////////////////////////

	if (true)
	{
		//		CONTINUE PARAMETER
		/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		EntityButtonVariantRouterForFilterBlock*
			button_continue = new EntityButtonVariantRouterForFilterBlock();
		show_hide_continue_group->add_button_to_working_group(button_continue);

		button_continue->make_as_default_router_variant_button
		(
			new ERegionGabarite(140.0f, 29.0f)
		);
		button_continue->can_be_stretched = true;

		button_continue->add_router_variant_with_localization_key_and_color("variant_continue", 0.25f, 0.9f, 1.0f, 1.0f);
		button_continue->add_router_variant_with_localization_key_and_color("variant_not_continue", 0.3f, 0.4f, 0.5f, 1.0f);

		button_continue->select_variant(1);


		whole_filter_block_group->button_continue = button_continue;
		/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////










	//		IMPORT BUTTON
	/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	//EntityButtonForFilterBlock*
	//	top_import_button = new EntityButtonForFilterBlock();
	//top_import_button->parent_filter_block = whole_filter_block_group;

	//top_import_button->make_default_button_with_unedible_text
	//(
	//	new ERegionGabarite(200.0f, 29.0f),
	//	control_part_mid_import,
	//	&EDataActionCollection::action_import_filter_text_from_clipboard,
	//	"Import filter block"
	//);

	//control_part_mid_import->button_list.push_back(top_import_button);
	/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////



		std::string localization_keys[5] =
		{
			"variant_version_very_soft",
			"variant_version_soft",
			"variant_version_regular",
			"variant_version_strict",
			"variant_version_very_strict"
		};

		std::string localization_keys_for_window[5] =
		{
			"variant_mode_full_ignore",
			"variant_mode_hide",
			"variant_mode_ignore",
			"variant_mode_default",
			"variant_mode_very_focus"
		};





		EColor_4 color_table[5][4] =
		{
			{1.0f,	0.0f,	0.0f,	1.0f},
			{1.0f,	0.5f,	0.45f,	1.0f},
			{0.7f,	0.7f,	0.7f,	1.0f},
			{0.9f,	0.95f,	1.0f,	1.0f},
			{0.6f,	1.0f,	0.8f,	1.0f}
		};

		ETextureGabarite* icon_array[5] =
		{
			NS_DefaultGabarites::texture_loot_version_full_ignore,
			NS_DefaultGabarites::texture_loot_version_hide,
			NS_DefaultGabarites::texture_loot_version_ignore,
			NS_DefaultGabarites::texture_loot_version_default,
			NS_DefaultGabarites::texture_loot_version_focus
		};

		//VERSION CONTROL
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		EntityButtonButtonGroupActivator*
			version_config_button = new EntityButtonButtonGroupActivator();
		version_config_button->force_field_right = 3.0f;

		block_for_loot_versions->add_button_to_working_group(version_config_button);

		version_config_button->target_group = EWindowMain::registered_group_loot_version_configure;

		version_config_button->make_as_default_button_with_icon
		(
			new ERegionGabarite(29.0f, 29.0f),
			block_for_loot_versions,
			&EDataActionCollection::action_set_button_group_as_active,
			NS_DefaultGabarites::texture_config_gear
		);




		//VERSION CONTROL
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		for (int i = 0; i < NSW_LOOT_FILTER_MAX_VERSIONS; i++)
		{
			EntityButtonVariantRouterForFilterBlock*
				loot_version_router = new EntityButtonVariantRouterForFilterBlock();
			block_for_loot_versions->add_button_to_working_group(loot_version_router);

			loot_version_router->make_as_default_router_variant_button(new ERegionGabarite(150.0f, 29.0f));
			loot_version_router->can_be_stretched = true;

			loot_version_router->action_on_choose_variant_from_window.push_back(&EDataActionCollection::action_make_unsave_filter_block_changes_and_refresh_loot_simulator);
			//button_variant_router->action_on_choose_variant_from_window.push_back(&EDataActionCollection::action_refresh_loot_simulator);

			loot_version_router->main_text_area->offset_by_gabarite_size_x = 0.0;
			loot_version_router->main_text_area->offset_by_text_size_x = 0.0;

			loot_version_router->height_division = 1;

			whole_filter_block_group->version_routers[i] = loot_version_router;

			loot_version_router->rotate_variant_mode = RotateVariantMode::OPEN_CHOOSE_WINDOW;
			loot_version_router->add_default_description_by_key("description_loot_version_control");

			/*for (int j = 0; j < 5; j++)
			{

				loot_version_router->add_router_variant_with_localization_color_and_icon
				(
					&EWindowMain::registered_group_loot_version_configure->pointer_to_version_name_button[i]->main_text_area->localisation_text,
					localization_keys_for_window[j],
					color_table[j][0],
					color_table[j][1],
					color_table[j][2],
					color_table[j][3],
					icon_array[j]
				);

			}*/

			whole_filter_block_group->refresh_version_router_button();

			loot_version_router->select_variant(3);


		}
		// // // // // // //// // // // // // //// // // // // // //










		//	BOTTOM SECTION FOR ADD NEW CONTENT, AND MOVE BLOCK
		/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		EButtonGroup*
			bottom_section_for_block_control = EButtonGroup::create_button_group_without_bg
			(
				new ERegionGabarite(40.0f, 90.0f),
				EGUIStyle::active_style
			);
		bottom_section_for_block_control->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_dynamic_autosize);
		//bottom_section_for_block_control->ignore_vertical_buttons_force_field = true;
		left_control_section->add_group(bottom_section_for_block_control);
		/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////




		//	TOP SECTION FOR REMOVE BLOCK
		/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		EButtonGroup* top_section_for_remove = EButtonGroup::create_button_group_without_bg
		(
			new ERegionGabarite(40.0f, 30.0f),
			EGUIStyle::active_style
		);
		top_section_for_remove->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_static_autosize);
		top_section_for_remove->ignore_vertical_buttons_force_field = true;
		left_control_section->add_group(top_section_for_remove);
		/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////




		///////////		BUTTON PLUS		///////////
		EntityButton*
			jc_button = new EntityButton();
		jc_button->make_as_default_button_with_icon
		(
			new ERegionGabarite(40.0f, 40.0f),
			bottom_section_for_block_control,
			&EDataActionCollection::action_open_add_content_window,
			NS_DefaultGabarites::texture_button_plus
		);
		jc_button->new_line_method = NewLineMethod::FORBIDDEN;
		//jc_button->force_field_up = 16.0f;

		EDataContainer_Button_OpenButtonGroup*
			data_open_group = new EDataContainer_Button_OpenButtonGroup();
		data_open_group->master_group = whole_filter_block_group;
		data_open_group->target_group = EWindowMain::data_entity_filter;

		EntityButton::get_last_custom_data(jc_button)->data_container = data_open_group;

		bottom_section_for_block_control->add_button_to_working_group(jc_button);
		////////////////



		if (true)
		{
			///////////		BUTTON MOVE DOWN		///////////
			EntityButtonForFilterBlock*
				move_down_button = new EntityButtonForFilterBlock();
			move_down_button->make_as_default_button_with_full_icon
			(
				new ERegionGabarite(40.0f, 15.0f),
				bottom_section_for_block_control,
				&EDataActionCollection::action_move_filter_block_down,
				NS_DefaultGabarites::texture_button_move_down
			);
			move_down_button->force_field_bottom = 8.0f;
			move_down_button->parent_filter_block = whole_filter_block_group;
			move_down_button->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_make_unsave_filter_block_changes_and_refresh_loot_simulator);

			bottom_section_for_block_control->add_button_to_working_group(move_down_button);
			////////////////


			///////////		BUTTON MOVE		///////////
			EntityButtonMoveButtonGroup*
				move_button = new EntityButtonMoveButtonGroup();
			move_button->make_as_default_button_with_full_icon
			(
				new ERegionGabarite(40.0f, 15.0f),
				bottom_section_for_block_control,
				&EDataActionCollection::action_move_button_group,
				NS_DefaultGabarites::texture_button_move
			);
			move_button->new_line_method = NewLineMethod::FORCIBLY;
			move_button->target_group_for_moving = whole_filter_block_group;
			move_button->parent_group_for_moving = _target_editor;
			move_button->move_method = MoveVectorMethod::METHOD_DRAG;

			bottom_section_for_block_control->add_button_to_working_group(move_button);
			////////////////


			///////////		BUTTON MOVE UP		///////////
			EntityButtonForFilterBlock*
				move_up_button = new EntityButtonForFilterBlock();
			move_up_button->make_as_default_button_with_full_icon
			(
				new ERegionGabarite(40.0f, 15.0f),
				bottom_section_for_block_control,
				&EDataActionCollection::action_move_filter_block_up,
				NS_DefaultGabarites::texture_button_move_up
			);
			move_up_button->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_make_unsave_filter_block_changes_and_refresh_loot_simulator);
			move_up_button->parent_filter_block = whole_filter_block_group;
			move_up_button->force_field_up = 8.0f;

			bottom_section_for_block_control->add_button_to_working_group(move_up_button);
			////////////////
		}







		///////////		BUTTON CUT		///////////
		EntityButtonMoveButtonGroup*
			cut_button = new EntityButtonMoveButtonGroup();
		cut_button->make_as_default_button_with_full_icon
		(
			new ERegionGabarite(40.0f, 15.0f),
			bottom_section_for_block_control,
			&EDataActionCollection::action_move_button_group,
			NS_DefaultGabarites::texture_button_cut
		);
		cut_button->new_line_method = NewLineMethod::FORCIBLY;
		cut_button->target_group_for_moving = whole_filter_block_group;
		cut_button->parent_group_for_moving = _target_editor;
		cut_button->move_method = MoveVectorMethod::METHOD_PRESS;

		bottom_section_for_block_control->add_button_to_working_group(cut_button);
		////////////////






	///////////		REMOVE FILTER BLOCK		///////////
		EntityButtonForFilterBlock*
			remove_filter_block_button = new EntityButtonForFilterBlock();
		remove_filter_block_button->make_as_default_button_with_full_icon
		(
			new ERegionGabarite(40.0f, 30.0f),
			top_section_for_remove,
			&EDataActionCollection::action_open_mark_filter_blocks_as_removed_confirmation,
			NS_DefaultGabarites::texture_button_remove_filter_block
		);
		remove_filter_block_button->parent_filter_block = whole_filter_block_group;

		remove_filter_block_button->main_custom_data->actions_on_update.push_back(&EDataActionCollection::action_highlight_removed_block);

		top_section_for_remove->add_button_to_working_group(remove_filter_block_button);
		////////////////






		//####### ITEM GROUP //#######
		/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		EButtonGroup*
			listed_condition_segment = EButtonGroup::create_button_group_without_bg(new ERegionGabarite(111.0f, 160.0f), EGUIStyle::active_style)
			->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_dynamic_autosize);
		listed_condition_segment->child_align_direction = ChildElementsAlignDirection::BOTTOM_TO_TOP;
		//listed_condition_segment->button_size_x_override = 200.0f;
		//root group data ontaner
		whole_filter_block_group->pointer_to_listed_segment_in_filter_block = listed_condition_segment;

		workspace_filter_block_part->add_group(listed_condition_segment);
		/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


		//ATTRIBUTE TAB
		if (true)
		{

			/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
			EButtonGroup*
				attribute_tab = EButtonGroup::create_default_button_group(new ERegionGabarite(111.0f, 28.0f), EGUIStyle::active_style)
				->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_static_autosize);
			attribute_tab->child_align_direction = ChildElementsAlignDirection::BOTTOM_TO_TOP;
			//listed_condition_segment->button_size_x_override = 200.0f;
			//root group data ontaner
			whole_filter_block_group->pointer_to_attribute_tab = attribute_tab;

			listed_condition_segment->add_group(attribute_tab);
			/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

			//SECTION FOR LISTED BLOCKS
			/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
			EButtonGroup*
				section_for_listed_attributes = EButtonGroup::create_button_group_without_bg(new ERegionGabarite(111.0f, 160.0f), EGUIStyle::active_style)
				->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_dynamic_autosize);
			section_for_listed_attributes->child_align_direction = ChildElementsAlignDirection::BOTTOM_TO_TOP;
			//listed_condition_segment->button_size_x_override = 200.0f;
			//root group data ontaner
			whole_filter_block_group->pointer_to_listed_attributes = section_for_listed_attributes;

			listed_condition_segment->add_group(section_for_listed_attributes);
			/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		}

		//FAKE LISTED GROUP
		/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		{
			EButtonGroup*
				fake_listed_condition_segment = EButtonGroup::create_button_group_without_bg(new ERegionGabarite(111.0f, 160.0f), EGUIStyle::active_style)
				->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_dynamic_autosize);
			fake_listed_condition_segment->child_align_direction = ChildElementsAlignDirection::BOTTOM_TO_TOP;
			//listed_condition_segment->button_size_x_override = 200.0f;
			//root group data ontaner
			whole_filter_block_group->pointer_to_fake_listed_segment_in_filter_block = fake_listed_condition_segment;
			fake_listed_condition_segment->button_group_is_active = false;
			workspace_filter_block_part->add_group(fake_listed_condition_segment);
		}
		/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////




		/*			SECONDARY COSMETIC SEGMENT GROUP		*/

		//		SOUND
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////	
		EButtonGroup*
			sound_cosmetic_segment
			= EButtonGroup::create_default_button_group(new ERegionGabarite(350.0f, 150.0f), EGUIStyle::active_style)
			->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_static_autosize, NSW_static_autosize);

		sound_cosmetic_segment->button_group_is_active = false;
		//sound_cosmetic_segment->disable_gabarite = true;

		workspace_filter_block_part->add_group(sound_cosmetic_segment);
		whole_filter_block_group->pointer_to_sound_segment = sound_cosmetic_segment;
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////








		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		EButtonGroup*
			bottom_sound_segment = EButtonGroup::create_invisible_button_group(new ERegionGabarite(350.0f, 50.0f), EGUIStyle::active_style)
			->set_parameters(ChildAlignMode::ALIGN_HORIZONTAL, NSW_dynamic_autosize, NSW_static_autosize);

		sound_cosmetic_segment->add_group(bottom_sound_segment);
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		EButtonGroup*
			general_sound_section_for_top = EButtonGroup::create_invisible_button_group(new ERegionGabarite(350.0f, 140.0f), EGUIStyle::active_style)
			->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_dynamic_autosize);

		sound_cosmetic_segment->add_group(general_sound_section_for_top);
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

			////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		EButtonGroup*
			left_sound_segment = EButtonGroup::create_invisible_button_group(new ERegionGabarite(150.0f, 100.0f), EGUIStyle::active_style)
			->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_dynamic_autosize);

		bottom_sound_segment->add_group(left_sound_segment);
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		// 
		//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		EButtonGroup*
			right_sound_segment = EButtonGroup::create_invisible_button_group(new ERegionGabarite(150.0f, 100.0f), EGUIStyle::active_style)
			->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_dynamic_autosize);

		bottom_sound_segment->add_group(right_sound_segment);
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	//EButtonGroup* bottom_user_sound_section
	//	= EButtonGroup::create_button_group_without_bg(new ERegionGabarite(178.0f, 100.0f), EGUIStyle::active_style)
	//	->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_static_autosize, NSW_static_autosize);
	//sound_cosmetic_segment->add_group(bottom_user_sound_section);

	//EButtonGroup* mid_ingame_sound_section
	//	= EButtonGroup::create_button_group_without_bg(new ERegionGabarite(178.0f, 50.0f), EGUIStyle::active_style)
	//	->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_static_autosize, NSW_dynamic_autosize);
	//sound_cosmetic_segment->add_group(mid_ingame_sound_section);

	//EButtonGroup* top_drop_sound_section
	//	= EButtonGroup::create_button_group_without_bg(new ERegionGabarite(178.0f, 80.0f), EGUIStyle::active_style)
	//	->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_static_autosize, NSW_static_autosize);
	//sound_cosmetic_segment->add_group(top_drop_sound_section);
	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////




	//		MINIMAP ICON
	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		EButtonGroup*
			minimap_and_ray_cosmetic_segment
			= EButtonGroup::create_default_button_group(new ERegionGabarite(156.0f, 160.0f), EGUIStyle::active_style)
			->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_static_autosize, NSW_dynamic_autosize);

		minimap_and_ray_cosmetic_segment->button_group_is_active = false;
		//	minimap_cosmetic_segment->disable_gabarite = true;

		workspace_filter_block_part->add_group(minimap_and_ray_cosmetic_segment);
		whole_filter_block_group->pointer_to_minimap_and_ray_segment = minimap_and_ray_cosmetic_segment;
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////






	/*			===============================			*/


	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////





	/*			SECONDARY COSMETIC SEGMENT BUTTONS [sounds, ray, minimap icon]			*/




















		//INGAME SOUND
		//	text
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		ELocalisationText l_text;
		l_text.localisations[NSW_localisation_EN] = "Ingame sound";
		l_text.localisations[NSW_localisation_RU] = "Звуки из игры";

		EntityButtonFilterSound*
			sound_button = new EntityButtonFilterSound();
		sound_button->add_default_description_by_key("description_ingame_sound");
		sound_button->make_default_button_with_unedible_text
		(
			new ERegionGabarite(145.0f, 22.0f),
			left_sound_segment,
			&EDataActionCollection::action_open_ingame_sound_list,
			l_text
		);
		sound_button->main_text_area->localisation_text = l_text;
		sound_button->new_line_method = NewLineMethod::FORBIDDEN;
		//sound_button->force_field_right = 4.0f;
		//sound_button->force_field_up = 4.0f;
		sound_button->can_be_stretched = true;

		sound_button->parent_filter_block = whole_filter_block_group;

		sound_button->create_clickable_region_witch_sprtite_layer_and_icon
		(
			new ERegionGabarite(20.0f, 20.0f),
			NS_EGraphicCore::load_from_textures_folder("buttons/play_button"),
			&EDataActionCollection::action_play_attached_sound
		);

		//Entity::get_last_clickable_area(sound_button)->actions_on_right_click_list.push_back(&EDataActionCollection::action_play_attached_sound);
		sound_button->suppressor = &whole_filter_block_group->game_sound_suppressor_bool;
		whole_filter_block_group->pointer_to_game_sound_button = sound_button;
		left_sound_segment->add_button_to_working_group(sound_button);













		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//	switcher GAME_SOUND
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		EntityButton*
			button_ingame_sound_suppressor_bool = new EntityButton();
		sound_button->button_suppressor = button_ingame_sound_suppressor_bool;
		button_ingame_sound_suppressor_bool->make_default_bool_switcher_button
		(
			new ERegionGabarite(22.0f, 22.0f),
			left_sound_segment,
			EDataActionCollection::action_switch_boolean_value,
			NS_DefaultGabarites::texture_bool_switcher_activated_box,
			NS_DefaultGabarites::texture_bool_switcher_deactivated_box,
			&whole_filter_block_group->game_sound_suppressor_bool
		);
		button_ingame_sound_suppressor_bool->new_line_method = NewLineMethod::FORBIDDEN;
		button_ingame_sound_suppressor_bool->force_field_right = 4.0f;
		left_sound_segment->add_button_to_working_group(button_ingame_sound_suppressor_bool);








		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//		POSITIONAL/NOT POSITIONAL SOUND ROUTER
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		EntityButtonVariantRouterForFilterBlock* button_variant_FB_router = new EntityButtonVariantRouterForFilterBlock();
		button_variant_FB_router->button_suppressor = button_ingame_sound_suppressor_bool;
		left_sound_segment->add_button_to_working_group(button_variant_FB_router);
		button_variant_FB_router->make_as_default_button_with_icon
		(
			new ERegionGabarite(170.0f, 22.0f),
			left_sound_segment,
			&EDataActionCollection::action_rotate_variant,
			nullptr
		);
		button_variant_FB_router->parent_filter_block = whole_filter_block_group;
		button_variant_FB_router->force_field_right = 4.0f;
		button_variant_FB_router->can_be_stretched = true;
		button_variant_FB_router->new_line_method = NewLineMethod::FORCIBLY;

		button_variant_FB_router->add_default_description_by_key("description_sound_mono_or_stereo");


		button_variant_FB_router->rotate_variant_mode = RotateVariantMode::SELECT_NEXT;

		button_variant_FB_router->layer_with_icon = button_variant_FB_router->sprite_layer_list.back();

		ETextArea*
			jc_text_area = ETextArea::create_centered_text_area(EntityButton::get_last_clickable_area(button_variant_FB_router), EFont::font_list[0], ELocalisationText());
		button_variant_FB_router->pointer_to_text_area = jc_text_area;

		jc_text_area->can_be_edited = false;
		Entity::add_text_area_to_last_clickable_region(button_variant_FB_router, jc_text_area);

		button_variant_FB_router->suppressor = &whole_filter_block_group->game_sound_suppressor_bool;
		whole_filter_block_group->pointer_to_positional_variant_button = button_variant_FB_router;


		//routers
		/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
		RouterVariant* router_variant = new RouterVariant();
		ELocalisationText local_text;

		local_text.base_name = "Not positional";
		local_text.localisations[NSW_localisation_EN] = "Not positional";
		local_text.localisations[NSW_localisation_RU] = "Не позиционный";
		router_variant->router_localisation = local_text;

		router_variant->text_color = new HSVRGBAColor();
		router_variant->text_color->set_color_RGBA(0.65f, 0.5f, 0.4f, 1.0f);

		button_variant_FB_router->router_variant_list.push_back(router_variant);





		router_variant = new RouterVariant();

		local_text.base_name = "Positional";
		local_text.localisations[NSW_localisation_EN] = "Positional";
		local_text.localisations[NSW_localisation_RU] = "Позиционный";
		router_variant->router_localisation = local_text;

		router_variant->text_color = new HSVRGBAColor();
		router_variant->text_color->set_color_RGBA(0.8f, 0.9f, 0.6f, 1.0f);

		button_variant_FB_router->router_variant_list.push_back(router_variant);
		/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
		button_variant_FB_router->select_variant(0);





		//////
		//INGAME SOUND BLOCK END
		/////















		//USER SOUND
		// 
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		l_text;
		l_text.localisations[NSW_localisation_EN] = "User sound";
		l_text.localisations[NSW_localisation_RU] = "Свой звук";


		sound_button = new EntityButtonFilterSound();
		sound_button->make_default_button_with_unedible_text
		(
			new ERegionGabarite(145.0f, 22.0f),
			sound_cosmetic_segment,
			&EDataActionCollection::action_open_custom_sound_list,
			l_text
		);
		sound_button->main_text_area->localisation_text = l_text;
		sound_button->can_be_stretched = true;
		sound_button->new_line_method = NewLineMethod::FORBIDDEN;
		sound_button->add_default_description_by_key("description_user_sound");
		sound_button->force_field_left = 4.0f;

		sound_button->parent_filter_block = whole_filter_block_group;

		sound_button->create_clickable_region_witch_sprtite_layer_and_icon
		(
			new ERegionGabarite(20.0f, 20.0f),
			NS_EGraphicCore::load_from_textures_folder("buttons/play_button"),
			&EDataActionCollection::action_play_attached_sound
		);

		//Entity::get_last_clickable_area(sound_button)->actions_on_right_click_list.push_back(&EDataActionCollection::action_play_attached_sound);

		sound_button->suppressor = &whole_filter_block_group->custom_sound_suppressor_bool;
		whole_filter_block_group->pointer_to_custom_sound_button = sound_button;
		right_sound_segment->add_button_to_working_group(sound_button);
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////




		//	switcher CUSTOM SOUND
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		EntityButton*
			button_custom_sound_bool_suppressor = new EntityButton();
		sound_button->button_suppressor = button_custom_sound_bool_suppressor;

		button_custom_sound_bool_suppressor->make_default_bool_switcher_button
		(
			new ERegionGabarite(22.0f, 22.0f),
			sound_cosmetic_segment,
			EDataActionCollection::action_switch_boolean_value,
			NS_DefaultGabarites::texture_bool_switcher_activated_box,
			NS_DefaultGabarites::texture_bool_switcher_deactivated_box,
			&whole_filter_block_group->custom_sound_suppressor_bool
		);
		button_custom_sound_bool_suppressor->new_line_method = NewLineMethod::FORBIDDEN;
		//button_custom_sound_bool_suppressor->force_field_left = 4.0f;
		right_sound_segment->add_button_to_working_group(button_custom_sound_bool_suppressor);
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


		//		OPTIONAL/NOT OPTIONAL USER SOUND VARIANT ROUTER
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		button_variant_FB_router = new EntityButtonVariantRouterForFilterBlock();
		button_variant_FB_router->make_as_default_button_with_icon
		(
			new ERegionGabarite(170.0f, 22.0f),
			sound_cosmetic_segment,
			&EDataActionCollection::action_rotate_variant,
			nullptr
		);
		button_variant_FB_router->parent_filter_block = whole_filter_block_group;
		button_variant_FB_router->can_be_stretched = true;
		//button_variant_FB_router->force_field_up = 8.0f;
		button_variant_FB_router->new_line_method = NewLineMethod::FORCIBLY;
		button_variant_FB_router->force_field_left = 4.0f;

		button_variant_FB_router->add_default_description_by_key("description_mandatory_or_optional_sound");

		button_variant_FB_router->rotate_variant_mode = RotateVariantMode::SELECT_NEXT;
		button_variant_FB_router->layer_with_icon = button_variant_FB_router->sprite_layer_list.back();

		jc_text_area = ETextArea::create_centered_text_area(EntityButton::get_last_clickable_area(button_variant_FB_router), EFont::font_list[0], ELocalisationText());
		button_variant_FB_router->pointer_to_text_area = jc_text_area;

		jc_text_area->can_be_edited = false;
		Entity::add_text_area_to_last_clickable_region(button_variant_FB_router, jc_text_area);

		button_variant_FB_router->suppressor = &whole_filter_block_group->custom_sound_suppressor_bool;
		button_variant_FB_router->button_suppressor = button_custom_sound_bool_suppressor;

		whole_filter_block_group->pointer_to_optional_user_sound = button_variant_FB_router;


		//routers
		/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
		router_variant = new RouterVariant();

		local_text.base_name = "Optional";
		local_text.localisations[NSW_localisation_EN] = "Optional";
		local_text.localisations[NSW_localisation_RU] = "Опциональный";
		router_variant->router_localisation = local_text;

		router_variant->text_color = new HSVRGBAColor();
		router_variant->text_color->set_color_RGBA(0.65f, 0.5f, 0.4f, 1.0f);

		button_variant_FB_router->router_variant_list.push_back(router_variant);
		/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///



		/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
		router_variant = new RouterVariant();

		local_text.base_name = "Mandatory";
		local_text.localisations[NSW_localisation_EN] = "Mandatory";
		local_text.localisations[NSW_localisation_RU] = "Обязательный";
		router_variant->router_localisation = local_text;

		router_variant->text_color = new HSVRGBAColor();
		router_variant->text_color->set_color_RGBA(0.6f, 1.0f, 0.8f, 1.0f);

		button_variant_FB_router->router_variant_list.push_back(router_variant);
		/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
		button_variant_FB_router->select_variant(1);

		right_sound_segment->add_button_to_working_group(button_variant_FB_router);
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////













		//////
		//USER SOUND BLOCK END
		/////





















	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	//		SOUND VOLUME SLIDERS
	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////



		//	VOLUME INGAME
		{
			jc_button = EntityButton::create_horizontal_named_slider
			(

				new ERegionGabarite(170.0f, 40.0f),
				general_sound_section_for_top,
				EFont::font_list[0],
				EGUIStyle::active_style,
				ELocalisationText::get_localisation_by_key("volume_slider")
			);
			jc_button->suppressor = &whole_filter_block_group->game_sound_suppressor_bool;
			jc_button->button_suppressor = button_ingame_sound_suppressor_bool;
			jc_button->new_line_method = NewLineMethod::FORBIDDEN;

			jc_button->add_default_description_by_key("description_ingame_sound_volume");
			jc_button->can_be_stretched = true;
			static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(jc_button)->data_container)->pointer_to_value = &whole_filter_block_group->ingame_sound_volume_value;
			static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(jc_button)->data_container)->max_value = 3.0f;

			whole_filter_block_group->ingame_sound_volume_button = jc_button;
			general_sound_section_for_top->add_button_to_working_group(jc_button);
		}


		//	VOLUME USER
		{
			jc_button = EntityButton::create_horizontal_named_slider
			(

				new ERegionGabarite(170.0f, 40.0f),
				general_sound_section_for_top,
				EFont::font_list[0],
				EGUIStyle::active_style,
				ELocalisationText::get_localisation_by_key("volume_slider")
			);
			jc_button->suppressor = &whole_filter_block_group->custom_sound_suppressor_bool;
			jc_button->button_suppressor = button_custom_sound_bool_suppressor;
			jc_button->new_line_method = NewLineMethod::FORBIDDEN;

			jc_button->add_default_description_by_key("description_user_sound_volume");
			jc_button->can_be_stretched = true;
			static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(jc_button)->data_container)->pointer_to_value = &whole_filter_block_group->user_sound_volume_value;
			static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(jc_button)->data_container)->max_value = 3.0f;

			whole_filter_block_group->user_sound_volume_button = jc_button;
			general_sound_section_for_top->add_button_to_working_group(jc_button);
		}




		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//		DISABLE INGAME SOUND
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		{
			EntityButtonVariantRouterForFilterBlock*
				button_variant_disable_ingame_sound = new EntityButtonVariantRouterForFilterBlock();
			//button_variant_disable_sound->button_suppressor = button_ingame_sound_suppressor_bool;

			general_sound_section_for_top->add_button_to_working_group(button_variant_disable_ingame_sound);
			button_variant_disable_ingame_sound->make_as_default_router_variant_button(new ERegionGabarite(170.0f, 20.0f));
			button_variant_disable_ingame_sound->add_default_description_by_key("description_disable_sound");

			button_variant_disable_ingame_sound->new_line_method = NewLineMethod::FORCIBLY;
			//button_variant_disable_sound->force_field_up = 8.0f;
			button_variant_disable_ingame_sound->can_be_stretched = true;

			whole_filter_block_group->pointer_to_forcibly_disable_ingame_sound_variant_button = button_variant_disable_ingame_sound;

			//routers
			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
			button_variant_disable_ingame_sound->add_router_variant_with_localization_key_and_color("variant_do_not_disable_sound", 0.5f, 0.55f, 0.6f, 1.0f);
			button_variant_disable_ingame_sound->add_router_variant_with_localization_key_and_color("variant_disable_sound", 1.0f, 0.5f, 0.25f, 1.0f);

			button_variant_disable_ingame_sound->select_variant(0);
			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
		}
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////



	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	//		DISABLE USER SOUND
	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		{
			EntityButtonVariantRouterForFilterBlock*
				button_variant_disable_user_sound = new EntityButtonVariantRouterForFilterBlock();
			//button_variant_disable_sound->button_suppressor = button_ingame_sound_suppressor_bool;

			general_sound_section_for_top->add_button_to_working_group(button_variant_disable_user_sound);
			button_variant_disable_user_sound->make_as_default_router_variant_button(new ERegionGabarite(170.0f, 20.0f));
			button_variant_disable_user_sound->add_default_description_by_key("description_disable_sound");

			button_variant_disable_user_sound->new_line_method = NewLineMethod::FORBIDDEN;
			//button_variant_disable_sound->force_field_up = 8.0f;
			button_variant_disable_user_sound->can_be_stretched = true;

			whole_filter_block_group->pointer_to_forcibly_disable_user_sound_variant_button = button_variant_disable_user_sound;

			//routers
			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
			button_variant_disable_user_sound->add_router_variant_with_localization_key_and_color("variant_do_not_disable_sound", 0.5f, 0.55f, 0.6f, 1.0f);
			button_variant_disable_user_sound->add_router_variant_with_localization_key_and_color("variant_disable_sound", 1.0f, 0.5f, 0.25f, 1.0f);

			button_variant_disable_user_sound->select_variant(0);
			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
		}
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////





	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	//		ENABLE/DISABLE DEFAULT DROP SOUND
	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

		{
			button_variant_FB_router = new EntityButtonVariantRouterForFilterBlock();
			button_variant_FB_router->make_as_default_button_with_icon
			(
				new ERegionGabarite(340.0f, 40.0f),
				general_sound_section_for_top,
				&EDataActionCollection::action_rotate_variant,
				nullptr
			);
			button_variant_FB_router->rotate_variant_mode = RotateVariantMode::OPEN_CHOOSE_WINDOW;
			button_variant_FB_router->parent_filter_block = whole_filter_block_group;
			button_variant_FB_router->can_be_stretched = true;
			button_variant_FB_router->add_default_description_by_key("description_drop_sound_play_mode");
			button_variant_FB_router->new_line_method = NewLineMethod::FORCIBLY;
			//button_variant_FB_router->rotate_variant_mode = RotateVariantMode::SELECT_NEXT;

			button_variant_FB_router->layer_with_icon = button_variant_FB_router->sprite_layer_list.back();

			jc_text_area = ETextArea::create_centered_text_area(EntityButton::get_last_clickable_area(button_variant_FB_router), EFont::font_list[0], ELocalisationText());
			button_variant_FB_router->pointer_to_text_area = jc_text_area;

			jc_text_area->can_be_edited = false;
			Entity::add_text_area_to_last_clickable_region(button_variant_FB_router, jc_text_area);

			//button_variant_FB_router->suppressor = &whole_filter_block_group->game_sound_suppressor_bool;
			whole_filter_block_group->pointer_to_disable_enable_drop_sound = button_variant_FB_router;


			//routers
			//0
			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
			router_variant = new RouterVariant();

			local_text.base_name = "Drop sound: default";
			local_text.localisations[NSW_localisation_EN] = "Drop sound: default";
			local_text.localisations[NSW_localisation_RU] = "Звук дропа: обычный";
			router_variant->router_localisation = local_text;

			router_variant->text_color = new HSVRGBAColor();
			router_variant->text_color->set_color_RGBA(1.0f, 0.8f, 0.6f, 1.0f);

			button_variant_FB_router->router_variant_list.push_back(router_variant);
			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///


			//1
			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
			router_variant = new RouterVariant();

			local_text.base_name = "DisableDropSound";
			local_text.localisations[NSW_localisation_EN] = "Drop sound: disable";
			local_text.localisations[NSW_localisation_RU] = "Звук дропа: выключен";
			router_variant->router_localisation = local_text;

			router_variant->text_color = new HSVRGBAColor();
			router_variant->text_color->set_color_RGBA(0.8f, 0.5f, 0.25f, 1.0f);

			button_variant_FB_router->router_variant_list.push_back(router_variant);
			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///


			//2
			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
			router_variant = new RouterVariant();

			local_text.base_name = "EnableDropSound";
			local_text.localisations[NSW_localisation_EN] = "Drop sound: enable";
			local_text.localisations[NSW_localisation_RU] = "Звук дропа: включён";
			router_variant->router_localisation = local_text;

			router_variant->text_color = new HSVRGBAColor();
			router_variant->text_color->set_color_RGBA(0.25f, 0.8f, 0.5f, 1.0f);

			button_variant_FB_router->router_variant_list.push_back(router_variant);
			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///


			//3
			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
			router_variant = new RouterVariant();

			local_text.base_name = "DisableDropSoundIfAlertSound";
			local_text.localisations[NSW_localisation_EN] = "Drop sound: Disable if alert sound";
			local_text.localisations[NSW_localisation_RU] = "Звук дропа: Выключен при условиях";
			router_variant->router_localisation = local_text;

			router_variant->text_color = new HSVRGBAColor();
			router_variant->text_color->set_color_RGBA(0.8f, 0.5f, 0.25f, 1.0f);

			button_variant_FB_router->router_variant_list.push_back(router_variant);
			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///


			//4
			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
			router_variant = new RouterVariant();

			local_text.base_name = "EnableDropSoundIfAlertSound";
			local_text.localisations[NSW_localisation_EN] = "Drop sound: Enable if alert sound";
			local_text.localisations[NSW_localisation_RU] = "Звук дропа: Включён при условиях";
			router_variant->router_localisation = local_text;

			router_variant->text_color = new HSVRGBAColor();
			router_variant->text_color->set_color_RGBA(0.25f, 0.8f, 0.5f, 1.0f);

			button_variant_FB_router->router_variant_list.push_back(router_variant);
			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///


			button_variant_FB_router->select_variant(0);

			general_sound_section_for_top->add_button_to_working_group(button_variant_FB_router);
		}





























		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


		//MINIMAP ICONS SEGMENT

		//COLOR NAMES ROUTER

		//		FORCIBLY DISABLE MINIMAP ICON
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		{
			EntityButtonVariantRouterForFilterBlock*
				button_variant_disable_icon = new EntityButtonVariantRouterForFilterBlock();
			//button_variant_disable_sound->button_suppressor = button_ingame_sound_suppressor_bool;

			minimap_and_ray_cosmetic_segment->add_button_to_working_group(button_variant_disable_icon);
			button_variant_disable_icon->make_as_default_router_variant_button(new ERegionGabarite(150.0f, 34.0f));
			button_variant_disable_icon->add_default_description_by_key("description_disable_minimap_icon");
			button_variant_disable_icon->force_field_up = 8.0f;
			button_variant_disable_icon->can_be_stretched = true;

			button_variant_disable_icon->main_custom_data->clickable_area_list.front()->actions_on_click_list.push_back(&EDataActionCollection::action_refresh_loot_simulator);

			whole_filter_block_group->pointer_to_forcibly_disable_minimap_icon_variant_button = button_variant_disable_icon;

			//routers
			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
			button_variant_disable_icon->add_router_variant_with_localization_key_and_color("variant_do_not_disable_minimap_icon", 0.5f, 0.5f, 0.5f, 1.0f);
			button_variant_disable_icon->add_router_variant_with_localization_key_and_color("variant_disable_minimap_icon", 1.0f, 0.5f, 0.25f, 1.0f);

			button_variant_disable_icon->select_variant(0);
			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
		}
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

		//MINIMAP ICON
		//if (true)
		//{

			//jc_button = new EntityButtonFilterSound();
		EntityButtonVariantRouterForFilterBlock*
			button_router_minimap_icon_color = new EntityButtonVariantRouterForFilterBlock();

		minimap_and_ray_cosmetic_segment->add_button_to_working_group(button_router_minimap_icon_color);
		button_router_minimap_icon_color->make_as_default_router_variant_button(new ERegionGabarite(124.0f, 22.0f));


		//button_variant_FB_router->parent_filter_block = whole_filter_block_group;
		button_router_minimap_icon_color->can_be_stretched = true;
		button_router_minimap_icon_color->add_default_description_by_key("description_minimap_color");
		button_router_minimap_icon_color->rotate_variant_mode = RotateVariantMode::OPEN_CHOOSE_WINDOW;
		button_router_minimap_icon_color->suppressor = &whole_filter_block_group->minimap_icon_color_suppressor_bool;

		whole_filter_block_group->pointer_to_minimap_icon_color_router = button_router_minimap_icon_color;

		button_router_minimap_icon_color->add_router_variant_with_localization_key_and_color("variant_color_red", 1.0f, 0.2f, 0.1f, 1.0f);
		button_router_minimap_icon_color->add_router_variant_with_localization_key_and_color("variant_color_green", 0.25f, 1.0f, 0.4f, 1.0f);
		button_router_minimap_icon_color->add_router_variant_with_localization_key_and_color("variant_color_blue", 0.25f, 0.4f, 1.0f, 1.0f);
		button_router_minimap_icon_color->add_router_variant_with_localization_key_and_color("variant_color_brown", 1.0f, 0.5f, 0.25f, 1.0f);
		button_router_minimap_icon_color->add_router_variant_with_localization_key_and_color("variant_color_white", 1.0f, 1.0f, 1.0f, 1.0f);
		button_router_minimap_icon_color->add_router_variant_with_localization_key_and_color("variant_color_yellow", 1.0f, 1.0f, 0.25f, 1.0f);
		button_router_minimap_icon_color->add_router_variant_with_localization_key_and_color("variant_color_cyan", 0.25f, 0.8f, 1.0f, 1.0f);
		button_router_minimap_icon_color->add_router_variant_with_localization_key_and_color("variant_color_grey", 0.55f, 0.55f, 0.55f, 1.0f);
		button_router_minimap_icon_color->add_router_variant_with_localization_key_and_color("variant_color_orange", 1.0f, 0.65f, 0.1f, 1.0f);
		button_router_minimap_icon_color->add_router_variant_with_localization_key_and_color("variant_color_pink", 1.0f, 0.5f, 1.0f, 1.0f);
		button_router_minimap_icon_color->add_router_variant_with_localization_key_and_color("variant_color_purple", 0.8f, 0.1f, 0.9f, 1.0f);

		button_router_minimap_icon_color->select_variant(0);



		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


	//}

	//		switcher MINIMAP ICON

		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		EntityButton*
			button_minimap_icon_suppressor = new EntityButton();

		button_router_minimap_icon_color->button_suppressor = button_minimap_icon_suppressor;


		button_minimap_icon_suppressor->make_default_bool_switcher_button
		(
			new ERegionGabarite(22.0f, 22.0f),
			minimap_and_ray_cosmetic_segment,
			EDataActionCollection::action_switch_boolean_value,
			NS_DefaultGabarites::texture_bool_switcher_activated_box,
			NS_DefaultGabarites::texture_bool_switcher_deactivated_box,
			&whole_filter_block_group->minimap_icon_color_suppressor_bool
		);

		button_minimap_icon_suppressor->add_default_description_by_key("description_switch_minimap_icon");


		minimap_and_ray_cosmetic_segment->add_button_to_working_group(button_minimap_icon_suppressor);

		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

		//		SIZE NAMES ROUTER
		{

			button_variant_FB_router = new EntityButtonVariantRouterForFilterBlock();
			button_variant_FB_router->button_suppressor = button_minimap_icon_suppressor;
			button_variant_FB_router->make_as_default_button_with_icon
			(
				new ERegionGabarite(150.0f, 22.0f),
				minimap_and_ray_cosmetic_segment,
				&EDataActionCollection::action_rotate_variant,
				nullptr

			);

			//button_variant_FB_router->force_field_up = 8.0f;
			button_variant_FB_router->can_be_stretched = true;

			button_variant_FB_router->parent_filter_block = whole_filter_block_group;
			button_variant_FB_router->can_be_stretched = true;
			button_variant_FB_router->add_default_description_by_key("description_minimap_icon_size");

			button_variant_FB_router->rotate_variant_mode = RotateVariantMode::SELECT_NEXT;

			button_variant_FB_router->layer_with_icon = button_variant_FB_router->sprite_layer_list.back();

			jc_text_area = ETextArea::create_centered_text_area(EntityButton::get_last_clickable_area(button_variant_FB_router), EFont::font_list[0], ELocalisationText());
			button_variant_FB_router->pointer_to_text_area = jc_text_area;

			jc_text_area->can_be_edited = false;
			Entity::add_text_area_to_last_clickable_region(button_variant_FB_router, jc_text_area);

			button_variant_FB_router->suppressor = &whole_filter_block_group->minimap_icon_color_suppressor_bool;
			whole_filter_block_group->pointer_to_minimap_icon_size_router = button_variant_FB_router;


			//routers
			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
			router_variant = new RouterVariant();

			local_text.base_name = "0";
			local_text.localisations[NSW_localisation_EN] = "Large";
			local_text.localisations[NSW_localisation_RU] = "Большая";
			router_variant->router_localisation = local_text;

			router_variant->text_color = new HSVRGBAColor();
			router_variant->text_color->set_color_RGBA(1.0f, 0.8f, 0.6f, 1.0f);

			button_variant_FB_router->router_variant_list.push_back(router_variant);
			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///

			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
			router_variant = new RouterVariant();

			local_text.base_name = "1";
			local_text.localisations[NSW_localisation_EN] = "Medium";
			local_text.localisations[NSW_localisation_RU] = "Средняя";
			router_variant->router_localisation = local_text;

			router_variant->text_color = new HSVRGBAColor();
			router_variant->text_color->set_color_RGBA(0.8f, 0.7f, 0.6f, 1.0f);

			button_variant_FB_router->router_variant_list.push_back(router_variant);
			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///

			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
			router_variant = new RouterVariant();

			local_text.base_name = "2";
			local_text.localisations[NSW_localisation_EN] = "Small";
			local_text.localisations[NSW_localisation_RU] = "Маленькая";
			router_variant->router_localisation = local_text;

			router_variant->text_color = new HSVRGBAColor();
			router_variant->text_color->set_color_RGBA(0.6f, 0.55f, 0.5f, 1.0f);

			button_variant_FB_router->router_variant_list.push_back(router_variant);
			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///

			button_variant_FB_router->select_variant(0);


			minimap_and_ray_cosmetic_segment->add_button_to_working_group(button_variant_FB_router);
			////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

		}

		//		ICONS ROUTER
		{

			////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
			//jc_button = new EntityButtonFilterSound();
			EntityButtonVariantRouterForFilterBlock* button_variant_router = new EntityButtonVariantRouterForFilterBlock();

			button_variant_router->make_as_default_button_with_icon
			(
				new ERegionGabarite(150.0f, 41.0f),
				minimap_and_ray_cosmetic_segment,
				&EDataActionCollection::action_rotate_variant,
				nullptr
			);
			button_variant_router->can_be_stretched = true;
			button_variant_router->layer_with_icon = button_variant_router->sprite_layer_list.back();
			button_variant_router->rotate_variant_mode = RotateVariantMode::OPEN_CHOOSE_WINDOW;
			button_variant_router->force_field_up = 8.0f;
			button_variant_router->add_default_description_by_key("description_minimap_icon_shape");

			jc_text_area = ETextArea::create_centered_to_left_text_area(EntityButton::get_last_clickable_area(button_variant_router), EFont::font_list[0], ELocalisationText::empty_localisation);
			button_variant_router->pointer_to_text_area = jc_text_area;

			jc_text_area->can_be_edited = false;
			Entity::add_text_area_to_last_clickable_region(button_variant_router, jc_text_area);

			button_variant_router->suppressor = &whole_filter_block_group->minimap_icon_color_suppressor_bool;
			button_variant_router->button_suppressor = button_minimap_icon_suppressor;

			whole_filter_block_group->pointer_to_minimap_icon_shape_router = button_variant_router;


			//routers
			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
			router_variant = new RouterVariant();

			local_text.base_name = "Circle";
			local_text.localisations[NSW_localisation_EN] = "Circle";
			local_text.localisations[NSW_localisation_RU] = "Круг";
			router_variant->router_localisation = local_text;

			router_variant->texture = NS_DefaultGabarites::texture_minimap_shape_circle;

			router_variant->text_color = new HSVRGBAColor();
			router_variant->text_color->set_color_RGBA(1.0f, 0.8f, 0.60f, 1.0f);

			router_variant->localisation_for_select_window = router_variant->router_localisation;

			button_variant_router->router_variant_list.push_back(router_variant);
			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///



			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
			router_variant = new RouterVariant();

			local_text.base_name = "Diamond";
			local_text.localisations[NSW_localisation_EN] = "Diamond";
			local_text.localisations[NSW_localisation_RU] = "Алмаз";
			router_variant->router_localisation = local_text;

			router_variant->texture = NS_DefaultGabarites::texture_minimap_shape_diamond;

			router_variant->text_color = new HSVRGBAColor();
			router_variant->text_color->set_color_RGBA(1.0f, 0.8f, 0.60f, 1.0f);

			router_variant->localisation_for_select_window = router_variant->router_localisation;

			button_variant_router->router_variant_list.push_back(router_variant);
			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///



			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
			router_variant = new RouterVariant();

			local_text.base_name = "Hexagon";
			local_text.localisations[NSW_localisation_EN] = "Hexagon";
			local_text.localisations[NSW_localisation_RU] = "Шестиугольник";
			router_variant->router_localisation = local_text;

			router_variant->texture = NS_DefaultGabarites::texture_minimap_shape_hexagon;

			router_variant->text_color = new HSVRGBAColor();
			router_variant->text_color->set_color_RGBA(1.0f, 0.8f, 0.60f, 1.0f);

			router_variant->localisation_for_select_window = router_variant->router_localisation;

			button_variant_router->router_variant_list.push_back(router_variant);
			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///

			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
			router_variant = new RouterVariant();

			local_text.base_name = "Square";
			local_text.localisations[NSW_localisation_EN] = "Square";
			local_text.localisations[NSW_localisation_RU] = "Квадрат";
			router_variant->router_localisation = local_text;

			router_variant->texture = NS_DefaultGabarites::texture_minimap_shape_square;

			router_variant->text_color = new HSVRGBAColor();
			router_variant->text_color->set_color_RGBA(1.0f, 0.8f, 0.60f, 1.0f);

			router_variant->localisation_for_select_window = router_variant->router_localisation;

			button_variant_router->router_variant_list.push_back(router_variant);
			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///

			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
			router_variant = new RouterVariant();

			local_text.base_name = "Star";
			local_text.localisations[NSW_localisation_EN] = "Star";
			local_text.localisations[NSW_localisation_RU] = "Звезда";
			router_variant->router_localisation = local_text;

			router_variant->texture = NS_DefaultGabarites::texture_minimap_shape_star;

			router_variant->text_color = new HSVRGBAColor();
			router_variant->text_color->set_color_RGBA(1.0f, 0.8f, 0.60f, 1.0f);

			router_variant->localisation_for_select_window = router_variant->router_localisation;

			button_variant_router->router_variant_list.push_back(router_variant);
			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///

			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
			router_variant = new RouterVariant();

			local_text.base_name = "Triangle";
			local_text.localisations[NSW_localisation_EN] = "Triangle";
			local_text.localisations[NSW_localisation_RU] = "Треугольник";
			router_variant->router_localisation = local_text;

			router_variant->texture = NS_DefaultGabarites::texture_minimap_shape_triangle;

			router_variant->text_color = new HSVRGBAColor();
			router_variant->text_color->set_color_RGBA(1.0f, 0.8f, 0.60f, 1.0f);

			router_variant->localisation_for_select_window = router_variant->router_localisation;

			button_variant_router->router_variant_list.push_back(router_variant);
			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///

			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
			router_variant = new RouterVariant();

			local_text.base_name = "Cross";
			local_text.localisations[NSW_localisation_EN] = "Cross";
			local_text.localisations[NSW_localisation_RU] = "Крест";
			router_variant->router_localisation = local_text;

			router_variant->texture = NS_DefaultGabarites::texture_minimap_shape_cross;

			router_variant->text_color = new HSVRGBAColor();
			router_variant->text_color->set_color_RGBA(1.0f, 0.8f, 0.60f, 1.0f);

			router_variant->localisation_for_select_window = router_variant->router_localisation;

			button_variant_router->router_variant_list.push_back(router_variant);
			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///

			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
			router_variant = new RouterVariant();

			local_text.base_name = "Moon";
			local_text.localisations[NSW_localisation_EN] = "Moon";
			local_text.localisations[NSW_localisation_RU] = "Полумесяц";
			router_variant->router_localisation = local_text;

			router_variant->texture = NS_DefaultGabarites::texture_minimap_shape_moon;

			router_variant->text_color = new HSVRGBAColor();
			router_variant->text_color->set_color_RGBA(1.0f, 0.8f, 0.60f, 1.0f);

			router_variant->localisation_for_select_window = router_variant->router_localisation;

			button_variant_router->router_variant_list.push_back(router_variant);
			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///

			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
			router_variant = new RouterVariant();

			local_text.base_name = "Raindrop";
			local_text.localisations[NSW_localisation_EN] = "Raindrop";
			local_text.localisations[NSW_localisation_RU] = "Капля";
			router_variant->router_localisation = local_text;

			router_variant->texture = NS_DefaultGabarites::texture_minimap_shape_raindrop;

			router_variant->text_color = new HSVRGBAColor();
			router_variant->text_color->set_color_RGBA(1.0f, 0.8f, 0.60f, 1.0f);

			router_variant->localisation_for_select_window = router_variant->router_localisation;

			button_variant_router->router_variant_list.push_back(router_variant);
			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///

			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
			router_variant = new RouterVariant();

			local_text.base_name = "Kite";
			local_text.localisations[NSW_localisation_EN] = "Kite";
			local_text.localisations[NSW_localisation_RU] = "Змей";
			router_variant->router_localisation = local_text;

			router_variant->texture = NS_DefaultGabarites::texture_minimap_shape_kite;

			router_variant->text_color = new HSVRGBAColor();
			router_variant->text_color->set_color_RGBA(1.0f, 0.8f, 0.60f, 1.0f);

			router_variant->localisation_for_select_window = router_variant->router_localisation;

			button_variant_router->router_variant_list.push_back(router_variant);
			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///

			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
			router_variant = new RouterVariant();

			local_text.base_name = "Pentagon";
			local_text.localisations[NSW_localisation_EN] = "Pentagon";
			local_text.localisations[NSW_localisation_RU] = "Пятиугольник";
			router_variant->router_localisation = local_text;

			router_variant->texture = NS_DefaultGabarites::texture_minimap_shape_pentagon;

			router_variant->text_color = new HSVRGBAColor();
			router_variant->text_color->set_color_RGBA(1.0f, 0.8f, 0.60f, 1.0f);

			router_variant->localisation_for_select_window = router_variant->router_localisation;

			button_variant_router->router_variant_list.push_back(router_variant);
			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///



			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
			router_variant = new RouterVariant();

			local_text.base_name = "UpsideDownHouse";
			local_text.localisations[NSW_localisation_EN] = "Marker";
			local_text.localisations[NSW_localisation_RU] = "Маркер";
			router_variant->router_localisation = local_text;

			router_variant->texture = NS_DefaultGabarites::texture_minimap_shape_upside_down_house;

			router_variant->text_color = new HSVRGBAColor();
			router_variant->text_color->set_color_RGBA(1.0f, 0.8f, 0.60f, 1.0f);

			router_variant->localisation_for_select_window = router_variant->router_localisation;

			button_variant_router->router_variant_list.push_back(router_variant);
			/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
			button_variant_router->select_variant(0);


			minimap_and_ray_cosmetic_segment->add_button_to_working_group(button_variant_router);
			////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		}
		/*=========================================================================*/



		//		RAY PREVIEW
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		EButtonGroup*
			ray_preview = EButtonGroup::create_invisible_button_group(new ERegionGabarite(32.0f, 160.0f), EGUIStyle::active_style)
			->set_parameters(ChildAlignMode::ALIGN_HORIZONTAL, NSW_static_autosize, NSW_dynamic_autosize);

		ray_preview->button_group_is_active = true;
		//ray_preview->disable_gabarite = false;

		whole_filter_block_group->pointer_to_ray_preview_segment = ray_preview;
		workspace_filter_block_part->add_group(ray_preview);





		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		//		MAIN COLORS EDIT
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////





		/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		EButtonGroup*
			whole_cosmetic_segment = EButtonGroup::create_default_button_group(new ERegionGabarite(170.0f, 160.0f), EGUIStyle::active_style)
			->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_static_autosize, NSW_dynamic_autosize);
		workspace_filter_block_part->add_group(whole_cosmetic_segment);
		whole_filter_block_group->pointer_to_cosmetic_segment = whole_cosmetic_segment;

		/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		EButtonGroup*
			bottom_cosmetic_segment = EButtonGroup::create_button_group_without_bg(new ERegionGabarite(170.0f, 160.0f), EGUIStyle::active_style)
			->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_dynamic_autosize);

		whole_cosmetic_segment->add_group(bottom_cosmetic_segment);
		/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


		/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		EButtonGroup*
			show_hide_cosmetic_segment = EButtonGroup::create_button_group_without_bg(new ERegionGabarite(170.0f, 30.0f), EGUIStyle::active_style)
			->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_static_autosize);

		whole_cosmetic_segment->add_group(show_hide_cosmetic_segment);
		/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


		/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		EButtonGroupPreviewBox*
			preview_box_cosmetic_segment = new EButtonGroupPreviewBox(new ERegionGabarite(170.0f, 30.0f));
		preview_box_cosmetic_segment->init_button_group(EGUIStyle::active_style, BrickStyleID::NONE, bgroup_without_slider);
		preview_box_cosmetic_segment->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_static_autosize);
		preview_box_cosmetic_segment->pointer_to_filter_block_group = whole_filter_block_group;
		whole_filter_block_group->pointer_preview_box_group = preview_box_cosmetic_segment;

		whole_cosmetic_segment->add_group(preview_box_cosmetic_segment);
		/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//root group data container



//cosmetic_segment->disable_gabarite = false;

		ELocalisationText ltext[3];

		ltext[0].base_name = "SetBackgroundColor";
		ltext[0].localisations[NSW_localisation_EN] = "Background";
		ltext[0].localisations[NSW_localisation_RU] = "Фон";

		ltext[1].base_name = "SetTextColor";
		ltext[1].localisations[NSW_localisation_EN] = "Text";
		ltext[1].localisations[NSW_localisation_RU] = "Текст";

		ltext[2].base_name = "SetBorderColor";
		ltext[2].localisations[NSW_localisation_EN] = "Border";
		ltext[2].localisations[NSW_localisation_RU] = "Рамка";
























		//color buttons
		for (int clr = 0; clr < 3; clr++)
		{
			// // // // // // //// // // // // // //// // // // // // //
			//HRA_color_collection* HRA_collection = Helper::registered_color_list[rand() % Helper::registered_color_list.size()];
			HSVRGBAColor* HRA_color = new HSVRGBAColor();
			HRA_color->h = rand() % 360;
			HRA_color->s = 1.0f - pow((rand() % 100) / 100.0f, 1.0);
			HRA_color->v = 1.0f - pow((rand() % 100) / 100.0f, 3.0);
			HRA_color->a = 1.0f - pow((rand() % 100) / 100.0f, 4.0);

			Helper::hsv2rgb(HRA_color);




			EntityButtonColorButtonForFilterBlock*
				color_button = new EntityButtonColorButtonForFilterBlock();

			color_button->make_as_named_color_button
			(
				new ERegionGabarite(120.0f, 22.0f),
				bottom_cosmetic_segment,
				EFont::font_list[0],
				EGUIStyle::active_style,
				ltext[clr],
				nullptr,
				HRA_color,
				ColorButtonMode::CBM_CUSTOM
			);

			//EntityButtonColorButtonForFilterBlock jjj;

			//memcpy(&jjj, &temp_button, sizeof(EntityButtonColorButton));
			//memcpy(color_button, (EntityButtonColorButton*)&temp_button, sizeof(temp_button));

			//*color_button = EntityButtonColorButtonForFilterBlock();
			//EntityButtonColorButton*
			//color_button_pointer = &temp_button;


			//*color_button = *((EntityButtonColorButtonForFilterBlock*)(&jjj));
			//*color_button = *(static_cast<EntityButtonColorButtonForFilterBlock*>(&temp_button));


			color_button->master_block = whole_filter_block_group;

			if (clr == 0)
			{
				color_button->assigned_cosmetic_element_button = NSWRegisteredButtonGroups::filter_block_colors->cosmetic_element_button_bg;
			}
			else
				if (clr == 1)
				{
					color_button->assigned_cosmetic_element_button = NSWRegisteredButtonGroups::filter_block_colors->cosmetic_element_button_text;
				}
				else
					if (clr == 2)
					{
						color_button->assigned_cosmetic_element_button = NSWRegisteredButtonGroups::filter_block_colors->cosmetic_element_button_rama;
					}

			color_button->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_open_filter_block_color_editor);
			color_button->can_be_stretched = true;

			color_button->new_line_method = ((clr == 0) ? (NewLineMethod::FORBIDDEN) : (NewLineMethod::FORCIBLY));

			color_button->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_make_unsave_filter_block_changes_and_refresh_loot_simulator);

			color_button->main_text_area->localisation_text = ltext[clr];
			color_button->suppressor = &whole_filter_block_group->color_check[clr];

			whole_filter_block_group->pointer_to_HRA_color[clr] = &color_button->stored_color;

			bottom_cosmetic_segment->add_button_to_working_group(color_button);

			bool*
				target_bool = &whole_filter_block_group->color_check[clr];
			whole_filter_block_group->pointer_to_color_button[clr] = color_button;



			//COLOR CHECKER
			jc_button = new EntityButton();
			color_button->button_suppressor = jc_button;

			jc_button->make_default_bool_switcher_button
			(
				new ERegionGabarite(22.0f, 22.0f),
				bottom_cosmetic_segment,
				EDataActionCollection::action_switch_boolean_value,
				NS_DefaultGabarites::texture_bool_switcher_activated_box,
				NS_DefaultGabarites::texture_bool_switcher_deactivated_box,
				target_bool
			);
			jc_button->new_line_method = NewLineMethod::FORBIDDEN;

			jc_button->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_make_unsave_filter_block_changes_and_refresh_loot_simulator);
			whole_filter_block_group->pointer_to_color_check_button[clr] = jc_button;

			bottom_cosmetic_segment->add_button_to_working_group(jc_button);
		}


		//font size slider
		// // // // // // //// // // // // // //// // // // // // //
		jc_button = EntityButton::create_horizontal_named_slider
		(

			new ERegionGabarite(150.0f, 36.0f),
			bottom_cosmetic_segment,
			EFont::font_list[0],
			EGUIStyle::active_style,
			ELocalisationText::get_localisation_by_key("font_size_slider")
		);

		//

		EDataContainer_VerticalNamedSlider*
			data = static_cast<EDataContainer_VerticalNamedSlider*>(jc_button->custom_data_list.back()->data_container);

		data->min_value = 18.0;
		data->max_value = 45.0;
		data->mid_value = (data->min_value + data->max_value) / 2.0f;
		data->rounded_numbers = true;
		data->current_slide_value = -1.0f;

		//data->pointer_to_digit_text_area->autoerase_text = true;
		//data->pointer_to_digit_text_area->offset_border[BorderSide::LEFT] = 8.0f;



		jc_button->can_be_stretched = true;
		jc_button->new_line_method = NewLineMethod::FORCIBLY;

		jc_button->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_make_unsave_filter_block_changes);

		jc_button->suppressor = &whole_filter_block_group->text_size_bool;

		static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(jc_button)->data_container)->pointer_to_value = &whole_filter_block_group->text_size;

		whole_filter_block_group->text_size_button = jc_button;

		jc_button->main_custom_data->actions_on_update.push_back(&EDataActionCollection::action_refresh_loot_simulator_sizes);

		bottom_cosmetic_segment->add_button_to_working_group(jc_button);
		// // // // // // //// // // // // // //// // // // // // //


		//font size switcher
		// // // // // // //// // // // // // //// // // // // // //
		bool*
			target_bool = &whole_filter_block_group->text_size_bool;

		//TEXT SIZE
		EntityButtonVariantRouter*
			button_text_size_suppressor = new EntityButtonVariantRouter();
		bottom_cosmetic_segment->add_button_to_working_group(button_text_size_suppressor);

		jc_button->button_suppressor = button_text_size_suppressor;
		whole_filter_block_group->text_size_router_button = button_text_size_suppressor;

		button_text_size_suppressor->make_as_default_router_variant_button(new ERegionGabarite(150.0f, 22.0f));
		button_text_size_suppressor->target_bool_value = target_bool;
		button_text_size_suppressor->can_be_stretched = true;


		button_text_size_suppressor->add_router_variant_with_localization_key_and_color("variant_disable_font_size", 0.6f, 0.5f, 0.4f, 1.0f);
		button_text_size_suppressor->add_router_variant_with_localization_key_and_color("variant_enable_font_size", 0.3f, 0.9f, 0.6f, 1.0f);

		button_text_size_suppressor->select_variant(1);
		button_text_size_suppressor->new_line_method = NewLineMethod::FORCIBLY;

		button_text_size_suppressor->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_make_unsave_filter_block_changes_and_refresh_loot_simulator);
		whole_filter_block_group->text_size_router_button = button_text_size_suppressor;


		// // // // // // //// // // // // // //// // // // // // //
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////





		//SHOW HIDE COSMETIC
		/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		button_variant_FB_router = new EntityButtonVariantRouterForFilterBlock();
		button_variant_FB_router->make_as_default_button_with_icon
		(
			new ERegionGabarite(165.0f, 30.0f),
			show_hide_cosmetic_segment,
			EDataActionCollection::action_rotate_variant,
			nullptr
		);
		Entity::get_last_clickable_area(button_variant_FB_router)->actions_on_click_list.push_back(&EDataActionCollection::action_show_hide_cosmetic_blocks);

		button_variant_FB_router->add_default_description_by_key("description_show_cosmetic_section");

		button_variant_FB_router->parent_filter_block = whole_filter_block_group;

		button_variant_FB_router->layer_with_icon = button_variant_FB_router->sprite_layer_list.back();
		//button_variant_FB_router->force_field_bottom = 8.0f;
		button_variant_FB_router->can_be_stretched = true;

		jc_text_area = ETextArea::create_centered_to_left_text_area(EntityButton::get_last_clickable_area(button_variant_FB_router), EFont::font_list[0], ELocalisationText::empty_localisation);
		button_variant_FB_router->pointer_to_text_area = jc_text_area;

		jc_text_area->can_be_edited = false;
		Entity::add_text_area_to_last_clickable_region(button_variant_FB_router, jc_text_area);

		//control_part_mid_show_hide_cosmetic->button_list.push_back(button_variant_FB_router);



		//	0
		/*************************************************************************************/

		router_variant = new RouterVariant();


		local_text.base_name = "Show cosmetic";
		local_text.localisations[NSW_localisation_EN] = "Edit visual";
		local_text.localisations[NSW_localisation_RU] = "Изменить визуал";
		router_variant->router_localisation = local_text;

		router_variant->text_color = new HSVRGBAColor();
		router_variant->text_color->set_color_RGBA(0.6f, 1.0f, 0.8f, 1.0f);

		router_variant->texture = NS_DefaultGabarites::texture_show_hide_visual_editor;

		button_variant_FB_router->router_variant_list.push_back(router_variant);
		/*************************************************************************************/

		//	1
		/*************************************************************************************/
		router_variant = new RouterVariant();

		local_text.base_name = "Hide cosmetic";
		local_text.localisations[NSW_localisation_EN] = "Hide";
		local_text.localisations[NSW_localisation_RU] = "Скрыть";
		router_variant->router_localisation = local_text;

		router_variant->text_color = new HSVRGBAColor();
		router_variant->text_color->set_color_RGBA(0.6f, 1.0f, 0.8f, 1.0f);

		router_variant->texture = NS_DefaultGabarites::texture_show_hide_visual_editor_deactivate;

		button_variant_FB_router->router_variant_list.push_back(router_variant);
		/*************************************************************************************/

		button_variant_FB_router->select_variant(0);
		show_hide_cosmetic_segment->add_button_to_working_group(button_variant_FB_router);
		/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////





		//		MINIMAP RAY
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		button_variant_FB_router = new EntityButtonVariantRouterForFilterBlock();
		button_variant_FB_router->make_as_default_button_with_icon
		(
			new ERegionGabarite(125.0f, 22.0f),
			minimap_and_ray_cosmetic_segment,
			&EDataActionCollection::action_rotate_variant,
			nullptr
		);
		button_variant_FB_router->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_make_unsave_filter_block_changes_and_refresh_loot_simulator);
		button_variant_FB_router->parent_filter_block = whole_filter_block_group;
		button_variant_FB_router->can_be_stretched = true;
		button_variant_FB_router->add_default_description_by_key("description_ray_color");

		button_variant_FB_router->rotate_variant_mode = RotateVariantMode::OPEN_CHOOSE_WINDOW;

		button_variant_FB_router->layer_with_icon = button_variant_FB_router->sprite_layer_list.back();

		jc_text_area = ETextArea::create_centered_text_area(EntityButton::get_last_clickable_area(button_variant_FB_router), EFont::font_list[0], ELocalisationText());
		button_variant_FB_router->pointer_to_text_area = jc_text_area;

		jc_text_area->can_be_edited = false;
		Entity::add_text_area_to_last_clickable_region(button_variant_FB_router, jc_text_area);

		button_variant_FB_router->suppressor = &whole_filter_block_group->ray_suppressor;
		whole_filter_block_group->pointer_to_ray_color_router = button_variant_FB_router;


		//routers
		/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
		router_variant = new RouterVariant();

		local_text.base_name = "Red";
		local_text.localisations[NSW_localisation_EN] = "Red";
		local_text.localisations[NSW_localisation_RU] = "Красный";
		router_variant->router_localisation = local_text;

		router_variant->text_color = new HSVRGBAColor();
		router_variant->text_color->set_color_RGBA(1.0f, 0.2f, 0.1f, 1.0f);

		router_variant->localisation_for_select_window = router_variant->router_localisation;

		button_variant_FB_router->router_variant_list.push_back(router_variant);
		/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///

		/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
		router_variant = new RouterVariant();


		local_text.base_name = "Green";
		local_text.localisations[NSW_localisation_EN] = "Green";
		local_text.localisations[NSW_localisation_RU] = "Зелёный";
		router_variant->router_localisation = local_text;

		router_variant->text_color = new HSVRGBAColor();
		router_variant->text_color->set_color_RGBA(0.25f, 1.0f, 0.4f, 1.0f);

		router_variant->localisation_for_select_window = router_variant->router_localisation;

		button_variant_FB_router->router_variant_list.push_back(router_variant);
		/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///

		/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
		router_variant = new RouterVariant();


		local_text.base_name = "Blue";
		local_text.localisations[NSW_localisation_EN] = "Blue";
		local_text.localisations[NSW_localisation_RU] = "Синий";
		router_variant->router_localisation = local_text;

		router_variant->text_color = new HSVRGBAColor();
		router_variant->text_color->set_color_RGBA(0.25f, 0.4f, 1.0f, 1.0f);

		router_variant->localisation_for_select_window = router_variant->router_localisation;

		button_variant_FB_router->router_variant_list.push_back(router_variant);
		/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///

		/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
		router_variant = new RouterVariant();


		local_text.base_name = "Brown";
		local_text.localisations[NSW_localisation_EN] = "Brown";
		local_text.localisations[NSW_localisation_RU] = "Коричневый";
		router_variant->router_localisation = local_text;

		router_variant->text_color = new HSVRGBAColor();
		router_variant->text_color->set_color_RGBA(1.0f, 0.5f, 0.25f, 1.0f);

		router_variant->localisation_for_select_window = router_variant->router_localisation;

		button_variant_FB_router->router_variant_list.push_back(router_variant);
		/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///

		/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
		router_variant = new RouterVariant();


		local_text.base_name = "White";
		local_text.localisations[NSW_localisation_EN] = "White";
		local_text.localisations[NSW_localisation_RU] = "Белый";
		router_variant->router_localisation = local_text;

		router_variant->text_color = new HSVRGBAColor();
		router_variant->text_color->set_color_RGBA(1.0f, 1.0f, 1.0f, 1.0f);

		router_variant->localisation_for_select_window = router_variant->router_localisation;

		button_variant_FB_router->router_variant_list.push_back(router_variant);
		/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///

		/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
		router_variant = new RouterVariant();


		local_text.base_name = "Yellow";
		local_text.localisations[NSW_localisation_EN] = "Yellow";
		local_text.localisations[NSW_localisation_RU] = "Жёлтый";
		router_variant->router_localisation = local_text;

		router_variant->text_color = new HSVRGBAColor();
		router_variant->text_color->set_color_RGBA(1.0f, 1.0f, 0.25f, 1.0f);

		router_variant->localisation_for_select_window = router_variant->router_localisation;

		button_variant_FB_router->router_variant_list.push_back(router_variant);
		/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///

		/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
		router_variant = new RouterVariant();


		local_text.base_name = "Cyan";
		local_text.localisations[NSW_localisation_EN] = "Cyan";
		local_text.localisations[NSW_localisation_RU] = "Голубой";
		router_variant->router_localisation = local_text;

		router_variant->text_color = new HSVRGBAColor();
		router_variant->text_color->set_color_RGBA(0.25f, 0.8f, 1.0f, 1.0f);

		router_variant->localisation_for_select_window = router_variant->router_localisation;

		button_variant_FB_router->router_variant_list.push_back(router_variant);
		/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///

		/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
		router_variant = new RouterVariant();


		local_text.base_name = "Grey";
		local_text.localisations[NSW_localisation_EN] = "Grey";
		local_text.localisations[NSW_localisation_RU] = "Серый";
		router_variant->router_localisation = local_text;

		router_variant->text_color = new HSVRGBAColor();
		router_variant->text_color->set_color_RGBA(0.55f, 0.55f, 0.55f, 1.0f);

		router_variant->localisation_for_select_window = router_variant->router_localisation;

		button_variant_FB_router->router_variant_list.push_back(router_variant);
		/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///

		/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
		router_variant = new RouterVariant();


		local_text.base_name = "Orange";
		local_text.localisations[NSW_localisation_EN] = "Orange";
		local_text.localisations[NSW_localisation_RU] = "Оранжевый";
		router_variant->router_localisation = local_text;

		router_variant->text_color = new HSVRGBAColor();
		router_variant->text_color->set_color_RGBA(1.0f, 0.65f, 0.1f, 1.0f);

		router_variant->localisation_for_select_window = router_variant->router_localisation;

		button_variant_FB_router->router_variant_list.push_back(router_variant);
		/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///

		/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
		router_variant = new RouterVariant();


		local_text.base_name = "Pink";
		local_text.localisations[NSW_localisation_EN] = "Pink";
		local_text.localisations[NSW_localisation_RU] = "Розовый";
		router_variant->router_localisation = local_text;

		router_variant->text_color = new HSVRGBAColor();
		router_variant->text_color->set_color_RGBA(1.0f, 0.5f, 1.0f, 1.0f);

		router_variant->localisation_for_select_window = router_variant->router_localisation;

		button_variant_FB_router->router_variant_list.push_back(router_variant);
		/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///

		/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
		router_variant = new RouterVariant();


		local_text.base_name = "Purple";
		local_text.localisations[NSW_localisation_EN] = "Purple";
		local_text.localisations[NSW_localisation_RU] = "Фиолетовый";
		router_variant->router_localisation = local_text;

		router_variant->text_color = new HSVRGBAColor();
		router_variant->text_color->set_color_RGBA(0.8f, 0.1f, 0.9f, 1.0f);

		router_variant->localisation_for_select_window = router_variant->router_localisation;

		button_variant_FB_router->router_variant_list.push_back(router_variant);
		/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
		button_variant_FB_router->select_variant(0);


		minimap_and_ray_cosmetic_segment->add_button_to_working_group(button_variant_FB_router);
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

		//font size switcher
		// // // // // // //// // // // // // //// // // // // // //
		target_bool = &whole_filter_block_group->ray_suppressor;

		//FONT SIZE SUPPRESSOR
		EntityButton* ray_bool_suppressor = new EntityButton();
		button_variant_FB_router->button_suppressor = ray_bool_suppressor;

		ray_bool_suppressor->make_default_bool_switcher_button
		(
			new ERegionGabarite(22.0f, 22.0f),
			minimap_and_ray_cosmetic_segment,
			EDataActionCollection::action_switch_boolean_value,
			NS_DefaultGabarites::texture_bool_switcher_activated_box,
			NS_DefaultGabarites::texture_bool_switcher_deactivated_box,
			target_bool
		);
		ray_bool_suppressor->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_make_unsave_filter_block_changes_and_refresh_loot_simulator);

		//whole_filter_block_group->text_size_router_button = ray_bool_suppressor;

		minimap_and_ray_cosmetic_segment->add_button_to_working_group(ray_bool_suppressor);
		// // // // // // //// // // // // // //// // // // // // //





		//		MINIMAP RAY [temp?]
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		button_variant_FB_router = new EntityButtonVariantRouterForFilterBlock();
		button_variant_FB_router->make_as_default_button_with_icon
		(
			new ERegionGabarite(150.0f, 22.0f),
			minimap_and_ray_cosmetic_segment,
			&EDataActionCollection::action_rotate_variant,
			nullptr
		);
		button_variant_FB_router->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_make_unsave_filter_block_changes_and_refresh_loot_simulator);
		button_variant_FB_router->parent_filter_block = whole_filter_block_group;
		button_variant_FB_router->can_be_stretched = true;
		button_variant_FB_router->add_default_description_by_key("description_ray_constant_or_temporary");

		button_variant_FB_router->rotate_variant_mode = RotateVariantMode::SELECT_NEXT;

		button_variant_FB_router->layer_with_icon = button_variant_FB_router->sprite_layer_list.back();

		jc_text_area = ETextArea::create_centered_text_area(EntityButton::get_last_clickable_area(button_variant_FB_router), EFont::font_list[0], ELocalisationText());
		button_variant_FB_router->pointer_to_text_area = jc_text_area;

		jc_text_area->can_be_edited = false;
		Entity::add_text_area_to_last_clickable_region(button_variant_FB_router, jc_text_area);

		button_variant_FB_router->suppressor = &whole_filter_block_group->ray_suppressor;
		button_variant_FB_router->button_suppressor = ray_bool_suppressor;

		whole_filter_block_group->pointer_to_temporary_option_router = button_variant_FB_router;


		//routers
		/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
		router_variant = new RouterVariant();


		local_text.base_name = "Constant";
		local_text.localisations[NSW_localisation_EN] = "Constant ray";
		local_text.localisations[NSW_localisation_RU] = "Постоянный луч";
		router_variant->router_localisation = local_text;

		router_variant->text_color = new HSVRGBAColor();
		router_variant->text_color->set_color_RGBA(1.0f, 0.8f, 0.6f, 1.0f);

		button_variant_FB_router->router_variant_list.push_back(router_variant);
		/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///

		/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///
		router_variant = new RouterVariant();


		local_text.base_name = "Temp";
		local_text.localisations[NSW_localisation_EN] = "Temporary";
		local_text.localisations[NSW_localisation_RU] = "Временный";
		router_variant->router_localisation = local_text;

		router_variant->text_color = new HSVRGBAColor();
		router_variant->text_color->set_color_RGBA(0.6f, 0.6f, 0.6f, 1.0f);

		button_variant_FB_router->router_variant_list.push_back(router_variant);
		/// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// /// ///

		button_variant_FB_router->select_variant(0);


		minimap_and_ray_cosmetic_segment->add_button_to_working_group(button_variant_FB_router);
		////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


	}



	//EInputCore::logger_param("size of subgroups", workspace_part->group_list.size());
	return whole_filter_block_group;
}

EButtonGroupFilterBlockSeparator* EWindowMain::create_filter_block_separator(EButtonGroup* _target_editor, int _specific_position)
{
	EButtonGroupFilterBlockSeparator*
		whole_separator_block = new EButtonGroupFilterBlockSeparator(new ERegionGabarite(1200.0f, 20.0f));
	whole_separator_block->init_button_group(EGUIStyle::active_style, BrickStyleID::NONE, bgroup_with_slider);
	whole_separator_block->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_static_autosize);
	whole_separator_block->debug_name = "Whole separator";
	whole_separator_block->focusable_for_select = true;
	whole_separator_block->additional_y_distance = NSW_default_y_force_field_for_separator;
	whole_separator_block->ignore_vertical_buttons_force_field = true;


	//		SHRINKER
	/////////////////////////////////////////////////////////////////////////////////////////////
	EntityButton* shrinker_button = new EntityButton();
	shrinker_button->make_default_bool_switcher_button
	(
		new ERegionGabarite(20.0f, 20.0f),
		whole_separator_block,
		EDataActionCollection::action_switch_boolean_value,
		NS_DefaultGabarites::texture_bool_switcher_activated_box,
		NS_DefaultGabarites::texture_bool_switcher_deactivated_box,
		&whole_separator_block->is_expanded
	);
	whole_separator_block->is_expanded = true;
	shrinker_button->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_change_separator_shrink_flag);

	whole_separator_block->add_button_to_working_group(shrinker_button);
	/////////////////////////////////////////////////////////////////////////////////////////////

	//		FORCE FIELD
	/////////////////////////////////////////////////////////////////////////////////////////////
	EntityButton*
		force_field_button = new EntityButton();
	force_field_button->make_default_bool_switcher_button
	(
		new ERegionGabarite(20.0f, 20.0f),
		whole_separator_block,
		EDataActionCollection::action_switch_boolean_value,
		NS_DefaultGabarites::texture_bool_switcher_force_field_on,
		NS_DefaultGabarites::texture_bool_switcher_force_field_off,
		&whole_separator_block->additional_force_field
	);
	whole_separator_block->is_expanded = true;
	force_field_button->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_change_force_field);

	whole_separator_block->add_button_to_working_group(force_field_button);
	/////////////////////////////////////////////////////////////////////////////////////////////




	//		MOVE
	/////////////////////////////////////////////////////////////////////////////////////////////
	EntityButtonMoveButtonGroup*
		move_button = new EntityButtonMoveButtonGroup();
	move_button->make_as_default_button_with_full_icon
	(
		new ERegionGabarite(20.0f, 20.0f),
		whole_separator_block,
		&EDataActionCollection::action_move_button_group,
		NS_DefaultGabarites::texture_button_move_small
	);
	move_button->target_group_for_moving = whole_separator_block;
	move_button->parent_group_for_moving = _target_editor;
	move_button->move_method = MoveVectorMethod::METHOD_DRAG;

	whole_separator_block->add_button_to_working_group(move_button);
	/////////////////////////////////////////////////////////////////////////////////////////////




	//		DESCRIPTION
	/////////////////////////////////////////////////////////////////////////////////////////////
	EntityButton*
		description_button = new EntityButton();
	description_button->make_default_button_with_edible_text
	(
		new ERegionGabarite(400.0f, 20.0f),
		whole_separator_block,
		nullptr,
		""
	);
	ELocalisationText ltext;;
	ltext.localisations[NSW_localisation_EN] = "Click here, and type commentary";
	ltext.localisations[NSW_localisation_RU] = "нажмите, что бы написать комментарий";

	description_button->main_text_area->gray_text = ltext;
	//move_button->parent_group_for_moving = _target_whole_group;

	whole_separator_block->add_button_to_working_group(description_button);

	whole_separator_block->pointer_to_description_button = description_button;
	/////////////////////////////////////////////////////////////////////////////////////////////


	//		REMOVE SEPARATOR
	/////////////////////////////////////////////////////////////////////////////////////////////
	{
		EntityButton*
			button_delete_separator = new EntityButton();
		button_delete_separator->do_not_generate_bg = true;
		whole_separator_block->add_button_to_working_group(button_delete_separator);

		button_delete_separator->make_as_default_button_with_full_icon
		(
			new ERegionGabarite(20.0f, 20.0f),
			whole_separator_block,
			&EDataActionCollection::action_mark_parent_group_as_removed,
			NS_DefaultGabarites::texture_close_circle
		);

		button_delete_separator->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_change_separator_shrink_flag);
	}
	/////////////////////////////////////////////////////////////////////////////////////////////

	if (_specific_position < 0)
	{
		_target_editor->add_group(whole_separator_block);
	}
	else
	{
		_target_editor->add_group_scecific_position(whole_separator_block, _specific_position);
	}

	return whole_separator_block;
}

void EWindowMain::parse_filter_text_lines(EButtonGroupFilterBlock* _target_filter_block, LootFilterOpenMode _parse_mode)
{
	std::string buffer_text = "";

	bool space_is_not_separator = false;
	bool comment_mode = false;

	int data_part = 0;
	int value_array_id = 0;
	int matched_id_for_color_button = -1;

	//bool comment_mode = false;

	EntityButton* matched_button = nullptr;

	EButtonGroupFilterBlock* jc_filter_block = nullptr;
	EButtonGroupFilterBlockSeparator* jc_filter_block_separator = nullptr;
	HRA_color_collection* jc_HRA_color_collection = nullptr;

	std::string attribute_text = "";
	std::string condition_text = "";
	//std::string value_array[512] = {};

	HSVRGBAColor* target_HRA_color;
	bool* target_color_bool;

	GameItemAttribute* matched_item_attribute = nullptr;

	EButtonGroupNonListedLine* last_non_listed_line = nullptr;
	EntityButtonFilterSound* last_custom_sound_button = nullptr;

	bool any_error = false;

	int line_id = 0;

	for (std::string str_line : filter_text_lines)
	{
		line_id++;
		//comment_mode = false;
		data_part = 0;
		value_array_id = 0;
		matched_id_for_color_button = -1;
		matched_button = nullptr;

		buffer_text = "";

		space_is_not_separator = false;
		comment_mode = false;

		condition_text = "";

		matched_item_attribute = nullptr;
		target_HRA_color = nullptr;

		last_non_listed_line = nullptr;

		//EButtonGroupFilterBlock* whole_filter_block = nullptr;
		EButtonGroupListedBlock* listed_block = nullptr;

		target_color_bool = nullptr;

		for (int i = 0; i < str_line.length(); i++)
		{
			char current_sym = str_line.at(i);

			if (current_sym == '"') { space_is_not_separator = !space_is_not_separator; }
			if ((current_sym == '#') && (!space_is_not_separator)) { comment_mode = true; }

			if
				(
					(
						(current_sym != ' ')
						||
						(space_is_not_separator)
						)
					&&
					(current_sym != '\t')
					&&
					(current_sym != '\r')
					&&
					(current_sym != '\n')
					&&
					(current_sym != '#')
					&&
					(i + 1 < str_line.length())
					)
			{
				if (current_sym != '"')
				{
					buffer_text += current_sym;
				}
			}
			else
			{
				//force add symbol
				if
					(
						(
							(current_sym != ' ')
							||
							(space_is_not_separator)
							)
						&&
						(current_sym != '\t')
						&&
						(current_sym != '\r')
						&&
						(current_sym != '\n')
						&&
						(current_sym != '#')
						&&
						(i + 1 >= str_line.length())
						)
				{
					if (current_sym != '"')
					{
						buffer_text += current_sym;
					}
				}

				if (buffer_text != "")
				{
					//attribute name
					if (data_part == DataOrderNames::ATTRIBUTE)
					{
						//EInputCore::logger_param("buffer text", buffer_text);

						if
							(
								(EStringUtils::compare_ignoring_case(buffer_text, "show"))
								||
								(EStringUtils::compare_ignoring_case(buffer_text, "hide"))
								)
						{
							//create or modify filter block
							if (!comment_mode)
							{
								int specific_position = -1;

								if (_target_filter_block != nullptr)
								{
									for (int i = 0; i < EWindowMain::active_loot_filter_editor->group_list.size(); i++)
									{
										if (EWindowMain::active_loot_filter_editor->group_list[i] == _target_filter_block)
										{
											specific_position = i;
										}
									}
								}


								jc_filter_block = create_filter_block(active_loot_filter_editor, specific_position);

								jc_filter_block->color_check[0] = false;
								jc_filter_block->color_check[1] = false;
								jc_filter_block->color_check[2] = false;

								if (jc_filter_block->text_size_router_button != nullptr)
								{
									jc_filter_block->text_size_router_button->select_variant(0);
								}

								if (_parse_mode == LootFilterOpenMode::LOOT_FILTER_OPEN_MODE_DEFAULT_FILTER_FROM_GAME)
								{
									jc_filter_block->group_is_suppressed = true;
									jc_filter_block->is_default_filter_block = true;
								}
								else
									if (_parse_mode == LootFilterOpenMode::LOOT_FILTER_OPEN_MODE_BASIC_FILTER_COLORS_FROM_GAME)
									{
										jc_filter_block->group_is_suppressed = true;
										jc_filter_block->is_base_filter_block = true;
									}



								//whole_filter_block = (EButtonGroupFilterBlock*)(jc_filter_block);

								if (jc_filter_block->button_show_hide != nullptr)
								{
									if (EStringUtils::compare_ignoring_case(buffer_text, "show"))
									{
										((EntityButtonVariantRouter*)(jc_filter_block->button_show_hide))->select_variant(1);
									}
									else
									{
										((EntityButtonVariantRouter*)(jc_filter_block->button_show_hide))->select_variant(0);
									}
								}
							}
							else
							{
								jc_filter_block = nullptr;
								//whole_filter_block = nullptr;
							}
						}
						else
						{
							matched_item_attribute = EButtonGroupFilterBlock::get_suitable_game_item_attribute(buffer_text);;

							//UNDEFINED ATTRIBUTE
							if
								(
									(!comment_mode)
									&&
									(matched_item_attribute == nullptr)
									&&
									(jc_filter_block != nullptr)
									)
							{
								add_game_item_attribute_to_filter_block(jc_filter_block, nullptr, buffer_text);

								EInputCore::logger_param_with_warning("UNREGISTERED attribure!", buffer_text);
								any_error = true;
								//registered_group_filter_error_list->activate_move_to_foreground_and_center();
							}

							if
								(
									(matched_item_attribute != nullptr)
									&&
									(
										(!comment_mode)
										||
										(matched_item_attribute->always_present)
										||
										(matched_item_attribute->commentary_config)
										)
									)
							{
								//add new sections to filter block
								if
									(
										(!matched_item_attribute->always_present)
										&&
										(!matched_item_attribute->commentary_config)
										&&
										(jc_filter_block != nullptr)
										)
								{
									add_game_item_attribute_to_filter_block(jc_filter_block, matched_item_attribute, "");
								}

								//if (jc_filter_block != nullptr)
								//{
								//	whole_filter_block = (EButtonGroupFilterBlock*)(jc_filter_block);
								//}

								//EInputCore::logger_param("found registered attribure", buffer_text);

								////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
								if
									(
										(jc_filter_block != nullptr)
										&&
										(matched_item_attribute->filter_attribute_type == FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED)
										&&
										(jc_filter_block->pointer_to_workspace_non_listed_segment != nullptr)
										)
								{
									if
										(
											(jc_filter_block != nullptr)
											&&
											(!jc_filter_block->pointer_to_workspace_non_listed_segment->group_list.empty())
											)
									{
										last_non_listed_line = static_cast<EButtonGroupNonListedLine*>(jc_filter_block->pointer_to_workspace_non_listed_segment->group_list.back());
									}
								}
								////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
								if (matched_item_attribute->filter_attribute_type == FilterAttributeType::FILTER_ATTRIBUTE_TYPE_COSMETIC)
								{
									if (jc_filter_block != nullptr)
									{

										for (int b = 0; b < 3; b++)
											if (jc_filter_block->pointer_to_color_button[b] != nullptr)
											{
												if (jc_filter_block->pointer_to_color_button[b]->main_text_area->localisation_text.base_name == matched_item_attribute->localisation.base_name)
												{
													//matched_button = whole_block_container->pointer_to_color_button[b];
													target_HRA_color = jc_filter_block->pointer_to_color_button[b]->stored_color;
													target_color_bool = &jc_filter_block->color_check[b];

													if (!comment_mode)
													{
														jc_filter_block->color_check[b] = true;
													}
													else
													{
														jc_filter_block->color_check[b] = false;
													}
												}
											}

										if
											(
												(matched_item_attribute->filter_attribute_value_type == FILTER_ATTRIBUTE_VALUE_TYPE_MINIMAP_ICON)
												&&
												(!comment_mode)
												)
										{
											jc_filter_block->minimap_icon_color_suppressor_bool = true;
										}
									}

									if
										(
											(matched_item_attribute->filter_attribute_value_type == FILTER_ATTRIBUTE_VALUE_TYPE_VALUE_USER_SOUND)
											&&
											(!comment_mode)
											&&
											(jc_filter_block->pointer_to_custom_sound_button != nullptr)
											)
									{
										last_custom_sound_button = jc_filter_block->pointer_to_custom_sound_button;
										//EInputCore::logger_simple_info("user_sound");
									}


									//		ATTRIBUTES WITHOUT PARAMETERS
									if
										(
											(!comment_mode)
											&&
											(jc_filter_block != nullptr)
											)
									{
										//disable/enable varian router button


										if (jc_filter_block->pointer_to_disable_enable_drop_sound != nullptr)
										{
											int disable_sound_router_id = -1;
											disable_sound_router_id = jc_filter_block->pointer_to_disable_enable_drop_sound->search_id_by_base_name(matched_item_attribute->localisation.base_name);

											if (disable_sound_router_id >= 0) { jc_filter_block->pointer_to_disable_enable_drop_sound->select_variant(disable_sound_router_id); }
										}


										if (matched_item_attribute->localisation.base_name == "PlayAlertSoundPositional")
										{
											if (jc_filter_block->pointer_to_positional_variant_button != nullptr)
											{
												jc_filter_block->pointer_to_positional_variant_button->select_variant(1);
											}
										}
										else
											if (matched_item_attribute->localisation.base_name == "PlayAlertSound")
											{
												if (jc_filter_block->pointer_to_positional_variant_button != nullptr)
												{
													jc_filter_block->pointer_to_positional_variant_button->select_variant(0);
												}
											}
											else
												if (matched_item_attribute->localisation.base_name == "CustomAlertSoundOptional")
												{
													if (jc_filter_block->pointer_to_optional_user_sound != nullptr)
													{
														jc_filter_block->pointer_to_optional_user_sound->select_variant(1);
													}
												}
									}

									if (jc_filter_block != nullptr)
									{
										if ((matched_item_attribute->filter_attribute_value_type == FILTER_ATTRIBUTE_VALUE_TYPE_RAY) && (!comment_mode))
										{
											jc_filter_block->ray_suppressor = true;
										}

										if ((matched_item_attribute->filter_attribute_value_type == FILTER_ATTRIBUTE_VALUE_TYPE_CONTINUE) && (!comment_mode) && (jc_filter_block->button_continue != nullptr))
										{
											jc_filter_block->button_continue->select_variant(0);
										}
									}
									//target_HRA_color = ((EDataContainer_Button_StoreColor*)(Entity::get_last_custom_data(whole_block_container->pointer_to_color_button[0])->data_container))->stored_color;
									//target_color_bool = &whole_block_container->color_check[0];
								}
								////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
								if (matched_item_attribute->filter_attribute_type == FilterAttributeType::FILTER_ATTRIBUTE_TYPE_CONFIG)
								{
									if (matched_item_attribute->filter_attribute_value_type == FILTER_ATTRIBUTE_VALUE_CONFIG_SEPARATOR)
									{
										int specific_position = -1;

										if (_target_filter_block != nullptr)
										{
											for (int i = 0; i < EWindowMain::active_loot_filter_editor->group_list.size(); i++)
											{
												if (EWindowMain::active_loot_filter_editor->group_list[i] == _target_filter_block)
												{
													specific_position = i;
												}
											}
										}

										jc_filter_block_separator = create_filter_block_separator(active_loot_filter_editor, specific_position);
									}

									//if (matched_filter_block_attribute->filter_attribute_value_type == FILTER_ATTRIBUTE_VALUE_CONFIG_COLOR_COLLECTION)
									//{
									//	jc_HRA_color_collection = new HRA_color_collection();

									//	Helper::registered_color_list.push_back(jc_HRA_color_collection);
									//}
								}
								////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
								//if (matched_filter_block_attribute->filter_attribute_type == FilterAttributeType::FILTER_ATTRIBUTE_TYPE_COSMETIC)
								//{

								//}
							}
							else
							{

							}
						}
					}

					//condition operator
					//set condition to last created block
					if (data_part == DataOrderNames::CONDITION_OPERATOR)
					{
						if (buffer_text == "!=") { buffer_text = "!"; }

						//undefined attributes have no condition operator
						//commented attributes cannot change filter block
						if ((matched_item_attribute == nullptr) || (comment_mode))
						{
							data_part = DataOrderNames::VALUE;
						}
						else
						{
							std::string f_sym = std::string(buffer_text.substr(0, 1));

							//if attribute can have operator or exact match, read buffer as operator
							if
								(
									(text_is_condition(f_sym))
									&&
									(
										(matched_item_attribute->have_exact_match)
										||
										(matched_item_attribute->have_operator)
										||
										(matched_item_attribute->have_input_field_for_listed)
										)
									)
							{


								//LISTED		for listed attributes, "==" mean "exact match"
								if (matched_item_attribute->filter_attribute_type == FILTER_ATTRIBUTE_TYPE_LISTED)
								{

									if
										(
											(jc_filter_block != nullptr)
											&&
											(jc_filter_block->pointer_to_listed_attributes != nullptr)
											)
									{
										listed_block = (EButtonGroupListedBlock*)(jc_filter_block->pointer_to_listed_attributes->group_list.back());
									}

									if (listed_block != nullptr)
									{
										//EXACT MATCH
										if (buffer_text == "==")//select variant "exact match"
										{
											listed_block->matching_mode_router_button->select_variant(1);
										}
										else//CONDITION OPERATOR FOR EXPLICIT
										{
											//if attribute have no input field, buffer is not condition
											if (matched_item_attribute->have_input_field_for_listed)
											{
												//input field for Explicit modfiers like ">= 1"
												listed_block->input_field->main_text_area->change_text(buffer_text);
												data_part = DataOrderNames::CONDITION_OPERATOR;
											}
											else
											{
												condition_text = "";
												data_part = DataOrderNames::VALUE;
											}
										}
									}
								}
								else
									//NON-LISTED	for non-listed attributes, set operator
									if ((matched_item_attribute->filter_attribute_type == FILTER_ATTRIBUTE_TYPE_NON_LISTED) && (matched_item_attribute->have_operator))
									{
										//condition operator can be omitted. for example, "ItemLvel 5" mean "ItemLevel = 5"
										//select suitable condition variant for route button
										//if text is condition, do something



										if
											(
												(last_non_listed_line != nullptr)
												&&
												(last_non_listed_line->target_button_with_condition != nullptr)
												)
										{
											if (text_is_condition(f_sym))
											{
												condition_text = buffer_text;
											}
											else
											{
												condition_text = "=";
											}
											//if (condition_text == "!=") { condition_text = "!"; }
											last_non_listed_line->target_button_with_condition->select_variant_by_base_name(condition_text);
										}
									}
									else
										//other attributes cannot have operator, buffer is value
									{
										data_part = DataOrderNames::VALUE;
									}
							}
							else//set VALUE mode. for non-listed, if attribute can have operator, set default "=" operator
							{
								condition_text = "";
								data_part = DataOrderNames::VALUE;
							}
						}

					}

					//values
					if (data_part >= DataOrderNames::VALUE)
					{
						//EInputCore::logger_param("value", buffer_text);
						//value_array[value_array_id] = buffer_text;

						//value_array_id++;

						//UNDEFINED ATTRIBUTE VALUES. undefined attributes always sent to listed group
						if (matched_item_attribute == nullptr)
						{
							if (!comment_mode)
							{
								if (jc_filter_block != nullptr)
								{
									jc_filter_block = (EButtonGroupFilterBlock*)(jc_filter_block);
								}

								if (jc_filter_block != nullptr)
								{
									listed_block = (EButtonGroupListedBlock*)(jc_filter_block->pointer_to_listed_attributes->group_list.back());
								}

								EntityButtonWideItem*
									wide_button = EntityButtonWideItem::create_wide_item_button
									(
										new ERegionGabarite(100.0f, 40.0f),
										listed_block->section_for_wide_item_buttons,
										nullptr,
										EFont::font_list[0],
										true
									);

								wide_button->localised_name.generate_localization_with_base_name(buffer_text);

								wide_button->main_text_area->can_be_edited = true;
								wide_button->main_text_area->change_text(buffer_text);

								//wide_button->can_be_stretched = true;
								listed_block->section_for_wide_item_buttons->add_button_to_working_group(wide_button);
							}
						}


						//non-undefined attribute, set value
						if (matched_item_attribute != nullptr)
						{
							if ((matched_item_attribute->filter_attribute_type == FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED) && (!comment_mode))
							{
								if
									(
										(last_non_listed_line != nullptr)
										&&
										(matched_item_attribute != nullptr)
										)
								{
									//
									//number
									if
										(
											(
												(matched_item_attribute->filter_attribute_value_type == FILTER_ATTRIBUTE_VALUE_TYPE_NUMBER)
												||
												(matched_item_attribute->filter_attribute_value_type == FILTER_ATTRIBUTE_VALUE_TYPE_COLOURS_TEXT)
												)
											&&
											(last_non_listed_line->target_button_with_value->main_text_area != nullptr)
											)
									{
										last_non_listed_line->target_button_with_value->main_text_area->change_text(buffer_text);
									}


									//
									//bool switcher
									if (matched_item_attribute->filter_attribute_value_type == FILTER_ATTRIBUTE_VALUE_TYPE_BOOL_SWITCHER)
									{
										if (EStringUtils::to_lower(buffer_text) == "true")
										{
											*static_cast <EDataContainer_Button_BoolSwitcher*>(last_non_listed_line->target_button_with_value->custom_data_list.back()->data_container)->target_value = true;
										}
										else
										{
											*static_cast <EDataContainer_Button_BoolSwitcher*>(last_non_listed_line->target_button_with_value->custom_data_list.back()->data_container)->target_value = false;
										}

									}

									//rarity
									if (matched_item_attribute->filter_attribute_value_type == FILTER_ATTRIBUTE_VALUE_TYPE_RARITY_LIST)
									{
										last_non_listed_line->rarity_router_button->select_variant_by_base_name(buffer_text);
									}

									//quality
									if (matched_item_attribute->filter_attribute_value_type == FILTER_ATTRIBUTE_VALUE_TYPE_QUALITY_LIST)
									{
										for (RouterVariant* qv : registered_alternate_gem_quality_router_variants)
										{
											if (EStringUtils::compare_ignoring_case(qv->router_localisation.base_name, buffer_text))
											{
												last_non_listed_line->target_button_with_value->main_text_area->localisation_text = qv->router_localisation;

												last_non_listed_line->target_button_with_value->main_text_area->stored_color = *qv->text_color;
												last_non_listed_line->target_button_with_value->main_text_area->color = *qv->text_color;

												last_non_listed_line->target_button_with_value->main_text_area->change_text(qv->router_localisation.localisations[ELocalisationText::active_localisation]);
											}
										}
									}
								}
							}

							if ((matched_item_attribute->filter_attribute_type == FilterAttributeType::FILTER_ATTRIBUTE_TYPE_LISTED) && (!comment_mode))
							{
								if (jc_filter_block != nullptr)
								{
									jc_filter_block = (EButtonGroupFilterBlock*)(jc_filter_block);
								}

								if ((jc_filter_block != nullptr) && (jc_filter_block->pointer_to_listed_attributes != nullptr))
								{
									listed_block = (EButtonGroupListedBlock*)(jc_filter_block->pointer_to_listed_attributes->group_list.back());
								}

								if (listed_block != nullptr)
								{
									EFilterRule* filter_rule = listed_block->data_container_with_filter_rule->filter_rule;
									std::string data_type_text = filter_rule->focused_by_data_type;

									std::vector<EDataEntity*>* target_data_entity_list = &EDataEntity::data_entity_global_list;




									int xxx = 0;
									EDataEntity* matched_data_entity = nullptr;

									for (EDataEntity* de : EDataEntity::data_entity_hash_struct.data_entity_list[EStringUtils::get_id_by_hash(buffer_text)])
									{
										if
											(
												(!DataEntityUtils::is_exist_tag_by_name_and_value(0, "item tag", "Hidden item", de))
												&&
												(
													(DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::name_EN, de) == buffer_text)
													||
													(DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::base_name, de) == buffer_text)
													||
													(DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::short_name, de) == buffer_text)
													)
												&&
												(EFilterRule::matched_by_filter_rule(de, filter_rule, ""))
												)
										{
											matched_data_entity = de;


											//EButtonGroup::change_group(((EDataContainer_Group_FilterBlockListedSegment*)d_container)->group_with_listed_buttons);
										}

										xxx++;
									}


									if (matched_data_entity != nullptr)
									{
										//if ()
										EntityButtonWideItem*
											wide_button = EntityButtonWideItem::create_wide_item_button
											(
												new ERegionGabarite(220.0f, 40.0f),
												listed_block->section_for_wide_item_buttons,
												matched_data_entity,
												EFont::font_list[0],
												true
											);
										//wide_button->can_be_stretched = true;
										listed_block->section_for_wide_item_buttons->add_button_to_working_group(wide_button);

									}
									else
									{
										EntityButtonWideItem* wide_button = EntityButtonWideItem::create_wide_item_button
										(
											new ERegionGabarite(220.0f, 40.0f),
											listed_block->section_for_wide_item_buttons,
											nullptr,
											EFont::font_list[0],
											true
										);

										listed_block->section_for_wide_item_buttons->add_button_to_working_group(wide_button);

										ELocalisationText l_text;
										l_text.base_name = buffer_text;
										l_text.localisations[NSW_localisation_EN] = buffer_text;
										l_text.localisations[NSW_localisation_RU] = buffer_text;

										wide_button->main_text_area->localisation_text = l_text;
										wide_button->main_text_area->change_text(l_text.localisations[ELocalisationText::active_localisation]);

									}
								}
							}

							if ((matched_item_attribute->filter_attribute_type == FilterAttributeType::FILTER_ATTRIBUTE_TYPE_COSMETIC) && (jc_filter_block != nullptr))
							{
								if (jc_filter_block != nullptr)
								{
									jc_filter_block = (EButtonGroupFilterBlock*)(jc_filter_block);
								}

								//EInputCore::logger_simple_info("Cosmetic");

								//		FONT SIZE
								//EInputCore::logger_param("Cosmetic, buffer text is", buffer_text);
								if ((matched_item_attribute->localisation.base_name == "SetFontSize") && (jc_filter_block != nullptr))
								{

									jc_filter_block->text_size = EStringUtils::safe_convert_string_to_number(buffer_text, 18, 45);

									jc_filter_block->text_size = std::max(jc_filter_block->text_size, 18.0f);
									jc_filter_block->text_size = std::min(jc_filter_block->text_size, 45.0f);

									jc_filter_block->text_size_bool = true;

									jc_filter_block->text_size_router_button->select_variant(1);
									//d_container->
								}

								//		BOX COLOR
								if (target_HRA_color != nullptr)
								{
									int converted_value = 0;

									if (!comment_mode)
									{
										if (EStringUtils::if_text_is_number(buffer_text))
										{
											converted_value = EStringUtils::safe_convert_string_to_number(buffer_text, 0, 255);
										}
										else
										{
											EInputCore::logger_simple_error("string [" + buffer_text + "] cannot be converted to number");
										}
									}

									if (data_part == 2) { target_HRA_color->r = converted_value / 255.0f; }
									if (data_part == 3) { target_HRA_color->g = converted_value / 255.0f; }
									if (data_part == 4)
									{
										target_HRA_color->b = converted_value / 255.0f;

										Helper::rgb2hsv(target_HRA_color);
										if (!comment_mode) { *target_color_bool = true; }
									}

									if (data_part == 5)
									{
										if ((!comment_mode) && (EStringUtils::if_text_is_number(buffer_text)))
										{
											target_HRA_color->a = std::stoi(buffer_text) / 255.0f;
										}
										else
										{
											target_HRA_color->a = 1.0f;
										}
									}
								}

								//		MINIMAP ICON
								if ((matched_item_attribute->filter_attribute_value_type == FILTER_ATTRIBUTE_VALUE_TYPE_MINIMAP_ICON) && (jc_filter_block != nullptr))
								{
									EntityButtonVariantRouter* router_button_size = jc_filter_block->pointer_to_minimap_icon_size_router;
									EntityButtonVariantRouter* router_button_color = jc_filter_block->pointer_to_minimap_icon_color_router;
									EntityButtonVariantRouter* router_button_shape = jc_filter_block->pointer_to_minimap_icon_shape_router;

									//SIZE OR DISABLE
									if ((data_part == 2) && (router_button_size != nullptr))
									{
										if (buffer_text != "-1")
										{
											router_button_size->select_variant(router_button_size->search_id_by_base_name(buffer_text));
										}
										else
										{
											jc_filter_block->pointer_to_forcibly_disable_minimap_icon_variant_button->select_variant(1);
										}
									}

									//COLOR
									if ((data_part == 3) && (router_button_color != nullptr))
									{
										router_button_color->select_variant(router_button_color->search_id_by_base_name(buffer_text));
									}

									//SHAPE
									if ((data_part == 4) && (router_button_shape != nullptr))
									{
										router_button_shape->select_variant(router_button_shape->search_id_by_base_name(buffer_text));
									}
								}

								//		USER SOUND
								if
									(
										(matched_item_attribute->filter_attribute_value_type == FILTER_ATTRIBUTE_VALUE_TYPE_VALUE_USER_SOUND)
										)
								{
									//parameter order - name
									if (data_part == 2)
									{
										ENamedSound*
											matched_named_sound = nullptr;





										if (buffer_text != "none")
										{
											std::string
												sound_name_buffer = "";

											std::vector<std::string>
												sound_name_vector;

											for (int z = 0; z < buffer_text.length(); z++)
											{
												char
													ch = buffer_text[z];

												if (ch != ';')
												{
													sound_name_buffer += ch;
												}

												if
													(
														(ch == ';')
														||
														(z >= buffer_text.length() - 1)
														)
												{
													sound_name_vector.push_back(sound_name_buffer);
													sound_name_buffer = "";
												}
											}

											if
												(
													(jc_filter_block != nullptr)
													&&
													(jc_filter_block->pointer_to_custom_sound_button != nullptr)
													)
											{

												for (std::string sound_names : sound_name_vector)
													for (ENamedSound* named_sound : EWindowMain::custom_sound_list)
														if (named_sound->localisation_text.base_name == sound_names)
														{
															//EInputCore::logger_param("matched sound", named_sound->localisation_text.base_name);
															//matched_named_sound = named_sound;
															jc_filter_block->pointer_to_custom_sound_button->named_sound_vector.push_back(named_sound);

															if (!comment_mode) { jc_filter_block->custom_sound_suppressor_bool = true; }
														}
											}


										}
										else//disable sound
										{
											if (jc_filter_block->pointer_to_forcibly_disable_user_sound_variant_button != nullptr)
											{
												if (!comment_mode)
												{
													jc_filter_block->pointer_to_forcibly_disable_user_sound_variant_button->select_variant(1);
												}
												else
												{
													jc_filter_block->pointer_to_forcibly_disable_user_sound_variant_button->select_variant(0);
												}
											}
										}



									}
									else
										if ((data_part == 3) && (jc_filter_block != nullptr))
										{
											float
												value = std::stoi(buffer_text) / 100.0f;
											value = std::max(value, 0.0f);
											value = std::min(value, 3.0f);

											jc_filter_block->user_sound_volume_value = value;
										}

								}



								//		INGAME SOUND
								if (matched_item_attribute->filter_attribute_value_type == FILTER_ATTRIBUTE_VALUE_TYPE_VALUE_INGAME_SOUND)
								{
									if (data_part == 2)
									{
										if (jc_filter_block->pointer_to_game_sound_button != nullptr)
										{
											ENamedSound* matched_named_sound = nullptr;

											if (buffer_text != "none")
											{
												for (ENamedSound* named_sound : EWindowMain::default_sound_list)
													if (named_sound->localisation_text.base_name == buffer_text)
													{
														matched_named_sound = named_sound;
													}

												if (jc_filter_block != nullptr)
												{
													if (jc_filter_block->pointer_to_game_sound_button->named_sound_vector.empty())
													{
														jc_filter_block->pointer_to_game_sound_button->named_sound_vector.push_back(matched_named_sound);
													}
													else
													{
														jc_filter_block->pointer_to_game_sound_button->named_sound_vector[0] = matched_named_sound;
													}

													if (!comment_mode) { jc_filter_block->game_sound_suppressor_bool = true; }

													jc_filter_block->pointer_to_forcibly_disable_ingame_sound_variant_button->select_variant(0);
												}


											}
											else
											{
												if (!comment_mode)
												{
													jc_filter_block->pointer_to_forcibly_disable_ingame_sound_variant_button->select_variant(1);
												}
												else
												{
													jc_filter_block->pointer_to_forcibly_disable_ingame_sound_variant_button->select_variant(0);
												}
											}
										}

										//if (matched_named_sound == nullptr)
										//{
										//	//EInputCore::logger_param_with_warning("undefined sound", buffer_text);
										//}



									}
									else
										if ((data_part == 3) && (jc_filter_block != nullptr))
										{
											float
												value = std::stoi(buffer_text) / 100.0f;
											value = std::max(value, 0.0f);
											value = std::min(value, 3.0f);

											jc_filter_block->ingame_sound_volume_value = value;
										}


								}

								//		RAY
								if
									(
										(matched_item_attribute->filter_attribute_value_type == FILTER_ATTRIBUTE_VALUE_TYPE_RAY)
										&&
										(!comment_mode)
										&&
										(jc_filter_block != nullptr)
										&&
										(jc_filter_block->pointer_to_ray_color_router != nullptr)
										)
								{
									EntityButtonVariantRouter*
										ray_router = jc_filter_block->pointer_to_ray_color_router;

									if (data_part == 2)
									{
										ray_router->select_variant(ray_router->search_id_by_base_name(buffer_text));
									}

									if ((data_part == 3) && (buffer_text == "Temp"))
									{
										jc_filter_block->pointer_to_temporary_option_router->select_variant(1);
									}
								}







							}

							if (matched_item_attribute->filter_attribute_type == FilterAttributeType::FILTER_ATTRIBUTE_TYPE_CONFIG)
							{

								switch (matched_item_attribute->filter_attribute_value_type)
								{
								case FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_CONFIG_VERSIONS:
								{
									if (jc_filter_block != nullptr)
									{
										int
											router_id = data_part - 2;

										EntityButtonVariantRouterForFilterBlock*
											target_router = jc_filter_block->version_routers[router_id];

										//EInputCore::logger_param("buffer text", buffer_text);
										//EInputCore::logger_param("router ID", router_id);
										//EInputCore::logger_param("searched id", target_router->seach_id_by_base_name(buffer_text));
										if (target_router != nullptr)
											target_router->select_variant(target_router->search_id_by_base_name_window_variant(buffer_text));
									}

									break;
								}

								case FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_OLD_VERSION_AUTOGEN:
								{
									if (jc_filter_block != nullptr)
									{
										int
											router_id = data_part - 2;

										EntityButtonVariantRouterForFilterBlock*
											target_router = jc_filter_block->version_routers[router_id];

										if (buffer_text == "true") { target_router->select_variant(3); }
										else
											if (buffer_text == "false") { target_router->select_variant(1); }
									}

									break;
								}

								case FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_CONFIG_SEPARATOR:
								{
									if (jc_filter_block_separator != nullptr)
									{
										if (data_part == 2)
										{
											if (buffer_text == "*EMPTY*")
											{
												jc_filter_block_separator->pointer_to_description_button->main_text_area->change_text("");
											}
											else
											{
												jc_filter_block_separator->pointer_to_description_button->main_text_area->change_text(buffer_text);
											}


										}

										if ((data_part == 3) && (buffer_text == "shrinked"))
										{
											jc_filter_block_separator->is_expanded = false;
											//jc_filter_block->is_expanded = false;
										}

										if ((data_part == 4) && (buffer_text == "additional_space"))
										{
											jc_filter_block_separator->additional_force_field = true;
											jc_filter_block_separator->additional_y_distance = NSW_default_y_force_field_for_separator + NSW_additional_y_force_field_for_separator;
											//jc_filter_block->is_expanded = false;
										}
									}

									break;
								}
								//case FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_CONFIG_COLOR_COLLECTION:
								//{
								//	
								//	if (jc_HRA_color_collection != nullptr)
								//	{	
								//		//0 attribute
								//		//1 operator
								//		//

								//		//2 R
								//		if (data_part == 2)
								//		{
								//			jc_HRA_color_collection->target_color.r = EStringUtils::safe_convert_string_to_number(buffer_text, 0, 255) / 255.0f;
								//			//jc_filter_block->is_expanded = false;
								//		}

								//		//3 G
								//		if (data_part == 3)
								//		{
								//			jc_HRA_color_collection->target_color.g = EStringUtils::safe_convert_string_to_number(buffer_text, 0, 255) / 255.0f;
								//			//jc_filter_block->is_expanded = false;
								//		}

								//		//4 B
								//		if (data_part == 4)
								//		{
								//			jc_HRA_color_collection->target_color.b = EStringUtils::safe_convert_string_to_number(buffer_text, 0, 255) / 255.0f;
								//		}

								//		//5 A
								//		if (data_part == 5)
								//		{
								//			jc_HRA_color_collection->target_color.a = EStringUtils::safe_convert_string_to_number(buffer_text, 0, 255) / 255.0f;
								//		}

								//		//6 EN
								//		//7 RU
								//		if ((data_part > 5) && (data_part <= 5 + NSW_languages_count))
								//		{
								//			jc_HRA_color_collection->localised_name.localisations[data_part - 6] = buffer_text;
								//		}
								//	}

								//	break;
								//}


								}


							}
							//FILTER_ATTRIBUTE_VALUE_CONFIG_VERSIONS
						}
					}

					//value_array[data_part] = buffer_text;

					buffer_text = "";
					data_part++;
				}
			}

		}
	}

	if (any_error)
	{
		registered_group_filter_error_list->check_errors();
		registered_group_filter_error_list->activate_move_to_foreground_and_center();
	}
}

bool EWindowMain::filter_block_contains_this_text(EButtonGroupFilterBlock* _target_filter_block, std::string* _text)
{
	bool any_match = false;
	bool listed_match = false;

	if (*_text != "")
	{

		//if (_target_filter_block->pointer_to_listed_segment->group_list.empty()) { any_match = true; }
		for (EButtonGroup* button_group : _target_filter_block->pointer_to_listed_attributes->group_list)
		{
			//listed_match = false;

			EButtonGroupListedBlock*
				listed_block = (EButtonGroupListedBlock*)(button_group);

			//if
			//(
			//	(listed_container->group_with_listed_buttons->button_list.empty())
			//	||
			//	(listed_container->group_with_listed_buttons->button_list.back() == listed_container->group_with_listed_buttons->slider)

			//)
			//{
			//	any_match = true;
			//}

			for (EntityButton* wide_button : listed_block->section_for_wide_item_buttons->workspace_button_list)
				if (wide_button->main_text_area != nullptr)
				{
					if
						(
							(EStringUtils::A_contains_B_ignore_case(wide_button->main_text_area->localisation_text.base_name, *_text))
							||
							(EStringUtils::A_contains_B_ignore_case(wide_button->main_text_area->localisation_text.localisations[NSW_localisation_EN], *_text))
							||
							(EStringUtils::A_contains_B_ignore_case(wide_button->main_text_area->localisation_text.localisations[NSW_localisation_RU], *_text))
							)
					{
						any_match = true;
						break;
					}
				}

		}

		for (EButtonGroup* button_group : _target_filter_block->pointer_to_workspace_non_listed_segment->group_list)
		{
			EButtonGroupNonListedLine*
				non_listed_block = (EButtonGroupNonListedLine*)(button_group);


		}
	}
	else
	{
		any_match = true;
	}

	return any_match;
}

void EWindowMain::add_game_item_data_entity_to_list()
{
	for (int i = 0; i < EDataEntity::data_entity_global_list.size(); i++)
	{
		EDataEntity*
			data_entity = EDataEntity::data_entity_global_list[i];

		if (data_entity != nullptr)
		{
			int index = 0;

			std::string
				data_type_name = DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::data_type, data_entity);

			if (data_type_name == "Game item")
			{
				EWindowMain::registered_data_entity_game_item_list.push_back(data_entity);
			}
			else if (data_type_name == "Base Class")
			{
				EWindowMain::registered_data_entity_class_list.push_back(data_entity);
			}
			else if (data_type_name == "Explicit")
			{
				EWindowMain::registered_data_entity_explicit_list.push_back(data_entity);
			}
		}
	}
}

void EWindowMain::write_loot_filter_to_disc(std::string _full_path, std::string* _data)
{
	if
		(
			(EWindowMain::tab_list_group != nullptr)
			&&
			(EWindowMain::tab_list_group->selected_button != nullptr)
			&&
			(EWindowMain::tab_list_group->selected_button->main_text_area != nullptr)
			)
	{
		std::ofstream writabro;

		writabro.open(_full_path);
		writabro << *_data;
		writabro.close();
	}
	else
	{
		EInputCore::logger_simple_error("something wrong, cannot get loot-filter name!");
	}
}



void EWindowMain::register_filter_rule_folder(std::string _named_id, std::string _tag, std::string _localisation_key, std::string _icon_path)
{
	EFilterRule*
		jc_filter_rule = new EFilterRule();
	jc_filter_rule->is_folder = true;
	jc_filter_rule->named_id = _named_id;

	jc_filter_rule->icon_texture = NS_EGraphicCore::load_from_textures_folder(_icon_path);

	jc_filter_rule->localisation_text = new ELocalisationText(ELocalisationText::get_localisation_by_key(_localisation_key));
	jc_filter_rule->tag = _tag;

	//
	//EFilterRule::registered_global_filter_rules.push_back(jc_filter_rule);
	EFilterRule::registered_filter_rules_for_list.push_back(jc_filter_rule);
}




void EWindowMain::register_loot_filter_version_patterns()
{
	LootFilterVersionPattern::PatternStruct*
	new_pattern;



	//[0] variant_mode_full_ignore
	//[1] variant_mode_hide
	//[2] variant_mode_ignore
	//[3] variant_mode_default
	//[4] variant_mode_very_focus

	//[0]	FULL IGNORE

	new_pattern = new LootFilterVersionPattern::PatternStruct();
	new_pattern->key_for_localisation = "variant_mode_full_ignore";
	new_pattern->localised_name = ELocalisationText::get_localisation_by_key("variant_mode_full_ignore");
	new_pattern->icon = NS_EGraphicCore::load_from_textures_folder("loot_versions/loot_version_full_ignore");
	new_pattern->disable_minimap_elements = true;
	new_pattern->disable_sound = true;
	new_pattern->focus_multiplier = 0.25f;
	new_pattern->full_ignore_mode = true;
	LootFilterVersionPattern::registered_loot_filter_version_patterns.push_back(new_pattern);

	//[1]	HIDE
	new_pattern = new LootFilterVersionPattern::PatternStruct();
	new_pattern->key_for_localisation = "variant_mode_hide";
	new_pattern->localised_name = ELocalisationText::get_localisation_by_key("variant_mode_hide");
	new_pattern->icon = NS_EGraphicCore::load_from_textures_folder("loot_versions/loot_version_hide");
	new_pattern->disable_minimap_elements = true;
	new_pattern->disable_sound = true;
	new_pattern->focus_multiplier = 0.25f;
	new_pattern->show_hide_mode = (int)(LootFilterVersionPattern::LootPatternParameterMode::FORCIBLY_DISABLE);
	LootFilterVersionPattern::registered_loot_filter_version_patterns.push_back(new_pattern);

	//[2]	LOW FOCUS
	new_pattern = new LootFilterVersionPattern::PatternStruct();
	new_pattern->key_for_localisation = "variant_mode_ignore";
	new_pattern->localised_name = ELocalisationText::get_localisation_by_key("variant_mode_ignore");
	new_pattern->icon = NS_EGraphicCore::load_from_textures_folder("loot_versions/loot_version_strong_ignore");
	new_pattern->disable_minimap_elements = true;
	new_pattern->disable_sound = true;
	new_pattern->focus_multiplier = 0.65f;
	LootFilterVersionPattern::registered_loot_filter_version_patterns.push_back(new_pattern);

	//[3]	DEFAULT
	new_pattern = new LootFilterVersionPattern::PatternStruct();
	new_pattern->key_for_localisation = "variant_mode_default";
	new_pattern->localised_name = ELocalisationText::get_localisation_by_key("variant_mode_default");
	new_pattern->icon = NS_EGraphicCore::load_from_textures_folder("loot_versions/loot_version_default");
	new_pattern->is_default = true;
	new_pattern->disable_minimap_elements = false;
	new_pattern->disable_sound = false;
	new_pattern->focus_multiplier = 1.00f;
	LootFilterVersionPattern::registered_loot_filter_version_patterns.push_back(new_pattern);

	//[4]	HIGH FOCUS
	new_pattern = new LootFilterVersionPattern::PatternStruct();
	new_pattern->key_for_localisation = "variant_mode_very_focus";
	new_pattern->localised_name = ELocalisationText::get_localisation_by_key("variant_mode_very_focus");
	new_pattern->icon = NS_EGraphicCore::load_from_textures_folder("loot_versions/loot_version_strong_focus");
	new_pattern->disable_minimap_elements = false;
	new_pattern->disable_sound = false;
	new_pattern->focus_multiplier = 1.5f;
	LootFilterVersionPattern::registered_loot_filter_version_patterns.push_back(new_pattern);
}




void EWindowMain::set_color_version(HSVRGBAColor* _target_color, int _selected_mode)
{
	// hide or ignore
	if ((_selected_mode == 1) || (_selected_mode == 2))
	{
		_target_color->s *= 0.75f;
		_target_color->v *= 0.75f;

		Helper::hsv2rgb(_target_color);
	}
	else//focus
		if (_selected_mode == 4)
		{
			_target_color->s *= 1.5f;
			_target_color->v *= 1.5f;

			Helper::hsv2rgb(_target_color);
		}


}

void EWindowMain::set_color_focus(HSVRGBAColor* _target_color, float _focus)
{
	_target_color->s *= _focus;
	_target_color->v *= _focus;

	Helper::hsv2rgb(_target_color);
}

void EWindowMain::make_unsaved_loot_filter_changes()
{
	EInputCore::NSW_have_unsave_changes = true;

	if (header_line->pointer_to_bottom_tabs_section->selected_button != nullptr)
	{
		header_line->pointer_to_bottom_tabs_section->selected_button->main_text_area->set_color(1.0f, 0.5f, 0.1f, 1.0f);

		static_cast<EntityButtonFilterBlockTab*>(EWindowMain::header_line->pointer_to_bottom_tabs_section->selected_button)->unsave_changes = true;

		header_line->pointer_to_bottom_tabs_section->selected_button->main_text_area->generate_text();
	}



}

void EWindowMain::remove_unsave_changes_flag_from_tab()
{
	EInputCore::NSW_have_unsave_changes = false;

	if (header_line->pointer_to_bottom_tabs_section->selected_button != nullptr)
	{
		EntityButtonFilterBlockTab*
			tab_button = static_cast<EntityButtonFilterBlockTab*>(header_line->pointer_to_bottom_tabs_section->selected_button);

		tab_button->unsave_changes = false;

		tab_button->main_text_area->set_color(1.0f, 0.9f, 0.8f, 1.0f);
		tab_button->main_text_area->generate_text();
	}

	for (EntityButton* button : header_line->pointer_to_bottom_tabs_section->workspace_button_list)
	{
		EntityButtonFilterBlockTab* tab_button = static_cast<EntityButtonFilterBlockTab*>(button);
		EInputCore::NSW_have_unsave_changes |= tab_button->unsave_changes;
	}




}

void EWindowMain::save_config_file()
{
	std::ofstream writabro;

	std::string buffer = "";

	writabro.open(path_of_exile_folder + "DaDEditorConfig.config");

	buffer = "active_localisation\t" + std::to_string(ELocalisationText::active_localisation);
	writabro << buffer << std::endl;

	buffer = "selected_style\t" + EGUIStyle::active_style->localisation_text.base_name;
	writabro << buffer << std::endl;



	for (HRA_color_collection* color_collection : Helper::registered_color_list)
	{

		buffer = "color_collection";
		buffer += "\t" + std::to_string((int)round(color_collection->target_color.r * 255.0f));
		buffer += "\t" + std::to_string((int)round(color_collection->target_color.g * 255.0f));
		buffer += "\t" + std::to_string((int)round(color_collection->target_color.b * 255.0f));
		buffer += "\t" + std::to_string((int)round(color_collection->target_color.a * 255.0f));

		for (int i = 0; i < NSW_languages_count; i++)
		{
			buffer += "\t";
			buffer += '"' + color_collection->localised_name.localisations[i] + '"';
		}

		//buffer += "\r";
		writabro << buffer << std::endl;
	}




	writabro.close();
}

void EWindowMain::save_config_file_for_loot_versions()
{
	std::ofstream writabro;

	std::string buffer = "";

	writabro.open(path_of_exile_folder + "DaDEditorConfig[loot_versions].config");

	for (int i = 0; i < NSW_LOOT_FILTER_MAX_VERSIONS; i++)
	{
		if (static_cast<EDataContainer_Button_BoolSwitcher*>(registered_group_loot_version_configure->pointer_to_version_name_button_switcher[i]->main_custom_data->data_container)->target_value != nullptr)
			buffer =
			(*(static_cast<EDataContainer_Button_BoolSwitcher*>(registered_group_loot_version_configure->pointer_to_version_name_button_switcher[i]->main_custom_data->data_container)->target_value))
			? ("version_name_active")
			: ("version_name_inactive");

		if (registered_group_loot_version_configure->pointer_to_version_name_button[i]->main_text_area->original_text != "")
		{
			buffer += "\t\"" + registered_group_loot_version_configure->pointer_to_version_name_button[i]->main_text_area->original_text + "\"";
		}
		else
		{
			buffer += "\t";
			buffer += "\"*EMPTY*\"";
		}

		writabro << buffer << std::endl;
	}

	writabro.close();
}

void EWindowMain::save_config_file_for_loot_version_patterns()
{
	std::ofstream writabro;

	std::string buffer = "";

	writabro.open(path_of_exile_folder + "DaDEditorConfig[loot_version_patterns].config");

	for (int i = 0; i < LootFilterVersionPattern::registered_loot_filter_version_patterns.size(); i++)
	{

		LootFilterVersionPattern::PatternStruct*
			target_pattern = LootFilterVersionPattern::registered_loot_filter_version_patterns[i];

		//name of version pattern
		buffer = "CREATE_NEW_LOOT_VERSION_PATTERN";
		buffer += "\n";

		if (target_pattern->key_for_localisation != "")
		{
			buffer += "localised_name\t\"";
			buffer += target_pattern->key_for_localisation;
			buffer += "\"";
		}
		else
		{
			buffer += "custom_name\t";
			buffer += "\"" + target_pattern->localised_name.base_name + "\"";
		}

		buffer += "\n";




		buffer += "selected_continue_mode";
		buffer += "\t" + std::to_string((int)(target_pattern->continue_mode));
		buffer += "\n";



		buffer += "selected_show_hide_mode";
		buffer += "\t" + std::to_string((int)(target_pattern->show_hide_mode));
		buffer += "\n";


		buffer += "focus_multiplier";
		buffer += "\t" + std::to_string(target_pattern->focus_multiplier);
		buffer += "\n";

		if (target_pattern->is_default)
		{
			buffer += "is_default";
			buffer += "\n";
		}


		if (target_pattern->disable_minimap_elements)
		{
			buffer += "disable_minimap_element";
			buffer += "\n";
		}

		if (target_pattern->disable_sound)
		{
			buffer += "disable_sound";
			buffer += "\n";
		}

		if (target_pattern->full_ignore_mode)
		{
			buffer += "full_ignore_mode";
			buffer += "\n";
		}

		if (target_pattern->color_pointer != nullptr)
		{
			buffer += "text_color";
			buffer += "\t" + std::to_string((int)round(target_pattern->color_pointer->r * 255.0f));
			buffer += "\t" + std::to_string((int)round(target_pattern->color_pointer->g * 255.0f));
			buffer += "\t" + std::to_string((int)round(target_pattern->color_pointer->b * 255.0f));
			buffer += "\t" + std::to_string((int)round(target_pattern->color_pointer->a * 255.0f));
			buffer += "\n";
		}

		if (target_pattern->icon != nullptr)
		{
			buffer += "icon_texture";

			buffer += "\t" + target_pattern->icon->get_name();
		}



		buffer += "\n";

		/*if (static_cast<EDataContainer_Button_BoolSwitcher*>(registered_group_loot_version_configure->pointer_to_version_name_button_switcher[i]->main_custom_data->data_container)->target_value != nullptr)
			buffer =
			(*(static_cast<EDataContainer_Button_BoolSwitcher*>(registered_group_loot_version_configure->pointer_to_version_name_button_switcher[i]->main_custom_data->data_container)->target_value))
			? ("version_name_active")
			: ("version_name_inactive");

		if (registered_group_loot_version_configure->pointer_to_version_name_button[i]->main_text_area->original_text != "")
		{
			buffer += "\t\"" + registered_group_loot_version_configure->pointer_to_version_name_button[i]->main_text_area->original_text + "\"";
		}
		else
		{
			buffer += "\t";
			buffer += "\"*EMPTY*\"";
		}*/

		writabro << buffer << std::endl;
	}

	writabro.close();
}

void EWindowMain::action_on_close()
{
	EWindow::action_on_close();

	save_config_file();
	save_config_file_for_loot_versions();
	save_config_file_for_loot_version_patterns();
}



void EDataActionCollection::action_highlight_block_with_error(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EntityButtonFilterBlockError*
		error_button = static_cast<EntityButtonFilterBlockError*>(_entity);

	if (error_button->target_filter_block != nullptr)
	{
		if (error_button->target_filter_block->attached_separator != nullptr)
		{
			error_button->target_filter_block->attached_separator->is_expanded = true;
		}

		error_button->target_filter_block->highlight_this_group_green_info();
		EWindowMain::active_loot_filter_editor->slide_to_this_group(error_button->target_filter_block);

	}

}

void EDataActionCollection::action_open_add_content_window(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EButtonGroup::add_content_to_filter_block_group->activate_move_to_foreground_and_center();

	//_custom_data
	EDataContainer_Button_OpenButtonGroup* button_plus_data = static_cast<EDataContainer_Button_OpenButtonGroup*>						(_custom_data->data_container);
	EButtonGroupFilterBlock* whole_filter_block_data = static_cast<EButtonGroupFilterBlock*>											(button_plus_data->master_group);
	EDataContainer_Group_AddContentToFilterBlock* add_content_block_data = static_cast<EDataContainer_Group_AddContentToFilterBlock*>	(EButtonGroup::add_content_to_filter_block_group->data_container);
	ETextArea* typing_text_area = add_content_block_data->typing_text_area;

	typing_text_area->change_text("");
	typing_text_area->outclick_protection = true;
	//for ()

	for (text_actions_pointer dap : typing_text_area->action_on_change_text) if (dap != nullptr) { dap(typing_text_area); }
	//typing_text_area->activate_this_text_area();

	{ add_content_block_data->target_filter_block = (EButtonGroupFilterBlock*)(button_plus_data->master_group); }

	//if (taget_group_for_content != nullptr) { taget_group_for_content->button_list.clear(); }
}

void EDataActionCollection::action_add_selected_content_to_filter_block(Entity* _entity, ECustomData* _custom_data, float _d)
{

	EDataContainer_Button_AddContentToFilterBlock*
		button_content_data = static_cast<EDataContainer_Button_AddContentToFilterBlock*>	(_custom_data->data_container);


	EDataContainer_Group_AddContentToFilterBlock*
		add_content_group_data = static_cast<EDataContainer_Group_AddContentToFilterBlock*>	(EButtonGroup::add_content_to_filter_block_group->data_container);

	EButtonGroupFilterBlock*
		target_filter_block = add_content_group_data->target_filter_block;

	EDataContainer_Button_AddContentToFilterBlock*
		add_content_button_data = static_cast<EDataContainer_Button_AddContentToFilterBlock*>	(_custom_data->data_container);

	EButtonGroup*
		target_group_for_content = nullptr;

	EntityButton*
		jc_button = nullptr;

	//bool target_block_is_selected = target_filter_block->is_selected




	//		add to only target filter block or to all selected?

	//		only to target
	if
		(
			(!EButtonGroup::selected_groups.empty())
			&&
			(target_filter_block->is_selected)
			)
	{
		for (EButtonGroup* selected_group : EButtonGroup::selected_groups)
		{
			add_game_item_attribute_to_filter_block
			(
				static_cast<EButtonGroupFilterBlock*>(selected_group),

				(add_content_button_data->target_attribute->filter_attribute_value_type != FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_UNDEFINED_ATTRIBUTE)
				?
				(add_content_button_data->target_attribute)
				:
				(nullptr),

				""
			);
		}
	}
	else//	to all selected
	{
		add_game_item_attribute_to_filter_block
		(
			target_filter_block,

			(add_content_button_data->target_attribute->filter_attribute_value_type != FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_UNDEFINED_ATTRIBUTE)
			?
			(add_content_button_data->target_attribute)
			:
			(nullptr),

			""
		);
	}

	//if (taget_group_for_content != nullptr)
	//{ 
	//	*taget_group_for_content->is_active = false; 
	//}

	if (!EInputCore::key_pressed(GLFW_KEY_LEFT_SHIFT))
	{
		EButtonGroup::add_content_to_filter_block_group->close_this_group();
	}

	EButtonGroup::change_group(EWindowMain::active_loot_filter_editor);
	//EWindowMain::loot_filter_editor->need_change = true;
	//EWindowMain::loot_simulator_button_group->refresh_loot_simulator();
	EWindowMain::loot_simulator_button_group->delayed_execution = true;

}

void EDataActionCollection::action_open_rarity_selector(Entity* _entity, ECustomData* _custom_data, float _d)
{
	EWindowMain::select_rarity_button_group->activate_move_to_foreground_and_center();

	static_cast<EDataContainer_Group_TextSelectorFromVariants*>(EWindowMain::select_rarity_button_group->data_container)->target_button = static_cast<EntityButton*>(_entity);
	//reg
	EWindowMain::select_rarity_button_group->region_gabarite->offset_x = static_cast<EntityButton*>(_entity)->button_gabarite->world_position_x;
	EWindowMain::select_rarity_button_group->region_gabarite->offset_y = static_cast<EntityButton*>(_entity)->button_gabarite->world_position_y + static_cast<EntityButton*>(_entity)->button_gabarite->size_y + 3.0f;

	EWindowMain::select_rarity_button_group->need_refresh = true;
}



//create group of buttons to filter block.
//usually, group include next buttons:
//1) attribute name ("rarity", "ItemLevel", "BaseClass", ...)
//2) comparison operator, if need ("<=", "=", ">=")
//3) value
//4) remove button
void add_game_item_attribute_to_filter_block(EButtonGroupFilterBlock* _target_filter_block, GameItemAttribute* _game_item_attribute, std::string _undefined_attribute_text)
{
	float button_height = 30.0f;
	//filter block have 4 sectors
	//1) control
	//2) non_listed
	//3) listed
	//4) cosmetic
	//
	//EDataContainer_Group_WholeFilterBlock store pointers to each segemnt
	EButtonGroupFilterBlock*
		whole_filter_block_data = static_cast<EButtonGroupFilterBlock*>(_target_filter_block);

	EntityButtonForFilterBlock* jc_button;

	std::string temp_rarity[] = { "Нормальный", "Магический", "Редкий", "Уникальный" };
	EButtonGroup* parent_group_for_content;

	HSVRGBAColor rarity_color[4];

	HSVRGBAColor temp_color;

	//normal
	temp_color.set_color_RGBA(1.0f, 1.0f, 1.0f, 1.0f);
	rarity_color[0] = temp_color;

	//magic
	temp_color.set_color_RGBA(0.5f, 0.6f, 1.0f, 1.0f);
	rarity_color[1] = temp_color;

	//rare
	temp_color.set_color_RGBA(1.0f, 1.0f, 0.25f, 1.0f);
	rarity_color[2] = temp_color;

	//unique
	temp_color.set_color_RGBA(1.0f, 0.5f, 0.250f, 1.0f);
	rarity_color[3] = temp_color;

	EButtonGroupListedBlock*
		listed_condition_group_container = nullptr;

	if (_game_item_attribute != nullptr)
	{
		//if selected content is non-listed
		if ((_game_item_attribute->filter_attribute_type == FilterAttributeType::FILTER_ATTRIBUTE_TYPE_NON_LISTED) && (whole_filter_block_data->pointer_to_workspace_non_listed_segment != nullptr))
		{

			float line_height = 30.0f;

			//EInputCore::logger_simple_info("add new non listed button");
			parent_group_for_content = whole_filter_block_data->pointer_to_workspace_non_listed_segment;

			parent_group_for_content->clickable_area_list.back()->clickable_region_is_active = false;

			EButtonGroupNonListedLine*
				non_listed_line = new EButtonGroupNonListedLine(new ERegionGabarite(line_height, button_height));
			non_listed_line->init_button_group(EGUIStyle::active_style, BrickStyleID::NONE, bgroup_without_slider);



			non_listed_line->set_parameters
			(
				ChildAlignMode::ALIGN_VERTICAL,
				NSW_dynamic_autosize,
				NSW_static_autosize
			);
			non_listed_line->button_align_type = ButtonAlignType::BUTTON_ALIGN_LEFT;

			whole_filter_block_data->pointer_to_workspace_non_listed_segment->add_group(non_listed_line);


			non_listed_line->target_game_attribute = _game_item_attribute;

			/*CLOSE BUTTON*/
			//REMOVE NON LISTED LINE
			///////////////////////////////////////////////////////////////////////////////////////////////
			jc_button = new EntityButtonForFilterBlock();
			jc_button->make_as_default_button_with_icon
			(
				new ERegionGabarite(button_height, button_height),
				non_listed_line,
				&EDataActionCollection::action_mark_parent_group_as_removed,
				NS_EGraphicCore::load_from_textures_folder("button_close")
			);

			jc_button->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_make_unsave_filter_block_changes_and_refresh_loot_simulator);

			jc_button->parent_filter_block = _target_filter_block;
			jc_button->used_filter_block_attribute = _game_item_attribute;

			non_listed_line->add_button_to_working_group(jc_button);
			jc_button->parent_filter_block = _target_filter_block;
			///////////////////////////////////////////////////////////////////////////////////////////////







			/*ATTRIBUTE NAME BUTTON*/
			///////////////////////////////////////////////////////////////////////////////////////////////
			jc_button = new EntityButtonForFilterBlock();

			jc_button->make_as_default_button_with_icon_and_text
			(
				new ERegionGabarite(100.0f, button_height),
				non_listed_line,
				nullptr,
				_game_item_attribute->icon,
				_game_item_attribute->localisation.localisations[ELocalisationText::active_localisation]

			);
			jc_button->can_be_stretched = true;
			jc_button->max_stretch_factor = 3.0f;

			jc_button->main_text_area->offset_by_gabarite_size_x = 1.0f;
			jc_button->main_text_area->offset_by_text_size_x = -1.0f;
			jc_button->main_text_area->offset_border[BorderSide::RIGHT] = 3.0f;

			jc_button->main_text_area->localisation_text = _game_item_attribute->localisation;

			jc_button->parent_filter_block = _target_filter_block;
			jc_button->used_filter_block_attribute = _game_item_attribute;

			if (jc_button->main_text_area != nullptr) { jc_button->main_text_area->localisation_text = _game_item_attribute->localisation; }
			non_listed_line->target_button_with_attribute_name = jc_button;

			non_listed_line->add_button_to_working_group(jc_button);
			///////////////////////////////////////////////////////////////////////////////////////////////







			/*CONDITION OPERATOR BUTTON*/
			///////////////////////////////////////////////////////////////////////////////////////////////
			float input_field_additional_width = 0.0f;
			//condition operator
			if (_game_item_attribute->have_operator)
			{
				EntityButtonVariantRouterForFilterBlock*
					condition_router_button = new EntityButtonVariantRouterForFilterBlock();

				non_listed_line->add_button_to_working_group(condition_router_button);
				condition_router_button->make_as_default_router_variant_button
				(
					new ERegionGabarite(40.0f, button_height)
				);
				condition_router_button->main_text_area->font = EFont::font_list[1];
				condition_router_button->main_text_area->font_scale = 0.7f;

				condition_router_button->rotate_variant_mode = RotateVariantMode::OPEN_CHOOSE_WINDOW;
				condition_router_button->action_on_choose_variant_from_window.push_back(&EDataActionCollection::action_make_unsave_filter_block_changes_and_refresh_loot_simulator);
				//condition_router_button->action_on_choose_variant_from_window.push_back(&EDataActionCollection::action_refresh_loot_simulator);
				condition_router_button->height_division = 1;
				///		<=		///////////////////////////////////////////////////////////////////////////
				{
					RouterVariant* router_variant = new RouterVariant();
					ELocalisationText ltext;

					ltext.base_name = "<=";
					ltext.localisations[NSW_localisation_EN] = "<=";
					ltext.localisations[NSW_localisation_RU] = "<=";

					router_variant->router_localisation = ltext;

					router_variant->text_color = new HSVRGBAColor();
					router_variant->text_color->set_color_RGBA(1.0f, 0.8f, 0.6f, 1.0f);

					condition_router_button->router_variant_list.push_back(router_variant);
				}

				///		<		///////////////////////////////////////////////////////////////////////////
				{
					RouterVariant* router_variant = new RouterVariant();
					ELocalisationText ltext;

					ltext.base_name = "<";
					ltext.localisations[NSW_localisation_EN] = "<";
					ltext.localisations[NSW_localisation_RU] = "<";

					router_variant->router_localisation = ltext;

					router_variant->text_color = new HSVRGBAColor();
					router_variant->text_color->set_color_RGBA(1.0f, 0.8f, 0.6f, 1.0f);

					condition_router_button->router_variant_list.push_back(router_variant);
				}


				///		=		///////////////////////////////////////////////////////////////////////////
				{
					RouterVariant* router_variant = new RouterVariant();
					ELocalisationText ltext;

					ltext.base_name = "=";
					ltext.localisations[NSW_localisation_EN] = "=";
					ltext.localisations[NSW_localisation_RU] = "=";

					router_variant->router_localisation = ltext;

					router_variant->text_color = new HSVRGBAColor();
					router_variant->text_color->set_color_RGBA(1.0f, 0.8f, 0.6f, 1.0f);

					condition_router_button->router_variant_list.push_back(router_variant);
				}

				///		>		///////////////////////////////////////////////////////////////////////////
				{
					RouterVariant* router_variant = new RouterVariant();
					ELocalisationText ltext;

					ltext.base_name = ">";
					ltext.localisations[NSW_localisation_EN] = ">";
					ltext.localisations[NSW_localisation_RU] = ">";

					router_variant->router_localisation = ltext;

					router_variant->text_color = new HSVRGBAColor();
					router_variant->text_color->set_color_RGBA(1.0f, 0.8f, 0.6f, 1.0f);

					condition_router_button->router_variant_list.push_back(router_variant);
				}


				///		>=		///////////////////////////////////////////////////////////////////////////
				{
					RouterVariant* router_variant = new RouterVariant();
					ELocalisationText ltext;

					ltext.base_name = ">=";
					ltext.localisations[NSW_localisation_EN] = ">=";
					ltext.localisations[NSW_localisation_RU] = ">=";

					router_variant->router_localisation = ltext;

					router_variant->text_color = new HSVRGBAColor();
					router_variant->text_color->set_color_RGBA(1.0f, 0.8f, 0.6f, 1.0f);

					condition_router_button->router_variant_list.push_back(router_variant);
				}


				///		>=		///////////////////////////////////////////////////////////////////////////
				{
					RouterVariant* router_variant = new RouterVariant();
					ELocalisationText ltext;

					ltext.base_name = "!";
					ltext.localisations[NSW_localisation_EN] = "!";
					ltext.localisations[NSW_localisation_RU] = "!";

					router_variant->router_localisation = ltext;

					router_variant->text_color = new HSVRGBAColor();
					router_variant->text_color->set_color_RGBA(1.0f, 0.4f, 0.3f, 1.0f);

					condition_router_button->router_variant_list.push_back(router_variant);
				}

				condition_router_button->select_variant(2);

				condition_router_button->parent_filter_block = _target_filter_block;
				condition_router_button->used_filter_block_attribute = _game_item_attribute;



				non_listed_line->target_button_with_condition = condition_router_button;


			}
			else
			{
				input_field_additional_width = button_height * 2.0f + BUTTON_FORCE_FIELD_SIZE;

				non_listed_line->target_button_with_condition = nullptr;
			}
			///////////////////////////////////////////////////////////////////////////////////////////////

			srand(std::chrono::duration_cast<std::chrono::microseconds>(std::chrono::system_clock::now().time_since_epoch()).count());

			//EInputCore::logger_param("current time", std::chrono::duration_cast<std::chrono::milliseconds>(std::chrono::system_clock::now().time_since_epoch()).count());
			int rarity_id = rand() % 4;

			std::string text = "1";

			switch (_game_item_attribute->filter_attribute_value_type)
			{
			case FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_RARITY_LIST:
			{
				EntityButtonVariantRouterForFilterBlock*
					rarity_button = new EntityButtonVariantRouterForFilterBlock();
				non_listed_line->add_button_to_working_group(rarity_button);

				rarity_button->make_as_default_router_variant_button(new ERegionGabarite(100.0f + input_field_additional_width, button_height));
				rarity_button->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_make_unsave_filter_block_changes_and_refresh_loot_simulator);

				rarity_button->main_text_area->font = EFont::font_list[1];
				rarity_button->main_text_area->font_scale = 0.7f;

				rarity_button->parent_filter_block = _target_filter_block;
				rarity_button->rotate_variant_mode = RotateVariantMode::OPEN_CHOOSE_WINDOW;

				non_listed_line->rarity_router_button = rarity_button;


				RouterVariant* router_variant = nullptr;
				ELocalisationText ltext;;

				///		NORMAL		///////////////////////////////////////////////////////////////////////////
				router_variant = new RouterVariant();


				ltext.base_name = "Normal";
				ltext.localisations[NSW_localisation_EN] = "Normal";
				ltext.localisations[NSW_localisation_RU] = "Обычный";

				router_variant->router_localisation = ltext;

				router_variant->text_color = new HSVRGBAColor();
				router_variant->text_color->set_color_RGBA(1.0f, 0.8f, 0.6f, 1.0f);

				rarity_button->router_variant_list.push_back(router_variant);
				///		MAGIC		///////////////////////////////////////////////////////////////////////////
				router_variant = new RouterVariant();


				ltext.base_name = "Magic";
				ltext.localisations[NSW_localisation_EN] = "Magic";
				ltext.localisations[NSW_localisation_RU] = "Волшебный";

				router_variant->router_localisation = ltext;

				router_variant->text_color = new HSVRGBAColor();
				router_variant->text_color->set_color_RGBA(0.2f, 0.6f, 1.6f, 1.0f);

				rarity_button->router_variant_list.push_back(router_variant);
				///		RARE		///////////////////////////////////////////////////////////////////////////
				router_variant = new RouterVariant();


				ltext.base_name = "Rare";
				ltext.localisations[NSW_localisation_EN] = "Rare";
				ltext.localisations[NSW_localisation_RU] = "Редкий";

				router_variant->router_localisation = ltext;

				router_variant->text_color = new HSVRGBAColor();
				router_variant->text_color->set_color_RGBA(1.0f, 0.8f, 0.2f, 1.0f);

				rarity_button->router_variant_list.push_back(router_variant);
				///		UNIQUE		///////////////////////////////////////////////////////////////////////////
				router_variant = new RouterVariant();


				ltext.base_name = "Unique";
				ltext.localisations[NSW_localisation_EN] = "Unique";
				ltext.localisations[NSW_localisation_RU] = "Уникальный";

				router_variant->router_localisation = ltext;

				router_variant->text_color = new HSVRGBAColor();
				router_variant->text_color->set_color_RGBA(1.0f, 0.5f, 0.25f, 1.0f);

				rarity_button->router_variant_list.push_back(router_variant);
				///////////////////////////////////////////////////////////////////////////////////////////////

				rarity_button->select_variant(0);


				//non_listed_line->button_list.push_back(rarity_button);
				break;
			}

			

			case FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_BOOL_SWITCHER:
			{
				//NON-LISTED GAME TTRIBUTE BOOL CHECKER
				jc_button = new EntityButtonForFilterBlock();
				jc_button->make_default_bool_switcher_button
				(
					new ERegionGabarite(button_height, button_height),
					non_listed_line,
					EDataActionCollection::action_switch_boolean_value,
					NS_DefaultGabarites::texture_bool_switcher_activated_box,
					NS_DefaultGabarites::texture_bool_switcher_deactivated_box,
					nullptr
				);
				jc_button->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_make_unsave_filter_block_changes_and_refresh_loot_simulator);

				jc_button->parent_filter_block = _target_filter_block;
				jc_button->used_filter_block_attribute = _game_item_attribute;

				non_listed_line->target_button_with_value = jc_button;
				non_listed_line->add_button_to_working_group(jc_button);

				break;
			}

			default:
			{
				jc_button = new EntityButtonForFilterBlock();
				jc_button->make_default_button_with_edible_text
				(
					new ERegionGabarite(100.0f + input_field_additional_width, button_height),
					non_listed_line,
					nullptr,
					text
				);
				jc_button->main_text_area->action_on_change_text.push_back(&EDataActionCollection::action_set_unsave_changes_flag);
				jc_button->main_text_area->font = EFont::font_list[1];
				jc_button->main_text_area->font_scale = 0.75f;

				jc_button->main_text_area->gray_text = ELocalisationText();
				jc_button->main_text_area->gray_text.localisations[NSW_localisation_EN] = "value";
				jc_button->main_text_area->gray_text.localisations[NSW_localisation_RU] = "значение";

				jc_button->parent_filter_block = _target_filter_block;
				jc_button->used_filter_block_attribute = _game_item_attribute;

				jc_button->main_text_area->localisation_text = _game_item_attribute->localisation;

				non_listed_line->target_button_with_value = jc_button;
				non_listed_line->add_button_to_working_group(jc_button);
			}
			}


		}


		if
			(
				(_game_item_attribute->filter_attribute_type == FilterAttributeType::FILTER_ATTRIBUTE_TYPE_LISTED)
				&&
				(whole_filter_block_data->pointer_to_listed_attributes != nullptr)
				)
		{
			parent_group_for_content = whole_filter_block_data->pointer_to_listed_attributes;

			listed_condition_group_container = create_block_for_listed_segment
			(
				_game_item_attribute->filter_rule,
				_game_item_attribute,
				_game_item_attribute->localisation.base_name,
				parent_group_for_content,
				_target_filter_block
			);

			//EButtonGroup::change_group(target_group_for_content);
			parent_group_for_content->need_change = true;
		}
	}
	else
	{

		listed_condition_group_container = create_block_for_listed_segment
		(
			nullptr,
			_game_item_attribute,
			_undefined_attribute_text,
			whole_filter_block_data->pointer_to_listed_attributes,
			_target_filter_block
		);

		whole_filter_block_data->pointer_to_listed_segment_in_filter_block->need_change = true;
	}

	if
		(
			(whole_filter_block_data->pointer_to_attribute_tab != nullptr)
			&&
			(
				(_game_item_attribute == nullptr)
				||
				(_game_item_attribute->filter_attribute_type == FilterAttributeType::FILTER_ATTRIBUTE_TYPE_LISTED)
				)
			)
	{
		EntityButtonAttributeTab*
			tab_button = new EntityButtonAttributeTab();

		tab_button->is_undefined = (_game_item_attribute == nullptr);
		tab_button->undefined_value = _undefined_attribute_text;

		tab_button->make_as_default_button_with_icon_and_text
		(
			new ERegionGabarite(160.0f, 28.0f),
			whole_filter_block_data->pointer_to_attribute_tab,
			&EDataActionCollection::action_select_this_attribute_tag,
			(_game_item_attribute != nullptr) ? (_game_item_attribute->icon) : (NS_EGraphicCore::load_from_textures_folder("undefined_item")),
			(_game_item_attribute != nullptr) ? (_game_item_attribute->localisation.localisations[ELocalisationText::active_localisation]) : ("{?}" + _undefined_attribute_text)
		);

		//tab_button->target_listed_block = listed_condition_group_container;
		tab_button->target_whole_listed_block = listed_condition_group_container;
		tab_button->parent_filter_block = _target_filter_block;
		//tab_button->target_listed_block = listed_condition_group_container;

		if (_game_item_attribute != nullptr)
		{
			tab_button->main_text_area->localisation_text = _game_item_attribute->localisation;
		}
		else
		{
			tab_button->main_text_area->localisation_text = ELocalisationText::get_localisation_by_key("undefined_attribute");
		}

		whole_filter_block_data->pointer_to_attribute_tab->add_button_to_working_group(tab_button);

		if ((_game_item_attribute != nullptr) && (tab_button->target_whole_listed_block != nullptr))
		{
			int moved_button_id = -1;

			for (int i = 0; i < whole_filter_block_data->pointer_to_attribute_tab->workspace_button_list.size() - 1; i++)
			{
				EntityButtonAttributeTab*
					existed_button = static_cast<EntityButtonAttributeTab*>(whole_filter_block_data->pointer_to_attribute_tab->workspace_button_list[i]);

				GameItemAttribute*
					existed_attribute = existed_button->target_whole_listed_block->associated_item_attribute;

				if (existed_attribute != nullptr)
				{
					if (existed_attribute->attribute_tab_priority < tab_button->target_whole_listed_block->associated_item_attribute->attribute_tab_priority)
					{
						moved_button_id = i;
					}
				}
				else
				{
					moved_button_id = i;
				}
			}

			if (moved_button_id >= 0)
			{
				//auto it = whole_filter_block_data->pointer_to_attribute_tab->workspace_button_list.begin() + moved_button_id;

				//std::rotate(it, it + 1, whole_filter_block_data->pointer_to_attribute_tab->workspace_button_list.begin());

				//
				EntityButton*
					moved_button = whole_filter_block_data->pointer_to_attribute_tab->workspace_button_list.back();

				whole_filter_block_data->pointer_to_attribute_tab->workspace_button_list.emplace
				(
					whole_filter_block_data->pointer_to_attribute_tab->workspace_button_list.begin() + moved_button_id,
					moved_button
				);

				whole_filter_block_data->pointer_to_attribute_tab->workspace_button_list.erase
				(
					whole_filter_block_data->pointer_to_attribute_tab->workspace_button_list.begin() + whole_filter_block_data->pointer_to_attribute_tab->workspace_button_list.size() - 1
				);
			}
		}


	}
	//EWindowMain::loot_simulator_button_group->refresh_loot_simulator();
}


std::string generate_filter_block_text(EButtonGroup* _button_group, int _save_mode = -1)
{

	auto whole_block_data = static_cast<EButtonGroupFilterBlock*>(_button_group);

	int		selected_version = -1;
	float	temp_size = whole_block_data->text_size;



	int		version_id = (int)(_save_mode);

	EntityButtonVariantRouterForFilterBlock* version_router = nullptr;

	//matched router button

	bool show_loot_flag = (whole_block_data->button_show_hide->selected_variant == 1);
	bool continue_flag = (whole_block_data->button_continue->selected_variant == 0);

	bool disable_minimap = false;
	bool disable_sounds = false;

	float visibility_focus = 1.0f;

	//not original version can modify colors, fonts, sounds and etc...
	if (_save_mode != -1)
	{

		version_router = whole_block_data->version_routers[version_id];

		//version of loot colors
		selected_version = version_router->selected_variant;

		LootFilterVersionPattern::PatternStruct*
			version_pattern = LootFilterVersionPattern::registered_loot_filter_version_patterns[selected_version];


		/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		show_loot_flag
			=
			(version_pattern->show_hide_mode == (int)LootFilterVersionPattern::LootPatternParameterMode::FORCIBLY_ENABLE)
			||
			(
				(show_loot_flag)
				&&
				(version_pattern->show_hide_mode != (int)LootFilterVersionPattern::LootPatternParameterMode::FORCIBLY_DISABLE)
				);
		/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////



		/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		continue_flag
			=
			(version_pattern->continue_mode == (int)LootFilterVersionPattern::LootPatternParameterMode::FORCIBLY_ENABLE)
			||
			(
				(continue_flag)
				&&
				(version_pattern->continue_mode != (int)LootFilterVersionPattern::LootPatternParameterMode::FORCIBLY_DISABLE)
				);
		/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


		visibility_focus = version_pattern->focus_multiplier;

		disable_minimap = version_pattern->disable_minimap_elements;
		disable_sounds = version_pattern->disable_sound;
	}



	//if version is not FULL_IGNORE, or if VERSION_ORIGINAL
	if ((selected_version != LootFilterVersionDescription::LOOT_VERSION_FULL_IGNORE) || (_save_mode == -1))
	{
		std::string result_string = "";

		//if (_save_mode != -1)
		//{
		//	result_string += "#AUTOGENERATED";
		//	result_string += '\n';
		//}

		if (show_loot_flag)
		{
			result_string += "Show";
		}
		else
		{
			result_string += "Hide";
		}
		result_string += '\n';


		if (_save_mode == -1)
		{
			result_string += "\t#config_VersionControl";

			for (int i = 0; i < NSW_LOOT_FILTER_MAX_VERSIONS; i++)
			{
				result_string += " " + whole_block_data->version_routers[i]->router_variant_list[whole_block_data->version_routers[i]->selected_variant]->localisation_for_select_window.base_name;
			}

			result_string += '\n';
		}







		//auto bg_color_data = static_cast<EDataContainer_Button_StoreColor*>(Entity::get_last_custom_data(whole_block_data->pointer_to_color_button[0])->data_container);
		//auto bg_color = bg_color_data->stored_color;
		HSVRGBAColor temp_colors[3];

		for (int i = 0; i < 3; i++)
		{
			temp_colors[i].set_color(whole_block_data->pointer_to_color_button[i]->stored_color);
		}
		//EInputCore::logger_param("version id", version_id);

		//	Full ignore	0
		//	Hide		1
		//	Ignore		2
		//	Default		3
		//	Focus		4

		//font size


		for (int i = 0; i < 3; i++)
		{
			temp_colors[i].s *= visibility_focus;
			temp_colors[i].v *= visibility_focus;

			Helper::hsv2rgb(&temp_colors[i]);
		}

		temp_size *= visibility_focus;





		EButtonGroup* non_listed_section = whole_block_data->pointer_to_workspace_non_listed_segment;
		EButtonGroup* listed_section = whole_block_data->pointer_to_listed_attributes;
		EButtonGroup* cosmetic_section = whole_block_data->pointer_to_cosmetic_segment;

		//NON-LISTED
		for (EButtonGroup* n_listed : non_listed_section->group_list)
		{
			EButtonGroupNonListedLine* container = static_cast<EButtonGroupNonListedLine*>(n_listed);

			result_string
				+=
				'\t'
				+
				container->
				target_button_with_attribute_name->
				custom_data_list.back()->
				clickable_area_list.back()->
				text_area->
				localisation_text.base_name;

			if ((container->target_button_with_condition != nullptr))
			{
				result_string += " ";
				result_string += container->target_button_with_condition->return_base_text_from_selected_router();
			}

			//bool attribute
			if (container->target_game_attribute->filter_attribute_value_type == FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_BOOL_SWITCHER)
			{
				result_string += " ";
				if (*static_cast <EDataContainer_Button_BoolSwitcher*>(container->target_button_with_value->custom_data_list.back()->data_container)->target_value)
				{
					result_string += "True";
				}
				else
				{
					result_string += "False";
				}
			}

			//bool attribute
			if
				(
					(container->target_game_attribute->filter_attribute_value_type == FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_NUMBER)
					||
					(container->target_game_attribute->filter_attribute_value_type == FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_COLOURS_TEXT)
					)
			{
				result_string += " ";
				result_string += container->target_button_with_value->main_text_area->original_text;
			}

			if (container->target_game_attribute->filter_attribute_value_type == FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_RARITY_LIST)
			{
				result_string += " ";
				result_string += container->rarity_router_button->router_variant_list[container->rarity_router_button->selected_variant]->router_localisation.base_name;
			}


			if (container->target_game_attribute->filter_attribute_value_type == FilterAttributeValueType::FILTER_ATTRIBUTE_VALUE_TYPE_QUALITY_LIST)
			{
				result_string += " ";
				result_string += container->target_button_with_value->main_text_area->localisation_text.base_name;
			}

			result_string += '\n';
		}

		//LISTED
		for (EButtonGroup* button_group : listed_section->group_list)
		{
			auto listed_block = static_cast<EButtonGroupListedBlock*>(button_group);

			//if attribute have no values, no sence generate this filter condition
			if ((listed_block != nullptr) && (listed_block->section_for_wide_item_buttons->all_button_list.size() > 1))
			{
				if (listed_block->filter_attribute_name != "")
				{
					result_string += '\t' + listed_block->filter_attribute_name;
				}
				else
				{
					result_string += '\t' + listed_block->pointer_to_undefined_attribute_field->main_text_area->original_text;
				}

				if ((listed_block->matching_mode_router_button != nullptr) && (listed_block->matching_mode_router_button->selected_variant == 1))
				{
					result_string += " ==";
				}

				if ((listed_block->input_field != nullptr))
				{
					if (listed_block->input_field->main_text_area->original_text != "")
					{
						result_string += " " + listed_block->input_field->main_text_area->original_text;
					}
					else
					{
						result_string += " >=1 ";
					}
				}


				int id = 0;

				for (EntityButton* listed_button : listed_block->section_for_wide_item_buttons->workspace_button_list)
				{

					if (listed_button->main_text_area != nullptr)
					{
						if (listed_block->associated_item_attribute != nullptr)
						{
							result_string += " ";
							result_string += '"' + listed_button->main_text_area->localisation_text.base_name + '"';
						}
						else
						{
							result_string += " ";
							result_string += '"' + listed_button->main_text_area->original_text + '"';
						}
					}
					else
					{
						EInputCore::logger_simple_error("TextArea is NULL! [" + std::to_string(id) + "]");
					}

					id++;
				}

				result_string += '\n';
			}
			else
			{
				EInputCore::logger_simple_error("listed button group have no data container!");
			}

		}

		//COSMETIC

			//auto container = static_cast<EDataContainer*>(listed->data_container);
			//for (EntityButton* cbut : cosmetic_section->button_list)
			//if (cbut != cosmetic_section->slider)
			//{
			//	//if
			//	//(
			//	//	cbut->custom_data_list[0]->data_container == 
			//	//)
			//}

		auto cosmetic_data = whole_block_data;
		ETextArea* tarea = nullptr;

		for (int i = 0; i < 3; i++)
		{
			result_string += '\t';
			if (!cosmetic_data->color_check[i])
			{
				result_string += "#";
			}
			tarea = cosmetic_data->pointer_to_color_button[i]->main_text_area;

			if (tarea != nullptr)
			{
				result_string += tarea->localisation_text.base_name;
			}
			//auto store_color_data = static_cast<EDataContainer_Button_StoreColor*>(Entity::get_last_custom_data(cosmetic_data->pointer_to_color_button[i])->data_container);

			result_string += " " + std::to_string((int)round(temp_colors[i].r * 255.0f));
			result_string += " " + std::to_string((int)round(temp_colors[i].g * 255.0f));
			result_string += " " + std::to_string((int)round(temp_colors[i].b * 255.0f));
			result_string += " " + std::to_string((int)round(temp_colors[i].a * 255.0f));

			result_string += '\n';
		}


		//font size
		result_string += '\t';
		if (!cosmetic_data->text_size_bool)
		{
			result_string += "#";
		}
		tarea = cosmetic_data->text_size_button->main_text_area;

		//result_string += tarea->localisation_text.base_name;
		result_string += "SetFontSize";

		temp_size = std::clamp((int)(round(temp_size)), 18, 45);

		result_string += " " + std::to_string((int)(round(temp_size)));
		result_string += '\n';




		//		MINIMAP ICONS
		//////////////////////////////////////////////////////////////////

		//		MINIMAP ICON
		if (!disable_minimap)
		{
			result_string += '\t';
			if
				(
					(!whole_block_data->minimap_icon_color_suppressor_bool)
					&&
					(whole_block_data->pointer_to_forcibly_disable_minimap_icon_variant_button->selected_variant == 0)
					)
			{
				result_string += "#";
			}

			result_string += "MinimapIcon";
			EntityButtonVariantRouter* button_router_size = whole_block_data->pointer_to_minimap_icon_size_router;
			EntityButtonVariantRouter* button_router_color = whole_block_data->pointer_to_minimap_icon_color_router;
			EntityButtonVariantRouter* button_router_shape = whole_block_data->pointer_to_minimap_icon_shape_router;

			if (whole_block_data->pointer_to_forcibly_disable_minimap_icon_variant_button->selected_variant == 0)
			{
				//		add size name to line
				result_string += ' ' + button_router_size->router_variant_list[button_router_size->selected_variant]->router_localisation.base_name;

				//		add color name to line
				result_string += ' ' + button_router_color->router_variant_list[button_router_color->selected_variant]->router_localisation.base_name;

				//		add shape name to line
				result_string += ' ' + button_router_shape->router_variant_list[button_router_shape->selected_variant]->router_localisation.base_name;
			}
			else
			{
				result_string += " -1";
			}

			result_string += '\n';



			//RAY
			result_string += '\t';
			if (!whole_block_data->ray_suppressor)
			{
				result_string += "#";
			}
			result_string += "PlayEffect";

			result_string += ' ';
			result_string += whole_block_data->pointer_to_ray_color_router->router_variant_list[whole_block_data->pointer_to_ray_color_router->selected_variant]->router_localisation.base_name;

			if (whole_block_data->pointer_to_temporary_option_router->selected_variant == 1)
			{
				result_string += ' ';
				result_string += whole_block_data->pointer_to_temporary_option_router->router_variant_list[1]->router_localisation.base_name;
			}

			result_string += '\n';
		}
		//////////////////////////////////////////////////////////////////



		if (!disable_sounds)
		{
			//		USER SOUND
			if
				(
					(!whole_block_data->pointer_to_custom_sound_button->named_sound_vector.empty())
					||
					(whole_block_data->pointer_to_forcibly_disable_user_sound_variant_button->selected_variant == 1)//forcibly disabled sound
					)
			{
				result_string += '\t';
				if
					(
						(!whole_block_data->custom_sound_suppressor_bool)
						&&
						(whole_block_data->pointer_to_forcibly_disable_user_sound_variant_button->selected_variant == 0)
						)
				{
					result_string += "#";
				}

				result_string += "CustomAlertSound";

				//disabled user sound cannot be optional
				if
					(
						(whole_block_data->pointer_to_optional_user_sound->selected_variant == 0)
						&&
						(whole_block_data->pointer_to_forcibly_disable_user_sound_variant_button->selected_variant == 0)
						)
				{
					result_string += "Optional";
				}

				if (whole_block_data->pointer_to_forcibly_disable_user_sound_variant_button->selected_variant == 0)
				{
					int
						id = 0;

					//open bracket
					result_string += " \"";

					//insert every name of NamedSound
					for (ENamedSound* named_sound : whole_block_data->pointer_to_custom_sound_button->named_sound_vector)
					{
						if (id > 0) { result_string += ";"; }

						result_string += named_sound->localisation_text.base_name;

						id++;
					}

					//close bracket
					result_string += '"';

					result_string += ' ' + std::to_string(int(round(whole_block_data->user_sound_volume_value * 100.0f)));
				}
				else
				{
					result_string += " none";
				}

				result_string += '\n';
			}






			//		INGAME SOUNDS
			if
				(
					(!whole_block_data->pointer_to_game_sound_button->named_sound_vector.empty())
					||
					(whole_block_data->pointer_to_forcibly_disable_ingame_sound_variant_button->selected_variant == 1)//forcibly disabled sound
					)
			{
				result_string += '\t';
				if
					(
						(!whole_block_data->game_sound_suppressor_bool)
						&&
						(whole_block_data->pointer_to_forcibly_disable_ingame_sound_variant_button->selected_variant == 0)
						)
				{
					result_string += "#";
				}

				result_string += "PlayAlertSound";

				//non forcibly disabled sound
				if (whole_block_data->pointer_to_forcibly_disable_ingame_sound_variant_button->selected_variant == 0)
				{
					if (whole_block_data->pointer_to_game_sound_button->named_sound_vector[0] != nullptr)
					{
						if (whole_block_data->pointer_to_positional_variant_button->selected_variant == 1) { result_string += "Positional"; }


						result_string += ' ' + whole_block_data->pointer_to_game_sound_button->named_sound_vector[0]->localisation_text.base_name;
						result_string += ' ' + std::to_string(int(round(whole_block_data->ingame_sound_volume_value * 100.0f)));

					}
				}
				else
				{
					result_string += " none";
				}

				result_string += '\n';
			}

			//ENABLE/DISABLE DROP SOUND
			EntityButtonVariantRouterForFilterBlock* drop_sound_router_button = whole_block_data->pointer_to_disable_enable_drop_sound;

			if (drop_sound_router_button->selected_variant > 0)
			{
				result_string += '\t';
				result_string += drop_sound_router_button->router_variant_list[drop_sound_router_button->selected_variant]->router_localisation.base_name;
				result_string += '\n';
			}
		}


		if (continue_flag)
		{
			result_string += "\tContinue";
			result_string += '\n';
		}

		return result_string;
	}
	else
	{
		return "";
	}
}

std::string generate_color_palette_text()
{
	std::string buffer = "";

	for (HRA_color_collection* color_collection : Helper::registered_color_list)
	{
		buffer += "#COLOR_PALETTE";


		buffer += " " + std::to_string((int)round(color_collection->target_color.r * 255.0f));
		buffer += " " + std::to_string((int)round(color_collection->target_color.g * 255.0f));
		buffer += " " + std::to_string((int)round(color_collection->target_color.b * 255.0f));
		buffer += " " + std::to_string((int)round(color_collection->target_color.a * 255.0f));

		for (int i = 0; i < NSW_languages_count; i++)
		{
			buffer += " ";
			buffer += '"' + color_collection->localised_name.localisations[i] + '\"';
		}

		buffer += "\r";

	}

	buffer += "\r";

	return buffer;
}

std::string generate_filter_block_separator_text(EButtonGroupFilterBlockSeparator* _separator, FilterBlockSaveMode _save_mode)
{
	std::string text_buffer = "";

	text_buffer += "#BlockSeparator";

	if (_separator->pointer_to_description_button->main_text_area->original_text == "")
	{
		text_buffer += " \"*EMPTY*\"";
	}
	else
	{
		text_buffer += " \"" + _separator->pointer_to_description_button->main_text_area->original_text + "\"";
	}

	if (_separator->is_expanded)
	{
		text_buffer += " expanded";
	}
	else
	{
		text_buffer += " shrinked";
	}


	if (_separator->additional_force_field)
	{
		text_buffer += " additional_space";
	}
	else
	{
		text_buffer += " no_space";
	}

	return text_buffer;
}

EButtonGroupListedBlock* create_block_for_listed_segment(EFilterRule* _filter_rule, GameItemAttribute* _attribute, std::string _attribute_name, EButtonGroup* _parent, EButtonGroupFilterBlock* _parent_filter_block)
{
	float line_height = 100.0f;

	if (_filter_rule != nullptr)
	{
		line_height += 30;
	}

	EButtonGroupListedBlock*
		whole_listed_line = new EButtonGroupListedBlock(new ERegionGabarite(800.0f, line_height));
	whole_listed_line->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DEFAULT, bgroup_with_slider);
	//whole_listed_line->parent_filter_block = static_cast<EButtonGroupFilterBlock*>(_parent);
	//whole_listed_line->max_size_y = whole_listed_line->parent_filter_block->add_content_to_filter_block_group->base_height;
	//whole_listed_line->can_be_resized_to_highest_point_y = true;
	//whole_listed_line->can_be_stretched_by_child = true;
	//whole_listed_line->can_be_resized_to_highest_point_y = true;
	whole_listed_line->
		set_parameters
		(
			ChildAlignMode::ALIGN_VERTICAL,
			NSW_dynamic_autosize,
			NSW_dynamic_autosize
		);
	whole_listed_line->parent_filter_block = _parent_filter_block;

	whole_listed_line->additional_y_distance = 0.0f;

	if (_filter_rule != nullptr)
	{
		whole_listed_line->min_size_y = _filter_rule->min_y_size + 80.0f;
	}
	else
	{
		whole_listed_line->min_size_y = 180.0f;
	}

	//data container, store pointer to group with listed buttons
	//auto d_container = new EDataContainer_Group_FilterBlockListedSegment();


	whole_listed_line->filter_attribute_name = _attribute_name;
	whole_listed_line->associated_item_attribute = _attribute;

	//whole_listed_line->data_container = d_container;

	_parent->add_group(whole_listed_line);

	////////////////////////
	//small subrow for additional buttons



	/////////////////////////////////////////////////////////////
	//side group for buttons
	EButtonGroup*
		group_bottom_for_control = EButtonGroup::create_button_group_without_bg(new ERegionGabarite(134.0f, 30.0f), EGUIStyle::active_style)
		->
		set_parameters
		(
			ChildAlignMode::ALIGN_HORIZONTAL,
			NSW_dynamic_autosize,
			NSW_static_autosize
		);
	whole_listed_line->add_group(group_bottom_for_control);
	//group_bottom_for_control->have_rama = true;
	/////////////////////////////////////////////////////////////


			/////////////////////////////////////////////////////////////
			//side group for add
	EButtonGroup*
		group_bottom_side_for_add = EButtonGroup::create_button_group_without_bg(new ERegionGabarite(134.0f, 30.0f), EGUIStyle::active_style)
		->
		set_parameters
		(
			ChildAlignMode::ALIGN_HORIZONTAL,
			NSW_dynamic_autosize,
			NSW_dynamic_autosize
		);
	group_bottom_side_for_add->have_slider = false;

	group_bottom_for_control->add_group(group_bottom_side_for_add);
	//group_left_side_for_add->have_rama = true;
	/////////////////////////////////////////////////////////////

	/////////////////////////////////////////////////////////////
	//side group for remove
	EButtonGroup*
		group_right_side_for_remove = EButtonGroup::create_button_group_without_bg(new ERegionGabarite(360.0f, 30.0f), EGUIStyle::active_style)
		->
		set_parameters
		(
			ChildAlignMode::ALIGN_HORIZONTAL,
			NSW_static_autosize,
			NSW_dynamic_autosize
		);

	group_bottom_for_control->add_group(group_right_side_for_remove);
	//group_right_side_for_remove->have_rama = true;
	/////////////////////////////////////////////////////////////



//float vertical_borders = group_bottom_for_control->group_offset_for_content_left + group_bottom_for_control->group_offset_for_content_right;



////////////////////////
//ADD NEW ITEM BUTTON

//data conatainer with filter rule (for data entity list)
	EDataContainer_Group_StoreFilterRuleForDataEntitySearcher*
		data_store_filter_rule = nullptr;

	EntityButtonForUndefinedAttribute*
		add_new_undefined_attribute_button = nullptr;

	if (_attribute != nullptr)
	{
		EntityButtonForFilterBlock*
			small_button = new EntityButtonForFilterBlock();

		ELocalisationText l_text;

		l_text = ELocalisationText::get_localisation_by_key("button_add_new_item");

		for (int i = 0; i < NSW_languages_count; i++)
		{
			l_text.localisations[i] += " " + _attribute->localisation.localisations[i];
		}

		small_button->make_default_button_with_unedible_text
		(
			new ERegionGabarite(200.0f, 24.0f),
			group_bottom_side_for_add,
			&EDataActionCollection::action_open_data_entity_filter_group,
			l_text
		);

		//data conatainer with filter rule (for data entity list)
		data_store_filter_rule = new EDataContainer_Group_StoreFilterRuleForDataEntitySearcher();
		data_store_filter_rule->filter_rule = _filter_rule;
		data_store_filter_rule->target_action_on_click = &EDataActionCollection::action_add_wide_item_to_group_receiver;

		EntityButton::get_last_custom_data(small_button)->data_container = data_store_filter_rule;

		whole_listed_line->data_container_with_filter_rule = data_store_filter_rule;

		group_bottom_side_for_add->add_button_to_working_group(small_button);
		////////////////////////


		if (_attribute->have_exact_match)
		{
			EntityButtonVariantRouterForFilterBlock*
				button_variant_FB_router = new EntityButtonVariantRouterForFilterBlock();
			group_bottom_side_for_add->add_button_to_working_group(button_variant_FB_router);
			button_variant_FB_router->make_as_default_router_variant_button(new ERegionGabarite(170.0f, 24.0f));
			button_variant_FB_router->parent_filter_block = _parent_filter_block;

			whole_listed_line->matching_mode_router_button = button_variant_FB_router;

			//	0
			/*************************************************************************************/
			RouterVariant* router_variant = new RouterVariant();
			ELocalisationText local_text;

			local_text.base_name = "Partially match";
			local_text.localisations[NSW_localisation_EN] = "Partially match";
			local_text.localisations[NSW_localisation_RU] = "Частичное совпадение";
			router_variant->router_localisation = local_text;

			router_variant->text_color = new HSVRGBAColor();
			router_variant->text_color->set_color_RGBA(1.0f, 0.8f, 0.6f, 1.0f);

			//router_variant->texture = NS_DefaultGabarites::texture_show_hide_visual_editor;

			button_variant_FB_router->router_variant_list.push_back(router_variant);
			/*************************************************************************************/

			//	1
			/*************************************************************************************/
			router_variant = new RouterVariant();


			local_text.base_name = "Exact match";
			local_text.localisations[NSW_localisation_EN] = "Exact match";
			local_text.localisations[NSW_localisation_RU] = "Полное совпадение";
			router_variant->router_localisation = local_text;

			router_variant->text_color = new HSVRGBAColor();
			router_variant->text_color->set_color_RGBA(1.0f, 0.5f, 1.0f, 1.0f);

			//router_variant->texture = NS_DefaultGabarites::texture_show_hide_visual_editor_deactivate;

			button_variant_FB_router->router_variant_list.push_back(router_variant);
			/*************************************************************************************/

			button_variant_FB_router->select_variant(0);



			//##//##//##//##//##	DESCRIPTION		//##//##//##//##//##//##//##//##
			DescriptionContainerHelpDescriptionImage*
				description_image = new DescriptionContainerHelpDescriptionImage();
			button_variant_FB_router->description_container = description_image;

			for (int i = 0; i < NSW_languages_count; i++)
			{
				description_image->stored_image[i] = NS_DefaultGabarites::texture_help_description_exact_match[i];
			}

			description_image->parent_button = button_variant_FB_router;
			//##//##//##//##//##//##//##//##//##//##//##//##//##//##//##//##//##//##//##//##//##
		}

		if (_attribute->have_input_field_for_listed)
		{
			EntityButtonForFilterBlock*
				input_field = new EntityButtonForFilterBlock();
			input_field->make_default_button_with_edible_text
			(
				new ERegionGabarite(80.0f, 24.0f),
				group_bottom_side_for_add,
				nullptr,
				""
			);
			whole_listed_line->input_field = input_field;

			ELocalisationText ltext;
			ltext.localisations[NSW_localisation_EN] = "condition";
			ltext.localisations[NSW_localisation_RU] = "условие";

			input_field->main_text_area->gray_text = ltext;

			group_bottom_side_for_add->add_button_to_working_group(input_field);
		}
	}
	else
	{
		EntityButtonForFilterBlock*
			undefined_attribute_button_info = new EntityButtonForFilterBlock();

		undefined_attribute_button_info->make_as_default_button_with_icon
		(
			new ERegionGabarite(24.0f, 24.0f),
			group_bottom_side_for_add,
			nullptr,
			NS_EGraphicCore::load_from_textures_folder("buttons/button_info")
		);
		undefined_attribute_button_info->add_default_description_by_key("description_undefined_attribute_info");

		group_bottom_side_for_add->add_button_to_working_group(undefined_attribute_button_info);




		EntityButtonForFilterBlock*
			undefined_attribute_button = new EntityButtonForFilterBlock();
		undefined_attribute_button->make_default_button_with_edible_text
		(
			new ERegionGabarite(230.0f, 24.0f),
			group_bottom_side_for_add,
			nullptr,
			_attribute_name
		);

		//undefined_attribute_button->main_text_area->localisation_text = ELocalisationText::generate_localisation("_attribute_name");
		undefined_attribute_button->main_text_area->gray_text = ELocalisationText::get_localisation_by_key("gray_text_undefined_attribute");
		group_bottom_side_for_add->add_button_to_working_group(undefined_attribute_button);
		whole_listed_line->pointer_to_undefined_attribute_field = undefined_attribute_button;

		add_new_undefined_attribute_button = new EntityButtonForUndefinedAttribute();
		add_new_undefined_attribute_button->make_default_button_with_unedible_text
		(
			new ERegionGabarite(200.0f, 24.0f),
			group_bottom_side_for_add,
			&EDataActionCollection::action_add_new_undefined_attribute,
			ELocalisationText::get_localisation_by_key("button_add_new_undefined_attribute_button")
		);


		//add_new_undefined_attribute_button->main_text_area->localisation_text = ELocalisationText::get_localisation_by_key("button_add_new_undefined_attribute_button");

		group_bottom_side_for_add->add_button_to_working_group(add_new_undefined_attribute_button);
	}












	////////////////////////////////////////////////




	////////////////////////



	////////////////////////
	//MAIN SECTION
	EButtonGroup*
		listed_group_main_section = EButtonGroup::create_button_group_without_bg(new ERegionGabarite(600.0f, 60.0f), EGUIStyle::active_style)
		->
		set_parameters
		(
			ChildAlignMode::ALIGN_HORIZONTAL,
			NSW_dynamic_autosize,
			NSW_dynamic_autosize
		);

	//listed_group_main_section->can_be_resized_to_highest_point_y = true;
	listed_group_main_section->max_size_y = 590.0f;
	//listed_group_main_section->child_align_direction = ChildElementsAlignDirection::TOP_TO_BOTTOM;

	//listed_group_main_section->have_rama = true;

	if (_attribute != nullptr)
	{
		listed_group_main_section->button_size_x_override = _attribute->button_x_size_override;


	}
	else
	{
		listed_group_main_section->button_size_x_override = 200.0f;
		add_new_undefined_attribute_button->target_part_with_buttons = listed_group_main_section;
		add_new_undefined_attribute_button->parent_filter_block = _parent_filter_block;

	}

	listed_group_main_section->group_have_button_lines = true;

	whole_listed_line->add_group(listed_group_main_section);

	if (data_store_filter_rule != nullptr)
	{
		data_store_filter_rule->target_group_receiver = listed_group_main_section;
	}


	whole_listed_line->section_for_wide_item_buttons = listed_group_main_section;
	////////////////////////

	////////////////////////
	//REMOVE ALL BUTTONS
	EntityButtonForListedSegment* delete_all_item_button = new EntityButtonForListedSegment();
	delete_all_item_button->make_default_button_with_unedible_text
	(
		new ERegionGabarite(180.0f, 24.0f),
		group_right_side_for_remove,
		&EDataActionCollection::action_open_delete_listed_buttons_confirmation,
		ELocalisationText::get_localisation_by_key("button_remove_all_listed_buttons")
	);
	delete_all_item_button->main_text_area->set_color(NS_EColorUtils::COLOR_RED);

	delete_all_item_button->add_default_description_by_key("description_delete_all_listed_button");
	//delete_segment_button->force_field_left = 64.0f;


	delete_all_item_button->group_with_items = listed_group_main_section;

	delete_all_item_button->target_block_for_highlight = listed_group_main_section;
	delete_all_item_button->main_custom_data->actions_on_update.push_back(&EDataActionCollection::action_draw_deleted_group);

	group_right_side_for_remove->add_button_to_working_group(delete_all_item_button);
	////////////////////////

	////////////////////////
	//REMOVE BLOCK
	EntityButtonForListedSegment*
		delete_segment_button = new EntityButtonForListedSegment();

	delete_segment_button->make_default_button_with_unedible_text
	(
		new ERegionGabarite(180.0f, 24.0f),
		group_right_side_for_remove,
		&EDataActionCollection::action_open_delete_listed_segment_confirmation,
		ELocalisationText::get_localisation_by_key("button_remove_block")
	);
	delete_segment_button->main_text_area->set_color(NS_EColorUtils::COLOR_RED);

	//delete_segment_button->force_field_left = 64.0f;

	delete_segment_button->listed_group = whole_listed_line;

	delete_segment_button->target_block_for_highlight = whole_listed_line;
	delete_segment_button->main_custom_data->actions_on_update.push_back(&EDataActionCollection::action_draw_deleted_group);

	delete_segment_button->add_default_description_by_key("description_delete_listed_block");

	group_right_side_for_remove->add_button_to_working_group(delete_segment_button);
	////////////////////////






	return whole_listed_line;
}

EntityButtonForFilterBlock::EntityButtonForFilterBlock()
{
	if (debug_deleting) EInputCore::logger_simple_info("<EntityButtonFilterBlock> created");
}

EntityButtonForFilterBlock::~EntityButtonForFilterBlock()
{
	if (debug_deleting) EInputCore::logger_simple_info("Called <EntityButtonFilterBlock> destructor");
}

EntityButtonForLootFilterSelector::EntityButtonForLootFilterSelector()
{
}

EntityButtonForLootFilterSelector::~EntityButtonForLootFilterSelector()
{
	if (debug_deleting) {
		EInputCore::logger_simple_info("deleting EntityButtonForLootFilterSelector");
	}
}



//EButtonGroupFilterBlock::~EButtonGroupFilterBlock()
//{
//}

EButtonGroupFilterBlock::~EButtonGroupFilterBlock()
{

	//if (EWindowMain::registered_group_filter_error_list->is_this_group_active())
	//{
	//	EWindowMain::registered_group_filter_error_list->check_errors();
	//}
	//~EButtonGroup;
	//EWindowMain::loot_simulator_button_group->refresh_loot_simulator();
	//EWindowMain::loot_simulator_button_group->delayed_execution = true;
}

void EButtonGroupFilterBlock::clear_non_listed_segment()
{
	for (EButtonGroup* non_listed_line : pointer_to_workspace_non_listed_segment->group_list)
	{
		non_listed_line->block_need_remove = true;
	}

	pointer_to_workspace_non_listed_segment->clickable_area_list[0]->clickable_region_is_active = true;
}

void EButtonGroupFilterBlock::clear_listed_segment()
{
	for (EButtonGroup* listed_line : pointer_to_listed_attributes->group_list)
	{
		listed_line->block_need_remove = true;
	}

	for (EntityButton* attribute_tab_button : pointer_to_attribute_tab->workspace_button_list)
	{
		attribute_tab_button->entity_need_remove = true;
	}
}

GameItemAttribute* EButtonGroupFilterBlock::get_suitable_game_item_attribute(std::string _name)
{
	for (int i = 0; i < registered_game_item_attributes.size(); i++)
	{
		GameItemAttribute*
			attribute = registered_game_item_attributes[i];

		if (EStringUtils::compare_ignoring_case(_name, attribute->localisation.base_name))
		{
			return attribute;
		}
	}

	return nullptr;
}

void EButtonGroupFilterBlock::post_draw()
{
	if
		(
			(is_this_group_active())
			&&
			(is_in_visible_diapason())
			)
	{
		EButtonGroup::post_draw();


		if ((button_show_hide != nullptr) && (button_show_hide->selected_variant == 0))
		{
			if (!EButtonGroup::catched_by_mouse(this))
			{
				NS_EGraphicCore::set_active_color(0.3f, 0.25f, 0.2f, 0.6f);
			}
			else
			{
				NS_EGraphicCore::set_active_color(0.3f, 0.3f, 0.3f, 0.3f);
			}
			ERenderBatcher::if_have_space_for_data(NS_EGraphicCore::default_batcher_for_drawing, 1);
			NS_ERenderCollection::add_data_to_vertex_buffer_textured_rectangle_with_custom_size
			(
				NS_EGraphicCore::default_batcher_for_drawing->vertex_buffer,
				NS_EGraphicCore::default_batcher_for_drawing->last_vertice_buffer_index,

				//x pos
				region_gabarite->world_position_x,

				//y pos
				region_gabarite->world_position_y,

				region_gabarite->size_x,
				region_gabarite->size_y,

				NS_DefaultGabarites::texture_gabarite_white_pixel
			);
		}
	}

}

void EButtonGroupFilterBlock::button_group_update(float _d)
{
	EButtonGroup::button_group_update(_d);

	//if (EButtonGroup::catched_by_mouse(this))
	//{
	//	if (!pointer_to_top_control_block->is_active)
	//	{
	//		pointer_to_top_control_block->is_active = true;
	//		pointer_to_top_control_block->group_phantom_redraw = true;

	//		//change_group(pointer_to_top_control_block);
	//	}
	//}
	//else
	//{
	//	if (pointer_to_top_control_block->is_active)
	//	{
	//		pointer_to_top_control_block->is_active = false;
	//		pointer_to_top_control_block->group_phantom_redraw = true;
	//		//change_group(pointer_to_top_control_block);
	//	}
	//};
}

void EButtonGroupFilterBlock::button_group_prechange()
{
}

bool EButtonGroupFilterBlock::is_this_group_active()
{
	//if (EButtonGroup::is_visible() && is_expanded && false)
	//{
	//	EInputCore::logger_simple_info("You are ebanutyi? YES");
	//}
	//else
	//{
	//	EInputCore::logger_simple_info("You are ebanutyi? NO");
	//}

	return EButtonGroup::is_this_group_active() && (is_expanded || group_search_status == GroupSearchStatus::SEARCH_STATUS_MATCHED);
}

void EButtonGroupFilterBlock::button_group_postchange()
{
	/*float total_size = pointer_to_top_control_block->region_gabarite->size_y + group_offset_for_content_bottom + group_offset_for_content_up + 1.0f;

	for (EButtonGroup* child : pointer_to_listed_segment_in_filter_block->group_list)
	{
		EButtonGroupListedBlock*
		listed_block = static_cast<EButtonGroupListedBlock*>(child);

		total_size += listed_block->region_gabarite->size_y;
	}

	total_size = max(total_size, 210.0f);

	if (region_gabarite->size_y != total_size)
	{
		region_gabarite->size_y = total_size;
		base_height = region_gabarite->size_y;

		root_group->need_change = true;
	}

	EButtonGroup::button_group_postchange();*/
}

void EButtonGroupFilterBlock::refresh_version_router_button()
{
	for (int i = 0; i < NSW_LOOT_FILTER_MAX_VERSIONS; i++)
	{
		EntityButtonVariantRouterForFilterBlock*
			router_button = version_routers[i];

		if (router_button != nullptr)
		{


			for (RouterVariant* rv : router_button->router_variant_list)
				if (rv != nullptr)
				{
					delete rv;
				}

			router_button->router_variant_list.clear();

			for (int k = 0; k < LootFilterVersionPattern::registered_loot_filter_version_patterns.size(); k++)
			{


				LootFilterVersionPattern::PatternStruct*
					pattern_struct = LootFilterVersionPattern::registered_loot_filter_version_patterns[k];

				RouterVariant*
					router_variant = new RouterVariant();

				router_variant->router_localisation = ELocalisationText::generate_localization_with_base_name(LootFilterVersionPattern::NSW_LOOT_VERSION_NAME[i]);

				router_variant->localisation_for_select_window = pattern_struct->localised_name;
				router_variant->texture = pattern_struct->icon;

				router_variant->text_color = new HSVRGBAColor();
				router_variant->text_color->set_color(pattern_struct->color_pointer);

				router_button->router_variant_list.push_back(router_variant);
			}

			router_button->reselect_variant();
		}
	}


}

void EButtonGroupFilterBlock::reselect_specific_variant_on_version_routers(int _target_variant)
{

	for (int i = 0; i < NSW_LOOT_FILTER_MAX_VERSIONS; i++)
	{
		EntityButtonVariantRouterForFilterBlock*
			router_button = version_routers[i];

		if (router_button != nullptr)
		{
			//is selected deletable variant, select default variant
			if (router_button->selected_variant == _target_variant)
			{
				std::string
					str = "default";

				router_button->select_variant_by_base_name_from_window_buttons(str);
			}
		}
	}

}

EButtonGroupFilterBlockAsText* EButtonGroupFilterBlockAsText::create_filter_block_as_text_group(EButtonGroupFilterBlock* _target_filter_block)
{
	//EButtonGroupFilterBlockAsText*
	//jc_FBaT_group = new EButtonGroupFilterBlockAsText(new ERegionGabarite(800.0f, 500.0f));
	//jc_FBaT_group->init_button_group(EGUIStyle::active_style, true, true, false);
	//jc_FBaT_group->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_dynamic_autosize);
	//jc_FBaT_group->root_group = jc_FBaT_group;


	//EButtonGroupjc_FBaT_group->add_close_group_and_return_workspace_group(new ERegionGabarite(800.0f, 20.0f), EGUIStyle::active_style);

	//_target_filter_block

	return nullptr;
}

void EButtonGroupSoundList::refresh_sound_list()
{
	part_with_selected_sound->button_group_is_active = (stored_sound_type_enum == NSW_StoredSoundsType::CUSTOM_USER_SOUND);

	part_with_registered_sound->remove_all_workspace_buttons();
	part_with_selected_sound->remove_all_workspace_buttons();

	if (pointer_to_sound_list != nullptr)
	{
		if (stored_sound_type_enum == NSW_StoredSoundsType::CUSTOM_USER_SOUND)
		{
			EntityButtonFilterSound*
				selected_sound_button;

			for (ENamedSound* n_sound : target_sound_button->named_sound_vector)
			{
				EButtonGroup::sound_list_group->add_selected_button_to_right_side(n_sound);
			}
		}

		for (ENamedSound* n_sound : *pointer_to_sound_list)
		{
			EntityButtonFilterSound* sound_button = new EntityButtonFilterSound();
			sound_button->make_default_button_with_unedible_text
			(
				new ERegionGabarite(300.0f, 32.0f),
				part_with_registered_sound,
				&EDataActionCollection::action_invoke_button_action_in_sound_group,
				n_sound->localisation_text
			);

			sound_button->can_be_stretched = true;
			sound_button->max_stretch_factor = 1.1f;

			sound_button->create_clickable_region_witch_sprtite_layer_and_icon
			(
				new ERegionGabarite(32.0f, 32.0f),
				NS_EGraphicCore::load_from_textures_folder("buttons/play_button"),
				&EDataActionCollection::action_play_attached_sound
			);

			sound_button->main_text_area->localisation_text = n_sound->localisation_text;
			sound_button->full_path = n_sound->full_path;

			sound_button->parent_filter_block = EButtonGroup::sound_list_group->target_sound_button->parent_filter_block;

			if (sound_button->named_sound_vector.empty())
			{
				sound_button->named_sound_vector.push_back(n_sound);
			}
			else
			{
				sound_button->named_sound_vector[0] = n_sound;
			}

			sound_button->target_sound_group = EButtonGroup::sound_list_group;

			//Entity::get_last_clickable_area(sound_button)->actions_on_right_click_list.push_back(&EDataActionCollection::action_play_attached_sound);

			part_with_registered_sound->add_button_to_working_group(sound_button);
		}
	}
	else
	{
		EInputCore::logger_simple_error("pointer to sound list is NULL!");
	}

	set_colors_to_registered_buttons();
}

void EButtonGroupSoundList::add_selected_button_to_right_side(ENamedSound* _named_sound)
{
	EntityButtonFilterSound*
		selected_sound_button;

	selected_sound_button = new EntityButtonFilterSound();

	selected_sound_button->make_default_button_with_unedible_text
	(
		new ERegionGabarite(200.0f, 32.0f),
		part_with_registered_sound,
		&EDataActionCollection::action_invoke_button_action_in_sound_group,
		_named_sound->localisation_text
	);
	selected_sound_button->can_be_stretched = true;

	selected_sound_button->create_clickable_region_witch_sprtite_layer_and_icon
	(
		new ERegionGabarite(32.0f, 32.0f),
		NS_EGraphicCore::load_from_textures_folder("buttons/play_button"),
		&EDataActionCollection::action_play_attached_sound
	);

	selected_sound_button->named_sound_vector.push_back(_named_sound);
	selected_sound_button->main_text_area->localisation_text = _named_sound->localisation_text;
	selected_sound_button->full_path = _named_sound->full_path;

	selected_sound_button->parent_filter_block = EButtonGroup::sound_list_group->target_sound_button->parent_filter_block;

	selected_sound_button->add_close_circle(EDataActionCollection::action_remove_this_random_user_sound);

	part_with_selected_sound->add_button_to_working_group(selected_sound_button);

	EButtonGroup::sound_list_group->target_sound_button->parent_filter_block->custom_sound_suppressor_bool = true;
	EButtonGroup::sound_list_group->need_refresh = true;
	set_colors_to_registered_buttons();
}

void EButtonGroupSoundList::set_colors_to_registered_buttons()
{
	if (EButtonGroup::sound_list_group->target_sound_button != nullptr)
	{
		for (EntityButton* but : EButtonGroup::sound_list_group->part_with_registered_sound->workspace_button_list)
		{
			EntityButtonFilterSound*
				registered_sound_button = static_cast<EntityButtonFilterSound*>(but);
			registered_sound_button->main_text_area->set_color(1.0f, 0.9f, 0.8f, 1.0f);

			for (ENamedSound* clicked_named_sound : EButtonGroup::sound_list_group->target_sound_button->named_sound_vector)
				if (clicked_named_sound == registered_sound_button->named_sound_vector.front())
				{
					registered_sound_button->main_text_area->set_color(0.6f, 1.0f, 0.3f, 1.0f);
				}
		}
	}
}

EntityButtonVariantRouterForFilterBlock::~EntityButtonVariantRouterForFilterBlock()
{
	if (debug_deleting) {
		EInputCore::logger_simple_info("deleting EntityButtonVariantRouterForFilterBlock");
	}
}

EntityButtonFilterSound::~EntityButtonFilterSound()
{
	//ESound::engine->removeSoundSource(stored_named_sound->sound);
	if (debug_deleting) {
		EInputCore::logger_simple_info("deleting EntityButtonVariantRouterForFilterBlock");
	}
}



EntityButtonForListedSegment::EntityButtonForListedSegment()
{
	//EInputCore::logger_simple_info("deleting EntityButtonForListedSegment");
}

EntityButtonForListedSegment::~EntityButtonForListedSegment()
{
	if (debug_deleting) {
		EInputCore::logger_simple_info("deleting EntityButtonForListedSegment");
	}
}

void EButtonGroupDataEntity::button_group_update(float _d)
{
	EButtonGroup::button_group_update(_d);

	//if
	//(
	//	(EInputCore::MOUSE_POSITION_X / NS_EGraphicCore::current_zoom >= right_side_for_filters->region_gabarite->world_position_x)
	//	&&
	//	(focused_part != right_side_for_filters)
	//)
	//{
	//	focused_part = right_side_for_filters;
	//	right_side_for_filters->base_width		= 500.0f;

	//	main_left_side->scroll_y = 0.0f;
	//	EButtonGroup::refresh_button_group(this);

	//	//EInputCore::logger_simple_info("1");
	//}
	//else
	//if
	//	(
	//		(EInputCore::MOUSE_POSITION_X / NS_EGraphicCore::current_zoom < right_side_for_filters->region_gabarite->world_position_x)
	//		&&
	//		(focused_part != main_left_side)
	//	)
	//{
	//	focused_part = main_left_side;
	//	right_side_for_filters->base_width = 250.0f;
	//	
	//	main_left_side->scroll_y = 0.0f;
	//	//scroll_y = 0.0f;
	//	EButtonGroup::refresh_button_group(this);
	//	//EInputCore::logger_simple_info("2");
	//}

}

void EButtonGroupDataEntity::background_update(float _d)
{
	EButtonGroup::background_update(_d);

	//buttons for data entity
	unsigned int counter = 0;
	for (int i = 0; i < 10; i++)
		if (data_entity_id < EDataEntity::data_entity_global_list.size())
		{
			EntityButtonWideItem* jc_button = EntityButtonWideItem::create_wide_item_button
			(
				new ERegionGabarite(300.0f, 60.0f),
				main_left_side,
				EDataEntity::data_entity_global_list[data_entity_id],
				EFont::font_list[0],
				false
			);
			jc_button->can_be_stretched = true;

			jc_button->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_invoke_data_entity_group_action);

			main_left_side->add_button_to_working_group(jc_button);

			//counter++;


			data_entity_id++;

			if (data_entity_id >= EDataEntity::data_entity_global_list.size())
			{

				EDataActionCollection::action_type_search_data_entity_text(main_input_field->main_text_area);
				//EButtonGroup::refresh_button_group(this);
				need_refresh = true;

				EWindowMain::background_loading_info->exist_time = 0.1f;
				EWindowMain::background_loading_info->block_need_remove = true;

				EInputCore::logger_simple_info("autorefresh!");

				glActiveTexture(GL_TEXTURE0);
				glBindTexture(GL_TEXTURE_2D, NS_EGraphicCore::default_texture_atlas->get_framebuffer());
				glGenerateMipmap(GL_TEXTURE_2D);

				//glActiveTexture(GL_TEXTURE0);
				//glBindTexture(GL_TEXTURE_2D, skydome_texture_atlas[i]->get_framebuffer());
				//glGenerateMipmap(GL_TEXTURE_2D);


			}
		}



}

void EButtonGroupFilterBlockEditor::button_group_prechange()
{
	bool								last_separator_state = true;
	EButtonGroupFilterBlockSeparator* last_separator = nullptr;
	int block_id = 1;

	for (int i = 0; i < group_list.size(); i++)
	{
		EButtonGroupFilterBlock* filter_block = static_cast<EButtonGroupFilterBlock*>(group_list[i]);

		//		IF SEPARATOR
		if (EButtonGroupFilterBlockSeparator* block = dynamic_cast<EButtonGroupFilterBlockSeparator*>(group_list[i]))
		{
			last_separator = dynamic_cast<EButtonGroupFilterBlockSeparator*>(group_list[i]);
			last_separator_state = last_separator->is_expanded;


		}
		else if (EButtonGroupFilterBlock* block = dynamic_cast<EButtonGroupFilterBlock*>(group_list[i]))
		{

			filter_block->is_expanded = last_separator_state;
			filter_block->attached_separator = last_separator;

			if
				(
					(filter_block->pointer_to_attribute_tab != nullptr)
					&&
					(
						(filter_block->pointer_to_attribute_tab->selected_button == nullptr)
						||
						(filter_block->pointer_to_attribute_tab->selected_button->entity_need_remove)
						)
					&&
					(!filter_block->pointer_to_attribute_tab->workspace_button_list.empty())
					)
			{
				//for (EButtonGroup* group : static_cast<EntityButtonAttributeTab*>(but)->target_whole_listed_block->group_list)
				//{
				//	group->button_group_is_active = false;
				//}

				for (EntityButton* but : filter_block->pointer_to_attribute_tab->workspace_button_list)
				{
					if (!but->entity_need_remove)
					{
						filter_block->pointer_to_attribute_tab->selected_button = but;
						static_cast<EntityButtonAttributeTab*>(but)->target_whole_listed_block->button_group_is_active = true;

						break;
					}
				}
			}

			if
				(
					(filter_block->pointer_to_attribute_tab != nullptr)
					&&
					(filter_block->pointer_to_attribute_tab->selected_button != nullptr)
					)
			{
				for (EntityButton* but : filter_block->pointer_to_attribute_tab->workspace_button_list)
				{
					EntityButtonAttributeTab*
						tab_button = static_cast<EntityButtonAttributeTab*>(but);

					if (tab_button->target_whole_listed_block != nullptr)
					{
						tab_button->target_whole_listed_block->button_group_is_active = (tab_button == filter_block->pointer_to_attribute_tab->selected_button);
					}
				}
			}

			if ((!filter_block->block_need_remove) && (filter_block->id_button != nullptr))
			{
				filter_block->id_button->main_text_area->change_text(std::to_string(block_id));
				block_id++;
			}

			for (int i = 0; i < NSW_LOOT_FILTER_MAX_VERSIONS; i++)
			{

				if (EWindowMain::registered_group_loot_version_configure->pointer_to_version_name_button[i] != nullptr)
				{
					filter_block->version_routers[i]->entity_disabled = !*(EWindowMain::registered_group_loot_version_configure->pointer_to_version_name_button[i]->suppressor);
				}
				else
				{
					filter_block->version_routers[i]->entity_disabled = true;
				}

				//change name of loot-filter version router
				filter_block->version_routers[i]->main_text_area->localisation_text
					=
					EWindowMain::registered_group_loot_version_configure->pointer_to_version_name_button[i]->main_text_area->localisation_text;

				//change text or routerr
				filter_block->version_routers[i]->main_text_area->change_text
				(EWindowMain::registered_group_loot_version_configure->pointer_to_version_name_button[i]->main_text_area->original_text);
			}
			//filter_block->disable_gabarite = filter_block->disable_gabarite || !filter_block->is_expanded;
			//filter_block->disable_gabarite = !is_visible();
		}



		//filter_block->button_group_prechange();
	}


}

EButtonGroupFilterBlockSeparator::~EButtonGroupFilterBlockSeparator()
{
}

EntityButtonLootItem::EntityButtonLootItem()
{
}

EntityButtonLootItem::~EntityButtonLootItem()
{
	if (debug_deleting) {
		EInputCore::logger_simple_info("deleting EntityButtonLootItem");
	}
}

void EntityButtonLootItem::get_matched_filter_blocks()
{
}

GameAttributeGenerator::~GameAttributeGenerator()
{
	delete target_attribute_container;
}

GameAttributeGenerator::GameAttributeGenerator(std::string _attribute_name)
{
	target_attribute = GameItemAttribute::get_attribute_by_name(&registered_game_item_attributes, _attribute_name);
}

void GameAttributeGenerator::execute_generation(EGameItem* _game_item)
{
	_game_item->attribute_container_list.push_back(*target_attribute_container);
}




void GameAttributeGeneratorMinMaxInt::execute_generation(EGameItem* _game_item)
{
	if (_game_item->stored_data_entity == nullptr)
	{
		int generated_value = min_value + round((max_value - min_value) * pow((rand() % 101) / 100.0f, generator_pow));

		target_attribute_container->attribute_value_int = generated_value;
	}
	//else
	//{
	//	target_attribute_container->attribute_value_int = 3;
	//}

	//GameAttributeGenerator::execute_generation(_game_item);

}

GameItemGenerator::GameItemGenerator()
{
}

GameItemGenerator::~GameItemGenerator()
{
	for (int i = 0; i < attribute_generators_list.size(); i++)
	{
		delete attribute_generators_list[i];
	}

	attribute_generators_list.clear();
	attribute_generators_list.shrink_to_fit();
	
	
	
	for (int i = 0; i < filtered_by_tags.size(); i++)
	{
		delete filtered_by_tags[i];
	}

	filtered_by_tags.clear();
	filtered_by_tags.shrink_to_fit();

}

GameItemGenerator::GameItemGenerator(std::string _key)
{
	if (_key != "")
	{
		generator_name = ELocalisationText::get_localisation_by_key(_key);
	}
}

void GameItemGenerator::generate_game_item_list(std::vector<EGameItem*>* _target_list)
{
	if (_target_list != nullptr)
	{







		EGameItem*
			game_item = nullptr;

		if (filtered_by_exact_name.base_name != "")
		{


			for (EDataEntity* de : EDataEntity::data_entity_hash_struct.data_entity_list[EStringUtils::get_id_by_hash(filtered_by_exact_name.base_name)])
			{
				if
					(
						(
							(DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::base_name, de) == filtered_by_exact_name.localisations[NSW_localisation_EN])
							||
							(DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::base_name, de) == filtered_by_exact_name.base_name)
							)
						&&
						(EFilterRule::matched_by_filter_rule(de, EFilterRule::registered_global_filter_rules[RegisteredFilterRules::FILTER_RULE_OBTAINABLE_GAME_ITEM], ""))
						)
				{
					for (int i = 0; i < generations_count; i++)
					{
						game_item = new EGameItem();
						game_item->stored_data_entity = de;
						_target_list->push_back(game_item);
					}

					break;
				}


			}



			for (int i = 0; i < generations_count; i++)
			{
				game_item = new EGameItem();

				_target_list->push_back(game_item);
			}
		}
		else
		{
			std::vector<EDataEntity*>
				generated_suitable_data_entity_item_vector;


			if (!filtered_by_tags.empty())
			{
				for (EDataEntity* data_entity : EWindowMain::registered_data_entity_game_item_list)
				{
					bool all_tag_filter_satisfied = true;
					bool any_banned_tag_match = false;

					for (DataEntityTagFilter* tag_filter : filtered_by_tags)
						if (all_tag_filter_satisfied)
						{
							if (!tag_filter->suitable_values.empty())
							{
								all_tag_filter_satisfied = false;

								//bool at_least_one_active_tag_filter = false;

								for (DETF_Value required_tag_value : tag_filter->suitable_values)
								{
									//at_least_one_active_tag_filter |= required_tag_value.is_active;

									if
										(
											(required_tag_value.DETF_is_active)
											&&
											(
												(required_tag_value.always_suitable)
												||
												(required_tag_value.target_value_key.string_value == "")
												||
												(DataEntityUtils::is_exist_tag_by_name_and_value_ID(0, &tag_filter->target_tag, &required_tag_value.target_value_key, data_entity))
												)
											)
									{
										all_tag_filter_satisfied = true;
										break;
									}


									//if (!all_tag_filter_satisfied) { break; }
								}

								//all_tag_filter_satisfied |= !at_least_one_active_tag_filter;
							}

							//if (!all_tag_filter_satisfied) { break; }
							for (DETF_Value banned_tag_value : tag_filter->banned_tags)
								if (DataEntityUtils::is_exist_tag_by_name_and_value_ID(0, &tag_filter->target_tag, &banned_tag_value.target_value_key, data_entity))
								{
									any_banned_tag_match = true;
									break;
								}
						}

					if ((all_tag_filter_satisfied) && (!any_banned_tag_match))
					{
						generated_suitable_data_entity_item_vector.push_back(data_entity);
					}
				}
			}

			//transfer FROM generated items vector TO global items vector

			if (generator_mode == GameItemGeneratorMode::GAME_ITEM_GENERATOR_MODE_ALL)
			{
				for (EDataEntity* de : generated_suitable_data_entity_item_vector)
				{
					for (int i = 0; i < generations_count; i++)
					{
						game_item = new EGameItem();
						game_item->stored_data_entity = de;
						_target_list->push_back(game_item);
					}
					//_target_list->insert(_target_list->end(), temp_game_item_vector.begin(), temp_game_item_vector.end());
				}
			}
			else
				if ((generator_mode == GameItemGeneratorMode::GAME_ITEM_GENERATOR_MODE_RANDOM_COUNT) || (generator_mode == GameItemGeneratorMode::GAME_ITEM_GENERATOR_MODE_RANDOM_COUNT_ERASE))
				{
					for (int i = 0; i < random_selection_count; i++)
						if (!generated_suitable_data_entity_item_vector.empty())
						{
							int random_element = rand() % generated_suitable_data_entity_item_vector.size();
							for (int i = 0; i < generations_count; i++)
							{
								game_item = new EGameItem();
								game_item->stored_data_entity = generated_suitable_data_entity_item_vector[random_element];
								_target_list->push_back(game_item);
							}

							if (generator_mode == GameItemGeneratorMode::GAME_ITEM_GENERATOR_MODE_RANDOM_COUNT_ERASE)
							{
								generated_suitable_data_entity_item_vector.erase(generated_suitable_data_entity_item_vector.begin() + random_element);
							}
						}
				}


		}





		//game_item->localised_name.base_name = 







		//return game_item;
	}
}

void GameItemGenerator::init_game_item(EGameItem* _game_item, GameItemGenerator* _generator)
{
	//reset item rarity
	_game_item->rarity = -1;

	//automatic generate basic attributes
	if
		(_game_item == nullptr)
	{
		EInputCore::logger_simple_error("_game_item is NULL");
	}
	else
	{
		if (_game_item->stored_data_entity != nullptr)
		{

			//STACK SIZE AND MAX STACK
			std::string
				max_stack_value = DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::max_stack_size, _game_item->stored_data_entity);

			std::string
				stack_multiplier_value = DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::stack_multiplier, _game_item->stored_data_entity);


			if (max_stack_value != "") { _game_item->max_stack_size = std::stof(max_stack_value); }
			if (stack_multiplier_value != "") { _game_item->stack_multiplier = std::stof(stack_multiplier_value); }


			_game_item->icon = NS_EGraphicCore::load_from_textures_folder("icons/" + DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::icon_path, _game_item->stored_data_entity));

			//BASE NAME AND LOCALISED NAMES
			_game_item->localised_name.base_name = DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::base_name, _game_item->stored_data_entity);

			if (_game_item->localised_name.base_name == "")
			{
				_game_item->localised_name.base_name = DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::name_EN, _game_item->stored_data_entity);
			}

			_game_item->localised_name.localisations[NSW_localisation_EN] = DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::name_EN, _game_item->stored_data_entity);
			_game_item->localised_name.localisations[NSW_localisation_RU] = DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::name_RU, _game_item->stored_data_entity);

			//WARN WHEN HIDDEN
			if
				(
					(DataEntityUtils::is_exist_tag_by_name_and_value(0, "item tag", "WARN WHEN HIDDEN", _game_item->stored_data_entity))
					||
					(DataEntityUtils::is_exist_tag_by_name_and_value(0, "worth", "Very expensive", _game_item->stored_data_entity))
					||
					(DataEntityUtils::is_exist_tag_by_name_and_value(0, "worth", "Expensive", _game_item->stored_data_entity))
					)
			{
				_game_item->warn_when_hidden = true;

				//EInputCore::logger_simple_info("WARN WHEN HIDDEN");
			}


			//default attributes [BASE TYPE]
			if (_game_item->localised_name.base_name != "")
			{
				EGameItemAttributeContainer
					attribute_container;

				attribute_container.target_attribute = GameItemAttribute::default_game_attribute[DefaultGameAttributeEnum::GAME_ATTRIBUTE_BASE_TYPE];
				//attribute_container.attribute_value_str = game_item->localised_name.base_name;
				attribute_container.listed_value_list.push_back(_game_item->localised_name);

				_game_item->attribute_container_list.push_back(attribute_container);
			}

			//default attributes [BASE CLASS]
			if (DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::base_class, _game_item->stored_data_entity) != "")
			{

				std::string
					raw_class_name_in_item = DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::base_class, _game_item->stored_data_entity);

				//try search data entity by exact match
				std::vector<EDataEntity*>*
					target_data_entity_list_for_class = &EWindowMain::registered_data_entity_class_list;

				ELocalisationText l_text;

				EDataEntity*
					suitable_data_entity = nullptr;

				bool suitable_data_entity_searched = false;

				std::string
					short_name = "";

				std::string
					class_EN_name = "";
				//search in all class data entity, to get localised names and short name
				for (EDataEntity* d_entity : *target_data_entity_list_for_class)
					if (!suitable_data_entity_searched)
					{
						//try get base name


						class_EN_name = DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::name_EN, d_entity);
						short_name = DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::short_name, d_entity);




						if
							(
								(raw_class_name_in_item == class_EN_name)
								||
								(raw_class_name_in_item == short_name)
								)
						{
							l_text.base_name = class_EN_name;
							l_text.localisations[NSW_localisation_EN] = class_EN_name;
							l_text.localisations[NSW_localisation_RU] = DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::name_RU, d_entity);

							std::string
								sockets_text = DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::max_sockets, d_entity);
							if (sockets_text != "") { _game_item->max_available_sockets = EStringUtils::safe_convert_string_to_number(sockets_text, 0, 6); }

							std::string
								rarity_override_text = DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::rarity_override, d_entity);
							if (rarity_override_text != "")
							{
								if (rarity_override_text == "Normal") { _game_item->rarity = 0; }
								else
									if (rarity_override_text == "Magic") { _game_item->rarity = 1; }
									else
										if (rarity_override_text == "Rare") { _game_item->rarity = 2; }
										else
											if (rarity_override_text == "Unique") { _game_item->rarity = 3; }
							}

							if (DataEntityUtils::is_exist_tag_by_name_and_value(0, "can be", "Synthesised",		d_entity))		{ _game_item->can_be_synthesised	= true; }
							if (DataEntityUtils::is_exist_tag_by_name_and_value(0, "can be", "Fractured",		d_entity))		{ _game_item->can_be_fractured		= true; }
							if (DataEntityUtils::is_exist_tag_by_name_and_value(0, "can be", "Corrupted",		d_entity))		{ _game_item->can_be_corrupted		= true; }
							if (DataEntityUtils::is_exist_tag_by_name_and_value(0, "can be", "Mirrored",		d_entity))		{ _game_item->can_be_mirrored		= true; }
							if (DataEntityUtils::is_exist_tag_by_name_and_value(0, "can be", "Enchanted",		d_entity))		{ _game_item->can_be_enchanted		= true; }
							if (DataEntityUtils::is_exist_tag_by_name_and_value(0, "can be", "Replica",			d_entity))		{ _game_item->can_be_replica		= true; }
							if (DataEntityUtils::is_exist_tag_by_name_and_value(0, "can be", "Quality",			d_entity))		{ _game_item->can_be_quality		= true; }
							if (DataEntityUtils::is_exist_tag_by_name_and_value(0, "can be", "Maptier",			d_entity))		{ _game_item->can_be_maptier		= true; }
							//if (DataEntityUtils::is_exist_tag_by_name_and_value(0, "can be", "Maptier",		d_entity))		{ _game_item->can_be_maptier	= true; }
							if (DataEntityUtils::is_exist_tag_by_name_and_value(0, "can be", "Gem level",		d_entity))		{ _game_item->can_be_gem_level		= true; }
							if (DataEntityUtils::is_exist_tag_by_name_and_value(0, "can be", "Transfigured",	d_entity))		{ _game_item->can_be_transfigured	= true; }
							if (DataEntityUtils::is_exist_tag_by_name_and_value(0, "can be", "Blighted",		d_entity))		{ _game_item->can_be_blighted		= true; }
							if (DataEntityUtils::is_exist_tag_by_name_and_value(0, "can be", "Uberblighted",	d_entity))		{ _game_item->can_be_uberblighted	= true; }
							if (DataEntityUtils::is_exist_tag_by_name_and_value(0, "can be", "Procentile",		d_entity))		{ _game_item->can_be_procentile		= true; }
							if (DataEntityUtils::is_exist_tag_by_name_and_value(0, "can be", "Influenced",		d_entity))		{ _game_item->can_be_influenced		= true; }

							suitable_data_entity_searched = true;
							break;
						}
					}

				if (!suitable_data_entity_searched)
				{
					l_text.base_name = raw_class_name_in_item;
					l_text.localisations[NSW_localisation_EN] = raw_class_name_in_item;
					l_text.localisations[NSW_localisation_RU] = raw_class_name_in_item;
					short_name = "";
				}

				EGameItemAttributeContainer
					attribute_container;

				attribute_container.target_attribute = GameItemAttribute::default_game_attribute[DefaultGameAttributeEnum::GAME_ATTRIBUTE_BASE_CLASS];
				//attribute_container.attribute_value_str = DataEntityUtils::get_tag_value_by_name(0, "base class", _game_item->stored_data_entity);

				attribute_container.listed_value_list.push_back(l_text);

				if (short_name != "")
				{
					attribute_container.listed_value_list.push_back(ELocalisationText::generate_localization_with_base_name(short_name));
					_game_item->short_class_name = short_name;
				}
				else
				{

				}

				//if (suitable_data_entity_searched != )


				/*if
				(
					(raw_class_name_in_item == "Body Armours")
					||
					(raw_class_name_in_item == "Two Hand Sword")
					||
					(raw_class_name_in_item == "Two Hand Axe")
					||
					(raw_class_name_in_item == "Two Hand Mace")
					||
					(raw_class_name_in_item == "Staves")
					||
					(raw_class_name_in_item == "Warstaves")
					||
					(raw_class_name_in_item == "Bows")
				)
				{
					_game_item->max_sockets = 6;
				}
				else
				if
				(
					(raw_class_name_in_item == "Helmets")
					||
					(raw_class_name_in_item == "Gloves")
					||
					(raw_class_name_in_item == "Boots")
				)
				{
					_game_item->max_sockets = 4;
				}
				else
				if
				(
					(raw_class_name_in_item == "Claws")
					||
					(raw_class_name_in_item == "Wands")
					||
					(raw_class_name_in_item == "Daggers")
					||
					(raw_class_name_in_item == "Rune Daggers")
					||
					(raw_class_name_in_item == "Sceptres")
					||
					(raw_class_name_in_item == "One Hand Swords")
					||
					(raw_class_name_in_item == "One Hand Axes")
					||
					(raw_class_name_in_item == "One Hand Maces")
					||
					(raw_class_name_in_item == "Shields")
					||
					(raw_class_name_in_item == "Thrusting One Hand Swords")
				)
				{
					_game_item->max_sockets = 3;
				}*/

				_game_item->attribute_container_list.push_back(attribute_container);


				//EInputCore::logger_param("width", attribute_container.attribute_value);
			}

			//reset item rarity



			if ((_game_item->rarity == -1) && (EWindowMain::loot_simulator_button_group->rarity_override != -1))
			{
				_game_item->rarity = EWindowMain::loot_simulator_button_group->rarity_override;

				GameItemAttribute::add_new_int_value_to_game_attribute
				(
					_game_item,
					"Rarity",
					_game_item->rarity
				);
			}

			//CHECK IS ITEM ALWAYS UNIQUE
			if
			(
				(_generator->always_unique)
				||
				(DataEntityUtils::is_exist_tag_by_name_and_value(0, "item tag", "Always unique", _game_item->stored_data_entity))
			)
			{
				_game_item->rarity = 3;

				GameItemAttribute::add_new_int_value_to_game_attribute
				(
					_game_item,
					"Rarity",
					_game_item->rarity
				);
			}

			//NON-UNIQUE TAGS
			for (EDataTag* data_tag : _game_item->stored_data_entity->tag_list)
			{
				if (data_tag->tag_name.string_value == "add affix")
				{
					
					GameItemAttribute::add_new_listed_value_to_game_attribute
					(
						_game_item,
						"HasExplicitMod",
						ELocalisationText::generate_localization_with_base_name(data_tag->tag_value_list[0].string_value)
					);
				}

			}
		}
		else//undefined item
		{

			{
				EGameItemAttributeContainer
					attribute_container;

				attribute_container.target_attribute = GameItemAttribute::default_game_attribute[DefaultGameAttributeEnum::GAME_ATTRIBUTE_BASE_TYPE];
				//attribute_container.attribute_value_str = game_item->localised_name.base_name;
				ELocalisationText l_text;

				l_text.base_name = filtered_by_exact_name.base_name;

				l_text.localisations[NSW_localisation_EN] = filtered_by_exact_name.localisations[NSW_localisation_EN];
				if (l_text.localisations[NSW_localisation_EN] == "") { l_text.localisations[NSW_localisation_EN] = filtered_by_exact_name.base_name; }

				l_text.localisations[NSW_localisation_RU] = filtered_by_exact_name.localisations[NSW_localisation_RU];
				if (l_text.localisations[NSW_localisation_RU] == "") { l_text.localisations[NSW_localisation_RU] = filtered_by_exact_name.base_name; }



				attribute_container.listed_value_list.push_back(l_text);

				_game_item->attribute_container_list.push_back(attribute_container);


				_game_item->localised_name = l_text;
			}

			{
				EGameItemAttributeContainer
					attribute_container;

				attribute_container.target_attribute = GameItemAttribute::get_attribute_by_name(&registered_game_item_attributes, "DropLevel");
				attribute_container.attribute_value_int = 1;

				_game_item->attribute_container_list.push_back(attribute_container);
			}

			{
				EGameItemAttributeContainer
					attribute_container;

				attribute_container.target_attribute = GameItemAttribute::default_game_attribute[DefaultGameAttributeEnum::GAME_ATTRIBUTE_HEIGHT];
				attribute_container.attribute_value_int = 1;

				_game_item->attribute_container_list.push_back(attribute_container);
			}



			{
				EGameItemAttributeContainer
					attribute_container;

				attribute_container.target_attribute = GameItemAttribute::default_game_attribute[DefaultGameAttributeEnum::GAME_ATTRIBUTE_WIDTH];
				attribute_container.attribute_value_int = 1;

				_game_item->attribute_container_list.push_back(attribute_container);
			}
		}
	}

	if (forceful_warn_when_hided)
	{
		_game_item->warn_when_hidden = true;
	}

	for (EButtonGroupAttributeGeneratorGroup* a_group : EWindowMain::loot_simulator_button_group->attribute_group_list)
	{
		if (a_group->attribute_generator_is_active)
		{
			a_group->execute_attribute_group(_game_item, _generator);

			/*EGameItemAttributeContainer
			generated_attribute_container;

			a_group->attribute_generator->target_attribute_container = &generated_attribute_container;
			a_group->attribute_generator->execute_generation(_game_item);

			generated_attribute_container.target_attribute = a_group->attribute_generator->target_attribute;
			_game_item->attribute_container_list.push_back(generated_attribute_container);*/
		}
	}

	if (_game_item->rarity == -1) { _game_item->rarity = 0; }
	//for (GameAttributeGenerator* a_generator : attribute_generators_list)
	//{
	//	if (a_generator->target_attribute == nullptr)
	//	{
	//		EInputCore::logger_simple_error("Cannot work with attribute container with NULL atrribute!");
	//	}
	//	else
	//	if (rand() % 100 < (int)(a_generator->chance_to_generate * 100.0f))
	//	{
	//			EGameItemAttributeContainer
	//			attribute_container;

	//			a_generator->target_attribute_container = &attribute_container;
	//			a_generator->execute_generation(_game_item);

	//			attribute_container.target_attribute = a_generator->target_attribute;
	//			_game_item->attribute_container_list.push_back(attribute_container);
	//	}
	//}

	//add some specific attributes from loot simulator, like [fractured][synthesised][corrupted] etc...
	for (EntityButtonVariantRouterForLootSimulatorAddition* addition_button : EWindowMain::loot_simulator_button_group->pointer_to_addition_button)
		if (addition_button->selected_variant == 1)
		{
			///EInputCore::logger_simple_info("try add addition attribute");

			bool this_attribute_already_exist = false;
			bool this_class_is_suitable = false;

			//check if target attribute already exist on item
			for (EGameItemAttributeContainer game_item_attribute_container : _game_item->attribute_container_list)
			{
				if (game_item_attribute_container.target_attribute == addition_button->target_attribute)
				{
					this_attribute_already_exist = true;
					break;
				}
			}

			if (!this_attribute_already_exist)
			{
				std::string item_class = "?";
				EGameItemAttributeContainer*
					container_with_class = nullptr;

				//for (EGameItemAttributeContainer attribute_container : _game_item->attribute_container_list)
				for (int i = 0; i < _game_item->attribute_container_list.size(); i++)
				{
					if (_game_item->attribute_container_list[i].target_attribute == GameItemAttribute::default_game_attribute[DefaultGameAttributeEnum::GAME_ATTRIBUTE_BASE_CLASS])
					{
						container_with_class = &_game_item->attribute_container_list[i];
						//EInputCore::logger_param("searched", container_with_class->target_attribute->localisation.base_name);

						break;
					}
				}



				if (container_with_class != nullptr)
				{
					//EInputCore::logger_param("listed_value_list.size()", container_with_class->listed_value_list.size());
					//EInputCore::logger_param("container_with_class", container_with_class->target_attribute->localisation.base_name);
					//this_class_is_suitable = true;

					for (std::string addition_button_suitable_string : addition_button->suitable_class_list)
					{
						//EInputCore::logger_param("suitable", addition_button_suitable_string);

						for (ELocalisationText l_text : container_with_class->listed_value_list)
						{
							//EInputCore::logger_param ("l_text", l_text.base_name);

							//std::cout << std::endl;

							if (l_text.base_name == addition_button_suitable_string)
							{

								this_class_is_suitable = true;

								break;
							}
						}
					}


				}
			}

			if
				(
					(!this_attribute_already_exist)
					&&
					(this_class_is_suitable)
					)
			{
				EGameItemAttributeContainer
					attribute_container;

				attribute_container.target_attribute = addition_button->target_attribute;

				if (addition_button->is_bool_attribute) { attribute_container.attribute_value_bool = true; }

				if (!addition_button->add_one_of_this_string_values.empty())
				{
					attribute_container.listed_value_list.push_back
					(
						addition_button->add_one_of_this_string_values[rand() % addition_button->add_one_of_this_string_values.size()]
					);
				}

				_game_item->attribute_container_list.push_back(attribute_container);
			}

			/*{
				EGameItemAttributeContainer
				game_item_attribute_container;

				game_item_attribute_container.target_attribute = GameItemAttribute::default_game_attribute[DefaultGameAttributeEnum::GAME_ATTRIBUTE_HEIGHT];
				game_item_attribute_container.attribute_value_int = 99;

			_game_item->attribute_container_list.push_back(game_item_attribute_container);
			}*/

		}

	//BASE ATTRIBUTES
	if
		(
			(_game_item != nullptr)
			&&
			(_game_item->stored_data_entity != nullptr)
			)
	{


		//default attributes [Base ward]
		if (DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::base_ward_min, _game_item->stored_data_entity) != "")
		{
			EGameItemAttributeContainer
				game_item_attribute_container;

			game_item_attribute_container.target_attribute = GameItemAttribute::default_game_attribute[DefaultGameAttributeEnum::GAME_ATTRIBUTE_BASE_WARD];
			int min_ward = EStringUtils::safe_convert_string_to_number(DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::base_ward_min, _game_item->stored_data_entity), 0, 99999);
			int max_ward = EStringUtils::safe_convert_string_to_number(DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::base_ward_max, _game_item->stored_data_entity), 0, 99999);

			int random_ward = round(min_ward + (max_ward - min_ward) * (float(rand() % 100) / 100.0f));
			game_item_attribute_container.attribute_value_int = random_ward;

			_game_item->attribute_container_list.push_back(game_item_attribute_container);

			//EInputCore::logger_param("height", attribute_container.attribute_value);	
		}

		//default attributes [Base armour]
		if (DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::base_armour_min, _game_item->stored_data_entity) != "")
		{
			EGameItemAttributeContainer
				game_item_attribute_container;

			game_item_attribute_container.target_attribute = GameItemAttribute::default_game_attribute[DefaultGameAttributeEnum::GAME_ATTRIBUTE_BASE_ARMOUR];
			int min_armour = EStringUtils::safe_convert_string_to_number(DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::base_armour_min, _game_item->stored_data_entity), 0, 99999);
			int max_armour = EStringUtils::safe_convert_string_to_number(DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::base_armour_max, _game_item->stored_data_entity), 0, 99999);

			int random_armour = round(min_armour + (max_armour - min_armour) * (float(rand() % 100) / 100.0f));
			game_item_attribute_container.attribute_value_int = random_armour;

			_game_item->attribute_container_list.push_back(game_item_attribute_container);

			//EInputCore::logger_param("height", attribute_container.attribute_value);	
		}

		//default attributes [Base evasion]
		if (DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::base_evasion_min, _game_item->stored_data_entity) != "")
		{
			EGameItemAttributeContainer
				game_item_attribute_container;

			game_item_attribute_container.target_attribute = GameItemAttribute::default_game_attribute[DefaultGameAttributeEnum::GAME_ATTRIBUTE_BASE_EVASION];
			int min_evasion = EStringUtils::safe_convert_string_to_number(DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::base_evasion_min, _game_item->stored_data_entity), 0, 99999);
			int max_evasion = EStringUtils::safe_convert_string_to_number(DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::base_evasion_max, _game_item->stored_data_entity), 0, 99999);

			int random_evasion = round(min_evasion + (max_evasion - min_evasion) * (float(rand() % 100) / 100.0f));
			game_item_attribute_container.attribute_value_int = random_evasion;

			_game_item->attribute_container_list.push_back(game_item_attribute_container);

			//EInputCore::logger_param("height", attribute_container.attribute_value);	
		}

		//default attributes [Base energy shield]
		if (DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::base_energy_shield_min, _game_item->stored_data_entity) != "")
		{
			EGameItemAttributeContainer
				game_item_attribute_container;

			game_item_attribute_container.target_attribute = GameItemAttribute::default_game_attribute[DefaultGameAttributeEnum::GAME_ATTRIBUTE_BASE_ENERGY_SHIELD];
			int min_energy_shield = EStringUtils::safe_convert_string_to_number(DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::base_energy_shield_min, _game_item->stored_data_entity), 0, 99999);
			int max_energy_shield = EStringUtils::safe_convert_string_to_number(DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::base_energy_shield_max, _game_item->stored_data_entity), 0, 99999);

			int random_energy_shield = round(min_energy_shield + (max_energy_shield - min_energy_shield) * (float(rand() % 100) / 100.0f));
			game_item_attribute_container.attribute_value_int = random_energy_shield;

			_game_item->attribute_container_list.push_back(game_item_attribute_container);

			//EInputCore::logger_param("height", attribute_container.attribute_value);	
		}

		//default attributes [HANE_IMPLICIT]
		if (DataEntityUtils::is_exist_tag_by_name_and_value(0, "item tag", "Have implicit", _game_item->stored_data_entity))
		{
			EGameItemAttributeContainer
				game_item_attribute_container;

			game_item_attribute_container.target_attribute = GameItemAttribute::default_game_attribute[DefaultGameAttributeEnum::GAME_ATTRIBUTE_HAVE_IMPLICIT];
			game_item_attribute_container.attribute_value_bool = true;

			_game_item->attribute_container_list.push_back(game_item_attribute_container);

			//EInputCore::logger_param("width", attribute_container.attribute_value);
		}

		//default attributes [HEIGHT]
		if (DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::item_height, _game_item->stored_data_entity) != "")
		{
			EGameItemAttributeContainer
				game_item_attribute_container;

			game_item_attribute_container.target_attribute = GameItemAttribute::default_game_attribute[DefaultGameAttributeEnum::GAME_ATTRIBUTE_HEIGHT];
			game_item_attribute_container.attribute_value_int = std::stoi(DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::item_height, _game_item->stored_data_entity));

			_game_item->attribute_container_list.push_back(game_item_attribute_container);

			//EInputCore::logger_param("height", attribute_container.attribute_value);	
		}

		//default attributes [WIDTH]
		if (DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::item_width, _game_item->stored_data_entity) != "")
		{
			EGameItemAttributeContainer
				game_item_attribute_container;

			game_item_attribute_container.target_attribute = GameItemAttribute::default_game_attribute[DefaultGameAttributeEnum::GAME_ATTRIBUTE_WIDTH];
			game_item_attribute_container.attribute_value_int = std::stoi(DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::item_width, _game_item->stored_data_entity));

			_game_item->attribute_container_list.push_back(game_item_attribute_container);

			//EInputCore::logger_param("width", attribute_container.attribute_value);
		}





	}
}

//void GameItemGenerator::add_rarity(int _rarity_min, int _rarity_max, float _pow)
//{
//	//		value
//	GameAttributeGeneratorRarity*
//	attribute_generator = new GameAttributeGeneratorRarity("Rarity");
//
//	//		parameters
//	//attribute_generator->min_value = _rarity_min;
//	//attribute_generator->max_value = _rarity_max;
//	//attribute_generator->generator_pow = _pow;
//
//	attribute_generator->base_pow = _pow;
//
//
//
//	attribute_generators_list.push_back(attribute_generator);
//}

//void GameItemGenerator::add_item_level(int _level_min, int _level_max, float _pow)
//{
//	GameAttributeGeneratorItemLevel*
//		value_generator = new GameAttributeGeneratorItemLevel("ItemLevel");
//
//	//		parameters
//	//value_generator->min_value = _level_min;
//	//value_generator->max_value = _level_max;
//	//value_generator->generator_pow = _pow;
//
//	attribute_generators_list.push_back(value_generator);
//}

//void GameItemGenerator::add_random_influence(float _chance)
//{
//	//		value
//	GameAttributeGeneratorItemInfluence*
//		attribute_generator = new GameAttributeGeneratorItemInfluence("HasInfluence");
//
//	//		parameters
//	attribute_generator->chance_to_generate = _chance;
//	attribute_generator->base_chance_to_add = _chance;
//
//	attribute_generators_list.push_back(attribute_generator);
//}

//GameAttributeGeneratorSocketsLinksColours* GameItemGenerator::add_sockets_and_links(int _min_sockets, int _max_sockets, int _min_links, int _max_links)
//{
//	//		value
//	GameAttributeGeneratorSocketsLinksColours*
//	attribute_generator = new GameAttributeGeneratorSocketsLinksColours("SocketGroup");
//
//	//		parameters
//	attribute_generator->sockets_min_value = _min_sockets;
//	attribute_generator->sockets_max_value = _max_sockets;
//
//	attribute_generator->links_min = _min_links;
//	attribute_generator->links_max = _max_links;
//
//
//	
//
//	attribute_generators_list.push_back(attribute_generator);
//
//	return attribute_generator;
//}

//void GameItemGenerator::add_quantity(float _min = 0.0f, float _max = 3.0f, float _pow = 2.0f)
//{
//	//		value
//	GameAttributeGeneratorQuantity*
//	value_generator = new GameAttributeGeneratorQuantity("StackSize");
//
//	////		parameters
//	//value_generator->min_value = _min;
//	//value_generator->max_value = _max;
//	//value_generator->generator_pow = _pow;
//
//	//value_generator->base_pow = _pow;
//
//	attribute_generators_list.push_back(value_generator);
//}

//void GameItemGenerator::add_quality(int _min, int _max, float _pow)
//{
//	//		value
//	GameAttributeGeneratorQuality*
//		value_generator = new GameAttributeGeneratorQuality("Quality");
//
//	//		parameters
//	value_generator->min_value = _min;
//	value_generator->max_value = _max;
//	value_generator->generator_pow = _pow;
//
//	value_generator->base_pow = _pow;
//
//	attribute_generators_list.push_back(value_generator);
//}

void GameItemGenerator::add_gem_level(int _level_min, int _level_max, float _pow)
{
	GameAttributeGeneratorMinMaxInt*
		value_generator = new GameAttributeGeneratorMinMaxInt("GemLevel");

	//		parameters
	value_generator->min_value = _level_min;
	value_generator->max_value = _level_max;
	value_generator->generator_pow = _pow;

	attribute_generators_list.push_back(value_generator);
}

//void GameItemGenerator::add_flag_attrubite_by_name(std::string _attribute_name, float _chance_to_add)
//{
//	//		value
//	GameAttributeGeneratorBoolFlag*
//		attribute_generator = new GameAttributeGeneratorBoolFlag(_attribute_name);
//
//	//		parameters
//	attribute_generator->chance_to_activate = _chance_to_add;
//
//	attribute_generators_list.push_back(attribute_generator);
//}

void GameItemGenerator::add_class(ELocalisationText _attribute_localisation)
{
	{
		//		value
		GameAttributeGeneratorExactListedValue*
			value_generator = new GameAttributeGeneratorExactListedValue("Class");


		//		parameters

		value_generator->exact_values_list.push_back(_attribute_localisation);

		attribute_generators_list.push_back(value_generator);
	}
}

void GameItemGenerator::add_default_worth_tags(int _min, int _max)
{
	DataEntityTagFilter*
		tag_filter = new DataEntityTagFilter;

	tag_filter->target_tag.set_ID_by_string("worth");

	if ((_min <= 0) && (_max >= 0)) { tag_filter->add_new_suitable_value("Trash", ELocalisationText::get_localisation_by_key("tag_trash")); }
	if ((_min <= 1) && (_max >= 1)) { tag_filter->add_new_suitable_value("Common", ELocalisationText::get_localisation_by_key("tag_common")); }
	if ((_min <= 2) && (_max >= 2)) { tag_filter->add_new_suitable_value("Moderate", ELocalisationText::get_localisation_by_key("tag_moderate")); }
	if ((_min <= 3) && (_max >= 3)) { tag_filter->add_new_suitable_value("Rare", ELocalisationText::get_localisation_by_key("tag_rare")); }
	if ((_min <= 4) && (_max >= 4)) { tag_filter->add_new_suitable_value("Expensive", ELocalisationText::get_localisation_by_key("tag_expensive")); }
	if ((_min <= 5) && (_max >= 5)) { tag_filter->add_new_suitable_value("Very expensive", ELocalisationText::get_localisation_by_key("tag_very_expensive")); }

	filtered_by_tags.push_back(tag_filter);
}

void GameItemGenerator::add_default_worth_tags()
{
	add_default_worth_tags(0, 5);
}

void GameAttributeGeneratorSocketsLinksColours::execute_generation(EGameItem* _game_item)
{


	/*static std::vector<std::string> suitable_classes
	{
		"Claws",
		"Wands",
		"Sceptres",
		"One Hand Swords",
		"Thrusting One Hand Swords",
		"Two Hand Swords",
		"One Hand Axes",
		"Two Hand Axes",
		"One Hand Maces",
		"Two Hand Maces",
		"Bows",
		"Staves",
		"Warstaves",
		"Fishing Rods",
		"Gloves",
		"Helmets",
		"Boots",
		"Body Armours",
		"Shields"
	};

	bool wrong_base = true;
	for (int i = 0; i < _game_item->attribute_container_list.size(); i++)
	{
		EGameItemAttributeContainer*
		pointer_to_container = &_game_item->attribute_container_list[i];

		if (pointer_to_container->target_attribute->localisation.base_name == "Class")
		{
			for (ELocalisationText value_variants : pointer_to_container->listed_value_list)
			{
				for (int i = 0; i < suitable_classes.size(); i++)
				{
					if (value_variants.base_name == suitable_classes[i])
					{
						wrong_base = false;

						break;
					}
				}
			}
		}
	}*/

	EButtonGroupLootSimulator*
		loot_simulator_pointer = EWindowMain::loot_simulator_button_group;
	if
		(
			(_game_item->stored_data_entity != nullptr)
			&&
			(DataEntityUtils::is_exist_tag_by_name_and_value_ID(0, &ERegisteredStrings::item_tag, &ERegisteredStrings::all_sockets_white, _game_item->stored_data_entity))
			)//ALWAYS WHITE
	{

		color_weight[SocketColorEnum::SOCKET_COLOR_ENUM_RED] = 0;
		color_weight[SocketColorEnum::SOCKET_COLOR_ENUM_GREEN] = 0;
		color_weight[SocketColorEnum::SOCKET_COLOR_ENUM_BLUE] = 0;

		color_weight[SocketColorEnum::SOCKET_COLOR_ENUM_WHITE] = 10000;
		color_weight[SocketColorEnum::SOCKET_COLOR_ENUM_ABYSS] = 0;
		color_weight[SocketColorEnum::SOCKET_COLOR_ENUM_DELVE] = 0;
	}
	else
	{
		color_weight[SocketColorEnum::SOCKET_COLOR_ENUM_RED] = round(loot_simulator_pointer->selected_red_weight);
		color_weight[SocketColorEnum::SOCKET_COLOR_ENUM_GREEN] = round(loot_simulator_pointer->selected_green_weight);
		color_weight[SocketColorEnum::SOCKET_COLOR_ENUM_BLUE] = round(loot_simulator_pointer->selected_blue_weight);

		color_weight[SocketColorEnum::SOCKET_COLOR_ENUM_WHITE] = round(loot_simulator_pointer->selected_white_weight);
		color_weight[SocketColorEnum::SOCKET_COLOR_ENUM_ABYSS] = 0;
		color_weight[SocketColorEnum::SOCKET_COLOR_ENUM_DELVE] = 0;
	}

	//if (!wrong_base)
	if (_game_item->max_available_sockets > 0)
	{

		std::string temp_socket_color_names = "RGBWAD";

		int exactly_color_count[6]{ 0 };
		//int color_id_array[6]		{ 0 };

		int total_weight = 0;

		int
			sockets_count = 0;

		int
			links_count = 0;



		std::string sockets_result_string = "";
		std::string links_result_string = "";

		if
			(
				(_game_item->stored_data_entity != nullptr)
				&&
				(DataEntityUtils::is_exist_tag_by_name_and_value_ID(0, &ERegisteredStrings::item_tag, &ERegisteredStrings::always_six_linked, _game_item->stored_data_entity))
				)//ALWAYS 6-linked
		{
			sockets_count = 6;
			links_count = 6;
		}
		else
		{
			/*sockets_count	= sockets_min_value	+ round((float)(sockets_max_value	- sockets_min_value)	* pow((rand() % 101) / 100.0f, sockets_pow	/ EWindowMain::loot_simulator_button_group->MF_factor));
			links_count		= links_min			+ round((float)(links_max			- links_min)			* pow((rand() % 101) / 100.0f, links_pow	/ EWindowMain::loot_simulator_button_group->MF_factor));*/

			sockets_count = round(loot_simulator_pointer->selected_sockets);
			links_count = round(loot_simulator_pointer->selected_links);

			sockets_count = std::min(sockets_count, _game_item->max_available_sockets);
			links_count = std::min(links_count, sockets_count);
		}

		if (links_count == 1) { links_count = 0; }

		for (int i = 0; i < 6; i++)
		{
			total_weight += color_weight[i];
		}

		int random_selected = 0;

		int weight_sum = 0;

		int result_color_id = -1;

		for (int sc = 0; sc < sockets_count; sc++)
		{
			random_selected = rand() % total_weight + 1;
			weight_sum = 0;
			result_color_id = 0;

			for (int i = 0; i < 6; i++)
			{
				if
					(
						(color_weight[i] > 0)
						&&
						(weight_sum <= random_selected)
						&&
						(color_weight[i] + weight_sum > random_selected)
						)
				{
					result_color_id = i;
					break;
				}

				weight_sum += color_weight[i];
			}

			//color_id_array[sc] = result_color_id;

			_game_item->socket_color_id_array[sc] = result_color_id;
		}

		_game_item->sockets_count = sockets_count;
		_game_item->links_count = links_count;

		sockets_result_string = std::to_string(sockets_count);
		links_result_string = std::to_string(links_count);

		//		GENERATE COLOR SOCKETS STRING LIKE "RRRGGB"
		for (int i = 0; i < 6; i++) { exactly_color_count[i] = 0; }

		for (int i = 0; i < sockets_count; i++)
		{
			exactly_color_count[_game_item->socket_color_id_array[i]]++;
		};

		for (int i = 0; i < 6; i++)
			if (exactly_color_count[i] > 0)
				for (int j = 0; j < exactly_color_count[i]; j++)
				{
					sockets_result_string.append(1, temp_socket_color_names[i]);
				}

		//		GENERATE COLOR LINKS STRING LIKE "RRRGGB"
		for (int i = 0; i < 6; i++) { exactly_color_count[i] = 0; }

		for (int i = 0; i < links_count; i++)
		{
			exactly_color_count[_game_item->socket_color_id_array[i]]++;
		};

		for (int i = 0; i < 6; i++)
			if (exactly_color_count[i] > 0)
				for (int j = 0; j < exactly_color_count[i]; j++)
				{
					links_result_string.append(1, temp_socket_color_names[i]);
				}


		//		GENERATE NEW ATTRIBUTE FOR SOCKETS OR LINKS
		{
			EGameItemAttributeContainer
				new_attribute_container;

			if (target_attribute->localisation.base_name == "Sockets")
			{
				target_attribute_container->attribute_value_str = sockets_result_string;

				new_attribute_container.target_attribute = GameItemAttribute::get_attribute_by_name(&registered_game_item_attributes, "SocketGroup");
				new_attribute_container.attribute_value_str = links_result_string;
			}
			else
				if (target_attribute->localisation.base_name == "SocketGroup")
				{
					target_attribute_container->attribute_value_str = links_result_string;

					new_attribute_container.target_attribute = GameItemAttribute::get_attribute_by_name(&registered_game_item_attributes, "Sockets");
					new_attribute_container.attribute_value_str = sockets_result_string;
				}
			_game_item->attribute_container_list.push_back(new_attribute_container);
		}

		EGameItemAttributeContainer
			new_attribute_container;

		new_attribute_container.target_attribute = GameItemAttribute::get_attribute_by_name(&registered_game_item_attributes, "LinkedSockets");
		new_attribute_container.attribute_value_int = links_count;
		_game_item->attribute_container_list.push_back(new_attribute_container);
	}
}

void EGameItem::import_base_attributes_from_data_entity()
{
	if (stored_data_entity != nullptr)
	{

	}
}

void EntityButtonLootItem::get_matched_filter_blocks_list(EButtonGroupFilterBlockEditor* _filter_block_editor)
{
	bool break_detect_user = false;
	matched_filter_blocks.clear();
	suitable_buttons_list.clear();

	//search from non-default filter blocks

	for (EButtonGroup* group : _filter_block_editor->group_list)
		if
			(
				(!group->block_need_remove)
				&&
				(dynamic_cast<const EButtonGroupFilterBlock*>(group) != nullptr)
				&&
				(!static_cast<EButtonGroupFilterBlock*>(group)->is_default_filter_block)
				&&
				(!static_cast<EButtonGroupFilterBlock*>(group)->is_base_filter_block)
				)//filter block
		{
			{
				EButtonGroupFilterBlock*
					filter_block = static_cast<EButtonGroupFilterBlock*>(group);

				if
					(
						(!break_detect_user)
						&&
						(EButtonGroupLootSimulator::this_group_is_matched(this, stored_game_item, filter_block))
						)
				{
					bool any_detect = false;


					matched_show_hide_block = filter_block;

					if (filter_block->color_check[0])
					{
						matched_bg_color = &filter_block->pointer_to_color_button[0]->stored_color;
						matched_bg_color_block = filter_block;

						any_detect = true;
					}

					if (filter_block->color_check[1])
					{

						matched_text_color = &filter_block->pointer_to_color_button[1]->stored_color;

						main_text_area->set_color(filter_block->pointer_to_color_button[1]->stored_color);
						matched_text_color_block = filter_block;

						any_detect = true;
					}

					if (filter_block->color_check[2])
					{
						matched_rama_color = &filter_block->pointer_to_color_button[2]->stored_color;
						matched_rama_color_block = filter_block;

						any_detect = true;
					}

					if (filter_block->text_size_bool)
					{
						matched_size = &filter_block->text_size;
						matched_size_block = filter_block;

						any_detect = true;
					}

					//if not continue
					if (filter_block->button_continue->selected_variant != 0)
					{
						break_detect_user = true;
					}

					if ((filter_block->minimap_icon_color_suppressor_bool) || (filter_block->pointer_to_forcibly_disable_minimap_icon_variant_button->selected_variant == 1))
					{
						matched_minimap_icon_color = filter_block->pointer_to_minimap_icon_color_router;
						matched_minimap_icon_shape = filter_block->pointer_to_minimap_icon_shape_router;
						matched_minimap_icon_size = filter_block->pointer_to_minimap_icon_size_router;

						matched_minimap_icon_block = filter_block;

						any_detect = true;
					}

					if (any_detect) { matched_filter_blocks.push_back(filter_block); }
				}
			}

			if (break_detect_user) { break; }
		}

	bool break_detect_default = false;
	bool break_detect_base = false;

	//if have no one match with user defined loot-filter, search in default ingame loot-filter
	//search from default filter blocks
	if (matched_filter_blocks.empty())
		for (EButtonGroup* group : _filter_block_editor->group_list)
			if
				(
					(!group->block_need_remove)
					&&
					(
						(matched_bg_color_block == nullptr)
						||
						(matched_text_color_block == nullptr)
						||
						(matched_rama_color_block == nullptr)
						||
						(matched_size_block == nullptr)
						)
					&&
					(dynamic_cast<const EButtonGroupFilterBlock*>(group) != nullptr)
					&&
					(static_cast<EButtonGroupFilterBlock*>(group)->is_default_filter_block)
					)//filter block
			{
				{
					EButtonGroupFilterBlock*
						filter_block = static_cast<EButtonGroupFilterBlock*>(group);

					if (EButtonGroupLootSimulator::this_group_is_matched(this, stored_game_item, filter_block))
					{
						bool any_detect = false;






						if ((matched_bg_color_block == nullptr) && (filter_block->color_check[0]))
						{
							matched_bg_color = &filter_block->pointer_to_color_button[0]->stored_color;
							matched_bg_color_block = filter_block;

							any_detect = true;
						}

						if
							(
								(matched_text_color_block == nullptr)
								&&
								(filter_block->color_check[1])
								)
						{

							matched_text_color = &filter_block->pointer_to_color_button[1]->stored_color;

							main_text_area->set_color(filter_block->pointer_to_color_button[1]->stored_color);
							matched_text_color_block = filter_block;

							any_detect = true;
						}

						if ((matched_rama_color_block == nullptr) && (filter_block->color_check[2]))
						{
							matched_rama_color = &filter_block->pointer_to_color_button[2]->stored_color;
							matched_rama_color_block = filter_block;

							any_detect = true;
						}

						if ((matched_size_block == nullptr) && (filter_block->text_size_bool))
						{
							matched_size = &filter_block->text_size;
							matched_size_block = filter_block;

							any_detect = true;
						}

						if ((!break_detect_user) && (!break_detect_default))
						{
							matched_show_hide_block = filter_block;

							any_detect = true;
						}

						//if not continue
						if (filter_block->button_continue->selected_variant != 0)
						{
							break_detect_default = true;
						}

						if ((matched_minimap_icon_block == nullptr) && (filter_block->minimap_icon_color_suppressor_bool))
						{
							matched_minimap_icon_color = filter_block->pointer_to_minimap_icon_color_router;
							matched_minimap_icon_shape = filter_block->pointer_to_minimap_icon_shape_router;
							matched_minimap_icon_size = filter_block->pointer_to_minimap_icon_size_router;

							matched_minimap_icon_block = filter_block;

							any_detect = true;
						}



						if (any_detect) {

							matched_filter_blocks.push_back(filter_block);
						}
					}
				}

				if (break_detect_default) { break; }
			}

	//BASIC COLOURS
	for (EButtonGroup* group : _filter_block_editor->group_list)
		if
			(
				(!group->block_need_remove)
				&&
				(
					(matched_bg_color_block == nullptr)
					||
					(matched_text_color_block == nullptr)
					||
					(matched_rama_color_block == nullptr)
					||
					(matched_size_block == nullptr)
					||
					(matched_minimap_icon_color == nullptr)
					)
				&&
				(dynamic_cast<const EButtonGroupFilterBlock*>(group) != nullptr)
				&&
				(static_cast<EButtonGroupFilterBlock*>(group)->is_base_filter_block)
				)//filter block
		{
			{
				EButtonGroupFilterBlock*
					filter_block = static_cast<EButtonGroupFilterBlock*>(group);

				if (EButtonGroupLootSimulator::this_group_is_matched(this, stored_game_item, filter_block))
				{
					bool any_detect = false;






					if ((matched_bg_color_block == nullptr) && (filter_block->color_check[0]))
					{
						matched_bg_color = &filter_block->pointer_to_color_button[0]->stored_color;
						matched_bg_color_block = filter_block;

						any_detect = true;
					}

					if
						(
							(matched_text_color_block == nullptr)
							&&
							(filter_block->color_check[1])
							)
					{

						matched_text_color = &filter_block->pointer_to_color_button[1]->stored_color;

						main_text_area->set_color(filter_block->pointer_to_color_button[1]->stored_color);
						matched_text_color_block = filter_block;

						any_detect = true;
					}

					if ((matched_rama_color_block == nullptr) && (filter_block->color_check[2]))
					{
						matched_rama_color = &filter_block->pointer_to_color_button[2]->stored_color;
						matched_rama_color_block = filter_block;

						any_detect = true;
					}

					if ((matched_size_block == nullptr) && (filter_block->text_size_bool))
					{
						matched_size = &filter_block->text_size;
						matched_size_block = filter_block;

						any_detect = true;
					}

					if ((!break_detect_user) && (!break_detect_default) && (!break_detect_base))
					{
						matched_show_hide_block = filter_block;

						any_detect = true;
					}

					//if not continue
					if (filter_block->button_continue->selected_variant != 0)
					{
						break_detect_base = true;
					}

					if ((matched_minimap_icon_block == nullptr) && (filter_block->minimap_icon_color_suppressor_bool))
					{
						matched_minimap_icon_color = filter_block->pointer_to_minimap_icon_color_router;
						matched_minimap_icon_shape = filter_block->pointer_to_minimap_icon_shape_router;
						matched_minimap_icon_size = filter_block->pointer_to_minimap_icon_size_router;

						matched_minimap_icon_block = filter_block;

						any_detect = true;
					}



					if (any_detect) {

						matched_filter_blocks.push_back(filter_block);
					}
				}
			}

			if (break_detect_base) { break; }
		}
}



LootSimulatorPattern::LootSimulatorPattern()
{
}

LootSimulatorPattern::~LootSimulatorPattern()
{
	for (int i = 0; i < game_item_generator_list.size(); i++)
	{
		delete game_item_generator_list[i];
	}
	
	game_item_generator_list.clear();
	game_item_generator_list.shrink_to_fit();
}

void LootSimulatorPattern::execute_loot_pattern(LootSimulatorPattern* _pattern)
{

	//disable all attribute group configurer
	for (EButtonGroupAttributeGeneratorGroup* a_group : EWindowMain::loot_simulator_button_group->attribute_group_list)
	{
		a_group->button_group_is_active				= false;
		a_group->attribute_generator_is_active		= false;
	}

	//activate all attribute group configurer by list
	for (ID_string								id_string	: _pattern->activate_attribute_group_by_ID_string_list)				//for every ID activator
	for (EButtonGroupAttributeGeneratorGroup*	a_group		: EWindowMain::loot_simulator_button_group->attribute_group_list)	//for every existed attribute group
	{
		if (id_string.ID == a_group->name.ID)
		{
			a_group->button_group_is_active			= true;
			a_group->attribute_generator_is_active	= true;

			break;
		}
	}
	
	EWindowMain::loot_simulator_button_group->rarity_override = _pattern->rarity_override;

	//srand(time(NULL));
	//srand(std::chrono::duration_cast<std::chrono::microseconds>(std::chrono::system_clock::now().time_since_epoch()).count());
	srand(EWindowMain::loot_simulator_button_group->seed);

	EButtonGroupLootSimulator::pointer_to_loot_buttons_segment->remove_all_workspace_buttons();

	EButtonGroupLootSimulator::pointer_to_warning_group->close_this_group();
	//EButtonGroupLootSimulator::pointer_to_warning_group->button_group_is_active = false;

	for (int i = 0; i < _pattern->game_item_generator_list.size(); i++)
	{
		std::vector<EGameItem*> game_item_vector;

		_pattern->game_item_generator_list[i]->generate_game_item_list(&game_item_vector);


		//EInputCore::logger_param("WTF", game_item->attribute_container_list[0].target_attribute->localisation.base_name);

		for (EGameItem* game_item : game_item_vector)
		{
			_pattern->game_item_generator_list[i]->init_game_item(game_item, _pattern->game_item_generator_list[i]);


			EntityButtonLootItem*
				loot_item = new EntityButtonLootItem();
			loot_item->align_even_if_hidden = true;
			loot_item->do_not_generate_bg = true;



			loot_item->stored_game_item = game_item;





			std::string item_name = game_item->localised_name.localisations[ELocalisationText::active_localisation];
			if (game_item->quantity > 1) { item_name += " x" + std::to_string(game_item->quantity); }

			loot_item->make_default_button_with_unedible_text
			(
				new ERegionGabarite(512.0f, 40.0f),
				EButtonGroupLootSimulator::pointer_to_loot_buttons_segment,
				&EDataActionCollection::action_select_loot_item_button,
				ELocalisationText::generate_localization_with_base_name(item_name)
			);

			loot_item->main_text_area->offset_border[BorderSide::LEFT] = 20.0f;
			//loot_item->main_text_area->offset_by_gabarite_size_x		= 1.0f;
			//loot_item->main_text_area->offset_by_text_size_x			= -1.0f;

			//loot_item->main_clickable_area->actions_on_click_list.pu
			loot_item->main_text_area->localisation_text.localisations[NSW_localisation_EN] = game_item->localised_name.localisations[NSW_localisation_EN];
			loot_item->main_text_area->localisation_text.localisations[NSW_localisation_RU] = game_item->localised_name.localisations[NSW_localisation_RU];

			if (game_item->quantity > 1)
			{
				loot_item->main_text_area->localisation_text.localisations[NSW_localisation_EN] += " x" + std::to_string(game_item->quantity);
				loot_item->main_text_area->localisation_text.localisations[NSW_localisation_RU] += " x" + std::to_string(game_item->quantity);
			}



			loot_item->main_custom_data->actions_on_update.push_back(&EDataActionCollection::action_create_or_delete_description_on_hover);


			loot_item->get_matched_filter_blocks_list(EWindowMain::active_loot_filter_editor);

			//float size_multiplier = *loot_item->matched_size;



			loot_item->main_custom_data->actions_on_pre_draw.push_back(EDataActionCollection::action_draw_loot_button);
			EButtonGroupLootSimulator::show_hidden = true;

			//loot_item->disable_draw =
			//(
			//	(loot_item->matched_filter_blocks.empty())
			//	&&
			//	(
			//		(loot_item->matched_filter_blocks.back()->button_show_hide->selected_variant == 1)
			//		&&
			//		(loot_item->matched_filter_blocks.back()->version_routers[EButtonGroupLootSimulator::pointer_to_target_loot_filter_version_button->selected_variant]->selected_variant != 1)
			//	)
			//	||
			//	(EButtonGroupLootSimulator::show_hidden)
			//);



			EButtonGroupLootSimulator::pointer_to_loot_buttons_segment->add_button_to_working_group(loot_item);
		}
	}

	std::vector<EButtonGroupFilterBlock*> filter_block_vector;



	EButtonGroupLootSimulator::refresh_button_sizes();
	//EWindowMain::loot_simulator_button_group->delayed_execution = true;
	//EButtonGroup::refresh_button_group(EWindowMain::loot_simulator_button_group);

	EWindowMain::loot_simulator_button_group->need_refresh = true;

	//EButtonGroup::refresh_button_group(EWindowMain::loot_simulator_button_group);
	//EButtonGroup::refresh_button_group(EWindowMain::loot_simulator_button_group);
}

void LootSimulatorPattern::activate_attribute_group_by_name(std::string _name)
{
	ID_string
		new_id_string;

	new_id_string.set_ID_by_string(_name);

	activate_attribute_group_by_ID_string_list.push_back(new_id_string);
	//for (EButtonGroupAttributeGeneratorGroup* a_group : EWindowMain::loot_simulator_button_group->attribute_group_list)
	//{
	//	if (a_group->name.string_value == _name)
	//	{
	//		activate_this_attribute_group_list.push_back(a_group);

	//		break;
	//	}
	//}
}

//void LootSimulatorPattern::activate_rarity_attribute_group()
//{
//}


void EButtonGroupLootSimulator::refresh_button_sizes()
{
	for (EntityButton* but : EButtonGroupLootSimulator::pointer_to_loot_buttons_segment->workspace_button_list)
	{
		EntityButtonLootItem* loot_item = static_cast<EntityButtonLootItem*>(but);

		float size_multiplier = 0.5f;

		if (loot_item->matched_size != nullptr) { size_multiplier = (*loot_item->matched_size - 18.0f) / 27.0f; }

		if (loot_item->matched_size_block != nullptr)
		{
			int
				selected_pattern_variant
				=
				loot_item->matched_size_block->version_routers[EButtonGroupLootSimulator::pointer_to_target_loot_filter_version_button->selected_variant]->selected_variant;

			size_multiplier *= LootFilterVersionPattern::registered_loot_filter_version_patterns[selected_pattern_variant]->focus_multiplier;

			/*if
				(
					(loot_item->matched_size_block->version_routers[EButtonGroupLootSimulator::pointer_to_target_loot_filter_version_button->selected_variant]->selected_variant == 1)
					||
					(loot_item->matched_size_block->version_routers[EButtonGroupLootSimulator::pointer_to_target_loot_filter_version_button->selected_variant]->selected_variant == 2)
					)
			{
				size_multiplier *= 0.6f;
			}
			else
			if (loot_item->matched_size_block->version_routers[EButtonGroupLootSimulator::pointer_to_target_loot_filter_version_button->selected_variant]->selected_variant == 4)
			{
				size_multiplier *= 1.5f;
			}*/
		}

		float additional_left_space = 0.0f;

		if
			(
				(loot_item->matched_minimap_icon_block != nullptr)
				&&
				(loot_item->matched_minimap_icon_block->pointer_to_forcibly_disable_minimap_icon_variant_button->selected_variant == 0)
				)
		{
			float
				size_multiplier = 1.0f - loot_item->matched_minimap_icon_size->selected_variant * 0.25;

			ETextureGabarite*
				texture_gabarite = loot_item->matched_minimap_icon_shape->router_variant_list[loot_item->matched_minimap_icon_shape->selected_variant]->texture;

			additional_left_space = (float)texture_gabarite->size_x_in_pixels * size_multiplier;
		}

		size_multiplier = std::min(size_multiplier, 1.0f);

		loot_item->main_text_area->font = EFont::font_list[1];
		loot_item->main_text_area->font_scale = (0.35f + size_multiplier * 0.65f);

		loot_item->main_text_area->offset_border[BorderSide::LEFT] = additional_left_space;

		loot_item->button_gabarite->size_x = loot_item->main_text_area->get_text_width(&loot_item->main_text_area->original_text) * (0.35f + size_multiplier * 0.65f) + additional_left_space + 10.0f;
		loot_item->button_gabarite->size_y = 30.0f * (0.35f + size_multiplier * 0.65f);

		loot_item->button_gabarite->size_x = std::max(loot_item->button_gabarite->size_x, 100.0f);
		loot_item->button_gabarite->size_y = std::max(loot_item->button_gabarite->size_y, 15.0f);

		loot_item->main_text_area->change_text(loot_item->main_text_area->original_text);
	}
}

std::vector<LootSimulatorPattern*>	LootSimulatorPattern::registered_loot_simulater_pattern_list;

GameItemAttribute* GameItemAttribute::get_attribute_by_name(std::vector<GameItemAttribute*>* _vector, std::string _name)
{
	for (GameItemAttribute* game_attribute : *_vector)
	{
		if (EStringUtils::compare_ignoring_case(game_attribute->localisation.base_name, _name))
		{
			//EInputCore::logger_param("matched attribute", game_attribute->localisation.base_name);
			//EInputCore::logger_param("required attribute", _name);
			return game_attribute;
		}
	}

	EInputCore::logger_simple_error("Attribute with name [" + _name + "] not exist!");
	return nullptr;
}

EGameItemAttributeContainer* GameItemAttribute::add_new_game_attribute_by_name(EGameItem* _game_item, std::string _name)
{
	EGameItemAttributeContainer
		generated_attribute_container;

	generated_attribute_container.target_attribute = GameItemAttribute::get_attribute_by_name(&registered_game_item_attributes, _name);

	_game_item->attribute_container_list.push_back(generated_attribute_container);

	return &(_game_item->attribute_container_list.back());
}

void GameItemAttribute::add_new_listed_value_to_game_attribute(EGameItem* _game_item, std::string _name, ELocalisationText _value)
{
	EGameItemAttributeContainer*
	attribute = nullptr;

	for (int i = 0; i < _game_item->attribute_container_list.size(); i++)
	//for (EGameItemAttributeContainer searched : _game_item->attribute_container_list)
	{
		EGameItemAttributeContainer*
		searched = &(_game_item->attribute_container_list[i]);

		if (EStringUtils::compare_ignoring_case(searched->target_attribute->localisation.base_name, _name))
		{
			attribute = searched;

			break;
		}
	}

	if (attribute == nullptr) { attribute = add_new_game_attribute_by_name(_game_item, _name); }

	attribute->listed_value_list.push_back(_value);
}

void GameItemAttribute::add_new_int_value_to_game_attribute(EGameItem* _game_item, std::string _name, int _value)
{
	EGameItemAttributeContainer*
	attribute = nullptr;

	for (int i = 0; i < _game_item->attribute_container_list.size(); i++)
		//for (EGameItemAttributeContainer searched : _game_item->attribute_container_list)
	{
		EGameItemAttributeContainer*
			searched = &(_game_item->attribute_container_list[i]);

		if (EStringUtils::compare_ignoring_case(searched->target_attribute->localisation.base_name, _name))
		{
			attribute = searched;

			break;
		}
	}

	if (attribute == nullptr) { attribute = add_new_game_attribute_by_name(_game_item, _name); }

	attribute->attribute_value_int = _value;
}



void GameAttributeGeneratorQuantity::execute_generation(EGameItem* _game_item)
{
	//generator_pow = base_pow / EWindowMain::loot_simulator_button_group->MF_factor;

	//GameAttributeGeneratorMinMaxFloat::execute_generation(_game_item);



	//generate base quantity
	float
		f_quantity = 1.0f;

	//apply stack multiplier
	f_quantity *= _game_item->stack_multiplier;
	f_quantity *= EWindowMain::loot_simulator_button_group->selected_quantity;
	//clamp values
	_game_item->quantity = std::clamp(int(round(f_quantity)), 1, _game_item->max_stack_size);

	target_attribute_container->attribute_value_int = _game_item->quantity;
}

//STATIC FIELDS FOR EButtonGroupLootSimulator
bool						EButtonGroupLootSimulator::show_hidden = false;
//float						EButtonGroupLootSimulator::show_hidden_cooldown = 0.5f;
HSVRGBAColor		EButtonGroupLootSimulator::temp_color;

EButtonGroup* EButtonGroupLootSimulator::pointer_to_loot_buttons_segment;
EButtonGroup* EButtonGroupLootSimulator::pointer_to_patterns_buttons_segment;
EButtonGroup* EButtonGroupLootSimulator::pointer_to_right_side_info_buttons;
EButtonGroup* EButtonGroupLootSimulator::pointer_to_warning_group;
EButtonGroup* EButtonGroupLootSimulator::pointer_to_flag_configurator_group;

EntityButtonVariantRouter* EButtonGroupLootSimulator::pointer_to_target_loot_filter_version_button;
//EntityButton* EButtonGroupLootSimulator::pointer_to_input_area_level_button;





bool EButtonGroupLootSimulator::this_group_is_matched(EntityButtonLootItem* _loot_button, EGameItem* _game_item, EButtonGroupFilterBlock* _filter_block)
{
	bool is_matched = true;

	//for (EGameItemAttributeContainer attribute_container : _game_item->attribute_container_list)
	int
		version_select = _filter_block->version_routers[EButtonGroupLootSimulator::pointer_to_target_loot_filter_version_button->selected_variant]->selected_variant;

	LootFilterVersionPattern::PatternStruct*
		target_version_pattern = LootFilterVersionPattern::registered_loot_filter_version_patterns[version_select];

	//if (version_select == 0) { return false; }
	//if (LootFilterVersionPattern::registered_loot_filter_version_patterns[version_select].full_ignore_mode) { return false; }


	//full ignored blocks cannot be matched
	if (target_version_pattern->full_ignore_mode) { return false; }



	{

		//		NON-LISTED lines attributes
		//for each non-listed attribute
		for (EButtonGroup* group : _filter_block->pointer_to_workspace_non_listed_segment->group_list)
		{
			EButtonGroupNonListedLine*
				line_group = static_cast<EButtonGroupNonListedLine*>(group);

			GameItemAttribute*
				non_listed_attribute = line_group->target_game_attribute;

			EGameItemAttributeContainer*
				matched_item_attribute_container = nullptr;

			//non-global attribute like AreaLevel
			if (!non_listed_attribute->global_attribute_value)
			{
				// try search matched attribute (between block attribute and item attribute)
				for (int i = 0; i < _game_item->attribute_container_list.size(); i++)
				{
					EGameItemAttributeContainer*
						attr_container = &_game_item->attribute_container_list[i];

					//for (EGameItemAttributeContainer item_attribute : _game_item->attribute_container_list)
					if (attr_container->target_attribute == non_listed_attribute)
					{
						matched_item_attribute_container = attr_container;
						break;
					}
				}


				//if matched atribute exist
				if (matched_item_attribute_container != nullptr)
				{
					//number attrubite
					if
						(
							(matched_item_attribute_container->target_attribute->filter_attribute_value_type == FILTER_ATTRIBUTE_VALUE_TYPE_NUMBER)
							&&
							(non_listed_attribute->filter_attribute_value_type == FILTER_ATTRIBUTE_VALUE_TYPE_NUMBER)
							)
					{
						//have_non_listed_attribute_match = true;


						if
							(
								!is_condition_satisfied
								(
									matched_item_attribute_container->attribute_value_int,								//item
									line_group->target_button_with_condition->return_base_text_from_selected_router(),	//operator
									std::stoi(line_group->target_button_with_value->main_text_area->original_text)		//block
								)
								)
						{
							return false;
						}
					}

					//bool attribute
					if (non_listed_attribute->filter_attribute_value_type == FILTER_ATTRIBUTE_VALUE_TYPE_BOOL_SWITCHER)
					{
						bool bool_match = false;

						//if item have matched attribute, and boll flags not same, return false (block not matched)
						if
							(
								(matched_item_attribute_container->target_attribute == line_group->target_game_attribute)//matched attribute
								&&
								(matched_item_attribute_container->attribute_value_bool != *static_cast<EDataContainer_Button_BoolSwitcher*>(line_group->target_button_with_value->main_custom_data->data_container)->target_value)//bool flags not same
								)
						{
							return false;
						}//suitable attribute exist but condition not satified
					}

					//Rarity
					if (non_listed_attribute->filter_attribute_value_type == FILTER_ATTRIBUTE_VALUE_TYPE_RARITY_LIST)
					{
						if
							(
								!is_condition_satisfied
								(
									matched_item_attribute_container->attribute_value_int,															//item
									line_group->target_button_with_condition->return_base_text_from_selected_router(),								//operator
									line_group->rarity_router_button->selected_variant		//block
								)
								)
						{
							return false;
						}
					}

					//alternate quality
					if (non_listed_attribute->filter_attribute_value_type == FILTER_ATTRIBUTE_VALUE_TYPE_QUALITY_LIST)
					{
						if (!EStringUtils::compare_ignoring_case(matched_item_attribute_container->attribute_value_str, line_group->target_button_with_value->main_text_area->localisation_text.base_name)) { return false; }
					}

					//sockets group
					if (non_listed_attribute->filter_attribute_value_type == FILTER_ATTRIBUTE_VALUE_TYPE_COLOURS_TEXT)
					{

						//SOCKETS GROUP
						if
							(
								//(matched_item_attribute_container->target_attribute->localisation.base_name == "Sockets")
								//&&
								//(line_group->target_game_attribute->localisation.base_name == "Sockets")
								//&&
								(
									!is_sockets_matched
									(
										line_group->target_button_with_value->main_text_area->original_text,				//block
										line_group->target_button_with_condition->return_base_text_from_selected_router(),	//operator
										matched_item_attribute_container->attribute_value_str								//item
									)
									)
								)
						{
							return false;
						}
					}
				}
				else//"phantom" parameter (non existed parameters have value "0"/"false" (for example, chaos orb dont have attribute "MapTier", but have value "0" for this attribute, and "false" for non existed bool-attributes
				{
					if (non_listed_attribute->filter_attribute_value_type == FILTER_ATTRIBUTE_VALUE_TYPE_NUMBER)
					{
						if
							(
								!is_condition_satisfied
								(
									0,																					//item
									line_group->target_button_with_condition->return_base_text_from_selected_router(),	//operator
									std::stoi(line_group->target_button_with_value->main_text_area->original_text)		//block
								)
								)
						{
							return false;
						}
					}

					if (non_listed_attribute->filter_attribute_value_type == FILTER_ATTRIBUTE_VALUE_TYPE_RARITY_LIST)
					{
						if
							(
								!is_condition_satisfied
								(
									0,																												//item
									line_group->target_button_with_condition->return_base_text_from_selected_router(),										//operator
									line_group->rarity_router_button->selected_variant																//block
								)
								)
						{
							return false;
						}
					}

					if (non_listed_attribute->filter_attribute_value_type == FILTER_ATTRIBUTE_VALUE_TYPE_BOOL_SWITCHER)
					{
						if (*static_cast<EDataContainer_Button_BoolSwitcher*>(line_group->target_button_with_value->main_custom_data->data_container)->target_value)
						{
							return false;//block require bool-flag for attribute, which item dont have
						}
					}

					if (non_listed_attribute->filter_attribute_value_type == FILTER_ATTRIBUTE_VALUE_TYPE_QUALITY_LIST)
					{
						return false;//if item have no alternative quality, always return false
					}

					if (non_listed_attribute->filter_attribute_value_type == FILTER_ATTRIBUTE_VALUE_TYPE_COLOURS_TEXT)
					{
						if
							(
								!is_sockets_matched
								(
									line_group->target_button_with_value->main_text_area->original_text,		//block
									line_group->target_button_with_condition->return_base_text_from_selected_router(),	//operator
									"0"																			//item
								)
								)
						{
							return false;
						}
					}


				}
			}
			else
			{
				if
					(
						(non_listed_attribute->localisation.base_name == "AreaLevel")
						&&
						(
							!is_condition_satisfied
							(
								(int)(EWindowMain::loot_simulator_button_group->selected_item_level),					//blobal parameter "AreaLevel"
								line_group->target_button_with_condition->return_base_text_from_selected_router(),		//condition operator
								std::stoi(line_group->target_button_with_value->main_text_area->original_text)			//block value
							)
							)
						)
				{
					return false;
				}
			}

		}

		//		LISTED
		for (EButtonGroup* button_group : _filter_block->pointer_to_listed_attributes->group_list)
		{
			EButtonGroupListedBlock* listed_block = static_cast<EButtonGroupListedBlock*>(button_group);

			bool this_listed_match = false;

			int listed_match_count = 0;


			//search suitable attribute in item
			for (EGameItemAttributeContainer item_attribute : _game_item->attribute_container_list)
				if
					(
						(
							EStringUtils::compare_ignoring_case
							(
								item_attribute.target_attribute->localisation.base_name,	//item
								listed_block->filter_attribute_name							//block
							)
							||
							(false)
							)
						)
				{
					/*std::cout << std::endl;
					std::cout << std::endl;
					std::cout << item_attribute.target_attribute->localisation.base_name << " " << data_container->filter_attribute_name << std::endl;*/
					//any_listed_match = true;

					//		FOR EVERY BLOCK ITEM
					for (EntityButton* filter_block_button : listed_block->section_for_wide_item_buttons->workspace_button_list)
						for (ELocalisationText dropped_item_attribute : item_attribute.listed_value_list)
						{
							std::string filter_block_button_attribute_name = "";

							EDataContainer_DataEntityHolder*
								data_container_entity = static_cast<EDataContainer_DataEntityHolder*>(filter_block_button->main_custom_data->data_container);


							//		GET ITEM NAME (FROM FILTER BLOCK)
							if (data_container_entity->stored_data_entity != nullptr)
							{
								filter_block_button_attribute_name = DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::base_name, data_container_entity->stored_data_entity);

								if (filter_block_button_attribute_name == "")
								{
									filter_block_button_attribute_name = DataEntityUtils::get_tag_value_by_name_ID(0, &ERegisteredStrings::name_EN, data_container_entity->stored_data_entity);
								}
							}
							else
							{
								filter_block_button_attribute_name = filter_block_button->main_text_area->original_text;
							}

							if
								(
									//		PATRIALLY MATCH
									(
										(listed_block->matching_mode_router_button != nullptr)
										&&
										(listed_block->matching_mode_router_button->selected_variant == 0)
										&&
										EStringUtils::A_contains_B_ignore_case
										(
											dropped_item_attribute.base_name,	//item
											filter_block_button_attribute_name	//block

										)
										)
									||
									//		EXACT MATCH
									(
										(
											(listed_block->matching_mode_router_button == nullptr)
											||
											(listed_block->matching_mode_router_button->selected_variant == 1)
											)
										&&
										(
											dropped_item_attribute.base_name	//item
											==
											filter_block_button_attribute_name		//block
											)
										)
									)
							{


								//EInputCore::logger_simple_info("A: " + dropped_item_attribute.base_name + " B: " + filter_block_button_attribute_name);
								listed_match_count++;

								//if (item_attribute.target_attribute->localisation.base_name == "")
								_loot_button->suitable_buttons_list.push_back(filter_block_button);


								if (!listed_block->associated_item_attribute->have_input_field_for_listed)
								{
									this_listed_match = true;
									break;
								}
							}



						}

					if ((listed_block->associated_item_attribute->have_input_field_for_listed) && (listed_block->input_field != nullptr))
					{
						std::string input_field_value = ">=1";

						if (listed_block->input_field->main_text_area->original_text != "") { input_field_value = listed_block->input_field->main_text_area->original_text; }

						if (!is_condition_sactified_for_listed_expression(input_field_value, listed_match_count))
						{
							return false;
						}
						else
						{
							this_listed_match = true;
						}
					}
				}

			if (!this_listed_match) { return false; }
		}
	}

	return true;
	//return is_matched;
}

bool EButtonGroupLootSimulator::is_condition_satisfied(int _left, std::string _operator, int _right)
{
	if ((_operator == "=") && (_left == _right)) { return true; }
	if ((_operator == "==") && (_left == _right)) { return true; }
	if ((_operator == "!") && (_left != _right)) { return true; }
	if ((_operator == "!=") && (_left != _right)) { return true; }

	if ((_operator == ">=") && (_left >= _right)) { return true; }
	if ((_operator == "<=") && (_left <= _right)) { return true; }

	if ((_operator == "<") && (_left < _right)) { return true; }
	if ((_operator == ">") && (_left > _right)) { return true; }

	return false;
}

bool EButtonGroupLootSimulator::is_sockets_matched(std::string _block, std::string _operator, std::string _item)
{
	int sockets_count_block = 0;
	int red_count_block = 0;
	int green_count_block = 0;
	int blue_count_block = 0;
	int white_count_block = 0;
	int abyss_count_block = 0;
	int delve_count_block = 0;

	int sockets_count_item = 0;
	int red_count_item = 0;
	int green_count_item = 0;
	int blue_count_item = 0;
	int white_count_item = 0;
	int abyss_count_item = 0;
	int delve_count_item = 0;

	for (int i = 0; i < _block.length(); i++)
	{

		if
			(
				(_block[i] == '0')
				||
				(_block[i] == '1')
				||
				(_block[i] == '2')
				||
				(_block[i] == '3')
				||
				(_block[i] == '4')
				||
				(_block[i] == '5')
				||
				(_block[i] == '6')
				)
		{
			sockets_count_block = std::stoi(&_block[i]);
		}

		if (_block[i] == 'R') { red_count_block++; }
		if (_block[i] == 'G') { green_count_block++; }
		if (_block[i] == 'B') { blue_count_block++; }
		if (_block[i] == 'W') { white_count_block++; }

		if (_block[i] == 'A') { abyss_count_block++; }
		if (_block[i] == 'D') { delve_count_block++; }
	}

	for (int i = 0; i < _item.length(); i++)
	{

		if
			(
				(_item[i] == '0')
				||
				(_item[i] == '1')
				||
				(_item[i] == '2')
				||
				(_item[i] == '3')
				||
				(_item[i] == '4')
				||
				(_item[i] == '5')
				||
				(_item[i] == '6')
				)
		{
			sockets_count_item = std::stoi(&_item[i]);
		}

		if (_item[i] == 'R') { red_count_item++; }
		if (_item[i] == 'G') { green_count_item++; }
		if (_item[i] == 'B') { blue_count_item++; }
		if (_item[i] == 'W') { white_count_item++; }
		if (_item[i] == 'A') { abyss_count_item++; }
		if (_item[i] == 'D') { delve_count_item++; }
	}

	if
		(
			(sockets_count_block > 0)
			&&
			(!is_condition_satisfied(sockets_count_item, _operator, sockets_count_block))
			)
	{
		return false;
	}


	if
		(
			(red_count_block > 0)
			&&
			(!is_condition_satisfied(red_count_item, _operator, red_count_block))
			)
	{
		return false;
	}


	if
		(
			(green_count_block > 0)
			&&
			(!is_condition_satisfied(green_count_item, _operator, green_count_block))
			)
	{
		return false;
	}


	if
		(
			(blue_count_block > 0)
			&&
			(!is_condition_satisfied(blue_count_item, _operator, blue_count_block))
			)
	{
		return false;
	}


	if
		(
			(white_count_block > 0)
			&&
			(!is_condition_satisfied(white_count_item, _operator, white_count_block))
			)
	{
		return false;
	}


	if
		(
			(abyss_count_block > 0)
			&&
			(!is_condition_satisfied(abyss_count_item, _operator, abyss_count_block))
			)
	{
		return false;
	}


	if
		(
			(delve_count_block > 0)
			&&
			(!is_condition_satisfied(delve_count_item, _operator, delve_count_block))
			)
	{
		return false;
	}


	return true;
}

void EButtonGroupLootSimulator::clear_loot_simulator()
{
	//EButtonGroupLootSimulator::pointer_to_warning_group->button_group_is_active = false;
	EButtonGroupLootSimulator::pointer_to_warning_group->close_this_group();
	pointer_to_loot_buttons_segment->remove_all_workspace_buttons();
}

void EButtonGroupLootSimulator::refresh_loot_simulator()
{
	if (EWindowMain::loot_simulator_button_group->button_group_is_active)
	{
		//EButtonGroupLootSimulator::pointer_to_warning_group->button_group_is_active = false;
		EButtonGroupLootSimulator::pointer_to_warning_group->close_this_group();

		EInputCore::logger_simple_info("refresh loot simulator");

		//EButtonGroupLootSimulator::show_hidden = true;
		//EButtonGroupLootSimulator::show_hidden_cooldown = 0.0f;

		for (EntityButton* button : pointer_to_loot_buttons_segment->workspace_button_list)
		{


			button->entity_disabled = false;

			EntityButtonLootItem*
			loot_button = static_cast<EntityButtonLootItem*>(button);

			loot_button->matched_show_hide_block = nullptr;

			loot_button->matched_bg_color = nullptr;
			loot_button->matched_bg_color_block = nullptr;

			loot_button->matched_text_color = nullptr;
			loot_button->matched_text_color_block = nullptr;

			loot_button->matched_rama_color = nullptr;
			loot_button->matched_rama_color_block = nullptr;





			loot_button->matched_minimap_icon_block = nullptr;

			loot_button->matched_minimap_icon_color = nullptr;
			loot_button->matched_minimap_icon_shape = nullptr;
			loot_button->matched_minimap_icon_size = nullptr;


			loot_button->matched_size_block = nullptr;




			loot_button->matched_filter_blocks.clear();
			loot_button->suitable_buttons_list.clear();

			loot_button->get_matched_filter_blocks_list(EWindowMain::active_loot_filter_editor);
		}

		refresh_button_sizes();

		//EButtonGroup::change_group(pointer_to_loot_buttons_segment);
		pointer_to_loot_buttons_segment->need_change = true;
	}

}

bool EButtonGroupLootSimulator::is_condition_sactified_for_listed_expression(std::string _expression, int _matches_count)
{
	//expression length cannot  be lesser that 2 (minimum expression for examle "=1", if expression less, then expression have no number or operator
	if (_expression.length() < 2) { EInputCore::logger_simple_error("expression [" + _expression + "] have wrong length. Length cannot be lesser than 2");  return false; }

	std::string condition_operator = "";
	int value = 0;
	if
		(
			(_expression.substr(0, 2) == ">=")
			||
			(_expression.substr(0, 2) == "<=")

			)
	{
		condition_operator = _expression.substr(0, 2);
		value = std::stoi(_expression.substr(2, _expression.length() - 2));
	}
	else
		if
			(
				(_expression[0] == '=')
				||
				(_expression[0] == '<')
				||
				(_expression[0] == '>')
				||
				(_expression[0] == '!')
				)
		{
			condition_operator = _expression[0];
			value = std::stoi(_expression.substr(1, _expression.length() - 1));
		}
		else
		{
			EInputCore::logger_simple_error("expression [" + _expression + "] contains wrong condition operator"); return false;
		}






	//if (_expression.substr(0, 2) == "<=") { condition_operator = "<="; }

	//EInputCore::logger_param("_matches_count", _matches_count);
	//EInputCore::logger_param("condition_operator", condition_operator);
	//EInputCore::logger_param("value", value);
	//std::cout << std::endl;

	return is_condition_satisfied(_matches_count, condition_operator, value);
}

void EButtonGroupLootSimulator::button_group_update(float _d)
{
	warning_cooldown -= _d;

	if (warning_cooldown <= 0.0f)
	{
		warning_cooldown += 0.5f;

		warning_sign_show_flag = !warning_sign_show_flag;
	}

	if ((delayed_execution) && (!EInputCore::MOUSE_BUTTON_LEFT) && (pointer_to_patterns_buttons_segment->selected_button != nullptr))
	{
		delayed_execution = false;

		EntityButtonLootPatternSelector*
			patter_button = static_cast<EntityButtonLootPatternSelector*>(pointer_to_patterns_buttons_segment->selected_button);

		LootSimulatorPattern::execute_loot_pattern(patter_button->target_pattern);
	}

	EButtonGroup::button_group_update(_d);
	//show_hidden_cooldown -= _d;

	//if (show_hidden_cooldown <= 0.0f)
	if
		(
			(EInputCore::key_pressed(GLFW_KEY_LEFT_ALT) && (!show_hidden))
			||
			(!EInputCore::key_pressed(GLFW_KEY_LEFT_ALT) && (show_hidden))
			||
			(
				(pointer_to_patterns_buttons_segment->selected_button != nullptr)
				&&
				(static_cast<EntityButtonLootPatternSelector*>(pointer_to_patterns_buttons_segment->selected_button)->target_pattern->always_show)
				)
			)
	{
		show_hidden = EInputCore::key_pressed(GLFW_KEY_LEFT_ALT);

		//if (show_hidden) { show_hidden_cooldown += 0.75f; }
		//else { show_hidden_cooldown += 0.25f; }

		int
			version_selected = 0;

		bool
			loot_is_visible = true;

		LootFilterVersionPattern::PatternStruct*
			target_version_pattern = nullptr;

		
		for (EntityButton* button : pointer_to_loot_buttons_segment->workspace_button_list)
		{
			EntityButtonLootItem*
			loot_button = static_cast<EntityButtonLootItem*>(button);
			
			if (loot_button->matched_show_hide_block != nullptr)
			{
				version_selected = loot_button->matched_show_hide_block->version_routers[EButtonGroupLootSimulator::pointer_to_target_loot_filter_version_button->selected_variant]->selected_variant;
				target_version_pattern = LootFilterVersionPattern::registered_loot_filter_version_patterns[version_selected];

				if (loot_button->matched_show_hide_block != nullptr)
				{
					loot_is_visible =
						(
							//full ignored
							(!target_version_pattern->full_ignore_mode)
							&&
							//if forcibly enabled, loot always not hiden
							(
								(target_version_pattern->show_hide_mode == (int)(LootFilterVersionPattern::LootPatternParameterMode::FORCIBLY_ENABLE))
								||
								(
									//block selected as show
									(loot_button->matched_show_hide_block->button_show_hide->selected_variant == 1)//selected show variant on filter block
									&&
									//filter pattern NOT [forcibly hidden]
									(target_version_pattern->show_hide_mode != (int)(LootFilterVersionPattern::LootPatternParameterMode::FORCIBLY_DISABLE))
									)
								)
							);
				}
				else
				{
					loot_is_visible = false;
				}

				//loot_is_visible = true;

				//loot show or hide?
				button->entity_disabled =
					!(
						(loot_is_visible)//filter block set up show, or version pattern always show
						||
						(show_hidden)//alt button pressed
						||
						(loot_button->stored_game_item->warn_when_hidden)//item always show
						);


				//WARN WHEN HIDDEN
				if
					(
						(!loot_is_visible)//loot hidden
						&&
						(loot_button->stored_game_item->warn_when_hidden)
						&&
						(!EButtonGroupLootSimulator::pointer_to_warning_group->button_group_is_active)
						)
				{
					EButtonGroupLootSimulator::pointer_to_warning_group->button_group_is_active = true;
					EWindowMain::loot_simulator_button_group->need_refresh = true;
				}

				if (!button->entity_is_active()) { button->destroy_attached_description(); }
			}
		}
	}
}

void EButtonGroupLootSimulator::generate_info_buttons_for_right_side(EntityButtonLootItem* _loot_button)
{
	//pointer_to_right_side_info_buttons->remove_all_workspace_buttons();





	//std::string key_string = "";
	//create_info_button(_loot_button->matched_size_block, "button_matched_size_block");

	//create_info_button(_loot_button->matched_bg_color_block, "button_matched_bg_color_block");
	//create_info_button(_loot_button->matched_rama_color_block, "button_matched_rama_color_block");
	//create_info_button(_loot_button->matched_text_color_block, "button_matched_text_color_block");

	//create_info_button(_loot_button->matched_minimap_icon_block, "button_matched_minimap_icon_block");
	////create_info_button(_loot_button->matched_minimap_icon_shape_block,	"button_matched_minimap_icon_shape_block");
	////create_info_button(_loot_button->matched_minimap_icon_size_block,	"button_matched_minimap_icon_size_block");


	//create_info_button(_loot_button->matched_show_hide_block, "button_matched_show_hide_block");

	//pointer_to_right_side_info_buttons->need_change = true;
}

void EButtonGroupLootSimulator::create_info_button(EButtonGroupFilterBlock* _filter_block, std::string _key)
{
	if (_filter_block != nullptr)
	{
		EntityButtonLootItemSuitableBlocks*
			but = new EntityButtonLootItemSuitableBlocks();

		but->make_default_button_with_unedible_text
		(
			new ERegionGabarite(150.0f, 25.0f),
			pointer_to_right_side_info_buttons,
			&EDataActionCollection::action_highlight_stored_block,
			ELocalisationText::get_localisation_by_key(_key)
		);

		but->target_filter_block = _filter_block;
		but->can_be_stretched = true;
		but->highlight_time = 0.5f;

		pointer_to_right_side_info_buttons->add_button_to_working_group(but);
	}
}

void GameAttributeGeneratorMapInfluence::execute_generation(EGameItem* _game_item)
{
	switch (rand() % 6)
	{
		//elder
	case 0:
	{
		ELocalisationText l_text;
		l_text.base_name = "Elder";
		l_text.localisations[NSW_localisation_EN] = "Elder";
		l_text.localisations[NSW_localisation_RU] = "Древнего";

		target_attribute_container->listed_value_list.push_back(l_text);

		EGameItemAttributeContainer new_container;

		new_container.target_attribute = GameItemAttribute::get_attribute_by_name(&registered_game_item_attributes, "ElderItem");
		new_container.attribute_value_bool = true;
		_game_item->attribute_container_list.push_back(new_container);

		break;
	}

	//shaper
	case 1:
	{
		ELocalisationText l_text;
		l_text.base_name = "Shaper";
		l_text.localisations[NSW_localisation_EN] = "Shaper";
		l_text.localisations[NSW_localisation_RU] = "Создателя";

		target_attribute_container->listed_value_list.push_back(l_text);

		EGameItemAttributeContainer new_container;

		new_container.target_attribute = GameItemAttribute::get_attribute_by_name(&registered_game_item_attributes, "ShaperItem");
		new_container.attribute_value_bool = true;
		_game_item->attribute_container_list.push_back(new_container);

		break;
	}

	//Redeemer
	case 2:
	{
		ELocalisationText l_text;
		l_text.base_name = "Redeemer";
		l_text.localisations[NSW_localisation_EN] = "Redeemer";
		l_text.localisations[NSW_localisation_RU] = "Избавительницы";

		target_attribute_container->listed_value_list.push_back(l_text);

		break;
	}

	//Warlord
	case 3:
	{
		ELocalisationText l_text;
		l_text.base_name = "Warlord";
		l_text.localisations[NSW_localisation_EN] = "Warlord";
		l_text.localisations[NSW_localisation_RU] = "Вождя";

		target_attribute_container->listed_value_list.push_back(l_text);

		break;
	}

	//Hunter
	case 4:
	{
		ELocalisationText l_text;
		l_text.base_name = "Hunter";
		l_text.localisations[NSW_localisation_EN] = "Hunter";
		l_text.localisations[NSW_localisation_RU] = "Охотника";

		target_attribute_container->listed_value_list.push_back(l_text);

		break;
	}

	//Crusader
	case 5:
	{
		ELocalisationText l_text;
		l_text.base_name = "Crusader";
		l_text.localisations[NSW_localisation_EN] = "Crusader";
		l_text.localisations[NSW_localisation_RU] = "Крестоносца";

		target_attribute_container->listed_value_list.push_back(l_text);

		break;
	}

	default: {}


	}
}

void GameAttributeGeneratorItemInfluence::execute_generation(EGameItem* _game_item)
{
	//if (rand() % 100 < (int)(influence_chance * 100.0f))
	switch (rand() % 6)
	{
		//elder
	case 0:
	{
		ELocalisationText l_text;
		l_text.base_name = "Elder";
		l_text.localisations[NSW_localisation_EN] = "Elder";
		l_text.localisations[NSW_localisation_RU] = "Древний";

		target_attribute_container->listed_value_list.push_back(l_text);

		break;
	}

	//shaper
	case 1:
	{
		ELocalisationText l_text;
		l_text.base_name = "Shaper";
		l_text.localisations[NSW_localisation_EN] = "Shaper";
		l_text.localisations[NSW_localisation_RU] = "Создателя";

		target_attribute_container->listed_value_list.push_back(l_text);

		//икуфлж
		break;
	}

	//Redeemer
	case 2:
	{
		ELocalisationText l_text;
		l_text.base_name = "Redeemer";
		l_text.localisations[NSW_localisation_EN] = "Redeemer";
		l_text.localisations[NSW_localisation_RU] = "Избавительницы";

		target_attribute_container->listed_value_list.push_back(l_text);

		break;
	}

	//Warlord
	case 3:
	{
		ELocalisationText l_text;
		l_text.base_name = "Warlord";
		l_text.localisations[NSW_localisation_EN] = "Warlord";
		l_text.localisations[NSW_localisation_RU] = "Вождя";

		target_attribute_container->listed_value_list.push_back(l_text);

		break;
	}

	//Hunter
	case 4:
	{
		ELocalisationText l_text;
		l_text.base_name = "Hunter";
		l_text.localisations[NSW_localisation_EN] = "Hunter";
		l_text.localisations[NSW_localisation_RU] = "Охотника";

		target_attribute_container->listed_value_list.push_back(l_text);

		break;
	}

	//Crusader
	case 5:
	{
		ELocalisationText l_text;
		l_text.base_name = "Crusader";
		l_text.localisations[NSW_localisation_EN] = "Crusader";
		l_text.localisations[NSW_localisation_RU] = "Крестоносца";

		target_attribute_container->listed_value_list.push_back(l_text);

		break;
	}

	default: {}


	}
}

void GameAttributeGeneratorExactListedValue::execute_generation(EGameItem* _game_item)
{
	target_attribute_container->listed_value_list = exact_values_list;
}

void GameAttributeGeneratorBoolFlag::execute_generation(EGameItem* _game_item)
{
	if (rand() % 100 < (int)(chance_to_activate * 100.0f))
	{
		target_attribute_container->attribute_value_bool = true;
	}
	else
	{
		target_attribute_container->attribute_value_bool = false;
	}
}

void GameAttributeGeneratorRarity::execute_generation(EGameItem* _game_item)
{

	//generator_pow = base_pow / EWindowMain::loot_simulator_button_group->MF_factor;
	//GameAttributeGeneratorMinMaxInt::execute_generation(_game_item);

	//not pre-defined rarity
	if (_game_item->rarity == -1)
	{
		_game_item->rarity = EWindowMain::loot_simulator_button_group->selected_rarity;
		_game_item->rarity = std::clamp(_game_item->rarity, 0, 3);
	}

	target_attribute_container->attribute_value_int = _game_item->rarity;
}

DescriptionContainerSeparatorExample::~DescriptionContainerSeparatorExample()
{
}

void DescriptionContainerSeparatorExample::create_description()
{
	DescriptionContainer::create_description();

	if (parent_button != nullptr)
	{
		EButtonGroupSeparatorExample*
			whole_group = new EButtonGroupSeparatorExample
			(
				new ERegionGabarite
				(
					size_x,
					size_y
				)
			);

		whole_group->init_as_root_group(parent_button->parent_button_group->root_group->parent_window);
		whole_group->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_dynamic_autosize);
		whole_group->need_refresh = true;

		EButtonGroup*
			bottom_side_for_preview = whole_group->add_group(new EButtonGroup(new ERegionGabarite(size_x, size_y)));
		bottom_side_for_preview->init_button_group(EGUIStyle::active_style, BrickStyleID::NONE, bgroup_without_slider);
		bottom_side_for_preview->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_dynamic_autosize);
		bottom_side_for_preview->child_align_direction = ChildElementsAlignDirection::TOP_TO_BOTTOM;


		EButtonGroup*
			top_sider_for_text = whole_group->add_group(new EButtonGroup(new ERegionGabarite(size_x, 50.0f)));
		top_sider_for_text->init_button_group(EGUIStyle::active_style, BrickStyleID::NONE, bgroup_without_slider);
		top_sider_for_text->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_static_autosize);
		top_sider_for_text->add_default_clickable_region_with_text_area(localisation_text);

		parent_button->parent_button_group->root_group->parent_window->button_group_list.push_back(whole_group);
		parent_button->attached_description = whole_group;

		ELocalisationText
			separator_names[3];

		separator_names[0].localisations[NSW_localisation_EN] = "Currency";
		separator_names[0].localisations[NSW_localisation_RU] = "Валюта";

		separator_names[1].localisations[NSW_localisation_EN] = "Heist tool";
		separator_names[1].localisations[NSW_localisation_RU] = "Инструменты кражи";

		separator_names[2].localisations[NSW_localisation_EN] = "Top bases";
		separator_names[2].localisations[NSW_localisation_RU] = "Хорошие базы";

		std::string
			block_wide_button_tags[3][2];

		block_wide_button_tags[0][0] = "Tainted currency";
		block_wide_button_tags[0][1] = "Currency shard";

		block_wide_button_tags[1][0] = "Heist tool";
		block_wide_button_tags[1][1] = "Best heist tool";

		block_wide_button_tags[2][0] = "Top tier base";
		block_wide_button_tags[2][1] = "Rare base";

		for (int i = 0; i < 3; i++)
		{







			EButtonGroupFilterBlockSeparator*
				sep = EWindowMain::create_filter_block_separator(bottom_side_for_preview, -1);
			sep->pointer_to_description_button->main_text_area->localisation_text = separator_names[i];
			sep->pointer_to_description_button->main_text_area->change_text(separator_names[i].localisations[ELocalisationText::active_localisation]);




			for (int j = 0; j < 2; j++)
			{
				EButtonGroup*
					fb = new EButtonGroup(new ERegionGabarite(120.0f, 50.0f));
				fb->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DEFAULT, bgroup_with_slider);
				fb->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_static_autosize);
				fb->debug_name = "Whole filter block";
				fb->focusable_for_select = true;
				if (j == 0) { fb->additional_y_distance = 16.0f; }

				bottom_side_for_preview->add_group(fb);


				//SEARCH SUITABLE GAME ITEMS

				int item_count = 0;



				for (EDataEntity* data_entity : EDataEntity::data_entity_global_list)
					if (item_count < 3)
					{
						if (DataEntityUtils::is_exist_tag_by_name_and_value(0, "item tag", block_wide_button_tags[i][j], data_entity))
						{
							EntityButtonWideItem* wide_button = EntityButtonWideItem::create_wide_item_button
							(
								new ERegionGabarite(150.0f, 40.0f),
								bottom_side_for_preview,
								data_entity,
								EFont::font_list[0],
								true
							);

							//wide_button->can_be_stretched = true;

							fb->add_button_to_working_group(wide_button);


							//if (item_count >= 2) { break; }

							item_count++;
						}
					}


				if (i == 0)
				{
					whole_group->separators_list.push_back(sep);
					whole_group->blocks_for_hide_list.push_back(fb);
				}
			}
		}

		init_description(whole_group);
	}
}

void EButtonGroupSeparatorExample::button_group_update(float _d)
{
	EButtonGroup::button_group_update(_d);

	cooldown_time -= _d;

	if (cooldown_time <= 0.0f)
	{
		separators_status = !separators_status;
		cooldown_time += 1.0f;

		//bool sep_bool = 
		for (EButtonGroupFilterBlockSeparator* sep : separators_list)
		{
			sep->is_expanded = separators_status;
		}


		for (EButtonGroup* group : blocks_for_hide_list)
		{
			group->button_group_is_active = separators_status;
		}

		need_refresh = true;

	}


}

EntityButtonLootItemSuitableBlocks::EntityButtonLootItemSuitableBlocks()
{
}

EntityButtonLootItemSuitableBlocks::~EntityButtonLootItemSuitableBlocks()
{
}

void GameAttributeGeneratorItemLevel::execute_generation(EGameItem* _game_item)
{
	//GameAttributeGenerator::execute_generation(_game_item);

	//ETextArea*
	//number_text = EWindowMain::loot_simulator_button_group->pointer_to_input_area_level_button->main_text_area;

	//if (EStringUtils::if_text_is_number(number_text->original_text))
	//{
	//	target_attribute_container->attribute_value_int = std::stoi(number_text->original_text) + target_attribute_container->attribute_value_int;
	//	target_attribute_container->attribute_value_int = std::clamp(target_attribute_container->attribute_value_int, 0, 100);
	//}



	target_attribute_container->attribute_value_int
		=
		std::clamp
		(
			(int)(round(EWindowMain::loot_simulator_button_group->selected_item_level)),
			1,
			100
		);

}

void GameAttributeGeneratorMinMaxFloat::execute_generation(EGameItem* _game_item)
{
	float generated_value = min_value + (max_value - min_value) * pow((rand() % 1001) / 1000.0f, generator_pow);

	target_attribute_container->attribute_value_float = generated_value;
}

void GameAttributeGeneratorQuality::execute_generation(EGameItem* _game_item)
{
	generator_pow = base_pow / EWindowMain::loot_simulator_button_group->MF_factor;

	GameAttributeGeneratorMinMaxInt::execute_generation(_game_item);
}

EntityButtonForUndefinedAttribute::EntityButtonForUndefinedAttribute()
{
}

EntityButtonForUndefinedAttribute::~EntityButtonForUndefinedAttribute()
{
}

EntityButtonFilterBlockError::EntityButtonFilterBlockError()
{
}

EntityButtonFilterBlockError::~EntityButtonFilterBlockError()
{
}

EntityButtonFilterBlockError* EntityButtonFilterBlockError::add_error_button_to_error_list(ERegionGabarite* _gabarite, EButtonGroupFilterBlock* _filter_block, ELocalisationText _ltext)
{
	EntityButtonFilterBlockError*
		error_button = new EntityButtonFilterBlockError();

	error_button->make_default_button_with_unedible_text
	(
		_gabarite,
		EWindowMain::registered_group_filter_error_list->part_with_buttons,
		&EDataActionCollection::action_highlight_block_with_error,
		_ltext
	);

	error_button->target_filter_block = _filter_block;

	EWindowMain::registered_group_filter_error_list->part_with_buttons->add_button_to_working_group(error_button);

	error_button->can_be_stretched = true;

	return error_button;
}

EButtonGroupLootFilterErrors::~EButtonGroupLootFilterErrors()
{
}

void EButtonGroupLootFilterErrors::check_errors()
{
	bool any_error = false;

	if (EWindowMain::active_loot_filter_editor != nullptr)
	{
		EWindowMain::registered_group_filter_error_list->part_with_buttons->remove_all_workspace_buttons();
		for (EButtonGroup* group : EWindowMain::active_loot_filter_editor->group_list)
			if (EButtonGroupFilterBlock* block = dynamic_cast<EButtonGroupFilterBlock*>(group))
			{
				EButtonGroupFilterBlock*
					filter_block = static_cast<EButtonGroupFilterBlock*>(group);

				for (EntityButton* but : filter_block->pointer_to_attribute_tab->workspace_button_list)
				{
					EntityButtonAttributeTab*
						tab_button = static_cast<EntityButtonAttributeTab*>(but);



					if (tab_button->is_undefined)
					{
						any_error = true;

						ELocalisationText ltext;
						ltext = ELocalisationText::get_localisation_by_key("button_loot_filter_error_undefined_attribute");
						ltext.add_text_to_all_languages(" [" + tab_button->main_text_area->stored_text + "]");

						EntityButtonFilterBlockError::add_error_button_to_error_list
						(
							new ERegionGabarite(300.0f, 30.0f),
							filter_block,
							ltext
						);
					}


				}
			}


	}

	if (any_error)
	{
		//EWindowMain::registered_group_filter_error_list->status_text_area.se
		EWindowMain::registered_group_filter_error_list->set_status_error();
	}
	else
	{
		EWindowMain::registered_group_filter_error_list->set_status_fine();
	}

	EWindowMain::registered_group_filter_error_list->need_refresh = true;
}

void EButtonGroupLootFilterErrors::set_status_error()
{
	status_text_area->set_color(0.8f, 0.5f, 0.25f, 1.0f);
	status_text_area->localisation_text = ELocalisationText::get_localisation_by_key("description_loot_filter_errors");
	status_text_area->update_localisation();
}

void EButtonGroupLootFilterErrors::set_status_fine()
{
	status_text_area->set_color(0.25f, 0.8f, 0.5f, 1.0f);
	status_text_area->localisation_text = ELocalisationText::get_localisation_by_key("description_loot_filter_no_errors");
	status_text_area->update_localisation();
}

bool EntityButtonLootPatternSelector::entity_is_active()
{
	return (EntityButton::entity_is_active()) && (!hidden_by_folder);
}

bool EntityButtonFilterRule::entity_is_active()
{
	return EntityButton::entity_is_active() && (!hidden_by_folder);
}

void EButtonGroupSocketPreview::draw_button_group()
{
	if (icon_texture != nullptr)
	{
		EColor_4 color_table[6][4];

		for (int i = 0; i < 4; i++)
		{
			color_table[SocketColorEnum::SOCKET_COLOR_ENUM_RED][i] = NS_EColorUtils::COLOR_RED[i];
			color_table[SocketColorEnum::SOCKET_COLOR_ENUM_GREEN][i] = NS_EColorUtils::COLOR_GREEN[i];
			color_table[SocketColorEnum::SOCKET_COLOR_ENUM_BLUE][i] = NS_EColorUtils::COLOR_BLUE[i];
			color_table[SocketColorEnum::SOCKET_COLOR_ENUM_WHITE][i] = NS_EColorUtils::COLOR_WHITE[i];
			color_table[SocketColorEnum::SOCKET_COLOR_ENUM_DELVE][i] = NS_EColorUtils::COLOR_YELLOW[i];
			color_table[SocketColorEnum::SOCKET_COLOR_ENUM_ABYSS][i] = NS_EColorUtils::COLOR_BLACK[i];
		}


		short	link_offset_correction_array_x[5]{ 1, 0, -1, 0, 1 };
		short	link_offset_correction_array_y[5]{ 0, 1, 0, 1, 0 };



		float	socket_size_x = NS_DefaultGabarites::texture_socket->size_x_in_pixels;
		float	socket_size_y = NS_DefaultGabarites::texture_socket->size_y_in_pixels;

		float	link_size_x = 20.0f;
		float	link_size_y = 8.0f;

		bool	left_side = true;

		int		y_descent = 0;

		int		sockets_count_x = std::min(stored_game_item->sockets_count, 2);
		int		sockets_count_y = ceil(stored_game_item->sockets_count / 2.0f);



		float socket_group_size_x = socket_size_x * sockets_count_x + link_size_x * std::max(sockets_count_x - 1, 0);
		float socket_group_size_y = socket_size_y * sockets_count_y + link_size_x * std::max(sockets_count_y - 1, 0);

		float socket_group_full_size_x = socket_size_y * 2 + link_size_x + 10.0f;
		float socket_group_full_size_y = socket_size_y * 3 + link_size_x * 2 + 10.0f;



		float socket_group_offset_x = (region_gabarite->size_x - socket_group_size_x) / 2.0f;
		float socket_group_offset_y = (region_gabarite->size_y - socket_group_size_y) / 2.0f;

		float socket_group_full_offset_x = (region_gabarite->size_x - socket_group_full_size_x) / 2.0f;
		float socket_group_full_offset_y = (region_gabarite->size_y - socket_group_full_size_y) / 2.0f;

		float socket_offset_x = 0.0f;
		float socket_offset_y = 0.0f;

		float link_offset_x = 0.0f;
		float link_offset_y = 0.0f;

		float link_offset_correction_x = 0.0f;
		float link_offset_correction_y = 0.0f;

		float final_link_size_x = 0.0f;
		float final_link_size_y = 0.0f;


		//		item icon
		float offset_x = 0.0f;
		float offset_y = 0.0f;

		float size_multiplier_x = std::min(socket_group_full_size_x / icon_texture->size_x_in_pixels, 1.0f);
		float size_multiplier_y = std::min(socket_group_full_size_y / icon_texture->size_y_in_pixels, 1.0f);
		float final_size_multiplier = std::min(size_multiplier_x, size_multiplier_y);

		offset_x = socket_group_full_offset_x + (socket_group_full_size_x - icon_texture->size_x_in_pixels * final_size_multiplier) / 2.0f;
		offset_y = socket_group_full_offset_y + (socket_group_full_size_y - icon_texture->size_y_in_pixels * final_size_multiplier) / 2.0f;

		NS_EGraphicCore::set_active_color(NS_EColorUtils::COLOR_WHITE);

		ERenderBatcher::if_have_space_for_data(NS_EGraphicCore::default_batcher_for_drawing, 1);
		NS_ERenderCollection::add_data_to_vertex_buffer_textured_rectangle_with_custom_size
		(
			NS_EGraphicCore::default_batcher_for_drawing->vertex_buffer,
			NS_EGraphicCore::default_batcher_for_drawing->last_vertice_buffer_index,

			//x pos
			region_gabarite->world_position_x + offset_x,

			//y pos
			region_gabarite->world_position_y + offset_y,

			icon_texture->size_x_in_pixels * final_size_multiplier,
			icon_texture->size_y_in_pixels * final_size_multiplier,

			icon_texture
		);



		//		SOCKETS RAMA
		NS_EGraphicCore::set_active_color_custom_alpha(NS_EColorUtils::COLOR_WHITE, 0.2f);

		ERenderBatcher::if_have_space_for_data(NS_EGraphicCore::default_batcher_for_drawing, 4);
		NS_ERenderCollection::add_data_to_vertex_buffer_rama
		(
			NS_EGraphicCore::default_batcher_for_drawing->vertex_buffer,
			NS_EGraphicCore::default_batcher_for_drawing->last_vertice_buffer_index,

			//x pos
			region_gabarite->world_position_x + socket_group_full_offset_x,

			//y pos
			region_gabarite->world_position_y + socket_group_full_offset_y,

			socket_group_full_size_x,
			socket_group_full_size_y,

			2.0f,

			NS_DefaultGabarites::texture_gabarite_white_pixel
		);





		//		SOCKETS AND LINKS
		if (!EInputCore::key_pressed(GLFW_KEY_LEFT_ALT))
			for (int i = 0; i < stored_game_item->sockets_count; i++)
			{
				(left_side) ? (socket_offset_x = 0.0f) : (socket_offset_x = socket_group_size_x - socket_size_x);




				//LINK
				if
					(
						(i < 5)
						&&
						(i < stored_game_item->links_count - 1)
						)
				{
					//is horizontal?
					if ((i + 1) % 2 != 0)
					{
						final_link_size_x = link_size_x + 8.0f;
						final_link_size_y = link_size_y;
					}
					else
					{
						final_link_size_x = link_size_y;
						final_link_size_y = link_size_x + 8.0f;
					}
					float link_offset_correction_x = (socket_size_x - final_link_size_x) / 2.0f;
					float link_offset_correction_y = (socket_size_y - final_link_size_y) / 2.0f;

					//is horizontal?
					//if ((i + 1) % 2 != 0)
					{
						link_offset_x = socket_offset_x;
						link_offset_y = socket_offset_y;

						if (link_offset_correction_array_x[i] > 0) { link_offset_x += socket_size_x - 4.0f; }
						else
							if (link_offset_correction_array_x[i] < 0) { link_offset_x -= final_link_size_x - 4.0f; }
							else
							{
								link_offset_x += link_offset_correction_x;
							}

						if (link_offset_correction_array_y[i] == 0)
						{
							link_offset_y += link_offset_correction_y;
						}
						else
						{
							link_offset_y += socket_size_y;
						}

						//link_offset_x += final_link_size_x * link_offset_correction_array_x[i];
						//link_offset_y += final_link_size_y * link_offset_correction_array_y[i];
					}

					NS_EGraphicCore::set_active_color(NS_EColorUtils::COLOR_BRIGHT_LEAD);

					ERenderBatcher::if_have_space_for_data(NS_EGraphicCore::default_batcher_for_drawing, 1);
					NS_ERenderCollection::add_data_to_vertex_buffer_textured_rectangle_with_custom_size
					(
						NS_EGraphicCore::default_batcher_for_drawing->vertex_buffer,
						NS_EGraphicCore::default_batcher_for_drawing->last_vertice_buffer_index,

						//x pos
						region_gabarite->world_position_x + socket_group_offset_x + link_offset_x,

						//y pos
						region_gabarite->world_position_y + socket_group_offset_y + link_offset_y,

						final_link_size_x,
						final_link_size_y,

						NS_DefaultGabarites::texture_gabarite_white_pixel
					);
				}




				//SOCKET
				NS_EGraphicCore::set_active_color
				(
					color_table[stored_game_item->socket_color_id_array[i]][0],
					color_table[stored_game_item->socket_color_id_array[i]][1],
					color_table[stored_game_item->socket_color_id_array[i]][2],
					color_table[stored_game_item->socket_color_id_array[i]][3]
				);

				ERenderBatcher::if_have_space_for_data(NS_EGraphicCore::default_batcher_for_drawing, 1);
				NS_ERenderCollection::add_data_to_vertex_buffer_textured_rectangle_with_custom_size
				(
					NS_EGraphicCore::default_batcher_for_drawing->vertex_buffer,
					NS_EGraphicCore::default_batcher_for_drawing->last_vertice_buffer_index,

					//x pos
					region_gabarite->world_position_x + socket_group_offset_x + socket_offset_x,

					//y pos
					region_gabarite->world_position_y + socket_group_offset_y + socket_offset_y,

					socket_size_x,
					socket_size_y,

					NS_DefaultGabarites::texture_socket
				);







				//even 2 socket
				if ((i + 1) % 2 == 0)
				{
					socket_offset_y += socket_size_y + std::max(link_size_x, link_size_y);
				}
				else
				{
					left_side = !left_side;
				}

				if (left_side)
				{

				}
			}
	}
}

void EButtonGroupPreviewBox::draw_button_group()
{
	EButtonGroup::draw_button_group();
	float box_size_y = 25.0f;
	if (true)
	{
		float
			icon_correction = (pointer_to_filter_block_group->minimap_icon_color_suppressor_bool) ? (region_gabarite->size_y) : (0.0f);

		float
			box_size_x = region_gabarite->size_x - icon_correction;

		EButtonGroupFilterBlock*
			d_con = pointer_to_filter_block_group;

		float
			font_size_rescale = 0.4f + ((d_con->text_size - 18.0f) / 27.0f) * 0.6f;

		float
			rescale_factor
			=
			std::min
			(
				(box_size_x * font_size_rescale) / (float)(example_text_texture[0]->size_x_in_pixels + 6.0f),
				(region_gabarite->size_y * font_size_rescale) / (float)(example_text_texture[0]->size_y_in_pixels + 6.0f)
			);

		rescale_factor = std::min(rescale_factor, 2.0f);

		int array_id = round(1.0f - rescale_factor);

		//rescale_factor *= font_size_rescale;

		float
			pos_x = region_gabarite->world_position_x + icon_correction - icon_correction * (1.0f - font_size_rescale) / 2.0f;



		float
			pos_y = region_gabarite->world_position_y;

		pos_x += (box_size_x * (1.0f - font_size_rescale)) / 2.0f;
		//pos_x += box_size_x * (1.0f - font_size_rescale) * 0.5f;

		//pos_y += box_size_y * (1.0f - font_size_rescale) * 0.5f;
		pos_y += (region_gabarite->size_y * (1.0f - font_size_rescale)) / 2.0f;

		//static background
		if (pointer_to_filter_block_group->color_check[0])
		{
			NS_EGraphicCore::set_active_color(NS_EColorUtils::COLOR_WHITE);
			ERenderBatcher::if_have_space_for_data(NS_EGraphicCore::default_batcher_for_drawing, 1);
			NS_ERenderCollection::add_data_to_vertex_buffer_textured_rectangle_with_custom_size
			(
				NS_EGraphicCore::default_batcher_for_drawing->vertex_buffer,
				NS_EGraphicCore::default_batcher_for_drawing->last_vertice_buffer_index,

				//x pos
				pos_x,

				//y pos
				pos_y,

				box_size_x * font_size_rescale,
				region_gabarite->size_y * font_size_rescale,

				example_text_bg
			);
		}

		float box_x = pos_x;
		float box_y = pos_y;


		//		PREVIEW BACKGROUND
		if (pointer_to_filter_block_group->color_check[0])
		{
			NS_EGraphicCore::set_active_color(*d_con->pointer_to_HRA_color[0]);
			ERenderBatcher::if_have_space_for_data(NS_EGraphicCore::default_batcher_for_drawing, 1);
			NS_ERenderCollection::add_data_to_vertex_buffer_textured_rectangle_with_custom_size
			(
				NS_EGraphicCore::default_batcher_for_drawing->vertex_buffer,
				NS_EGraphicCore::default_batcher_for_drawing->last_vertice_buffer_index,

				//x pos
				pos_x,

				//y pos
				pos_y,

				box_size_x * font_size_rescale,
				region_gabarite->size_y * font_size_rescale,

				NS_DefaultGabarites::texture_gabarite_white_pixel

			);
		}

		//		PREVIEW TEXT
		if (pointer_to_filter_block_group->color_check[1])
		{
			NS_EGraphicCore::set_active_color(*d_con->pointer_to_HRA_color[1]);
			ERenderBatcher::if_have_space_for_data(NS_EGraphicCore::default_batcher_for_drawing, 1);
			NS_ERenderCollection::add_data_to_vertex_buffer_textured_rectangle_with_custom_size
			(
				NS_EGraphicCore::default_batcher_for_drawing->vertex_buffer,
				NS_EGraphicCore::default_batcher_for_drawing->last_vertice_buffer_index,

				//x pos
				pos_x + (box_size_x * font_size_rescale - example_text_texture[0]->size_x_in_pixels * rescale_factor) / 2.0f,

				//y pos
				pos_y + (region_gabarite->size_y * font_size_rescale - example_text_texture[0]->size_y_in_pixels * rescale_factor) / 2.0f - 1.0f * font_size_rescale,

				example_text_texture[0]->size_x_in_pixels * rescale_factor,
				example_text_texture[0]->size_y_in_pixels * rescale_factor,

				example_text_texture[array_id]
			);
		}

		//		PREVIEW RAMA
		if (pointer_to_filter_block_group->color_check[2])
		{
			NS_EGraphicCore::set_active_color(*d_con->pointer_to_HRA_color[2]);
			ERenderBatcher::if_have_space_for_data(NS_EGraphicCore::default_batcher_for_drawing, 1);
			NS_ERenderCollection::add_data_to_vertex_buffer_rama
			(
				NS_EGraphicCore::default_batcher_for_drawing->vertex_buffer,
				NS_EGraphicCore::default_batcher_for_drawing->last_vertice_buffer_index,

				//x pos
				pos_x,

				//y pos
				pos_y,

				box_size_x * font_size_rescale,
				region_gabarite->size_y * font_size_rescale,

				2.0f * (font_size_rescale * 0.5f + 0.5f),

				NS_DefaultGabarites::texture_gabarite_white_pixel

			);
		}




		//		MINIMAP ICON PREVIEW
		if (pointer_to_filter_block_group->minimap_icon_color_suppressor_bool)
		{
			EntityButtonVariantRouter* shape_router_button = pointer_to_filter_block_group->pointer_to_minimap_icon_shape_router;
			RouterVariant* shape_router = (shape_router_button->router_variant_list[shape_router_button->selected_variant]);


			EntityButtonVariantRouter* color_router_button = pointer_to_filter_block_group->pointer_to_minimap_icon_color_router;
			RouterVariant* color_router = (color_router_button->router_variant_list[color_router_button->selected_variant]);


			EntityButtonVariantRouter* size_router_button = pointer_to_filter_block_group->pointer_to_minimap_icon_size_router;



			rescale_factor = region_gabarite->size_y / (float)(shape_router->texture->size_y_in_pixels);

			rescale_factor *= 1.0f - 0.25f * size_router_button->selected_variant;

			rescale_factor = std::max(rescale_factor, 0.25f);
			rescale_factor = std::min(rescale_factor, 1.0f);

			float shape_x_size = shape_router->texture->size_x_in_pixels * rescale_factor;

			NS_EGraphicCore::set_active_color(color_router->text_color);
			ERenderBatcher::if_have_space_for_data(NS_EGraphicCore::default_batcher_for_drawing, 1);
			NS_ERenderCollection::add_data_to_vertex_buffer_textured_rectangle_with_custom_size
			(
				NS_EGraphicCore::default_batcher_for_drawing->vertex_buffer,
				NS_EGraphicCore::default_batcher_for_drawing->last_vertice_buffer_index,

				//x pos
				box_x - shape_x_size - 1.0f,

				//y pos
				region_gabarite->world_position_y + 0.0f,

				shape_x_size,
				shape_router->texture->size_y_in_pixels * rescale_factor,

				shape_router->texture
			);
		}

		if (pointer_to_filter_block_group->pointer_to_ray_preview_segment != nullptr)
		{
			pos_x = pointer_to_filter_block_group->pointer_to_ray_preview_segment->region_gabarite->world_position_x;
			pos_x += (pointer_to_filter_block_group->pointer_to_ray_preview_segment->region_gabarite->size_x - NS_DefaultGabarites::texture_ray->size_x_in_pixels) / 2.0f;

			pos_y = pointer_to_filter_block_group->pointer_to_ray_preview_segment->region_gabarite->world_position_y;

			if (pointer_to_filter_block_group->ray_suppressor)
			{
				EntityButtonVariantRouter* ray_color_router = pointer_to_filter_block_group->pointer_to_ray_color_router;

				NS_EGraphicCore::set_active_color(ray_color_router->router_variant_list[ray_color_router->selected_variant]->text_color);

				ERenderBatcher::if_have_space_for_data(NS_EGraphicCore::default_batcher_for_drawing, 1);
				NS_ERenderCollection::add_data_to_vertex_buffer_textured_rectangle_with_custom_size
				(
					NS_EGraphicCore::default_batcher_for_drawing->vertex_buffer,
					NS_EGraphicCore::default_batcher_for_drawing->last_vertice_buffer_index,

					//x pos
					pos_x,

					//y pos
					pos_y,

					NS_DefaultGabarites::texture_ray->size_x_in_pixels,
					NS_DefaultGabarites::texture_ray->size_y_in_pixels,


					NS_DefaultGabarites::texture_ray
				);
			}
		}
	}
}

DataEntityTagFilter* DataEntityTagFilter::add_new_suitable_value(std::string _value, ELocalisationText _ltext)
{
	DETF_Value
		new_value;

	new_value.target_value_key.set_ID_by_string(_value);
	new_value.localised_attribute_name = _ltext;

	new_value.text_color.set_color_RGBA(1.0f, 0.9f, 0.8f, 1.0f);

	suitable_values.push_back(new_value);

	return this;
}

void DataEntityTagFilter::set_text_color(float _r, float _g, float _b, float _a)
{
	suitable_values.back().text_color.set_color_RGBA(_r, _g, _b, _a);
}

void DataEntityTagFilter::add_force_field()
{
	suitable_values.back().force_field = true;
}

ID_string ID_string::register_new_unique_ID_by_key(std::string _string)
{
	int
		hash_id = EStringUtils::get_id_by_hash(EStringUtils::to_lower(_string));

	for (int i = 0; i < ID_string_array_size; i++)
	{
		if (HASHED_registered_ID_strings[hash_id][i].is_empty)
		{
			ID_string::register_new_ID_string(i, _string);

			return HASHED_registered_ID_strings[hash_id][i];
		}
	}

	ID_string
		empty_ID_string;

	empty_ID_string.is_empty = true;

	return empty_ID_string;
}

void ID_string::set_ID_by_string(std::string _string)
{
	std::string
		lowered = EStringUtils::to_lower(_string);
	//_string = EStringUtils::to_lower(_string);

	int
		hash_id = EStringUtils::get_id_by_hash(lowered);

	bool success = false;

	//if (_string == "Rarity")
	//{
	//	_string = _string;
	//}

	for (int i = 0; i < ID_string_array_size_for_hash; i++)
	{

		//create new one
		if (HASHED_registered_ID_strings[hash_id][i].is_empty)//empty = free
		{
			//if (_string == "Rarity")
			//{
			//	_string = _string;
			//}

			ID = last_registered_id;
			//last_registered_id++;

			string_value = _string;
			is_empty = false;

			register_new_ID_string(i, _string);

			success = true;

			//if (_string == "Rarity")
			//{
			//	_string = _string;
			//}

			break;
		}
		else//search for registered strings
			if (EStringUtils::to_lower(HASHED_registered_ID_strings[hash_id][i].string_value) == lowered)//already existed
			{
				ID = HASHED_registered_ID_strings[hash_id][i].ID;
				//last_registered_id++;

				string_value = _string;
				is_empty = false;

				//std::cout << green << "Registeren new unique ID_string. ID=" << yellow << ID << green << " value={" << yellow << string_value << std::endl;

				success = true;

				//if (_string == "Rarity")
				//{
				//	_string = _string;
				//}

				break;
			}
	}

	if (!success)
	{
		EInputCore::logger_simple_error("Too many ID_string in [" + std::to_string(hash_id) + "], string <" + _string + ">");
	}
}




DataEntityTagFilter* DataEntityTagFilter::add_new_banned_value(std::string _value, ELocalisationText _ltext)
{
	DETF_Value
		new_value;

	new_value.target_value_key.set_ID_by_string(_value);
	new_value.localised_attribute_name = _ltext;

	new_value.text_color.set_color_RGBA(1.0f, 0.5f, 0.25f, 1.0f);

	banned_tags.push_back(new_value);

	return this;
}


////////////////////////////////////////////////

namespace DataEntityFilterConfigurer
{
	std::vector <EntityButtonVariantRouterPatternConfigurer*>
	router_button_vector_for_loot_simulator[ROUTER_BUTTON_VECTOR_SIZE];
	
	std::vector <EntityButtonVariantRouterPatternConfigurer*>
	router_button_vector_for_data_entity_filter[ROUTER_BUTTON_VECTOR_SIZE];

	int
	router_button_vector_id_for_loot_simulator = 0;

	int
	router_button_vector_id_for_data_entity_filter = 0;
}
////////////////////////////////////////////////

void DataEntityFilterConfigurer::create_configurer_buttons(DataEntityTagFilter* _tag_filter, DETFConfigurerMode _mode, EButtonGroup* _target_group)
{
	EntityButtonVariantRouterPatternConfigurer*
		last_button = nullptr;

	//router_button_vector_id = 0;
	if (_tag_filter->can_be_configured)
		for (int i = 0; i < _tag_filter->suitable_values.size(); i++)
		{
			DETF_Value*
				detf = &(_tag_filter->suitable_values[i]);


			last_button = new EntityButtonVariantRouterPatternConfigurer();

			_target_group->add_button_to_working_group(last_button);

			last_button->target_tag_filter = _tag_filter;
			last_button->target_group_with_configurer_buttons = _target_group;
			last_button->DETF_mode = _mode;



			if (detf->localised_attribute_name.localisations[NSW_localisation_EN] == "")
			{
				detf->localised_attribute_name = ELocalisationText::generate_localization_with_base_name(detf->target_value_key.string_value);
			}

			last_button->make_as_default_router_variant_button(new ERegionGabarite(150.0f, 22.0f));

			last_button->add_router_variant_with_localization_color_and_icon
			(
				&detf->localised_attribute_name,
				"",
				detf->text_color.r * 0.40f,
				detf->text_color.g * 0.35f,
				detf->text_color.b * 0.3f,
				detf->text_color.a,
				nullptr
			);

			last_button->add_router_variant_with_localization_color_and_icon
			(
				&detf->localised_attribute_name,
				"",
				detf->text_color.r,
				detf->text_color.g,
				detf->text_color.b,
				detf->text_color.a,
				nullptr
			);

			last_button->main_text_area->set_align_to_left_middle();

			last_button->select_variant((int)(detf->DETF_is_active));

			last_button->target_bool_value = &(detf->DETF_is_active);

			if (_mode == DETFConfigurerMode::LOOT_GENERATOR_PATTERN)
			{
				last_button->router_button_vector_pointer = &(router_button_vector_for_loot_simulator[router_button_vector_id_for_loot_simulator]);
				router_button_vector_for_loot_simulator[router_button_vector_id_for_loot_simulator].push_back(last_button);
			}
			else
			if(_mode == DETFConfigurerMode::DATA_ENTITY_FILTER)
			{
				last_button->router_button_vector_pointer = &(router_button_vector_for_data_entity_filter[router_button_vector_id_for_data_entity_filter]);
				router_button_vector_for_data_entity_filter[router_button_vector_id_for_data_entity_filter].push_back(last_button);
			}

			if (detf->force_field) { last_button->force_field_up = 12.0f; }

			//but->make_default_bool_switcher_button_with_unedible_text
			//(
			//	new ERegionGabarite(150.0f, 22.0f),
			//	EButtonGroupLootSimulator::pointer_to_flag_configurator_group,
			//	EDataActionCollection::action_switch_boolean_value,
			//	NS_DefaultGabarites::texture_bool_switcher_activated_box,
			//	NS_DefaultGabarites::texture_bool_switcher_deactivated_box,
			//	//detf->localised_attribute_name,
			//	ELocalisationText::generate_localization_with_base_name(detf->target_value),
			//	&(detf->is_active)
			//);
			last_button->can_be_stretched = true;

			//but->main_clickable_area->actions_on_click_list.push_back
			//(
			//	(_mode == DETFConfigurerMode::LOOT_GENERATOR_PATTERN)
			//	?
			//	(&EDataActionCollection::action_refresh_loot_simulator)
			//	:
			//	(&EDataActionCollection::action_refresh_loot_simulator)
			//);

			last_button->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_change_selection_of_tag_configurer);









		}

	if (last_button != nullptr) { last_button->force_field_up = 24.0f; }

	if
	(
		(_tag_filter->can_be_configured)
		&&
		(!_tag_filter->merge_with_prev)
	)
	{
		if (_mode == DETFConfigurerMode::LOOT_GENERATOR_PATTERN)
		{
			router_button_vector_id_for_loot_simulator++;
		}
		else
		if (_mode == DETFConfigurerMode::DATA_ENTITY_FILTER)
		{
			router_button_vector_id_for_data_entity_filter++;
		}
	}
}

void DataEntityFilterConfigurer::clear_router_vector(DETFConfigurerMode _mode)
{
	if (_mode == DETFConfigurerMode::LOOT_GENERATOR_PATTERN)
	{
		router_button_vector_id_for_loot_simulator = 0;

		for (int i = 0; i < ROUTER_BUTTON_VECTOR_SIZE; i++)
		{
			router_button_vector_for_loot_simulator[i].clear();
		}
	}
	else
	if (_mode == DETFConfigurerMode::DATA_ENTITY_FILTER)
	{
		router_button_vector_id_for_data_entity_filter = 0;

		for (int i = 0; i < ROUTER_BUTTON_VECTOR_SIZE; i++)
		{
			router_button_vector_for_data_entity_filter[i].clear();
		}
	}
}

void NSWRegisteredButtonGroups::register_filter_block_colors_group_for_filter_block()
{

	filter_block_colors = new EButtonGroupFilterBlockColors(new ERegionGabarite(350.0f, 350.0f));

	filter_block_colors->auto_superfocused = true;
	filter_block_colors->button_group_is_active = false;

	//filter_block_colors->button_group_is_active = false;
	filter_block_colors->init_as_root_group(EWindowMain::link_to_main_window);

	EDataContainer_VerticalNamedSlider* pointer_to_data;

	EButtonGroup*
		workspace_part = filter_block_colors->add_close_group_and_return_workspace_group(new ERegionGabarite(100.0f, 20.0f), EGUIStyle::active_style);
	workspace_part->child_align_mode = ChildAlignMode::ALIGN_HORIZONTAL;

	//left size for configure
	////////////////////////////////////////////////////////////////////////////
	EButtonGroup*
		left_part = workspace_part->add_group(new EButtonGroup(new ERegionGabarite(150.0f, 256.0f)));
	left_part->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DEFAULT, bgroup_without_slider);
	left_part->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_static_autosize, NSW_dynamic_autosize);
	////////////////////////////////////////////////////////////////////////////

			//slider	[Value]	[Alpha]
			////////////////////////////////////////////////////////////////////////////
	EButtonGroup*
		value_alpha_part = left_part->add_group(EButtonGroup::create_button_group_without_bg(new ERegionGabarite(150.0f, 70.0f), EGUIStyle::active_style));
	value_alpha_part->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_static_autosize);

	filter_block_colors->pointer_to_VA_slider_group = value_alpha_part;
	////////////////////////////////////////////////////////////////////////////

	//slider	hair slider Hue Saturation
	////////////////////////////////////////////////////////////////////////////
	EButtonGroup*
		hair_HS_slider_part = left_part->add_group(EButtonGroup::create_button_group_without_bg(new ERegionGabarite(150.0f, 150.0f), EGUIStyle::active_style));
	hair_HS_slider_part->init_button_group(EGUIStyle::active_style, BrickStyleID::NONE, bgroup_without_slider);
	hair_HS_slider_part->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_static_autosize);

	filter_block_colors->pointer_to_hair_slider_group = hair_HS_slider_part;
	////////////////////////////////////////////////////////////////////////////

	//cosmetic element	rama text BG
	////////////////////////////////////////////////////////////////////////////
	EButtonGroup*
		cosmetic_element_part = left_part->add_group(EButtonGroup::create_button_group_without_bg(new ERegionGabarite(150.0f, 64.0f), EGUIStyle::active_style));
	cosmetic_element_part->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_static_autosize);

	filter_block_colors->pointer_to_cosmetic_element_group = cosmetic_element_part;
	////////////////////////////////////////////////////////////////////////////

	//preview box
	////////////////////////////////////////////////////////////////////////////
	EButtonGroup*
		preview_box_part = left_part->add_group(EButtonGroup::create_button_group_without_bg(new ERegionGabarite(150.0f, 32.0f), EGUIStyle::active_style));
	preview_box_part->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_dynamic_autosize);

	filter_block_colors->pointer_to_preview_group = preview_box_part;
	////////////////////////////////////////////////////////////////////////////







	//right size for patterns
	////////////////////////////////////////////////////////////////////////////
	EButtonGroup*
		right_part = workspace_part->add_group(new EButtonGroup(new ERegionGabarite(150.0f, 256.0f)));
	right_part->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DEFAULT, bgroup_with_slider);
	right_part->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_dynamic_autosize);
	////////////////////////////////////////////////////////////////////////////

			//bottom group for control
			////////////////////////////////////////////////////////////////////////////
	EButtonGroup*
		color_pattern_control_part = right_part->add_group(new EButtonGroup(new ERegionGabarite(150.0f, 25.0f)));
	color_pattern_control_part->init_button_group(EGUIStyle::active_style, BrickStyleID::NONE, bgroup_with_slider);
	color_pattern_control_part->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_static_autosize);
	////////////////////////////////////////////////////////////////////////////

	//up group for color patterns
	////////////////////////////////////////////////////////////////////////////
	EButtonGroup*
		color_patterns_button_group = right_part->add_group(new EButtonGroup(new ERegionGabarite(150.0f, 25.0f)));
	color_patterns_button_group->init_button_group(EGUIStyle::active_style, BrickStyleID::GROUP_DEFAULT, bgroup_with_slider);
	color_patterns_button_group->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_dynamic_autosize);

	filter_block_colors->pointer_to_color_pattern_group = color_patterns_button_group;
	////////////////////////////////////////////////////////////////////////////





//add group to group list
	filter_block_colors->need_refresh = true;
	EWindowMain::link_to_main_window->button_group_list.push_back(filter_block_colors);



	////////////////////////////////////////////////////////////////////////////
	//buttons for SA group
	////////////////////////////////////////////////////////////////////////////
	EntityButton*
		alpha_slider = EntityButton::create_horizontal_named_slider
		(

			new ERegionGabarite(350.0f, 35.0f),
			value_alpha_part,
			EFont::font_list[0],
			EGUIStyle::active_style,
			ELocalisationText::get_localisation_by_key("slider_color_a")
		);
	filter_block_colors->color_slider_alpha = alpha_slider;

	alpha_slider->can_be_stretched = true;
	pointer_to_data = static_cast<EDataContainer_VerticalNamedSlider*>(alpha_slider->main_custom_data->data_container);

	pointer_to_data->pointer_to_value = new float(1.0f);
	pointer_to_data->min_value = 0.0f;
	pointer_to_data->mid_value = 0.5f;
	pointer_to_data->max_value = 1.0f;

	value_alpha_part->add_button_to_working_group(alpha_slider);





	EntityButton*
		value_slider = EntityButton::create_horizontal_named_slider
		(

			new ERegionGabarite(350.0f, 35.0f),
			value_alpha_part,
			EFont::font_list[0],
			EGUIStyle::active_style,
			ELocalisationText::get_localisation_by_key("slider_color_v")
		);
	filter_block_colors->color_slider_value = value_slider;

	value_slider->can_be_stretched = true;
	pointer_to_data = static_cast<EDataContainer_VerticalNamedSlider*>(value_slider->main_custom_data->data_container);

	pointer_to_data->pointer_to_value = new float(1.0f);
	pointer_to_data->min_value = 0.0f;
	pointer_to_data->mid_value = 0.5f;
	pointer_to_data->max_value = 1.0f;

	value_alpha_part->add_button_to_working_group(value_slider);
	////////////////////////////////////////////////////////////////////////////







	////////////////////////////////////////////////////////////////////////////
	//buttons for SA group
	////////////////////////////////////////////////////////////////////////////
	EntityButton*
		crosshair_slider = EntityButton::create_default_crosshair_slider
		(
			new ERegionGabarite(150.0f, 150.0f),
			hair_HS_slider_part,
			&NS_EGraphicCore::sun_x,
			&NS_EGraphicCore::sun_y,
			"hue_saturation"
		);
	crosshair_slider->can_be_stretched = true;
	filter_block_colors->color_hair_slider_hue_saturation = crosshair_slider;

	EDataContainer_CrosshairSlider* crosshair_data = (EDataContainer_CrosshairSlider*)EntityButton::get_last_custom_data(crosshair_slider)->data_container;
	crosshair_data->min_x = 0.0f;
	crosshair_data->max_x = 360.0f;

	crosshair_data->min_y = 0.0f;
	crosshair_data->max_y = 1.0f;

	hair_HS_slider_part->add_button_to_working_group(crosshair_slider);
	////////////////////////////////////////////////////////////////////////////



	////////////////////////////////////////////////////////////////////////////
	//buttons for SA group
	////////////////////////////////////////////////////////////////////////////
	EntityButtonCosmeticElement*
		cosmetic_element_button = new EntityButtonCosmeticElement();

	//BG
	cosmetic_element_button->make_default_button_with_unedible_text
	(
		new ERegionGabarite(150.0f, 20.0f),
		cosmetic_element_part,
		&EDataActionCollection::action_select_cosmetic_element,
		ELocalisationText::get_localisation_by_key("cosmetic_element_bg")
	);
	cosmetic_element_button->can_be_stretched = true;
	cosmetic_element_part->add_button_to_working_group(cosmetic_element_button);
	filter_block_colors->cosmetic_element_button_bg = cosmetic_element_button;

	//TEXT
	cosmetic_element_button = new EntityButtonCosmeticElement();
	cosmetic_element_button->make_default_button_with_unedible_text
	(
		new ERegionGabarite(150.0f, 20.0f),
		cosmetic_element_part,
		&EDataActionCollection::action_select_cosmetic_element,
		ELocalisationText::get_localisation_by_key("cosmetic_element_text")
	);
	cosmetic_element_button->can_be_stretched = true;
	cosmetic_element_part->add_button_to_working_group(cosmetic_element_button);
	filter_block_colors->cosmetic_element_button_text = cosmetic_element_button;

	//RAMA
	cosmetic_element_button = new EntityButtonCosmeticElement();
	cosmetic_element_button->make_default_button_with_unedible_text
	(
		new ERegionGabarite(150.0f, 20.0f),
		cosmetic_element_part,
		&EDataActionCollection::action_select_cosmetic_element,
		ELocalisationText::get_localisation_by_key("cosmetic_element_rama")
	);
	cosmetic_element_button->can_be_stretched = true;
	cosmetic_element_part->add_button_to_working_group(cosmetic_element_button);
	filter_block_colors->cosmetic_element_button_rama = cosmetic_element_button;









	EntityButtonNewColorPattern*
		new_color_button = new EntityButtonNewColorPattern();
	new_color_button->make_default_button_with_unedible_text
	(
		new ERegionGabarite(150.0f, 20.0f),
		color_pattern_control_part,
		&EDataActionCollection::action_create_new_color,
		ELocalisationText::get_localisation_by_key("button_create_color_pattern")

	);
	new_color_button->can_be_stretched = true;

	new_color_button->target_button_group = color_patterns_button_group;
	new_color_button->pointer_to_color = &(filter_block_colors->target_color);

	color_pattern_control_part->add_button_to_working_group(new_color_button);


	filter_block_colors->generate_color_pattern_buttons();


	//filter_block_colors->activate_move_to_foreground_and_center();
}

void NSWRegisteredButtonGroups::register_explicit_for_loot_simulator_group()
{
	add_explicit_to_simulator = new EButtonGroupAddExplicitToLootSimulatorItem(new ERegionGabarite(300.0f, 400.0f));
	add_explicit_to_simulator->auto_superfocused = true;
	add_explicit_to_simulator->init_as_root_group(EWindowMain::link_to_main_window);
	add_explicit_to_simulator->button_group_is_active = false;
	//WORKSPACE PART
	EButtonGroup*
	workspace_part = add_explicit_to_simulator->add_close_group_and_return_workspace_group(new ERegionGabarite(100.0f, 20.0f), EGUIStyle::active_style);
	workspace_part->child_align_mode = ChildAlignMode::ALIGN_VERTICAL;

	add_explicit_to_simulator->need_refresh = true;
	EWindowMain::link_to_main_window->button_group_list.push_back(add_explicit_to_simulator);


	//PART WITH DATA_ENTITY
	EButtonGroup*
		part_with_data_entity = new EButtonGroup(new ERegionGabarite(300.0f, 300.0f));
	part_with_data_entity->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_dynamic_autosize);
	part_with_data_entity->init_button_group(EGUIStyle::active_style, BrickStyleID::NONE, bgroup_with_slider);
	workspace_part->add_group(part_with_data_entity);

	//SEARCH BAR
	EButtonGroup*
		search_group = new EButtonGroup(new ERegionGabarite(300.0f, 30.0f));
	search_group->set_parameters(ChildAlignMode::ALIGN_VERTICAL, NSW_dynamic_autosize, NSW_static_autosize);
	search_group->init_button_group(EGUIStyle::active_style, BrickStyleID::NONE, bgroup_with_slider);
	workspace_part->add_group(search_group);

	{
		EntityButtonMultiSearch*
			button_multisearch = new EntityButtonMultiSearch();

		button_multisearch->make_default_button_with_edible_text
		(
			new ERegionGabarite(add_explicit_to_simulator->region_gabarite->size_x, 30.0f),
			search_group,
			nullptr,
			""
		);

		button_multisearch->main_text_area->gray_text = ELocalisationText();
		button_multisearch->main_text_area->gray_text.localisations[NSW_localisation_EN] = "Filter attributes";
		button_multisearch->main_text_area->gray_text.localisations[NSW_localisation_RU] = "Поиск по названию";

		button_multisearch->can_be_stretched = true;

		button_multisearch->target_group_list.push_back(part_with_data_entity);

		button_multisearch->main_text_area->action_on_change_text.push_back(&EDataActionCollection::action_type_text_multiblock_searcher);

		search_group->add_button_to_working_group(button_multisearch);
	}

	for (EDataEntity* explicit_data_entity : EWindowMain::registered_data_entity_explicit_list)
	{
		EntityButtonWideItem*
		wide_button = EntityButtonWideItem::create_wide_item_button
		(
			new ERegionGabarite(add_explicit_to_simulator->region_gabarite->size_x, 40.0f),
			part_with_data_entity,
			explicit_data_entity,
			EFont::font_list[0],
			false
		);

		wide_button->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_select_this_affix_for_loot_simulator);
		//wide_button->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_refresh_loot_simulator);
		

		part_with_data_entity->add_button_to_working_group(wide_button);
	}
}
void EButtonGroupFilterBlockColors::draw_button_group()
{
	EButtonGroup::draw_button_group();

	//if (pointer_to_cosmetic_element_group == nullptr)
	//{

	//}
	//else
	{
		float pos_x = pointer_to_preview_group->region_gabarite->world_position_x;
		float pos_y = pointer_to_preview_group->region_gabarite->world_position_y;
		float size_x = pointer_to_preview_group->region_gabarite->size_x;
		float size_y = pointer_to_preview_group->region_gabarite->size_y - pointer_to_preview_group->group_border_texture_bottom - pointer_to_preview_group->group_border_texture_up;

		EntityButtonCosmeticElement*
			selected_cosmetic_button = static_cast<EntityButtonCosmeticElement*>(pointer_to_cosmetic_element_group->selected_button);

		//BACKGROUND
		if ((cosmetic_element_button_bg != nullptr) && (cosmetic_element_button_bg->target_color != nullptr))
		{
			Helper::hsv2rgb(cosmetic_element_button_bg->target_color);

			NS_EGraphicCore::set_active_color(cosmetic_element_button_bg->target_color);
			ERenderBatcher::if_have_space_for_data(NS_EGraphicCore::default_batcher_for_drawing, 4);
			NS_ERenderCollection::add_data_to_vertex_buffer_textured_rectangle_with_custom_size
			(
				NS_EGraphicCore::default_batcher_for_drawing->vertex_buffer,
				NS_EGraphicCore::default_batcher_for_drawing->last_vertice_buffer_index,

				//x pos
				pos_x,

				//y pos
				pos_y,

				size_x,
				size_y,

				NS_DefaultGabarites::texture_gabarite_white_pixel
			);
		}

		//"TEXT"
		if ((cosmetic_element_button_text != nullptr) && (cosmetic_element_button_text->target_color != nullptr))
		{
			Helper::hsv2rgb(cosmetic_element_button_text->target_color);

			NS_EGraphicCore::set_active_color(cosmetic_element_button_text->target_color);
			ERenderBatcher::if_have_space_for_data(NS_EGraphicCore::default_batcher_for_drawing, 4);
			NS_ERenderCollection::add_data_to_vertex_buffer_textured_rectangle_with_custom_size
			(
				NS_EGraphicCore::default_batcher_for_drawing->vertex_buffer,
				NS_EGraphicCore::default_batcher_for_drawing->last_vertice_buffer_index,

				//x pos
				pos_x + (size_x - NS_DefaultGabarites::texture_example_text_for_preview_box->size_x_in_pixels * 0.85f) / 2.0f,

				//y pos
				pos_y + (size_y - NS_DefaultGabarites::texture_example_text_for_preview_box->size_y_in_pixels * 0.85f) / 2.0f,

				NS_DefaultGabarites::texture_example_text_for_preview_box->size_x_in_pixels * 0.85f,
				NS_DefaultGabarites::texture_example_text_for_preview_box->size_y_in_pixels * 0.85f,

				NS_DefaultGabarites::texture_example_text_for_preview_box
			);
		}

		//RAMA
		if ((cosmetic_element_button_rama != nullptr) && (cosmetic_element_button_rama->target_color != nullptr))
		{
			Helper::hsv2rgb(cosmetic_element_button_rama->target_color);

			NS_EGraphicCore::set_active_color(cosmetic_element_button_rama->target_color);
			ERenderBatcher::if_have_space_for_data(NS_EGraphicCore::default_batcher_for_drawing, 4);
			NS_ERenderCollection::add_data_to_vertex_buffer_rama
			(
				NS_EGraphicCore::default_batcher_for_drawing->vertex_buffer,
				NS_EGraphicCore::default_batcher_for_drawing->last_vertice_buffer_index,

				//x pos
				pos_x,

				//y pos
				pos_y,

				size_x,
				size_y,

				3.0f,

				NS_DefaultGabarites::texture_gabarite_white_pixel
			);
		}
	}
}

void EButtonGroupSimpleColorEditor::assign_colors(HSVRGBAColor* _color)
{

	//EInputCore::logger_simple_info("Color asigned!");

	EDataContainer_VerticalNamedSlider*
		slider_data = nullptr;

	EDataContainer_CrosshairSlider*
		crosshair_data = nullptr;

	target_color = _color;

	Helper::rgb2hsv(_color);

	//CROSSHAIR SLIDER
	crosshair_data = static_cast<EDataContainer_CrosshairSlider*>(color_hair_slider_hue_saturation->main_custom_data->data_container);

	crosshair_data->target_pointer_x = &(_color->h);
	crosshair_data->target_pointer_y = &(_color->s);


	//VALUE AND ALPHA
	slider_data = static_cast<EDataContainer_VerticalNamedSlider*>(color_slider_value->main_custom_data->data_container);
	slider_data->pointer_to_value = &(_color->v);

	slider_data = static_cast<EDataContainer_VerticalNamedSlider*>(color_slider_alpha->main_custom_data->data_container);
	slider_data->pointer_to_value = &(_color->a);

	//std::cout << "group H pointer " << crosshair_data->target_pointer_x << std::endl;
	//std::cout << "color H pointer " << &(_color->h) << std::endl;
}

void EButtonGroupSimpleColorEditor::generate_color_pattern_buttons()
{
	for (int i = 0; i < Helper::registered_color_list.size(); i++)
	{
		// // // // // // //// // // // // // //// // // // // // //
		HRA_color_collection* HRA_collection = Helper::registered_color_list[i];
		HSVRGBAColor* HRA_color = &HRA_collection->target_color;
		//HRA_color->h = rand() % 360;
		//HRA_color->s = 1.0f - pow((rand() % 100) / 100.0f, 1.0);
		//HRA_color->v = 1.0f - pow((rand() % 100) / 100.0f, 3.0);
		//HRA_color->a = 1.0f - pow((rand() % 100) / 100.0f, 4.0);


		//std::cout << Helper::registered_color_list[0] << std::endl;
		EntityButtonColorButton*
			color_button = new EntityButtonColorButton();

		color_button->make_as_named_color_button
		(
			//*color_collection->child_align_mode = ChildAlignMode::ALIGN_HORIZONTAL;

			new ERegionGabarite(120.0f, 38.0f),
			pointer_to_color_pattern_group,
			EFont::font_list[0],
			EGUIStyle::active_style,
			HRA_collection->localised_name,
			HRA_collection,
			HRA_color,
			ColorButtonMode::CBM_SELECT_COLOR
		);
		color_button->can_be_stretched = true;
		color_button->target_color_pointer = &target_color;
		//std::cout << HRA_color << std::endl;
		//Entity::get_last_clickable_area(jc_button)->actions_on_click_list.push_back(&EDataActionCollection::action_select_this_button);

		pointer_to_color_pattern_group->add_button_to_working_group(color_button);
		// // // // // // //// // // // // // //// // // // // // //
	}
}

void EButtonGroupSimpleColorEditor::button_group_update(float _d)
{
	EButtonGroup::button_group_update(_d);

	if
		(
			(EInputCore::MOUSE_BUTTON_LEFT)
			&&
			(target_color != nullptr)
			)
	{
		Helper::hsv2rgb(target_color);
	}
}

EntityButtonColorButtonForFilterBlock::~EntityButtonColorButtonForFilterBlock()
{
}

void EButtonGroupAttributeGeneratorGroup::execute_attribute_group(EGameItem* _game_item, GameItemGenerator* _generator)
{
}

void EButtonGroupAttributeGeneratorGroup::init()
{
}


//////////////////////////////////////////////////////////////////////////////////////////

void EButtonGroupAttributeGeneratorGroup_Rarity::init()
{
	name.set_ID_by_string("Rarity");
	//attribute_generator = new GameAttributeGeneratorRarity("Rarity");
	EWindowMain::loot_simulator_button_group->attribute_group_list.push_back(this);




	EntityButtonVariantRouter*
		router_button = new EntityButtonVariantRouter();

	add_button_to_working_group(router_button);
	router_button->make_as_default_router_variant_button(new ERegionGabarite(region_gabarite->size_x, region_gabarite->size_y));

	router_button->can_be_stretched = true;
	router_button->rotate_variant_mode = RotateVariantMode::OPEN_CHOOSE_WINDOW;
	router_button->height_division = 1;

	router_button->add_router_variant_with_localization_key_and_color("item_rarity_normal", 0.9f, 0.8f, 0.7f, 1.0f);
	router_button->add_router_variant_with_localization_key_and_color("item_rarity_magic", 0.25f, 0.5f, 0.9f, 1.0f);
	router_button->add_router_variant_with_localization_key_and_color("item_rarity_rare", 0.9f, 0.8f, 0.4f, 1.0f);
	router_button->add_router_variant_with_localization_key_and_color("item_rarity_unique", 0.6f, 0.25f, 0.1f, 1.0f);

	router_button->target_int_value = &EWindowMain::loot_simulator_button_group->selected_rarity;

	router_button->action_on_choose_variant_from_window.push_back(&EDataActionCollection::action_refresh_loot_simulator);

	router_button->select_variant(0);

	//EWindowMain::loot_simulator_button_group->attribute_group_rarity = this;



}

void EButtonGroupAttributeGeneratorGroup_Rarity::execute_attribute_group(EGameItem* _game_item, GameItemGenerator* _generator)
{
	//EGameItemAttributeContainer*
	//attribute_container = GameItemAttribute::add_new_game_attribute_by_name(_game_item, "Rarity");

	if (_game_item->rarity == -1)
	{
		_game_item->rarity = EWindowMain::loot_simulator_button_group->selected_rarity;
		_game_item->rarity = std::clamp(_game_item->rarity, 0, 3);


	}

	GameItemAttribute::add_new_int_value_to_game_attribute
	(
		_game_item,
		"Rarity",
		_game_item->rarity
	);
	//attribute_container->attribute_value_int = _game_item->rarity;
}

void EButtonGroupAttributeGeneratorGroup_ItemLevel::init()
{
	name.set_ID_by_string("ItemLevel");
	//attribute_generator = new GameAttributeGeneratorItemLevel("ItemLevel");
	EWindowMain::loot_simulator_button_group->attribute_group_list.push_back(this);



	EntityButton*
		named_slider = EntityButton::create_horizontal_named_slider
		(

			new ERegionGabarite(350.0f, region_gabarite->size_y),
			this,
			EFont::font_list[0],
			EGUIStyle::active_style,
			ELocalisationText::get_localisation_by_key("item_level")
		);
	add_button_to_working_group(named_slider);
	named_slider->can_be_stretched = true;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->pointer_to_value = &EWindowMain::loot_simulator_button_group->selected_item_level;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->min_value = 1.0f;
	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->mid_value = 25.0f;
	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->max_value = 100.0f;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->rounded_numbers = true;

	named_slider->main_custom_data->actions_on_update.push_back(&EDataActionCollection::action_refresh_loot_simulator_when_release);



}

void EButtonGroupAttributeGeneratorGroup_ItemLevel::execute_attribute_group(EGameItem* _game_item, GameItemGenerator* _generator)
{
	EGameItemAttributeContainer*
		attribute_container = GameItemAttribute::add_new_game_attribute_by_name(_game_item, "ItemLevel");

	attribute_container->attribute_value_int = EWindowMain::loot_simulator_button_group->selected_item_level;

}

void EButtonGroupAttributeGeneratorGroup_SocketsAndLinks::init()
{
	name.set_ID_by_string("SocketsLinksColours");
	//attribute_generator = new GameAttributeGeneratorSocketsLinksColours("SocketGroup");
	
	EWindowMain::loot_simulator_button_group->attribute_group_list.push_back(this);









	EntityButton*
		named_slider = nullptr;


	//WHITE SOCKETS
	named_slider = EntityButton::create_horizontal_named_slider
	(

		new ERegionGabarite(350.0f, 36.0f),
		this,
		EFont::font_list[0],
		EGUIStyle::active_style,
		ELocalisationText::get_localisation_by_key("white_sockets_weight")
	);
	add_button_to_working_group_and_expand_y(named_slider);
	named_slider->can_be_stretched = true;
	named_slider->force_field_up = 2.0f;
	named_slider->force_field_bottom = 2.0f;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->pointer_to_value = &EWindowMain::loot_simulator_button_group->selected_white_weight;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->min_value = 0.0f;
	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->mid_value = 25.0f;
	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->max_value = 100.0f;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->current_slide_value = 1.0f;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->rounded_numbers = true;

	named_slider->main_custom_data->actions_on_update.push_back(&EDataActionCollection::action_refresh_loot_simulator_when_release);





	//BLUE SOCKETS
	named_slider = EntityButton::create_horizontal_named_slider
	(

		new ERegionGabarite(350.0f, 36.0f),
		this,
		EFont::font_list[0],
		EGUIStyle::active_style,
		ELocalisationText::get_localisation_by_key("blue_sockets_weight")
	);
	named_slider->force_field_up = 2.0f;
	named_slider->main_text_area->set_color(0.5f, 0.8f, 0.9f, 1.0f);
	add_button_to_working_group_and_expand_y(named_slider);
	named_slider->can_be_stretched = true;


	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->pointer_to_value = &EWindowMain::loot_simulator_button_group->selected_blue_weight;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->min_value = 0.0f;
	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->mid_value = 25.0f;
	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->max_value = 100.0f;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->rounded_numbers = true;

	named_slider->main_custom_data->actions_on_update.push_back(&EDataActionCollection::action_refresh_loot_simulator_when_release);



	//GREEN SOCKETS
	named_slider = EntityButton::create_horizontal_named_slider
	(

		new ERegionGabarite(350.0f, 36.0f),
		this,
		EFont::font_list[0],
		EGUIStyle::active_style,
		ELocalisationText::get_localisation_by_key("green_sockets_weight")
	);
	named_slider->force_field_up = 2.0f;
	named_slider->main_text_area->set_color(0.5f, 0.9f, 0.6f, 1.0f);
	add_button_to_working_group_and_expand_y(named_slider);
	named_slider->can_be_stretched = true;


	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->pointer_to_value = &EWindowMain::loot_simulator_button_group->selected_green_weight;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->min_value = 0.0f;
	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->mid_value = 25.0f;
	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->max_value = 100.0f;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->rounded_numbers = true;

	named_slider->main_custom_data->actions_on_update.push_back(&EDataActionCollection::action_refresh_loot_simulator_when_release);




	//RED SOCKETS
	named_slider = EntityButton::create_horizontal_named_slider
	(

		new ERegionGabarite(350.0f, 36.0f),
		this,
		EFont::font_list[0],
		EGUIStyle::active_style,
		ELocalisationText::get_localisation_by_key("red_sockets_weight")
	);
	named_slider->force_field_up = 12.0f;
	named_slider->main_text_area->set_color(0.9f, 0.6f, 0.5f, 1.0f);
	add_button_to_working_group_and_expand_y(named_slider);
	named_slider->can_be_stretched = true;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->pointer_to_value = &EWindowMain::loot_simulator_button_group->selected_red_weight;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->min_value = 0.0f;
	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->mid_value = 25.0f;
	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->max_value = 100.0f;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->rounded_numbers = true;

	named_slider->main_custom_data->actions_on_update.push_back(&EDataActionCollection::action_refresh_loot_simulator_when_release);




	//LINKS
	named_slider = EntityButton::create_horizontal_named_slider
	(

		new ERegionGabarite(350.0f, 36.0f),
		this,
		EFont::font_list[0],
		EGUIStyle::active_style,
		ELocalisationText::get_localisation_by_key("links_count")
	);

	named_slider->force_field_up = 2.0f;

	add_button_to_working_group_and_expand_y(named_slider);
	named_slider->can_be_stretched = true;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->pointer_to_value = &EWindowMain::loot_simulator_button_group->selected_links;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->min_value = 0.0f;
	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->mid_value = 3.0f;
	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->max_value = 6.0f;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->rounded_numbers = true;

	named_slider->main_custom_data->actions_on_update.push_back(&EDataActionCollection::action_refresh_loot_simulator_when_release);






	//SOCKETS
	named_slider = EntityButton::create_horizontal_named_slider
	(

		new ERegionGabarite(350.0f, 36.0f),
		this,
		EFont::font_list[0],
		EGUIStyle::active_style,
		ELocalisationText::get_localisation_by_key("sockets_count")
	);

	named_slider->force_field_up = 4.0f;
	named_slider->force_field_bottom = 2.0f;

	add_button_to_working_group_and_expand_y(named_slider);
	named_slider->can_be_stretched = true;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->pointer_to_value = &EWindowMain::loot_simulator_button_group->selected_sockets;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->min_value = 1.0f;
	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->mid_value = 3.0f;
	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->max_value = 6.0f;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->rounded_numbers = true;

	named_slider->main_custom_data->actions_on_update.push_back(&EDataActionCollection::action_refresh_loot_simulator_when_release);


















}

void EButtonGroupAttributeGeneratorGroup_SocketsAndLinks::execute_attribute_group(EGameItem* _game_item, GameItemGenerator* _generator)
{
	EButtonGroupLootSimulator*
		loot_simulator_pointer = EWindowMain::loot_simulator_button_group;

	int color_weight[6];

	EGameItemAttributeContainer*
		attribute_container = GameItemAttribute::add_new_game_attribute_by_name(_game_item, "SocketGroup");
	if
		(
			(_game_item->stored_data_entity != nullptr)
			&&
			(DataEntityUtils::is_exist_tag_by_name_and_value_ID(0, &ERegisteredStrings::item_tag, &ERegisteredStrings::all_sockets_white, _game_item->stored_data_entity))
			)//ALWAYS WHITE
	{

		color_weight[SocketColorEnum::SOCKET_COLOR_ENUM_RED] = 0;
		color_weight[SocketColorEnum::SOCKET_COLOR_ENUM_GREEN] = 0;
		color_weight[SocketColorEnum::SOCKET_COLOR_ENUM_BLUE] = 0;

		color_weight[SocketColorEnum::SOCKET_COLOR_ENUM_WHITE] = 10000;
		color_weight[SocketColorEnum::SOCKET_COLOR_ENUM_ABYSS] = 0;
		color_weight[SocketColorEnum::SOCKET_COLOR_ENUM_DELVE] = 0;
	}
	else
	{
		color_weight[SocketColorEnum::SOCKET_COLOR_ENUM_RED] = round(loot_simulator_pointer->selected_red_weight);
		color_weight[SocketColorEnum::SOCKET_COLOR_ENUM_GREEN] = round(loot_simulator_pointer->selected_green_weight);
		color_weight[SocketColorEnum::SOCKET_COLOR_ENUM_BLUE] = round(loot_simulator_pointer->selected_blue_weight);

		color_weight[SocketColorEnum::SOCKET_COLOR_ENUM_WHITE] = round(loot_simulator_pointer->selected_white_weight);
		color_weight[SocketColorEnum::SOCKET_COLOR_ENUM_ABYSS] = 0;
		color_weight[SocketColorEnum::SOCKET_COLOR_ENUM_DELVE] = 0;
	}

	//if (!wrong_base)
	if (_game_item->max_available_sockets > 0)
	{

		std::string temp_socket_color_names = "RGBWAD";

		int exactly_color_count[6]{ 0 };
		//int color_id_array[6]		{ 0 };

		int total_weight = 0;

		int
			sockets_count = 0;

		int
			links_count = 0;



		std::string sockets_group_result_string = "";
		std::string links_group_result_string = "";

		if
			(
				(
					(_game_item->stored_data_entity != nullptr)
					&&
					(DataEntityUtils::is_exist_tag_by_name_and_value_ID(0, &ERegisteredStrings::item_tag, &ERegisteredStrings::always_six_linked, _game_item->stored_data_entity))
					)
				||
				(
					(_generator != nullptr)
					&&
					(_generator->always_6_linked)
				)
			)//ALWAYS 6-linked
		{
			sockets_count = 6;
			links_count = 6;
		}
		else
		{
			/*sockets_count	= sockets_min_value	+ round((float)(sockets_max_value	- sockets_min_value)	* pow((rand() % 101) / 100.0f, sockets_pow	/ EWindowMain::loot_simulator_button_group->MF_factor));
			links_count		= links_min			+ round((float)(links_max			- links_min)			* pow((rand() % 101) / 100.0f, links_pow	/ EWindowMain::loot_simulator_button_group->MF_factor));*/

			sockets_count = round(loot_simulator_pointer->selected_sockets);
			links_count = round(loot_simulator_pointer->selected_links);

			sockets_count = std::min(sockets_count, _game_item->max_available_sockets);
			links_count = std::min(links_count, sockets_count);
		}

		if (links_count == 1) { links_count = 0; }

		for (int i = 0; i < 6; i++)
		{
			total_weight += color_weight[i];
		}

		int random_selected = 0;

		int weight_sum = 0;

		int result_color_id = -1;

		for (int sc = 0; sc < sockets_count; sc++)
		{
			random_selected = rand() % total_weight + 1;
			weight_sum = 0;
			result_color_id = 0;

			for (int i = 0; i < 6; i++)
			{
				if
					(
						(color_weight[i] > 0)
						&&
						(weight_sum <= random_selected)
						&&
						(color_weight[i] + weight_sum > random_selected)
						)
				{
					result_color_id = i;
					break;
				}

				weight_sum += color_weight[i];
			}

			//color_id_array[sc] = result_color_id;

			_game_item->socket_color_id_array[sc] = result_color_id;
		}

		_game_item->sockets_count = sockets_count;
		_game_item->links_count = links_count;

		sockets_group_result_string = std::to_string(sockets_count);
		links_group_result_string = std::to_string(links_count);

		//		GENERATE COLOR SOCKETS STRING LIKE "RRRGGB"
		for (int i = 0; i < 6; i++) { exactly_color_count[i] = 0; }

		for (int i = 0; i < sockets_count; i++)
		{
			exactly_color_count[_game_item->socket_color_id_array[i]]++;
		};

		for (int i = 0; i < 6; i++)
			if (exactly_color_count[i] > 0)
				for (int j = 0; j < exactly_color_count[i]; j++)
				{
					sockets_group_result_string.append(1, temp_socket_color_names[i]);
				}

		//		GENERATE COLOR LINKS STRING LIKE "RRRGGB"
		for (int i = 0; i < 6; i++) { exactly_color_count[i] = 0; }

		for (int i = 0; i < links_count; i++)
		{
			exactly_color_count[_game_item->socket_color_id_array[i]]++;
		};

		for (int i = 0; i < 6; i++)
			if (exactly_color_count[i] > 0)
				for (int j = 0; j < exactly_color_count[i]; j++)
				{
					links_group_result_string.append(1, temp_socket_color_names[i]);
				}


		//		GENERATE NEW ATTRIBUTE FOR SOCKETS OR LINKS
		{


			//SOCKET GROUP VALUE
			attribute_container->attribute_value_str = links_group_result_string;


			//ADD "SOCKET GROUP" ATTRIBUTE
			EGameItemAttributeContainer
				new_attribute_container;

			new_attribute_container.target_attribute = GameItemAttribute::get_attribute_by_name(&registered_game_item_attributes, "Sockets");
			new_attribute_container.attribute_value_str = sockets_group_result_string;

			_game_item->attribute_container_list.push_back(new_attribute_container);
		}

		//ADD "LINKED SOCKETS COUNT" ATTRIBUTE
		EGameItemAttributeContainer
			new_attribute_container;

		new_attribute_container.target_attribute = GameItemAttribute::get_attribute_by_name(&registered_game_item_attributes, "LinkedSockets");
		new_attribute_container.attribute_value_int = links_count;
		_game_item->attribute_container_list.push_back(new_attribute_container);
	}
}

void EButtonGroupAttributeGeneratorGroup_Quantity::init()
{
	name.set_ID_by_string("Quantity");
	//attribute_generator = new GameAttributeGeneratorQuantity("StackSize");

	EWindowMain::loot_simulator_button_group->attribute_group_list.push_back(this);









	EntityButton*
		named_slider = nullptr;


	//Quantity
	named_slider = EntityButton::create_horizontal_named_slider
	(

		new ERegionGabarite(350.0f, 36.0f),
		this,
		EFont::font_list[0],
		EGUIStyle::active_style,
		ELocalisationText::get_localisation_by_key("item_quantity")
	);
	add_button_to_working_group_and_expand_y(named_slider);
	named_slider->can_be_stretched = true;
	named_slider->force_field_up = 2.0f;
	named_slider->force_field_bottom = 2.0f;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->pointer_to_value = &EWindowMain::loot_simulator_button_group->selected_quantity;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->min_value = 0.1f;
	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->mid_value = 5.0f;
	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->max_value = 20.0f;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->current_slide_value = 2.0f;

	//static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->current_slide_value = 1.0f;

	//static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->rounded_numbers = true;

	named_slider->main_custom_data->actions_on_update.push_back(&EDataActionCollection::action_refresh_loot_simulator_when_release);
}

void EButtonGroupAttributeGeneratorGroup_Quantity::execute_attribute_group(EGameItem* _game_item, GameItemGenerator* _generator)
{
	EGameItemAttributeContainer*
		attribute_container = GameItemAttribute::add_new_game_attribute_by_name(_game_item, "StackSize");

	float
		f_quantity = 1.0f;

	//apply stack multiplier
	f_quantity *= _game_item->stack_multiplier;
	f_quantity *= EWindowMain::loot_simulator_button_group->selected_quantity;
	//clamp values
	_game_item->quantity = std::clamp(int(round(f_quantity)), 1, _game_item->max_stack_size);

	attribute_container->attribute_value_int = _game_item->quantity;
}

void EButtonGroupAttributeGeneratorGroup_FlagAttributes::init()
{
	name.set_ID_by_string("FlagAttributes");

	EWindowMain::loot_simulator_button_group->attribute_group_list.push_back(this);

	EntityButton*
		switch_button = nullptr;




	switch_button = new EntityButton();
	switch_button->can_be_stretched = true;
	switch_button->make_default_bool_switcher_button_with_unedible_text
	(
		new ERegionGabarite(region_gabarite->size_x, 24.0f),
		this,
		EDataActionCollection::action_switch_boolean_value,
		NS_EGraphicCore::load_from_textures_folder("buttons/bool_flag_attributes/synthesised_active"),
		NS_EGraphicCore::load_from_textures_folder("buttons/bool_flag_attributes/synthesised_inactive"),
		ELocalisationText::get_localisation_by_key("item_synthesised"),
		&EWindowMain::loot_simulator_button_group->is_synthesised
	);
	switch_button->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_refresh_loot_simulator);
	add_button_to_working_group_and_expand_y(switch_button);






	switch_button = new EntityButton();
	switch_button->can_be_stretched = true;
	switch_button->make_default_bool_switcher_button_with_unedible_text
	(
		new ERegionGabarite(region_gabarite->size_x, 24.0f),
		this,
		EDataActionCollection::action_switch_boolean_value,
		NS_EGraphicCore::load_from_textures_folder("buttons/bool_flag_attributes/fractured_active"),
		NS_EGraphicCore::load_from_textures_folder("buttons/bool_flag_attributes/fractured_inactive"),
		ELocalisationText::get_localisation_by_key("item_fractured"),
		&EWindowMain::loot_simulator_button_group->is_fractured
	);
	switch_button->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_refresh_loot_simulator);
	add_button_to_working_group_and_expand_y(switch_button);



	///
	//CORRUPTED IMPLICITS
	EntityButton*
		named_slider = nullptr;



	named_slider = EntityButton::create_horizontal_named_slider
	(

		new ERegionGabarite(350.0f, 36.0f),
		this,
		EFont::font_list[0],
		EGUIStyle::active_style,
		ELocalisationText::get_localisation_by_key("corrupted_implicits")
	);

	named_slider->force_field_up = 2.0f;
	named_slider->force_field_bottom = 8.0f;

	add_button_to_working_group_and_expand_y(named_slider);
	named_slider->can_be_stretched = true;


	EDataContainer_VerticalNamedSlider*
		container = static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container);

	container->pointer_to_value = &EWindowMain::loot_simulator_button_group->selected_corrupted_implicits;

	container->min_value = 0.0f;
	container->mid_value = 1.0f;
	container->max_value = 2.0f;

	container->rounded_numbers = true;

	named_slider->main_custom_data->actions_on_update.push_back(&EDataActionCollection::action_refresh_loot_simulator_when_release);








	switch_button = new EntityButton();
	switch_button->can_be_stretched = true;
	switch_button->make_default_bool_switcher_button_with_unedible_text
	(
		new ERegionGabarite(region_gabarite->size_x, 24.0f),
		this,
		EDataActionCollection::action_switch_boolean_value,
		NS_EGraphicCore::load_from_textures_folder("buttons/bool_flag_attributes/corrupted_active"),
		NS_EGraphicCore::load_from_textures_folder("buttons/bool_flag_attributes/corrupted_inactive"),
		ELocalisationText::get_localisation_by_key("item_corrupted"),
		&EWindowMain::loot_simulator_button_group->is_corrupted
	);
	switch_button->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_refresh_loot_simulator);
	add_button_to_working_group_and_expand_y(switch_button);






	switch_button = new EntityButton();
	switch_button->can_be_stretched = true;
	switch_button->make_default_bool_switcher_button_with_unedible_text
	(
		new ERegionGabarite(region_gabarite->size_x, 24.0f),
		this,
		EDataActionCollection::action_switch_boolean_value,
		NS_EGraphicCore::load_from_textures_folder("buttons/bool_flag_attributes/identified_active"),
		NS_EGraphicCore::load_from_textures_folder("buttons/bool_flag_attributes/identified_inactive"),
		ELocalisationText::get_localisation_by_key("item_identified"),
		&EWindowMain::loot_simulator_button_group->is_identified
	);
	switch_button->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_refresh_loot_simulator);
	add_button_to_working_group_and_expand_y(switch_button);






	switch_button = new EntityButton();
	switch_button->can_be_stretched = true;
	switch_button->make_default_bool_switcher_button_with_unedible_text
	(
		new ERegionGabarite(region_gabarite->size_x, 24.0f),
		this,
		EDataActionCollection::action_switch_boolean_value,
		NS_EGraphicCore::load_from_textures_folder("buttons/bool_flag_attributes/mirrored_active"),
		NS_EGraphicCore::load_from_textures_folder("buttons/bool_flag_attributes/mirrored_inactive"),
		ELocalisationText::get_localisation_by_key("item_mirrored"),
		&EWindowMain::loot_simulator_button_group->is_mirrored
	);
	switch_button->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_refresh_loot_simulator);
	add_button_to_working_group_and_expand_y(switch_button);






	switch_button = new EntityButton();
	switch_button->can_be_stretched = true;
	switch_button->make_default_bool_switcher_button_with_unedible_text
	(
		new ERegionGabarite(region_gabarite->size_x, 24.0f),
		this,
		EDataActionCollection::action_switch_boolean_value,
		NS_EGraphicCore::load_from_textures_folder("buttons/bool_flag_attributes/enchanted_active"),
		NS_EGraphicCore::load_from_textures_folder("buttons/bool_flag_attributes/enchanted_inactive"),
		ELocalisationText::get_localisation_by_key("item_enchanted"),
		&EWindowMain::loot_simulator_button_group->is_enchanted
	);
	switch_button->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_refresh_loot_simulator);
	add_button_to_working_group_and_expand_y(switch_button);






	switch_button = new EntityButton();
	switch_button->can_be_stretched = true;
	switch_button->make_default_bool_switcher_button_with_unedible_text
	(
		new ERegionGabarite(region_gabarite->size_x, 24.0f),
		this,
		EDataActionCollection::action_switch_boolean_value,
		NS_EGraphicCore::load_from_textures_folder("buttons/bool_flag_attributes/replica_active"),
		NS_EGraphicCore::load_from_textures_folder("buttons/bool_flag_attributes/replica_inactive"),
		ELocalisationText::get_localisation_by_key("item_replica"),
		&EWindowMain::loot_simulator_button_group->is_replica
	);
	switch_button->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_refresh_loot_simulator);
	add_button_to_working_group_and_expand_y(switch_button);


}

void EButtonGroupAttributeGeneratorGroup_FlagAttributes::execute_attribute_group(EGameItem* _game_item, GameItemGenerator* _generator)
{
	if ((EWindowMain::loot_simulator_button_group->is_synthesised) && (_game_item->can_be_synthesised))
	{
		EGameItemAttributeContainer*
			attribute_container = GameItemAttribute::add_new_game_attribute_by_name(_game_item, "SynthesisedItem");
		attribute_container->attribute_value_bool = true;
	}

	if ((EWindowMain::loot_simulator_button_group->is_corrupted) && (_game_item->can_be_corrupted))
	{
		EGameItemAttributeContainer*
			attribute_container = GameItemAttribute::add_new_game_attribute_by_name(_game_item, "Corrupted");
		attribute_container->attribute_value_bool = true;


		if (std::round(EWindowMain::loot_simulator_button_group->selected_corrupted_implicits) > 0)
		{
			attribute_container = GameItemAttribute::add_new_game_attribute_by_name(_game_item, "CorruptedMods");
			attribute_container->attribute_value_int = std::round(EWindowMain::loot_simulator_button_group->selected_corrupted_implicits);
		}

	}

	if ((EWindowMain::loot_simulator_button_group->is_enchanted) && (_game_item->can_be_enchanted))
	{
		EGameItemAttributeContainer*
			attribute_container = GameItemAttribute::add_new_game_attribute_by_name(_game_item, "AnyEnchantment");
		attribute_container->attribute_value_bool = true;
	}

	if ((EWindowMain::loot_simulator_button_group->is_fractured) && (_game_item->can_be_fractured))
	{
		EGameItemAttributeContainer*
			attribute_container = GameItemAttribute::add_new_game_attribute_by_name(_game_item, "FracturedItem");
		attribute_container->attribute_value_bool = true;
	}

	if ((EWindowMain::loot_simulator_button_group->is_identified))
	{
		EGameItemAttributeContainer*
			attribute_container = GameItemAttribute::add_new_game_attribute_by_name(_game_item, "Identified");
		attribute_container->attribute_value_bool = true;
	}

	if ((EWindowMain::loot_simulator_button_group->is_mirrored) && (_game_item->can_be_mirrored))
	{
		EGameItemAttributeContainer*
			attribute_container = GameItemAttribute::add_new_game_attribute_by_name(_game_item, "Mirrored");
		attribute_container->attribute_value_bool = true;
	}

	if ((EWindowMain::loot_simulator_button_group->is_replica) && (_game_item->can_be_replica))
	{
		EGameItemAttributeContainer*
			attribute_container = GameItemAttribute::add_new_game_attribute_by_name(_game_item, "Replica");
		attribute_container->attribute_value_bool = true;
	}
}

void EButtonGroupAttributeGeneratorGroup_Influense::init()
{
	name.set_ID_by_string("Influence");
	EWindowMain::loot_simulator_button_group->attribute_group_list.push_back(this);


	EntityButton*
		switch_button = nullptr;




	switch_button = new EntityButton();
	switch_button->can_be_stretched = true;
	switch_button->make_default_bool_switcher_button_with_unedible_text
	(
		new ERegionGabarite(region_gabarite->size_x, 24.0f),
		this,
		EDataActionCollection::action_switch_boolean_value,
		NS_EGraphicCore::load_from_textures_folder("buttons/influences_swicher/crusader_active"),
		NS_EGraphicCore::load_from_textures_folder("buttons/influences_swicher/crusader_inactive"),
		ELocalisationText::get_localisation_by_key("influence_crusader"),
		&EWindowMain::loot_simulator_button_group->influence_crusader
	);
	switch_button->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_refresh_loot_simulator);
	add_button_to_working_group_and_expand_y(switch_button);




	switch_button = new EntityButton();
	switch_button->can_be_stretched = true;
	switch_button->make_default_bool_switcher_button_with_unedible_text
	(
		new ERegionGabarite(region_gabarite->size_x, 24.0f),
		this,
		EDataActionCollection::action_switch_boolean_value,
		NS_EGraphicCore::load_from_textures_folder("buttons/influences_swicher/hunter_active"),
		NS_EGraphicCore::load_from_textures_folder("buttons/influences_swicher/hunter_inactive"),
		ELocalisationText::get_localisation_by_key("influence_hunter"),
		&EWindowMain::loot_simulator_button_group->influence_hunter
	);
	switch_button->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_refresh_loot_simulator);
	add_button_to_working_group_and_expand_y(switch_button);




	switch_button = new EntityButton();
	switch_button->can_be_stretched = true;
	switch_button->make_default_bool_switcher_button_with_unedible_text
	(
		new ERegionGabarite(region_gabarite->size_x, 24.0f),
		this,
		EDataActionCollection::action_switch_boolean_value,
		NS_EGraphicCore::load_from_textures_folder("buttons/influences_swicher/redeemer_active"),
		NS_EGraphicCore::load_from_textures_folder("buttons/influences_swicher/redeemer_inactive"),
		ELocalisationText::get_localisation_by_key("influence_redeemer"),
		&EWindowMain::loot_simulator_button_group->influence_redeemer
	);
	switch_button->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_refresh_loot_simulator);
	add_button_to_working_group_and_expand_y(switch_button);




	switch_button = new EntityButton();
	switch_button->can_be_stretched = true;
	switch_button->make_default_bool_switcher_button_with_unedible_text
	(
		new ERegionGabarite(region_gabarite->size_x, 24.0f),
		this,
		EDataActionCollection::action_switch_boolean_value,
		NS_EGraphicCore::load_from_textures_folder("buttons/influences_swicher/warlord_active"),
		NS_EGraphicCore::load_from_textures_folder("buttons/influences_swicher/warlord_inactive"),
		ELocalisationText::get_localisation_by_key("influence_warlord"),
		&EWindowMain::loot_simulator_button_group->influence_warlord
	);
	switch_button->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_refresh_loot_simulator);
	add_button_to_working_group_and_expand_y(switch_button);




	switch_button = new EntityButton();
	switch_button->can_be_stretched = true;
	switch_button->make_default_bool_switcher_button_with_unedible_text
	(
		new ERegionGabarite(region_gabarite->size_x, 24.0f),
		this,
		EDataActionCollection::action_switch_boolean_value,
		NS_EGraphicCore::load_from_textures_folder("buttons/influences_swicher/shaper_active"),
		NS_EGraphicCore::load_from_textures_folder("buttons/influences_swicher/shaper_inactive"),
		ELocalisationText::get_localisation_by_key("influence_shaper"),
		&EWindowMain::loot_simulator_button_group->influence_shaper
	);
	switch_button->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_refresh_loot_simulator);
	add_button_to_working_group_and_expand_y(switch_button);




	switch_button = new EntityButton();
	switch_button->can_be_stretched = true;
	switch_button->make_default_bool_switcher_button_with_unedible_text
	(
		new ERegionGabarite(region_gabarite->size_x, 24.0f),
		this,
		EDataActionCollection::action_switch_boolean_value,
		NS_EGraphicCore::load_from_textures_folder("buttons/influences_swicher/elder_active"),
		NS_EGraphicCore::load_from_textures_folder("buttons/influences_swicher/elder_inactive"),
		ELocalisationText::get_localisation_by_key("influence_elder"),
		&EWindowMain::loot_simulator_button_group->influence_elder
	);
	switch_button->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_refresh_loot_simulator);
	add_button_to_working_group_and_expand_y(switch_button);




	EntityButton*
	named_slider = nullptr;



	named_slider = EntityButton::create_horizontal_named_slider
	(

		new ERegionGabarite(350.0f, 36.0f),
		this,
		EFont::font_list[0],
		EGUIStyle::active_style,
		ELocalisationText::get_localisation_by_key("exarch_level")
	);

	named_slider->force_field_up = 2.0f;
	named_slider->force_field_bottom = 8.0f;

	add_button_to_working_group_and_expand_y(named_slider);
	named_slider->can_be_stretched = true;


	EDataContainer_VerticalNamedSlider*
		container = static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container);

	container->pointer_to_value = &EWindowMain::loot_simulator_button_group->selected_exarch_level;

	container->min_value = 0.0f;
	container->mid_value = 2.0f;
	container->max_value = 6.0f;

	container->current_slide_value = 1.0f;

	container->rounded_numbers = true;

	named_slider->main_custom_data->actions_on_update.push_back(&EDataActionCollection::action_refresh_loot_simulator_when_release);






	named_slider = EntityButton::create_horizontal_named_slider
	(

		new ERegionGabarite(350.0f, 36.0f),
		this,
		EFont::font_list[0],
		EGUIStyle::active_style,
		ELocalisationText::get_localisation_by_key("eater_level")
	);

	named_slider->force_field_up = 2.0f;
	//named_slider->force_field_bottom = 8.0f;

	add_button_to_working_group_and_expand_y(named_slider);
	named_slider->can_be_stretched = true;


	container = static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container);

	container->pointer_to_value = &EWindowMain::loot_simulator_button_group->selected_eater_level;

	container->min_value = 0.0f;
	container->mid_value = 2.0f;
	container->max_value = 6.0f;

	container->current_slide_value = 1.0f;

	container->rounded_numbers = true;

	named_slider->main_custom_data->actions_on_update.push_back(&EDataActionCollection::action_refresh_loot_simulator_when_release);


}

void EButtonGroupAttributeGeneratorGroup_Influense::execute_attribute_group(EGameItem* _game_item, GameItemGenerator* _generator)
{
	if (_game_item->can_be_influenced)
	{
		if
			(
				(EWindowMain::loot_simulator_button_group->influence_elder)
				||
				(EWindowMain::loot_simulator_button_group->influence_shaper)
				||
				(EWindowMain::loot_simulator_button_group->influence_redeemer)
				||
				(EWindowMain::loot_simulator_button_group->influence_warlord)
				||
				(EWindowMain::loot_simulator_button_group->influence_hunter)
				||
				(EWindowMain::loot_simulator_button_group->influence_crusader)
				)
		{

			EGameItemAttributeContainer*
				attribute_container = GameItemAttribute::add_new_game_attribute_by_name(_game_item, "HasInfluence");
			//attribute_container->attribute_value_bool = true;


				//elder
			if (EWindowMain::loot_simulator_button_group->influence_elder)
			{
				ELocalisationText l_text;
				l_text.base_name = "Elder";
				l_text.localisations[NSW_localisation_EN] = "Elder";
				l_text.localisations[NSW_localisation_RU] = "Древний";

				attribute_container->listed_value_list.push_back(l_text);
			}

			//shaper
			if (EWindowMain::loot_simulator_button_group->influence_shaper)
			{
				ELocalisationText l_text;
				l_text.base_name = "Shaper";
				l_text.localisations[NSW_localisation_EN] = "Shaper";
				l_text.localisations[NSW_localisation_RU] = "Создателя";

				attribute_container->listed_value_list.push_back(l_text);
			}

			//Redeemer
			if (EWindowMain::loot_simulator_button_group->influence_redeemer)
			{
				ELocalisationText l_text;
				l_text.base_name = "Redeemer";
				l_text.localisations[NSW_localisation_EN] = "Redeemer";
				l_text.localisations[NSW_localisation_RU] = "Избавительницы";

				attribute_container->listed_value_list.push_back(l_text);
			}

			//Warlord
			if (EWindowMain::loot_simulator_button_group->influence_warlord)
			{
				ELocalisationText l_text;
				l_text.base_name = "Warlord";
				l_text.localisations[NSW_localisation_EN] = "Warlord";
				l_text.localisations[NSW_localisation_RU] = "Вождя";

				attribute_container->listed_value_list.push_back(l_text);
			}

			//Hunter
			if (EWindowMain::loot_simulator_button_group->influence_hunter)
			{
				ELocalisationText l_text;
				l_text.base_name = "Hunter";
				l_text.localisations[NSW_localisation_EN] = "Hunter";
				l_text.localisations[NSW_localisation_RU] = "Охотника";

				attribute_container->listed_value_list.push_back(l_text);
			}

			//Crusader
			if (EWindowMain::loot_simulator_button_group->influence_crusader)
			{
				ELocalisationText l_text;
				l_text.base_name = "Crusader";
				l_text.localisations[NSW_localisation_EN] = "Crusader";
				l_text.localisations[NSW_localisation_RU] = "Крестоносца";

				attribute_container->listed_value_list.push_back(l_text);
			}
		}

		//Exarch
		if ((EWindowMain::loot_simulator_button_group->selected_exarch_level > 0))
		{
			EGameItemAttributeContainer*
			attribute_container = GameItemAttribute::add_new_game_attribute_by_name(_game_item, "HasSearingExarchImplicit");

			attribute_container->attribute_value_int = round(EWindowMain::loot_simulator_button_group->selected_exarch_level);
		}

		//Eater
		if (EWindowMain::loot_simulator_button_group->selected_eater_level > 0)
		{
			EGameItemAttributeContainer*
			attribute_container = GameItemAttribute::add_new_game_attribute_by_name(_game_item, "HasEaterOfWorldsImplicit");

			attribute_container->attribute_value_int = std::round(EWindowMain::loot_simulator_button_group->selected_eater_level);
		}
	}
}


void EButtonGroupAttributeGeneratorGroup_Quality::init()
{
	name.set_ID_by_string("Quality");
	//attribute_generator = new GameAttributeGeneratorItemLevel("Quality");
	EWindowMain::loot_simulator_button_group->attribute_group_list.push_back(this);



	EntityButton*
	named_slider = EntityButton::create_horizontal_named_slider
	(

		new ERegionGabarite(350.0f, 40.0f),
		this,
		EFont::font_list[0],
		EGUIStyle::active_style,
		ELocalisationText::get_localisation_by_key("item_quality")
	);
	add_button_to_working_group_and_expand_y(named_slider);
	named_slider->can_be_stretched = true;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->pointer_to_value = &EWindowMain::loot_simulator_button_group->selected_quality;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->min_value = 0.0f;
	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->mid_value = 20.0f;
	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->max_value = 30.0f;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->current_slide_value = 1.0f;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->rounded_numbers = true;

	named_slider->main_custom_data->actions_on_update.push_back(&EDataActionCollection::action_refresh_loot_simulator_when_release);
}

void EButtonGroupAttributeGeneratorGroup_Quality::execute_attribute_group(EGameItem* _game_item, GameItemGenerator* _generator)
{

	//attribute_container->attribute_value_bool = true;


	//elder
	if (EWindowMain::loot_simulator_button_group->selected_quality > 0)
	{
		EGameItemAttributeContainer*
			attribute_container = GameItemAttribute::add_new_game_attribute_by_name(_game_item, "Quality");

		attribute_container->attribute_value_int = std::round(EWindowMain::loot_simulator_button_group->selected_quality);
	}

}

void EButtonGroupAttributeGeneratorGroup_GemAttributes::init()
{
	name.set_ID_by_string("GemAttributes");
	//attribute_generator = new GameAttributeGeneratorItemLevel("GemLevel");
	EWindowMain::loot_simulator_button_group->attribute_group_list.push_back(this);







	EntityButton*
	switch_button = nullptr;




	switch_button = new EntityButton();
	switch_button->can_be_stretched = true;
	switch_button->make_default_bool_switcher_button_with_unedible_text
	(
		new ERegionGabarite(region_gabarite->size_x, 24.0f),
		this,
		EDataActionCollection::action_switch_boolean_value,
		NS_EGraphicCore::load_from_textures_folder("buttons/bool_flag_attributes/corrupted_active"),
		NS_EGraphicCore::load_from_textures_folder("buttons/bool_flag_attributes/corrupted_inactive"),
		ELocalisationText::get_localisation_by_key("item_corrupted"),
		&EWindowMain::loot_simulator_button_group->gem_is_corrupted
	);
	switch_button->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_refresh_loot_simulator);
	add_button_to_working_group_and_expand_y(switch_button);










	EntityButton*
		named_slider = EntityButton::create_horizontal_named_slider
		(

			new ERegionGabarite(350.0f, 40.0f),
			this,
			EFont::font_list[0],
			EGUIStyle::active_style,
			ELocalisationText::get_localisation_by_key("gem_quality")
		);
	add_button_to_working_group_and_expand_y(named_slider);
	named_slider->can_be_stretched = true;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->pointer_to_value = &EWindowMain::loot_simulator_button_group->selected_gem_quality;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->min_value = 1.0f;
	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->mid_value = 15.0f;
	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->max_value = 21.0f;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->current_slide_value = 0.0f;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->rounded_numbers = true;














	named_slider->main_custom_data->actions_on_update.push_back(&EDataActionCollection::action_refresh_loot_simulator_when_release);
		named_slider = EntityButton::create_horizontal_named_slider
		(

			new ERegionGabarite(350.0f, 40.0f),
			this,
			EFont::font_list[0],
			EGUIStyle::active_style,
			ELocalisationText::get_localisation_by_key("gem_level")
		);
	add_button_to_working_group_and_expand_y(named_slider);
	named_slider->can_be_stretched = true;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->pointer_to_value = &EWindowMain::loot_simulator_button_group->selected_gem_level;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->min_value = 1.0f;
	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->mid_value = 15.0f;
	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->max_value = 21.0f;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->current_slide_value = 0.0f;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->rounded_numbers = true;

	named_slider->main_custom_data->actions_on_update.push_back(&EDataActionCollection::action_refresh_loot_simulator_when_release);
	
	
	
	
	
	
	









	switch_button = nullptr;




	switch_button = new EntityButton();
	switch_button->can_be_stretched = true;
	switch_button->make_default_bool_switcher_button_with_unedible_text
	(
		new ERegionGabarite(region_gabarite->size_x, 24.0f),
		this,
		EDataActionCollection::action_switch_boolean_value,
		NS_EGraphicCore::load_from_textures_folder("buttons/bool_flag_attributes/enchanted_active"),
		NS_EGraphicCore::load_from_textures_folder("buttons/bool_flag_attributes/enchanted_inactive"),
		ELocalisationText::get_localisation_by_key("transfigured_gem"),
		&EWindowMain::loot_simulator_button_group->is_transfigured
	);
	switch_button->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_refresh_loot_simulator);
	add_button_to_working_group_and_expand_y(switch_button);


}

void EButtonGroupAttributeGeneratorGroup_GemAttributes::execute_attribute_group(EGameItem* _game_item, GameItemGenerator* _generator)
{
	if ((EWindowMain::loot_simulator_button_group->is_transfigured) && (_game_item->can_be_transfigured))
	{
		EGameItemAttributeContainer*
		attribute_container = GameItemAttribute::add_new_game_attribute_by_name(_game_item, "TransfiguredGem");

		attribute_container->attribute_value_bool = true;
	}

	if (_game_item->can_be_gem_level)
	{
		EGameItemAttributeContainer*
		attribute_container = GameItemAttribute::add_new_game_attribute_by_name(_game_item, "GemLevel");

		attribute_container->attribute_value_int = EWindowMain::loot_simulator_button_group->selected_gem_level;
	}

	if (_game_item->can_be_quality)
	{
		EGameItemAttributeContainer*
		attribute_container = GameItemAttribute::add_new_game_attribute_by_name(_game_item, "Quality");

		attribute_container->attribute_value_int = EWindowMain::loot_simulator_button_group->selected_gem_quality;
	}

	if (_game_item->can_be_corrupted)
	{
		EGameItemAttributeContainer*
		attribute_container = GameItemAttribute::add_new_game_attribute_by_name(_game_item, "Corrupted");

		attribute_container->attribute_value_bool = true;
	}

}

void EButtonGroupAttributeGeneratorGroup_MapAttributes::init()
{
	name.set_ID_by_string("MapAttributes");
	//attribute_generator = new GameAttributeGeneratorItemLevel("GemLevel");
	EWindowMain::loot_simulator_button_group->attribute_group_list.push_back(this);



	EntityButton*
		named_slider = EntityButton::create_horizontal_named_slider
		(

			new ERegionGabarite(350.0f, 40.0f),
			this,
			EFont::font_list[0],
			EGUIStyle::active_style,
			ELocalisationText::get_localisation_by_key("map_tier")
		);
	add_button_to_working_group_and_expand_y(named_slider);
	named_slider->can_be_stretched = true;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->pointer_to_value = &EWindowMain::loot_simulator_button_group->selected_maptier;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->min_value = 0.0f;
	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->mid_value = 9.0f;
	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->max_value = 17.0f;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->rounded_numbers = true;

	named_slider->main_custom_data->actions_on_update.push_back(&EDataActionCollection::action_refresh_loot_simulator_when_release);









	EntityButton*
	switch_button = nullptr;




	switch_button = new EntityButton();
	switch_button->can_be_stretched = true;
	switch_button->make_default_bool_switcher_button_with_unedible_text
	(
		new ERegionGabarite(region_gabarite->size_x, 24.0f),
		this,
		EDataActionCollection::action_switch_boolean_value,
		NS_EGraphicCore::load_from_textures_folder("buttons/bool_flag_attributes/blighted_active"),
		NS_EGraphicCore::load_from_textures_folder("buttons/bool_flag_attributes/blighted_inactive"),
		ELocalisationText::get_localisation_by_key("blighted_map"),
		&EWindowMain::loot_simulator_button_group->is_blighted
	);
	switch_button->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_refresh_loot_simulator);
	add_button_to_working_group_and_expand_y(switch_button);






	switch_button = new EntityButton();
	switch_button->can_be_stretched = true;
	switch_button->make_default_bool_switcher_button_with_unedible_text
	(
		new ERegionGabarite(region_gabarite->size_x, 24.0f),
		this,
		EDataActionCollection::action_switch_boolean_value,
		NS_EGraphicCore::load_from_textures_folder("buttons/bool_flag_attributes/uberblighted_active"),
		NS_EGraphicCore::load_from_textures_folder("buttons/bool_flag_attributes/uberblighted_inactive"),
		ELocalisationText::get_localisation_by_key("uberblighted_map"),
		&EWindowMain::loot_simulator_button_group->is_uberblighted
	);
	switch_button->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_refresh_loot_simulator);
	add_button_to_working_group_and_expand_y(switch_button);
}

void EButtonGroupAttributeGeneratorGroup_MapAttributes::execute_attribute_group(EGameItem* _game_item, GameItemGenerator* _generator)
{
	if ((_game_item->can_be_maptier))
	{
		EGameItemAttributeContainer*
		attribute_container = GameItemAttribute::add_new_game_attribute_by_name(_game_item, "MapTier");

		attribute_container->attribute_value_int = std::round(EWindowMain::loot_simulator_button_group->selected_maptier);
	}

	if ((EWindowMain::loot_simulator_button_group->is_blighted) && (_game_item->can_be_blighted))
	{
		EGameItemAttributeContainer*
		attribute_container = GameItemAttribute::add_new_game_attribute_by_name(_game_item, "BlightedMap");

		attribute_container->attribute_value_bool = true;
	}

	if ((EWindowMain::loot_simulator_button_group->is_uberblighted) && (_game_item->can_be_uberblighted))
	{
		EGameItemAttributeContainer*
		attribute_container = GameItemAttribute::add_new_game_attribute_by_name(_game_item, "UberBlightedMap");

		attribute_container->attribute_value_bool = true;
	}


}

void EButtonGroupAttributeGeneratorGroup_DefenceProcentile::init()
{
	name.set_ID_by_string("DefenceProcentile");
	//attribute_generator = new GameAttributeGeneratorItemLevel("GemLevel");
	EWindowMain::loot_simulator_button_group->attribute_group_list.push_back(this);



	EntityButton*
		named_slider = EntityButton::create_horizontal_named_slider
		(

			new ERegionGabarite(350.0f, 40.0f),
			this,
			EFont::font_list[0],
			EGUIStyle::active_style,
			ELocalisationText::get_localisation_by_key("defence_procentile")
		);
	add_button_to_working_group_and_expand_y(named_slider);
	named_slider->can_be_stretched = true;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->pointer_to_value = &EWindowMain::loot_simulator_button_group->selected_procentile;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->min_value = 0.0f;
	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->mid_value = 80.0f;
	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->max_value = 100.0f;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->current_slide_value = 1.0f;

	static_cast<EDataContainer_VerticalNamedSlider*>(EntityButton::get_last_custom_data(named_slider)->data_container)->rounded_numbers = true;

	named_slider->main_custom_data->actions_on_update.push_back(&EDataActionCollection::action_refresh_loot_simulator_when_release);

}

void EButtonGroupAttributeGeneratorGroup_DefenceProcentile::execute_attribute_group(EGameItem* _game_item, GameItemGenerator* _generator)
{
	if ((EWindowMain::loot_simulator_button_group->selected_procentile >= 0) && (_game_item->can_be_procentile))
	{
		EGameItemAttributeContainer*
		attribute_container = GameItemAttribute::add_new_game_attribute_by_name(_game_item, "BaseDefencePercentile");

		attribute_container->attribute_value_int = std::round(EWindowMain::loot_simulator_button_group->selected_procentile);
	}
}


void EButtonGroupAttributeGeneratorGroup_Explicit::init()
{
	name.set_ID_by_string("Explicits");
	//attribute_generator = new GameAttributeGeneratorItemLevel("GemLevel");
	EWindowMain::loot_simulator_button_group->attribute_group_list.push_back(this);
	EntityButtonWideItem*
	wide_button = nullptr;

	for (int i = 0; i < NSW_loot_simulator_explicit_button_count; i++)
	{
		wide_button = EntityButtonWideItem::create_wide_item_button
		(
			new ERegionGabarite(region_gabarite->size_x, 24.0f),
			this,
			nullptr,
			EFont::font_list[0],
			false
		);

		wide_button->main_text_area->localisation_text = ELocalisationText::get_localisation_by_key("empty_affix");
		wide_button->main_text_area->change_text(wide_button->main_text_area->localisation_text.localisations[ELocalisationText::active_localisation]);
		explicit_item_buttons[i] = wide_button;

		wide_button->main_clickable_area->actions_on_click_list.push_back(&EDataActionCollection::action_open_add_explicit_for_loot_simulator);
		
		wide_button->add_close_circle(&EDataActionCollection::action_reset_affix_for_loot_simulator);

		add_button_to_working_group_and_expand_y(wide_button);
	}
}
void EButtonGroupAttributeGeneratorGroup_Explicit::execute_attribute_group(EGameItem* _game_item, GameItemGenerator* _generator)
{
	for (int i = 0; i < NSW_loot_simulator_explicit_button_count; i++)
	{
		if ((explicit_item_buttons[i]->main_text_area->localisation_text.base_name != "") && (explicit_item_buttons[i]->pointer_to_data_entity != nullptr))
		{
			ELocalisationText
			ltext;

			ltext.base_name = explicit_item_buttons[i]->main_text_area->localisation_text.base_name;
			ltext.localisations[NSW_localisation_EN] = DataEntityUtils::get_tag_value_by_name(0, "name EN", explicit_item_buttons[i]->pointer_to_data_entity);
			ltext.localisations[NSW_localisation_RU] = DataEntityUtils::get_tag_value_by_name(0, "name RU", explicit_item_buttons[i]->pointer_to_data_entity);

			GameItemAttribute::add_new_listed_value_to_game_attribute
			(
				_game_item,
				"HasExplicitMod",
				ltext
			);
		}
	}
}

EntityButton* EButtonGroupPoeNijaPriceChecker::add_status_button(ELocalisationText _ltext, int _code, int _data_length)
{
	EntityButton*
	status_button = new EntityButton();



	status_button->make_default_button_with_unedible_text
	(
		new ERegionGabarite(region_gabarite->size_x, 35.0),
		this,
		nullptr,
		ELocalisationText()
	);
	status_button->can_be_stretched = true;

	if (_code == CURLE_OK)
	{
		if (_data_length > 500)
		{
			status_button->main_text_area->set_color(0.25f, 1.0f, 0.5f, 1.0f);

			status_button->main_text_area->localisation_text.localisations[NSW_localisation_EN] = _ltext.localisations[NSW_localisation_EN] + ": success!";
			status_button->main_text_area->localisation_text.localisations[NSW_localisation_RU] = _ltext.localisations[NSW_localisation_RU] + ": успешно!";
		}
		else
		{
			status_button->main_text_area->set_color(1.0f, 0.25f, 0.5f, 1.0f);

			status_button->main_text_area->localisation_text.localisations[NSW_localisation_EN] = _ltext.localisations[NSW_localisation_EN] + ": no data!";
			status_button->main_text_area->localisation_text.localisations[NSW_localisation_RU] = _ltext.localisations[NSW_localisation_RU] + ": мало данных!";
		}
	}
	else
	{
		status_button->main_text_area->set_color(1.0f, 0.25f, 0.5f, 1.0f);

		status_button->main_text_area->localisation_text.localisations[NSW_localisation_EN] = _ltext.localisations[NSW_localisation_EN] + ": ERROR #"	+ std::to_string(_code);
		status_button->main_text_area->localisation_text.localisations[NSW_localisation_RU] = _ltext.localisations[NSW_localisation_RU] + ": ОШИБКА #"	+ std::to_string(_code);
	}

	status_button->main_text_area->change_text(status_button->main_text_area->localisation_text.localisations[ELocalisationText::active_localisation]);

	pointer_to_status_group->add_button_to_working_group(status_button);

	NSWRegisteredButtonGroups::poe_ninja_price_checker_group->need_refresh = true;

	return status_button;
}
